<Objs Version="1.1.0.1" xmlns="http://schemas.microsoft.com/powershell/2004/04">
  <Obj RefId="0">
    <TN RefId="0">
      <T>System.Management.Automation.PSCustomObject</T>
      <T>System.Object</T>
    </TN>
    <MS>
      <S N="Type">Database</S>
      <S N="SqlVersion">2014</S>
      <S N="VulnID">V-67357</S>
      <S N="RuleID">SV-81847r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL4-00-002000</S>
      <S N="Title">SQL Server must enforce approved authorizations for logical access to information and database-level system resources in accordance with applicable access control policies.</S>
      <S N="Description">Authentication with a DoD-approved PKI certificate does not necessarily imply authorization to access the database and all its contents.  To mitigate the risk of unauthorized access to sensitive information by entities that have been issued certificates by DoD-approved PKIs, all DoD systems, including SQL Server databases, must be properly configured to implement access control policies. _x000A__x000A_Successful authentication must not automatically give an entity access to an asset or security boundary. Authorization procedures and controls must be implemented to ensure each authenticated entity also has a validated and current authorization. Authorization is the process of determining whether an entity, once authenticated, is permitted to access a specific asset. Information systems use access control policies and enforcement mechanisms to implement this requirement. _x000A__x000A_Access control policies include identity-based policies, role-based policies, and attribute-based policies. Access enforcement mechanisms include access control lists, access control matrices, and cryptography. These policies and mechanisms must be employed by the application to control access between users (or processes acting on behalf of users) and objects (e.g., devices, files, records, processes, programs, and domains) in the information system._x000A__x000A_This requirement is applicable to access control enforcement applications, a category that includes SQL Server.  If SQL Server is not configured to follow applicable policy when approving access, it may be in conflict with networks or other applications in the information system. This may result in users either gaining or being denied access inappropriately and in conflict with applicable policy.</S>
      <S N="FixText">Use GRANT, REVOKE, DENY, ALTER ROLE â€¦ ADD MEMBER â€¦ and/or ALTER ROLE â€¦. DROP MEMBER statements to add and remove permissions on database-level securables, bringing them into line with the documented requirements.</S>
      <S N="Check">Review the system documentation to determine the required levels of protection for securables in the database, by type of user._x000A__x000A_Review the permissions actually in place in the database. _x000A__x000A_The database permission functions and views provided in the supplemental file Permissions.sql can help with this._x000A__x000A_If the actual permissions do not match the documented requirements, this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="1">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Database</S>
      <S N="SqlVersion">2014</S>
      <S N="VulnID">V-67359</S>
      <S N="RuleID">SV-81849r2_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL4-00-011200</S>
      <S N="Title">SQL Server must generate Trace or Audit records for organization-defined auditable events.</S>
      <S N="Description">Audit records can be generated from various components within the information system (e.g., network interface, hard disk, modem, etc.). From an application perspective, certain specific application functionalities may be audited as well._x000A__x000A_The list of audited events is the set of events for which audits are to be generated. This set of events is typically a subset of the list of all events for which the system is capable of generating audit records.  Examples are auditable events, time stamps, source and destination addresses, user/process identifiers, event descriptions, success/fail indications, file names involved, and access control or flow control rules invoked._x000A__x000A_Organizations define which application components shall provide auditable events._x000A__x000A_The DBMS must provide auditing for the list of events defined by the organization or risk negatively impacting forensic investigations into malicious behavior in the information system._x000A__x000A_Use of SQL Server Audit is recommended.  All features of SQL Server Audit are available in the Enterprise and Developer editions of SQL Server 2014.  It is not available at the database level in other editions.  For this or legacy reasons, the instance may be using SQL Server Trace for auditing, which remains an acceptable solution for the time being.  Note, however, that Microsoft intends to remove most aspects of Trace at some point after SQL Server 2016.</S>
      <S N="FixText">Design and deploy a SQL Server Audit or Trace that captures all auditable events._x000A__x000A_The script provided in the supplemental file Trace.sql can be used to create a trace; edit it as necessary to capture any additional, locally-defined events._x000A__x000A_The script provided in the supplemental file Audit.sql can be used to create an audit; edit it as necessary to capture any additional, locally-defined events.</S>
      <S N="Check">If there are no locally-defined security tables or procedures, this is not applicable._x000A__x000A_If neither SQL Server Audit nor SQL Server Trace is in use for audit purposes, this is a finding._x000A__x000A_If SQL Server Trace is in use for audit purposes, verify that all required events are being audited. From the query prompt:_x000A_SELECT * FROM sys.traces;_x000A__x000A_All currently defined traces for the SQL server instance will be listed. If no traces are returned, this is a finding._x000A__x000A_Determine the trace(s) being used for the auditing requirement._x000A_In the following, replace # with a trace ID being used for the auditing requirements._x000A_From the query prompt:_x000A_SELECT DISTINCT(eventid) FROM sys.fn_trace_geteventinfo(#);_x000A__x000A_The following required event IDs should all be among those listed; if not, this is a finding._x000A__x000A_Any additional events locally defined should also be in the list; if not, this is a finding._x000A__x000A_14 -- Audit Login_x000A_15 -- Audit Logout_x000A_16 -- Attention_x000A_17 -- ExistingConnection_x000A_18 -- Audit Server Starts and Stops_x000A_20 -- Audit Login Failed_x000A_42 -- SP:Starting_x000A_43 -- SP:Completed_x000A_46 -- Object:Created_x000A_47 -- Object:Deleted_x000A_90 -- User-defined Event_x000A_102 -- Audit Database Scope GDR Event_x000A_103 -- Audit Object GDR Event_x000A_104 -- Audit AddLogin Event_x000A_105 -- Audit Login GDR Event_x000A_106 -- Audit Login Change Property Event_x000A_107 -- Audit Login Change Password Event_x000A_108 -- Audit Add Login to Server Role Event_x000A_109 -- Audit Add DB User Event_x000A_110 -- Audit Add Member to DB Role Event_x000A_111 -- Audit Add Role Event_x000A_112 -- Audit App Role Change Password Event_x000A_113 -- Audit Statement Permission Event_x000A_115 -- Audit Backup/Restore Event_x000A_116 -- Audit DBCC Event_x000A_117 -- Audit Change Audit Event_x000A_118 -- Audit Object Derived Permission Event_x000A_128 -- Audit Database Management Event_x000A_129 -- Audit Database Object Management Event_x000A_130 -- Audit Database Principal Management Event_x000A_131 -- Audit Schema Object Management Event_x000A_132 -- Audit Server Principal Impersonation Event_x000A_133 -- Audit Database Principal Impersonation Event_x000A_134 -- Audit Server Object Take Ownership Event_x000A_135 -- Audit Database Object Take Ownership Event_x000A_152 -- Audit Change Database Owner_x000A_153 -- Audit Schema Object Take Ownership Event_x000A_162 -- User error message_x000A_164 -- Object:Altered_x000A_170 -- Audit Server Scope GDR Event_x000A_171 -- Audit Server Object GDR Event_x000A_172 -- Audit Database Object GDR Event_x000A_173 -- Audit Server Operation Event_x000A_175 -- Audit Server Alter Trace Event_x000A_176 -- Audit Server Object Management Event_x000A_177 -- Audit Server Principal Management Event_x000A_178 -- Audit Database Operation Event_x000A_180 -- Audit Database Object Access Event_x000A__x000A__x000A_If SQL Server Audit is in use, proceed as follows._x000A__x000A_The basic SQL Server Audit configuration provided in the supplemental file Audit.sql uses broad, server-level audit action groups for this purpose. SQL Server Audit's flexibility makes other techniques possible._x000A__x000A_If an alternative technique is in use and demonstrated effective, this is not a finding._x000A__x000A_Determine the name(s) of the server audit specification(s) in use._x000A__x000A_To look at audits and audit specifications, in Management Studio's object explorer, expand _x000A_&lt;server name&gt; &gt;&gt; Security &gt;&gt; Audits_x000A_and_x000A_&lt;server name&gt; &gt;&gt; Security &gt;&gt; Server Audit Specifications._x000A_Also, _x000A_&lt;server name&gt; &gt;&gt; Databases &gt;&gt; &lt;database name&gt; &gt;&gt; Security &gt;&gt; Database Audit Specifications._x000A__x000A_Alternatively, review the contents of the system views with "audit" in their names._x000A__x000A_Run the following code to verify that all configuration-related actions are being audited:_x000A_USE [master];_x000A_GO_x000A_SELECT * FROM sys.server_audit_specification_details WHERE server_specification_id =_x000A_(SELECT server_specification_id FROM sys.server_audit_specifications WHERE [name] = '&lt;server_audit_specification_name&gt;');_x000A_GO_x000A__x000A_Examine the list produced by the query._x000A__x000A_If the audited_result column is not "SUCCESS AND FAILURE" on every row, this is a finding._x000A__x000A_If any of the following audit action groups is not included in the list, this is a finding._x000A__x000A_APPLICATION_ROLE_CHANGE_PASSWORD_GROUP_x000A_AUDIT_CHANGE_GROUP_x000A_BACKUP_RESTORE_GROUP_x000A_DATABASE_CHANGE_GROUP_x000A_DATABASE_OBJECT_ACCESS_GROUP_x000A_DATABASE_OBJECT_OWNERSHIP_CHANGE_GROUP_x000A_DATABASE_OBJECT_PERMISSION_CHANGE_GROUP_x000A_DATABASE_OPERATION_GROUP_x000A_DATABASE_OWNERSHIP_CHANGE_GROUP_x000A_DATABASE_PERMISSION_CHANGE_GROUP_x000A_DATABASE_PRINCIPAL_CHANGE_GROUP_x000A_DATABASE_PRINCIPAL_IMPERSONATION_GROUP_x000A_DATABASE_ROLE_MEMBER_CHANGE_GROUP_x000A_DBCC_GROUP_x000A_FAILED_LOGIN_GROUP_x000A_LOGIN_CHANGE_PASSWORD_GROUP_x000A_LOGOUT_GROUP_x000A_SCHEMA_OBJECT_ACCESS_GROUP_x000A_SCHEMA_OBJECT_CHANGE_GROUP_x000A_SCHEMA_OBJECT_OWNERSHIP_CHANGE_GROUP_x000A_SCHEMA_OBJECT_PERMISSION_CHANGE_GROUP_x000A_SERVER_OBJECT_CHANGE_GROUP_x000A_SERVER_OBJECT_OWNERSHIP_CHANGE_GROUP_x000A_SERVER_OBJECT_PERMISSION_CHANGE_GROUP_x000A_SERVER_OPERATION_GROUP_x000A_SERVER_PERMISSION_CHANGE_GROUP_x000A_SERVER_PRINCIPAL_CHANGE_GROUP_x000A_SERVER_PRINCIPAL_IMPERSONATION_GROUP_x000A_SERVER_ROLE_MEMBER_CHANGE_GROUP_x000A_SERVER_STATE_CHANGE_GROUP_x000A_SUCCESSFUL_LOGIN_GROUP_x000A_TRACE_CHANGE_GROUP</S>
    </MS>
  </Obj>
  <Obj RefId="2">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Database</S>
      <S N="SqlVersion">2014</S>
      <S N="VulnID">V-67361</S>
      <S N="RuleID">SV-81851r2_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL4-00-011320</S>
      <S N="Title">Where SQL Server Audit is in use at the database level, SQL Server must allow only the ISSM (or individuals or roles appointed by the ISSM) to select which auditable events are to be audited at the database level.</S>
      <S N="Description">Without the capability to restrict which roles and individuals can select which events are audited, unauthorized personnel may be able to prevent or interfere with the auditing of critical events._x000A__x000A_Suppression of auditing could permit an adversary to evade detection._x000A__x000A_Misconfigured audits can degrade the system's performance by overwhelming the audit log. Misconfigured audits may also make it more difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one._x000A__x000A_Use of SQL Server Audit is recommended.  All features of SQL Server Audit are available in the Enterprise and Developer editions of SQL Server 2014.  It is not available at the database level in other editions.  For this or legacy reasons, the instance may be using SQL Server Trace for auditing, which remains an acceptable solution for the time being.  Note, however, that Microsoft intends to remove most aspects of Trace at some point after SQL Server 2016._x000A__x000A_This version of the requirement deals with SQL Server Audit-based audit trails.</S>
      <S N="FixText">Create a database role specifically for audit maintainers, and give it permission to maintain audits, without granting it unnecessary permissions:_x000A_USE &lt;database name&gt;;_x000A_GO_x000A_CREATE ROLE DATABASE_AUDIT_MAINTAINERS;_x000A_GO_x000A_GRANT ALTER ANY DATABASE AUDIT TO DATABASE_AUDIT_MAINTAINERS;_x000A_GO_x000A_(The role name used here is an example; other names may be used.)_x000A__x000A_Use REVOKE and/or DENY and/or ALTER ROLE ... DROP MEMBER ... statements to remove the ALTER ANY DATABASE AUDIT permission from all users._x000A__x000A_Then, for each authorized database user, run the statement:_x000A_ALTER ROLE DATABASE_AUDIT_MAINTAINERS ADD MEMBER &lt;user name&gt; ;_x000A_GO_x000A__x000A_Use REVOKE and/or DENY and/or ALTER SERVER ROLE ... DROP MEMBER ... statements to remove CONTROL DATABASE permission from logins that do not need it.</S>
      <S N="Check">If SQL Server Audit is not in use at the database level, this is not applicable (NA)._x000A__x000A_Obtain the list of approved audit maintainers from the system documentation._x000A__x000A_Review the database roles and individual users that have the following permissions, both of which enable the ability to maintain audit definitions:_x000A_ALTER ANY DATABASE AUDIT_x000A_CONTROL ON DATABASE_x000A__x000A_The functions and views provided in the supplemental file Permissions.sql can assist in this review.  In the following, "STIG" stands for the schema where you have deployed these views and functions.  To see which logins and server roles have been granted these permissions:_x000A_    SELECT_x000A_        *_x000A_    FROM_x000A_        STIG.database_permissions P_x000A_    WHERE_x000A_        (P.[Permission] = 'ALTER ANY DATABASE AUDIT')_x000A_        OR_x000A_        (P.[Permission] = 'CONTROL' AND P.[Securable Type or Class] = 'DATABASE')_x000A_        ;_x000A__x000A_To see what users and database roles inherit these permissions from the database roles reported by the previous query, repeat the following for each one:_x000A_    SELECT * FROM STIG.members_of_database_role(&lt;database role name&gt;);_x000A__x000A_To see all the permissions in effect for a database principal (server role or login):_x000A_    SELECT * FROM STIG.server_effective_permissions(&lt;principal name&gt;); _x000A__x000A_If designated personnel are not able to configure auditable events, this is a finding._x000A__x000A_If unapproved personnel are able to configure auditable events, this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="3">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Database</S>
      <S N="SqlVersion">2014</S>
      <S N="VulnID">V-67365</S>
      <S N="RuleID">SV-81855r2_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL4-00-014900</S>
      <S N="Title">SQL Server must be monitored to discover unauthorized changes to functions.</S>
      <S N="Description">When dealing with change control issues, it should be noted, any changes to the hardware, software, and/or firmware components of SQL Server and/or application can potentially have significant effects on the overall security of the system._x000A__x000A_If SQL Server were to allow any user to make changes to software libraries, then those changes might be implemented without undergoing the appropriate testing and approvals that are part of a robust change management process._x000A__x000A_This requirement is contingent upon the language in which the application is programmed, as many application architectures in use today incorporate their software libraries into, and make them inseparable from, their compiled distributions, rendering them static and version-dependent. However, this requirement does apply to applications with software libraries accessible and configurable, as in the case of interpreted languages._x000A__x000A_Accordingly, only qualified and authorized individuals shall be allowed to obtain access to SQL Server components for purposes of initiating changes, including upgrades and modifications._x000A__x000A_Unmanaged changes that occur to the SQL Server software libraries or configuration, such as Functions, can lead to unauthorized or compromised installations.</S>
      <S N="FixText">Configure a SQL Server timed job that automatically checks all system and user-defined Functions for being modified. _x000A__x000A_(The supplemental file Track.sql, provided with this STIG, can be used to establish a monitoring job.  This should be supplemented with a process for informing the appropriate personnel.  Other techniques for achieving the same ends, such as the use of DDL triggers, are acceptable.)</S>
      <S N="Check">Check the SQL Server configuration for a timed job that automatically checks all system and user-defined Functions for being modified by running the following SQL Server query:_x000A_EXEC msdb.dbo.sp_help_job @job_name = '&lt;enter . . . job name&gt;';_x000A__x000A_(Alternatively, in SQL Server Management Studio, navigate to SQL Server Agent and examine the job from there.)_x000A__x000A_If a timed job or some other method is not implemented to check for Functions being modified, this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="4">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Database</S>
      <S N="SqlVersion">2014</S>
      <S N="VulnID">V-67367</S>
      <S N="RuleID">SV-81857r2_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL4-00-015100</S>
      <S N="Title">SQL Server must be monitored to discover unauthorized changes to triggers.</S>
      <S N="Description">When dealing with change control issues, it should be noted, any changes to the hardware, software, and/or firmware components of SQL Server and/or application can potentially have significant effects on the overall security of the system._x000A__x000A_If SQL Server were to allow any user to make changes to software libraries, then those changes might be implemented without undergoing the appropriate testing and approvals that are part of a robust change management process._x000A__x000A_This requirement is contingent upon the language in which the application is programmed, as many application architectures in use today incorporate their software libraries into, and make them inseparable from, their compiled distributions, rendering them static and version-dependent. However, this requirement does apply to applications with software libraries accessible and configurable, as in the case of interpreted languages._x000A__x000A_Accordingly, only qualified and authorized individuals shall be allowed to obtain access to SQL Server components for purposes of initiating changes, including upgrades and modifications._x000A__x000A_Unmanaged changes that occur to the SQL Server software libraries or configuration, such as Triggers, can lead to unauthorized or compromised installations.</S>
      <S N="FixText">Configure a SQL Server timed job that automatically checks all system and user-defined Triggers for modification._x000A__x000A_(The supplemental file Track.sql, provided with this STIG, can be used to establish a monitoring job.  This should be supplemented with a process for informing the appropriate personnel.  Other techniques for achieving the same ends, such as the use of DDL triggers, are acceptable.)</S>
      <S N="Check">Check the SQL Server configuration for the timed job that automatically checks all system and user-defined Triggers for being modified by running the following SQL Server query:_x000A_EXEC msdb.dbo.sp_help_job @job_name = '&lt;enter . . . job name&gt;';_x000A__x000A_(Alternatively, in SQL Server Management Studio, navigate to SQL Server Agent and examine the job from there.)_x000A__x000A_If such a job, or an alternative method of monitoring triggers for modification, does not exist, this is a finding</S>
    </MS>
  </Obj>
  <Obj RefId="5">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Database</S>
      <S N="SqlVersion">2014</S>
      <S N="VulnID">V-67369</S>
      <S N="RuleID">SV-81859r2_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL4-00-015200</S>
      <S N="Title">SQL Server must be monitored to discover unauthorized changes to stored procedures.</S>
      <S N="Description">When dealing with change control issues, it should be noted, any changes to the hardware, software, and/or firmware components of SQL Server and/or application can potentially have significant effects on the overall security of the system._x000A__x000A_If SQL Server were to allow any user to make changes to software libraries, then those changes might be implemented without undergoing the appropriate testing and approvals that are part of a robust change management process._x000A__x000A_This requirement is contingent upon the language in which the application is programmed, as many application architectures in use today incorporate their software libraries into, and make them inseparable from, their compiled distributions, rendering them static and version-dependent. However, this requirement does apply to applications with software libraries accessible and configurable, as in the case of interpreted languages._x000A__x000A_Accordingly, only qualified and authorized individuals shall be allowed to obtain access to SQL Server components for purposes of initiating changes, including upgrades and modifications._x000A__x000A_Unmanaged changes that occur to the SQL Server software libraries or configuration, such as Stored Procedures, can lead to unauthorized or compromised installations.</S>
      <S N="FixText">Configure a SQL Server timed job that automatically checks all system and user-defined Stored Procedures for modification._x000A__x000A_(The supplemental file Track.sql, provided with this STIG, can be used to establish a monitoring job.  This should be supplemented with a process for informing the appropriate personnel.  Other techniques for achieving the same ends, such as the use of DDL triggers, are acceptable.)</S>
      <S N="Check">Check for the existence of a job to monitor for changes to stored procedures:_x000A_EXEC msdb.dbo.sp_help_job @job_name = '&lt;enter . . . job name&gt;';_x000A__x000A_(Alternatively, in SQL Server Management Studio, navigate to SQL Server Agent and examine the job from there.)_x000A__x000A_If such a job, or an alternative method of monitoring stored procedures for modification, does not exist, this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="6">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Database</S>
      <S N="SqlVersion">2014</S>
      <S N="VulnID">V-67371</S>
      <S N="RuleID">SV-81861r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL4-00-015600</S>
      <S N="Title">Database objects (including but not limited to tables, indexes, storage, stored procedures, functions, triggers, links to software external to SQL Server, etc.) must be owned by database/DBMS principals authorized for ownership.</S>
      <S N="Description">Within the database, object ownership implies full privileges to the owned object, including the privilege to assign access to the owned objects to other subjects. Database functions and procedures can be coded using definer's rights. This allows anyone who utilizes the object to perform the actions if they were the owner. If not properly managed, this can lead to privileged actions being taken by unauthorized individuals._x000A__x000A_Conversely, if critical tables or other objects rely on unauthorized owner accounts, these objects may be lost when an account is removed.</S>
      <S N="FixText">Add and/or update system documentation to include any accounts authorized for object ownership and remove any account not authorized._x000A__x000A_To change the schema owning a database object in SQL Server, use this code:_x000A_USE &lt;database name&gt;;_x000A_GO_x000A_ALTER SCHEMA &lt;name of new schema&gt; TRANSFER &lt;name of old schema&gt;.&lt;object name&gt;;_x000A_GO_x000A__x000A_Caution:  this can break code.  This Fix should be implemented in conjunction with corrections to such code.  Test before deploying in production.  Deploy during a scheduled maintenance window.</S>
      <S N="Check">Review system documentation to identify SQL Server accounts authorized to own database objects._x000A__x000A_If the SQL Server database ownership list does not exist or needs to be updated, this is a finding._x000A__x000A_The view STIG.database_permissions, included in the supplemental file, Permissions.sql, can be of use in making this determination:_x000A_USE &lt;database name&gt;;_x000A_GO_x000A_SELECT DISTINCT_x000A_        S.[Schema/Owner] AS  [Owner],_x000A_        O.[Schema/Owner] AS [Schema],_x000A_        O.[Securable]_x000A_FROM_x000A_        STIG.database_permissions O_x000A_        INNER JOIN STIG.database_permissions S_x000A_                ON S.[Securable] = O.[Schema/Owner]_x000A_                AND O.[Securable Type or Class] = 'OBJECT_OR_COLUMN'_x000A_                AND S.[Securable Type or Class] = 'SCHEMA'_x000A_WHERE_x000A_        S.[Schema/Owner] NOT IN ('dbo', 'sys', 'INFORMATION_SCHEMA' ... )_x000A_        --  Complete the "NOT IN" list with the names of user accounts authorized for ownership._x000A_;_x000A_If any of the listed owners is not authorized, this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="7">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Database</S>
      <S N="SqlVersion">2014</S>
      <S N="VulnID">V-67373</S>
      <S N="RuleID">SV-81863r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL4-00-015620</S>
      <S N="Title">In a database owned by a login not having administrative privileges at the instance level, the database property TRUSTWORTHY must be OFF unless required and authorized.</S>
      <S N="Description">SQL Server's fixed (built-in) server roles, especially [sysadmin], have powerful capabilities that could cause great harm if misused, so their use must be tightly controlled._x000A__x000A_The SQL Server instance uses each database's TRUSTWORTHY property to guard against tampering that could enable unwarranted privilege escalation. When TRUSTWORTHY is 0/False/Off, SQL Server prevents the database from accessing resources in other databases. When TRUSTWORTHY is 1/True/On, SQL Server permits access to other databases (subject to other protections). SQL Server sets TRUSTWORTHY OFF when it creates a new database. SQL Server forces TRUSTWORTHY OFF, irrespective of its prior value, when an existing database is attached to it, to address the possibility that an adversary may have tampered with the database, introducing malicious code. To set TRUSTWORTHY ON, an account with the [sysadmin] role must issue an ALTER DATABASE command._x000A__x000A_Although SQL Server itself treats this property conservatively, application installer programs may set TRUSTWORTHY ON and leave it on. This provides an opportunity for misuse._x000A__x000A_When TRUSTWORTHY is ON, users of the database can take advantage of the database owner's privileges, by impersonating the owner. This can have particularly serious consequences if the database owner is the [sa] login (which may have been renamed in accordance with SQL4-00-010200, and disabled in accordance with SQL4-00-017100, but nonetheless can be invoked in an EXECUTE AS USER = 'dbo' statement, or CREATE PROCEDURE ... WITH EXECUTE AS OWNER ...). The [sa] login cannot be removed from the [sysadmin] role. The user impersonating [sa] - or another [sysadmin] account - is then able to perform administrative actions across all databases under the instance, including making any himself or any other login a member of [sysadmin]._x000A__x000A_Most of the other fixed server roles could be similarly abused._x000A__x000A_Therefore, TRUSTWORTHY must not be used on databases owned by logins that are members of the fixed server roles. Further, if TRUSTWORTHY is to be used for any other database, the need must be documented and approved._x000A__x000A_The system database [msdb] is an exception: it is required to be TRUSTWORTHY.</S>
      <S N="FixText">Run the SQL statements:_x000A_USE [master];_x000A_GO_x000A_ALTER DATABASE &lt;name&gt; SET TRUSTWORTHY OFF;_x000A_GO</S>
      <S N="Check">If the database is owned by an account that is directly or indirectly a member of a fixed (built-in) server role, this is not applicable (NA)._x000A__x000A_Run the query:_x000A_USE &lt;database name&gt;;_x000A_GO_x000A_SELECT_x000A_DB_NAME() AS [Database],_x000A_SUSER_SNAME(D.owner_sid) AS [Database Owner],_x000A_CASE WHEN D.is_trustworthy_on = 1 THEN 'ON' ELSE 'off' END_x000A_AS [Trustworthy]_x000A_FROM_x000A_sys.databases D_x000A_WHERE_x000A_D.[name] = DB_NAME()_x000A_AND DB_NAME() &lt;&gt; 'msdb'_x000A_AND D.is_trustworthy_on = 1;_x000A_GO_x000A_If the query returns a row indicating that the TRUSTWORTHY setting is OFF, or returns no rows, this is not a finding._x000A__x000A_Review the system security plan to determine whether the need for TRUSTWORTHY is documented and approved. If not, this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="8">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Database</S>
      <S N="SqlVersion">2014</S>
      <S N="VulnID">V-67375</S>
      <S N="RuleID">SV-81865r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL4-00-015610</S>
      <S N="Title">In a database owned by [sa], or by any other login having administrative privileges at the instance level, the database property TRUSTWORTHY must be OFF.</S>
      <S N="Description">SQL Server's fixed (built-in) server roles, especially [sysadmin], have powerful capabilities that could cause great harm if misused, so their use must be tightly controlled._x000A__x000A_The SQL Server instance uses each database's TRUSTWORTHY property to guard against tampering that could enable unwarranted privilege escalation. When TRUSTWORTHY is 0/False/Off, SQL Server prevents the database from accessing resources in other databases. When TRUSTWORTHY is 1/True/On, SQL Server permits access to other databases (subject to other protections). SQL Server sets TRUSTWORTHY OFF when it creates a new database. SQL Server forces TRUSTWORTHY OFF, irrespective of its prior value, when an existing database is attached to it, to address the possibility that an adversary may have tampered with the database, introducing malicious code. To set TRUSTWORTHY ON, an account with the [sysadmin] role must issue an ALTER DATABASE command._x000A__x000A_Although SQL Server itself treats this property conservatively, application installer programs may set TRUSTWORTHY ON and leave it on. This provides an opportunity for misuse._x000A__x000A_When TRUSTWORTHY is ON, users of the database can take advantage of the database owner's privileges, by impersonating the owner. This can have particularly serious consequences if the database owner is the [sa] login (which may have been renamed in accordance with SQL4-00-010200, and disabled in accordance with SQL4-00-017100, but nonetheless can be invoked in an EXECUTE AS USER = 'dbo' statement, or CREATE PROCEDURE ... WITH EXECUTE AS OWNER ...). The [sa] login cannot be removed from the [sysadmin] role. The user impersonating [sa] - or another [sysadmin] account - is then able to perform administrative actions across all databases under the instance, including making any himself or any other login a member of [sysadmin]._x000A__x000A_Most of the other fixed server roles could be similarly abused._x000A__x000A_Therefore, TRUSTWORTHY must not be used on databases owned by logins that are members of the fixed server roles. Further, if TRUSTWORTHY is to be used for any other database, the need must be documented and approved._x000A__x000A_The system database [msdb] is an exception: it is required to be TRUSTWORTHY.</S>
      <S N="FixText">Set the TRUSTWORTHY property OFF; or remove the database owner from the fixed server role(s); or change the database owner._x000A__x000A_To set the TRUSTWORTHY property OFF:_x000A_USE [master];_x000A_GO_x000A_ALTER DATABASE &lt;name&gt; SET TRUSTWORTHY OFF;_x000A_GO_x000A_Verify that this produced the intended result by re-running the query specified in the Check._x000A__x000A_To determine the path or paths by which the database owner is assigned the fixed server role or roles, run this query:_x000A__x000A_USE &lt;database name&gt;;_x000A_GO_x000A_WITH C AS_x000A_(_x000A_SELECT_x000A_      P.name      AS [Parent Server Role],_x000A_      CAST('Fixed' AS varchar(8))_x000A_                  AS [Server Role Type],_x000A_      M.name      AS [Member],_x000A_      M.type_desc AS [Member Type],_x000A_      P.name      AS [Root],_x000A_      1           AS [Level]_x000A_FROM_x000A_      [sys].[server_role_members] X_x000A_      INNER JOIN [sys].[server_principals] P ON P.principal_id = X.role_principal_id_x000A_      INNER JOIN [sys].[server_principals] M ON M.principal_id = X.member_principal_id_x000A_WHERE_x000A_      P.is_fixed_role = 1_x000A_UNION ALL_x000A_SELECT_x000A_      P.name        AS [Parent Server Role],_x000A_      CASE WHEN M.is_fixed_role = 1 THEN CAST('Fixed' AS varchar(8)) ELSE CAST('Custom' AS varchar(8)) END_x000A_                    AS [Server Role Type],_x000A_      M.name        AS [Member],_x000A_      M.type_desc   AS [Member Type],_x000A_      C.[Root]      AS [Root],_x000A_      C.[Level] + 1 AS [Level]_x000A_FROM_x000A_      [sys].[server_role_members] X_x000A_      INNER JOIN [sys].[server_principals] P ON P.principal_id = X.role_principal_id_x000A_      INNER JOIN [sys].[server_principals] M ON M.principal_id = X.member_principal_id_x000A_      INNER JOIN C ON P.name = C.Member_x000A_)_x000A_,_x000A_B AS_x000A_(_x000A_SELECT_x000A_      C.[Member] AS [Leaf],_x000A_      C.[Root],_x000A_      C.[Parent Server Role],_x000A_      C.[Server Role Type],_x000A_      C.[Member],_x000A_      C.[Member Type],_x000A_      C.[Level]_x000A_FROM C_x000A_WHERE_x000A_      C.[Member Type] NOT LIKE '%ROLE%'_x000A_UNION ALL_x000A_SELECT_x000A_      B.[Leaf],_x000A_      C.[Root],_x000A_      C.[Parent Server Role],_x000A_      C.[Server Role Type],_x000A_      C.[Member],_x000A_      C.[Member Type],_x000A_      C.[Level]_x000A_FROM C_x000A_INNER JOIN B_x000A_      ON       C.[Member] = B.[Parent Server Role]_x000A_      AND       C.[Level] = B.[Level] - 1_x000A_      AND       C.[Root] = B.[Root]_x000A_)_x000A_SELECT_x000A_      DB_NAME() AS [Database],_x000A_      B.[Leaf]  AS [Owner Login],_x000A_      B.[Root]  AS[Top-Level Server Role],_x000A_      B.[Parent Server Role],_x000A_      B.[Server Role Type],_x000A_      B.[Member],_x000A_      B.[Member Type],_x000A_      B.[Level]_x000A_FROM B_x000A_WHERE B.[Leaf] = (SELECT SUSER_SNAME(D.owner_sid) FROM sys.databases D WHERE D.Name = DB_NAME())_x000A_ORDER BY B.[Root], B.[Level], B.[Parent Server Role], B.[Member]_x000A_;_x000A_GO_x000A__x000A_To remove the database owner from a fixed server role or a custom server role:_x000A_USE [master];_x000A_GO_x000A_ALTER SERVER ROLE &lt;fixed/custom server role name&gt;_x000A_      DROP MEMBER &lt;database owner name&gt;;_x000A_GO_x000A_Verify that this produced the intended result by re-running the Check query._x000A__x000A_To change the database owner:_x000A_USE [master];_x000A_GO_x000A_ALTER AUTHORIZATION ON DATABASE::&lt;DB name&gt; TO &lt;new owner name&gt;;_x000A_GO_x000A_Verify that this produced the intended result by re-running the Check query.</S>
      <S N="Check">Run the SQL statements:_x000A_USE &lt;database name&gt;;_x000A_GO_x000A_WITH FixedServerRoles(RoleName) AS_x000A_(_x000A_      SELECT 'sysadmin'_x000A_      UNION SELECT 'securityadmin'_x000A_      UNION SELECT 'serveradmin'_x000A_      UNION SELECT 'setupadmin'_x000A_      UNION SELECT 'processadmin'_x000A_      UNION SELECT 'diskadmin'_x000A_      UNION SELECT 'dbcreator'_x000A_      UNION SELECT 'bulkadmin'_x000A_)_x000A_SELECT_x000A_      DB_NAME() AS [Database],_x000A_      SUSER_SNAME(D.owner_sid) AS [Database Owner],_x000A_      F.RoleName AS [Fixed Server Role],_x000A_      CASE WHEN D.is_trustworthy_on = 1 THEN 'ON' ELSE 'off' END_x000A_            AS [Trustworthy]      _x000A_FROM_x000A_      FixedServerRoles F_x000A_      INNER JOIN sys.databases D ON D.Name = DB_NAME()_x000A_WHERE_x000A_      IS_SRVROLEMEMBER(F.RoleName, SUSER_SNAME(D.owner_sid)) = 1_x000A_AND   DB_NAME() &lt;&gt; 'msdb'_x000A_AND   D.is_trustworthy_on = 1;_x000A_GO_x000A__x000A_If the query returns any rows, this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="9">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Database</S>
      <S N="SqlVersion">2014</S>
      <S N="VulnID">V-67381</S>
      <S N="RuleID">SV-81871r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL4-00-024100</S>
      <S N="Title">The Database Master Key must be encrypted by the Service Master Key, where a Database Master Key is required and another encryption method has not been specified.</S>
      <S N="Description">When not encrypted by the Service Master Key, system administrators or application administrators may access and use the Database Master Key to view sensitive data that they are not authorized to view. Where alternate encryption means are not feasible, encryption by the Service Master Key may be necessary. To help protect sensitive data from unauthorized access by DBAs, mitigations may be in order. Mitigations may include automatic alerts or other audit events when the Database Master Key is accessed outside of the application or by a DBA account.</S>
      <S N="FixText">Where possible, encrypt the Database Master Key with a password known only to the application administrator.  Where not possible, configure additional audit events or alerts to detect unauthorized access to the Database Master Key by users not authorized to view sensitive data.</S>
      <S N="Check">If no databases require encryption, this is not a finding._x000A__x000A_From the query prompt:_x000A_SELECT name_x000A_FROM [master].sys.databases_x000A_WHERE is_master_key_encrypted_by_server = 1_x000A_AND owner_sid &lt;&gt; 1_x000A_AND state = 0;_x000A_(Note that this query assumes that the [sa] account is not used as the owner of application databases, in keeping with other STIG guidance.  If this is not the case, modify the query accordingly.)_x000A__x000A_If no databases are returned by the query, this is not a finding._x000A__x000A_For any databases returned, verify in the System Security Plan that encryption of the Database Master Key using the Service Master Key is acceptable and approved by the Information Owner, and the encrypted data does not require additional protections to deter or detect DBA access. If not approved, this is a finding._x000A__x000A_If approved and additional protections are required, then verify the additional requirements are in place in accordance with the System Security Plan. These may include additional auditing on access of the Database Master Key with alerts or other automated monitoring._x000A__x000A_If the additional requirements are not in place, this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="10">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Database</S>
      <S N="SqlVersion">2014</S>
      <S N="VulnID">V-67383</S>
      <S N="RuleID">SV-81873r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL4-00-024200</S>
      <S N="Title">Database Master Key passwords must not be stored in credentials within the database.</S>
      <S N="Description">Storage of the Database Master Key password in a database credential allows decryption of sensitive data by privileged users who may not have a need-to-know requirement to access the data.</S>
      <S N="FixText">Use the stored procedure sp_control_dbmasterkey_password to remove any credentials that_x000A_store Database Master Key passwords._x000A_From the query prompt:_x000A_EXEC SP_CONTROL_DBMASTERKEY_PASSWORD @db_name = '&lt;database name&gt;', @action_x000A_= N'drop'</S>
      <S N="Check">From the query prompt:_x000A_SELECT COUNT(credential_id)_x000A_FROM [master].sys.master_key_passwords_x000A__x000A_If count is not 0, this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="11">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Database</S>
      <S N="SqlVersion">2014</S>
      <S N="VulnID">V-67385</S>
      <S N="RuleID">SV-81875r2_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL4-00-024300</S>
      <S N="Title">Symmetric keys (other than the database master key) must use a DoD certificate to encrypt the key.</S>
      <S N="Description">Data within the database is protected by use of encryption. The symmetric keys are critical for this process. If the symmetric keys were to be compromised the data could be disclosed to unauthorized personnel._x000A__x000A_The database master key is exempt, as a password must be supplied when creating it.</S>
      <S N="FixText">Configure or alter symmetric keys to encrypt keys with certificates or authorized asymmetric keys._x000A_In a query tool:_x000A_     ALTER SYMMETRIC KEY &lt;key name&gt; ADD ENCRYPTION BY CERTIFICATE &lt;certificate name&gt;;_x000A_     ALTER SYMMETRIC KEY &lt;key name&gt; DROP ENCRYPTION BY &lt;password, symmetric key or asymmetric key&gt;;_x000A__x000A_The symmetric key must specify a certificate or asymmetric key for encryption.</S>
      <S N="Check">In a query tool:_x000A_USE &lt;database name&gt;;_x000A_GO_x000A_SELECT s.name, k.crypt_type_desc_x000A_FROM sys.symmetric_keys s, sys.key_encryptions k_x000A_WHERE s.symmetric_key_id = k.key_id_x000A_AND s.name &lt;&gt; '##MS_DatabaseMasterKey##'_x000A_AND k.crypt_type IN ('ESKP', 'ESKS')_x000A_ORDER BY s.name, k.crypt_type_desc;_x000A_GO_x000A__x000A_Review any symmetric keys that have been defined against the System Security Plan._x000A__x000A_If any keys are defined that are not documented in the System Security Plan, this is a finding._x000A__x000A_Review the System Security Plan to review the encryption mechanism specified for each symmetric key. If the method does not indicate use of certificates, this is a finding._x000A__x000A_If the certificate specified is not a DoD PKI certificate, this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="12">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Database</S>
      <S N="SqlVersion">2014</S>
      <S N="VulnID">V-67389</S>
      <S N="RuleID">SV-81879r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL4-00-021800</S>
      <S N="Title">Database contents must be protected from unauthorized and unintended information transfer by enforcement of a data-transfer policy.</S>
      <S N="Description">The purpose of this control is to prevent information, including encrypted representations of information, produced by the actions of a prior user/role (or the actions of a process acting on behalf of a prior user/role) from being available to any current user/role (or current process) that obtains access to a shared system resource (e.g., registers, main memory, secondary storage) after the resource has been released back to the information system. Control of information in shared resources is also referred to as object reuse._x000A__x000A_Data used for the development and testing of applications often involves copying data from production. It is important that specific procedures exist for this process, so copies of sensitive data are not misplaced or left in a temporary location without the proper controls.</S>
      <S N="FixText">Create and document a process for moving data from production to development/test systems and follow the process._x000A__x000A_Modify any code used for moving data from production to development/test systems to ensure copies of production data are not left in unsecured locations.</S>
      <S N="Check">Verify there are proper procedures in place for the transfer of development/test data from production. Review any scripts or code that exists for the movement of production data to development/test and verify copies of production data are not left in unprotected locations._x000A__x000A_If there is no documented procedure for data movement from production to development/test, this is a finding._x000A__x000A_If data movement code that copies from production to development/test does exist and leaves any copies of production data in unprotected locations, this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="13">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Database</S>
      <S N="SqlVersion">2014</S>
      <S N="VulnID">V-67391</S>
      <S N="RuleID">SV-81881r2_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL4-00-022500</S>
      <S N="Title">SQL Server must check the validity of all data inputs except those specifically identified by the organization.</S>
      <S N="Description">Invalid user input occurs when a user inserts data or characters into an applicationâ€™s data entry fields and the application is unprepared to process that data. This results in unanticipated application behavior potentially leading to an application or information system compromise. Invalid user input is one of the primary methods employed when attempting to compromise an application._x000A__x000A_SQL Server needs to validate the data userâ€™s attempt to input to the application for processing. Rules for checking the valid syntax and semantics of information system inputs (e.g., character set, length, numerical range, acceptable values) are in place to verify inputs match specified definitions for format and content. Inputs passed to interpreters are prescreened to prevent the content from being unintentionally interpreted as commands._x000A__x000A_A poorly designed database system can have many problems. A common issue with these types of systems is the missed opportunity to use constraints._x000A__x000A_This calls for inspection of application source code, which will require collaboration with the application developers. It is recognized that in many cases, the database administrator (DBA) is organizationally separate from the application developers and may have limited, if any, access to source code. Nevertheless, protections of this type are so important to the secure operation of databases that they must not be ignored. At a minimum, the DBA must attempt to obtain assurances from the development organization that this issue has been addressed and must document what has been discovered.</S>
      <S N="FixText">Use triggers, constraints, foreign keys, etc. to validate data input._x000A__x000A_Modify SQL Server to properly use the correct column data types as required in the database.</S>
      <S N="Check">Review DBMS code (stored procedures, functions, triggers), application code, settings, column and field definitions, and constraints to determine whether the database is protected against invalid input._x000A__x000A_If code exists that allows invalid data to be acted upon or input into the database, this is a finding._x000A__x000A_If column/field definitions are not reflective of the data, this is a finding._x000A__x000A_If columns/fields do not contain constraints and validity checking where required, this is a finding._x000A__x000A_Where a column/field is noted in the system documentation as necessarily free-form, even though its name and context suggest that it should be strongly typed and constrained, the absence of these protections is not a finding._x000A__x000A_Where a column/field is clearly identified by name, caption or context as Notes, Comments, Description, Text, etc., the absence of these protections is not a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="14">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Database</S>
      <S N="SqlVersion">2014</S>
      <S N="VulnID">V-67393</S>
      <S N="RuleID">SV-81883r2_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL4-00-031500</S>
      <S N="Title">The DBMS and associated applications must reserve the use of dynamic code execution for situations that require it.</S>
      <S N="Description">With respect to database management systems, one class of threat is known as SQL Injection, or more generally, code injection. It takes advantage of the dynamic execution capabilities of various programming languages, including dialects of SQL. In such cases, the attacker deduces the manner in which SQL statements are being processed, either from inside knowledge or by observing system behavior in response to invalid inputs. When the attacker identifies scenarios where SQL queries are being assembled by application code (which may be within the database or separate from it) and executed dynamically, the attacker is then able to craft input strings that subvert the intent of the query. Potentially, the attacker can gain unauthorized access to data, including security settings, and severely corrupt or destroy the database._x000A__x000A_The principal protection against code injection is not to use dynamic execution except where it provides necessary functionality that cannot be utilized otherwise. Use strongly typed data items rather than general-purpose strings as input parameters to task-specific, pre-compiled stored procedures and functions (and triggers)._x000A__x000A_This calls for inspection of application source code, which will require collaboration with the application developers. It is recognized that in many cases, the database administrator (DBA) is organizationally separate from the application developers and may have limited, if any, access to source code. Nevertheless, protections of this type are so important to the secure operation of databases that they must not be ignored. At a minimum, the DBA must attempt to obtain assurances from the development organization that this issue has been addressed and must document what has been discovered</S>
      <S N="FixText">Where dynamic code execution is employed in circumstances where the objective could practically be satisfied by static execution with strongly typed parameters, modify the code to do so.</S>
      <S N="Check">Review source code in the database (stored procedures, functions, triggers) and application source code, to identify cases of dynamic code execution._x000A__x000A_If dynamic code execution is employed in circumstances where the objective could practically be satisfied by static execution with strongly typed parameters, this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="15">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Database</S>
      <S N="SqlVersion">2014</S>
      <S N="VulnID">V-67395</S>
      <S N="RuleID">SV-81885r2_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL4-00-031600</S>
      <S N="Title">The DBMS and associated applications, when making use of dynamic code execution, must scan input data for invalid values that may indicate a code injection attack.</S>
      <S N="Description">With respect to database management systems, one class of threat is known as SQL Injection, or more generally, code injection. It takes advantage of the dynamic execution capabilities of various programming languages, including dialects of SQL. In such cases, the attacker deduces the manner in which SQL statements are being processed, either from inside knowledge or by observing system behavior in response to invalid inputs. When the attacker identifies scenarios where SQL queries are being assembled by application code (which may be within the database or separate from it) and executed dynamically, the attacker is then able to craft input strings that subvert the intent of the query. Potentially, the attacker can gain unauthorized access to data, including security settings, and severely corrupt or destroy the database._x000A__x000A_The principal protection against code injection is not to use dynamic execution except where it provides necessary functionality that cannot be utilized otherwise. Use strongly typed data items rather than general-purpose strings as input parameters to task-specific, pre-compiled stored procedures and functions (and triggers)._x000A__x000A_When dynamic execution is necessary, ways to mitigate the risk include the following, which should be implemented both in the on-screen application and at the database level, in the stored procedures:_x000A_-- Allow strings as input only when necessary. _x000A_-- Rely on data typing to validate numbers, dates, etc. Do not accept invalid values. If substituting other values for them, think carefully about whether this could be subverted._x000A_-- Limit the size of input strings to what is truly necessary._x000A_-- If single quotes/apostrophes, double quotes, semicolons, equals signs, angle brackets, or square brackets will never be valid as input, reject them._x000A_-- If comment markers will never be valid as input, reject them. In SQL, these are -- or /* */ _x000A_-- If HTML and XML tags, entities, comments, etc., will never be valid, reject them._x000A_-- If wildcards are present, reject them unless truly necessary. In SQL these are the underscore and the percentage sign, and the word ESCAPE is also a clue that wildcards are in use._x000A_-- If SQL key words, such as SELECT, INSERT, UPDATE, DELETE, CREATE, ALTER, DROP, ESCAPE, UNION, GRANT, REVOKE, DENY, MODIFY will never be valid, reject them. Use case-insensitive comparisons when searching for these. Bear in mind that some of these words, particularly Grant (as a person's name), could also be valid input. _x000A_-- If there are range limits on the values that may be entered, enforce those limits._x000A_-- Institute procedures for inspection of programs for correct use of dynamic coding, by a party other than the developer._x000A_-- Conduct rigorous testing of program modules that use dynamic coding, searching for ways to subvert the intended use._x000A_-- Record the inspection and testing in the system documentation._x000A_-- Bear in mind that all this applies not only to screen input, but also to the values in an incoming message to a web service or to a stored procedure called by a software component that has not itself been hardened in these ways. Not only can the caller be subject to such vulnerabilities; it may itself be the attacker._x000A__x000A_This calls for inspection of application source code, which will require collaboration with the application developers. It is recognized that in many cases, the database administrator (DBA) is organizationally separate from the application developers and may have limited, if any, access to source code. Nevertheless, protections of this type are so important to the secure operation of databases that they must not be ignored. At a minimum, the DBA must attempt to obtain assurances from the development organization that this issue has been addressed and must document what has been discovered</S>
      <S N="FixText">Where dynamic code execution is used, modify the code to implement protections against code injection.</S>
      <S N="Check">Review source code in the database (stored procedures, functions, triggers) and application source code to identify cases of dynamic code execution._x000A__x000A_If dynamic code execution is employed without protective measures against code injection, this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="16">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Database</S>
      <S N="SqlVersion">2014</S>
      <S N="VulnID">V-67397</S>
      <S N="RuleID">SV-81887r2_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL4-00-022800</S>
      <S N="Title">The DBMS and associated applications must provide non-privileged users with error messages that provide information necessary for corrective actions without revealing information that could be exploited by adversaries.</S>
      <S N="Description">Any DBMS or associated application providing too much information in error messages on the screen or printout risks compromising the data and security of the system. The structure and content of error messages need to be carefully considered by the organization and development team._x000A__x000A_Databases can inadvertently provide a wealth of information to an attacker through improperly handled error messages. In addition to sensitive business or personal information, database errors can provide host names, IP addresses, user names, and other system information not required for end-user troubleshooting but very useful to someone targeting the system._x000A__x000A_Carefully consider the structure/content of error messages. The extent to which information systems are able to identify and handle error conditions is guided by organizational policy and operational requirements. Information that could be exploited by adversaries includes, for example, logon attempts with passwords entered by mistake as the username, mission/business information that can be derived from (if not stated explicitly by) information recorded, and personal information, such as account numbers, social security numbers, and credit card numbers._x000A__x000A_It is important that detailed error messages be visible only to those who are authorized to view them; that general users receive only generalized acknowledgment that errors have occurred; and that these generalized messages appear only when relevant to the user's task. For example, a message along the lines of, "An error has occurred. Unable to save your changes. If this problem persists, please contact your help desk" would be relevant. A message such as "Warning: your transaction generated a large number of page splits" would likely not be relevant. "ABGQ is not a valid widget code" would be appropriate; but "The INSERT statement conflicted with the FOREIGN KEY constraint "WidgetTransactionFK". The conflict occurred in database "DB7", table "dbo.WidgetMaster", column 'WidgetCode'" would not, as it reveals too much about the database structure._x000A__x000A_This calls for inspection of application source code, which will require collaboration with the application developers. It is recognized that in many cases, the database administrator (DBA) is organizationally separate from the application developers and may have limited, if any, access to source code. Nevertheless, protections of this type are so important to the secure operation of databases that they must not be ignored. At a minimum, the DBA must attempt to obtain assurances from the development organization that this issue has been addressed and must document what has been discovered.</S>
      <S N="FixText">Configure DBMS settings, custom database code, and associated application code not to divulge sensitive information or information useful for system identification in error messages that are displayed to general users.</S>
      <S N="Check">Review application behavior and custom database code (stored procedures; triggers),  to determine whether  error messages contain information beyond what is needed for explaining the issue to general users._x000A__x000A_If database error messages contain PII data, sensitive business data, or information useful for identifying the host system or database structure, this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="17">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Database</S>
      <S N="SqlVersion">2014</S>
      <S N="VulnID">V-67399</S>
      <S N="RuleID">SV-81889r2_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL4-00-022900</S>
      <S N="Title">SQL Server must reveal detailed error messages only to the ISSO, ISSM (or their designees), SA and DBA.</S>
      <S N="Description">If the DBMS provides too much information in error logs and administrative messages to the screen, this could lead to compromise. The structure and content of error messages need to be carefully considered by the organization and development team. The extent to which the information system is able to identify and handle error conditions is guided by organizational policy and operational requirements. _x000A__x000A_Some default DBMS error messages can contain information that could aid an attacker in, among others things, identifying the database type, host address, or state of the database. Custom errors may contain sensitive customer information. _x000A__x000A_It is important that detailed error messages be visible only to those who are authorized to view them; that general users receive only generalized acknowledgment that errors have occurred; and that these generalized messages appear only when relevant to the user's task. For example, a message along the lines of, "An error has occurred. Unable to save your changes. If this problem persists, please contact your help desk" would be relevant. A message such as "Warning: your transaction generated a large number of page splits" would likely not be relevant. "ABGQ is not a valid widget code" would be appropriate; but "The INSERT statement conflicted with the FOREIGN KEY constraint "WidgetTransactionFK". The conflict occurred in database "DB7", table "dbo.WidgetMaster", column 'WidgetCode'" would not, as it reveals too much about the database structure._x000A__x000A_Administrative users authorized to review detailed error messages typically are the ISSO, ISSM, SA and DBA. Other individuals or roles may be specified according to organization-specific needs, with appropriate approval._x000A__x000A_This calls for inspection of application source code, which will require collaboration with the application developers. It is recognized that in many cases, the database administrator (DBA) is organizationally separate from the application developers and may have limited, if any, access to source code. Nevertheless, protections of this type are so important to the secure operation of databases that they must not be ignored. At a minimum, the DBA must attempt to obtain assurances from the development organization that this issue has been addressed and must document what has been discovered.</S>
      <S N="FixText">Configure audit logging, tracing and/or custom code in the database or application to record detailed error messages generated by SQL Server, for review by authorized personnel.</S>
      <S N="Check">Review application behavior, custom database code (stored procedures; triggers) and DBMS audit and trace settings,  to determine whether detailed error messages are logged or stored for review by authorized personnel._x000A__x000A_If detailed error messages are not available to individuals authorized to view them, this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="18">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Database</S>
      <S N="SqlVersion">2014</S>
      <S N="VulnID">V-67401</S>
      <S N="RuleID">SV-81891r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL4-00-031900</S>
      <S N="Title">When supporting applications that require security labeling of data, SQL Server must associate organization-defined types of security labels having organization-defined security label values with information in storage.</S>
      <S N="Description">Without the association of security labels to information, there is no basis for the DBMS to make security-related access-control decisions._x000A__x000A_Security labels are abstractions representing the basic properties or characteristics of an entity (e.g., subjects and objects) with respect to safeguarding information. _x000A__x000A_These labels are typically associated with internal data structures (e.g., tables, rows) within the database and are used to enable the implementation of access control and flow control policies, reflect special dissemination, handling or distribution instructions, or support other aspects of the information security policy. _x000A__x000A_One example includes marking data as classified or FOUO. These security labels may be assigned manually or during data processing, but, either way, it is imperative these assignments are maintained while the data is in storage. If the security labels are lost when the data is stored, there is the risk of a data compromise._x000A__x000A_SQL Server does not include security labeling as a standard or licensable feature.  However, a community-developed SQL Server Label Security Toolkit can be downloaded from the Microsoft-supported web site codeplex.com.   Other implementations may also exist.  Custom application code is also a viable way to implement a solution.</S>
      <S N="FixText">Deploy third-party software such as the SQL Server Label Security Toolkit, or add custom data structures, data elements and application code, to provide reliable security labeling of information in storage.</S>
      <S N="Check">If security labeling is not required, this is not a finding._x000A__x000A_If security labeling requirements have been specified, but the security labeling is not implemented or does not reliably maintain labels on information in storage, this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="19">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Database</S>
      <S N="SqlVersion">2014</S>
      <S N="VulnID">V-67403</S>
      <S N="RuleID">SV-81893r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL4-00-032000</S>
      <S N="Title">When supporting applications that require security labeling of data, SQL Server must associate organization-defined types of security labels having organization-defined security label values with information in process.</S>
      <S N="Description">Without the association of security labels to information, there is no basis for the DBMS to make security-related access-control decisions._x000A__x000A_Security labels are abstractions representing the basic properties or characteristics of an entity (e.g., subjects and objects) with respect to safeguarding information. _x000A__x000A_These labels are typically associated with internal data structures (e.g., tables, rows) within the database and are used to enable the implementation of access control and flow control policies, reflect special dissemination, handling or distribution instructions, or support other aspects of the information security policy. _x000A__x000A_One example includes marking data as classified or FOUO. These security labels may be assigned manually or during data processing, but, either way, it is imperative these assignments are maintained while the data is in storage. If the security labels are lost when the data is stored, there is the risk of a data compromise._x000A__x000A_SQL Server does not include security labeling as a standard or licensable feature.  However, a community-developed SQL Server Label Security Toolkit can be downloaded from the Microsoft-supported web site codeplex.com.   Other implementations may also exist.  Custom application code is also a viable way to implement a solution.</S>
      <S N="FixText">Deploy third-party software such as the SQL Server Label Security Toolkit, or add custom data structures, data elements and application code, to provide reliable security labeling of information in process.</S>
      <S N="Check">If security labeling is not required, this is not a finding._x000A__x000A_If security labeling requirements have been specified, but the security labeling is not implemented or does not reliably maintain labels on information in process, this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="20">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Database</S>
      <S N="SqlVersion">2014</S>
      <S N="VulnID">V-67405</S>
      <S N="RuleID">SV-81895r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL4-00-032100</S>
      <S N="Title">When supporting applications that require security labeling of data, SQL Server must associate organization-defined types of security labels having organization-defined security label values with information in transmission.</S>
      <S N="Description">Without the association of security labels to information, there is no basis for the DBMS to make security-related access-control decisions._x000A__x000A_Security labels are abstractions representing the basic properties or characteristics of an entity (e.g., subjects and objects) with respect to safeguarding information. _x000A__x000A_These labels are typically associated with internal data structures (e.g., tables, rows) within the database and are used to enable the implementation of access control and flow control policies, reflect special dissemination, handling or distribution instructions, or support other aspects of the information security policy. _x000A__x000A_One example includes marking data as classified or FOUO. These security labels may be assigned manually or during data processing, but, either way, it is imperative these assignments are maintained while the data is in storage. If the security labels are lost when the data is stored, there is the risk of a data compromise._x000A__x000A_SQL Server does not include security labeling as a standard or licensable feature.  However, a community-developed SQL Server Label Security Toolkit can be downloaded from the Microsoft-supported web site codeplex.com.   Other implementations may also exist.  Custom application code is also a viable way to implement a solution.</S>
      <S N="FixText">Deploy third-party software such as the SQL Server Label Security Toolkit, or add custom data structures, data elements and application code, to provide reliable security labeling of information in transmission.</S>
      <S N="Check">If security labeling is not required, this is not a finding._x000A__x000A_If security labeling requirements have been specified, but the security labeling is not implemented or does not reliably maintain labels on information in transmission, this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="21">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Database</S>
      <S N="SqlVersion">2014</S>
      <S N="VulnID">V-67407</S>
      <S N="RuleID">SV-81897r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL4-00-033700</S>
      <S N="Title">Time stamps in database tables, intended for auditing or activity-tracking purposes, must include both date and time of day, with a minimum granularity of one second.</S>
      <S N="Description">If time stamps are not consistently applied and there is no common time reference, it is difficult to perform forensic analysis, in audit files, trace files/tables, and application data tables._x000A__x000A_Time stamps generated by SQL Server must include date and time, to a granularity of one second or finer. Time is commonly expressed in Coordinated Universal Time (UTC), a modern continuation of Greenwich Mean Time (GMT), or local time with an offset from UTC. Granularity of time measurements refers to the precision available in time stamp values. Granularity coarser than one second is not sufficient for audit trail purposes, and granularity finer than one second is recommended. Time stamp values are typically presented with three or more decimal places of seconds; however, the actual granularity may be coarser than the apparent precision. For example, SQL Server's GETDATE()/CURRENT_TMESTAMP values are presented to three decimal places, but the granularity is not one millisecond: it is about 1/300 of a second. _x000A__x000A_The data types that can be used for this purpose in SQL Server are:_x000A_DATETIME2 - precision variable from a whole second down to a ten-millionth (subject to the actual precision of the hardware and operating system)_x000A_DATETIMEOFFSET - as datetime2, together with local offset from UTC_x000A_DATE, together with TIME (same precision considerations as for datetime2)_x000A_DATETIME - precision 1/300 of a second_x000A_Character-string data types allowing for at least 20 characters are also permissible, but not recommended._x000A__x000A_SQL Server built-in functions for retrieving current timestamps are:  (high precision) sysdatetime(), sysdatetimeoffset(), sysutcdatetime();  (lower precision) CURRENT_TIMESTAMP or getdate(), getutcdate()._x000A__x000A_Ensure that values recorded for tracking purposes in data tables are correctly defined and maintained.  (Design decisions about which tables require audit-trail or activity-tracking columns are outside the scope of this STIG.  This requirement applies only to the data type and maintenance of such columns if they do exist.)_x000A__x000A_The SMALLDATETIME data type is not precise enough for this purpose.  Although it gives the impression of including a seconds component, the seconds value is always "00"._x000A__x000A_SQL Server offers a data type called TIMESTAMP that is not a representation of date and time. Rather, it is a database state counter and does not correspond to calendar and clock time. This requirement does not refer to that meaning of TIMESTAMP.  To avoid confusion, Microsoft recommends using the newer name for this data type, ROWVERSION, instead.</S>
      <S N="FixText">Modify applications and/or column/field definitions so that the time stamps in audit-trail and activity-tracking columns/fields in application data include date and time of day, to a granularity of one second or finer, and are recorded accurately.</S>
      <S N="Check">Review the column definitions and contents of audit-trail and activity-tracking timestamps in database tables._x000A__x000A_If these are not defined and maintained to include date and time of day, accurate to a granularity of one second or finer, this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="22">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Database</S>
      <S N="SqlVersion">2014</S>
      <S N="VulnID">V-67409</S>
      <S N="RuleID">SV-81899r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL4-00-034700</S>
      <S N="Title">SQL Server must implement and/or support cryptographic mechanisms to prevent unauthorized modification of organization-defined information at rest (to include, at a minimum, PII and classified information) on organization-defined information system components.</S>
      <S N="Description">Databases holding data requiring "data at rest" protections must employ cryptographic mechanisms to prevent unauthorized disclosure and modification of the information at rest. These cryptographic mechanisms may be native to the DBMS or implemented via additional software or operating system/file system settings, as appropriate to the situation._x000A__x000A_Selection of a cryptographic mechanism is based on the need to protect the integrity of organizational information. The strength of the mechanism is commensurate with the security category and/or classification of the information. Organizations have the flexibility to either encrypt all information on storage devices (i.e., full disk encryption) or encrypt specific data structures (e.g., files, records, or fields). _x000A__x000A_The decision whether and what to encrypt rests with the data owner and is also influenced by the physical measures taken to secure the equipment and media on which the information resides.</S>
      <S N="FixText">Where full-disk encryption is required, configure Windows and/or the storage system to provide this._x000A__x000A_Where transparent data encryption (TDE) is required, deploy the necessary stack of certificates and keys, and set the Encryption Enabled to True.  For guidance from the Microsoft Developer Network on how to do this, perform a web search for "SQL Server 2014 TDE"._x000A__x000A_Where column encryption is required, deploy the necessary stack of certificates and keys, and enable encryption on the columns in question.  For guidance from the Microsoft Developer Network on how to do this, perform a web search for "SQL Server 2014 Encrypt a Column of Data".</S>
      <S N="Check">Review the system documentation to determine whether the organization has defined the information at rest that is to be protected from modification, which must include, at a minimum, PII and classified information._x000A__x000A_If no information is identified as requiring such protection, this is not a finding._x000A__x000A_Review the configuration of SQL Server, Windows, and additional software as relevant._x000A__x000A_If full-disk encryption is required, and Windows or the storage system is not configured for this, this is a finding._x000A__x000A_If database transparent data encryption (TDE) is called for, check whether it is enabled:_x000A_In SQL Server Management Studio, Object Explorer, expand the instance and right-click on the database name; select properties.  Select the Options page, State section, Encryption Enabled parameter._x000A__x000A_If the value displayed is False, this is a finding._x000A__x000A_If column encryption, done via SQL Server features, is required, review the definitions and contents of the relevant tables and columns._x000A__x000A_If any of the information defined as requiring cryptographic protection is not encrypted in a manner that provides the required level of protection, this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="23">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Database</S>
      <S N="SqlVersion">2014</S>
      <S N="VulnID">V-67411</S>
      <S N="RuleID">SV-81901r2_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL4-00-035200</S>
      <S N="Title">When invalid inputs are received, SQL Server must behave in a predictable and documented manner that reflects organizational and system objectives.</S>
      <S N="Description">A common vulnerability is unplanned behavior when invalid inputs are received. This requirement guards against adverse or unintended system behavior caused by invalid inputs, where information system responses to the invalid input may be disruptive or cause the system to fail into an unsafe state._x000A__x000A_The behavior will be derived from the organizational and system requirements and includes, but is not limited to, notification of the appropriate personnel, creating an audit record, and rejecting invalid input._x000A__x000A_This calls for inspection of application source code, which will require collaboration with the application developers. It is recognized that in many cases, the database administrator (DBA) is organizationally separate from the application developers and may have limited, if any, access to source code. Nevertheless, protections of this type are so important to the secure operation of databases that they must not be ignored. At a minimum, the DBA must attempt to obtain assurances from the development organization that this issue has been addressed and must document what has been discovered.</S>
      <S N="FixText">Revise and deploy the source code for database program objects (stored procedures, functions, triggers) and application source code, to implement the documented behavior.</S>
      <S N="Check">Review system documentation to determine how input errors are to be handled in general and if any special handling is defined for specific circumstances._x000A__x000A_Review the source code for database program objects (stored procedures, functions, triggers) and application source code to identify how the system responds to invalid input._x000A__x000A_If it does not implement the documented behavior, this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="24">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Database</S>
      <S N="SqlVersion">2014</S>
      <S N="VulnID">V-67413</S>
      <S N="RuleID">SV-81903r2_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL4-00-035800</S>
      <S N="Title">Trace or Audit records must be generated when categorized information (e.g., classification levels/security levels) is accessed.</S>
      <S N="Description">Changes in categorized information must be tracked. Without an audit trail, unauthorized access to protected data could go undetected._x000A__x000A_For detailed information on categorizing information, refer to FIPS Publication 199, Standards for Security Categorization of Federal Information and Information Systems, and FIPS Publication 200, Minimum Security Requirements for Federal Information and Information Systems._x000A__x000A_Use of SQL Server Audit is recommended.  All features of SQL Server Audit are available in the Enterprise and Developer editions of SQL Server 2014.  It is not available at the database level in other editions.  For this or legacy reasons, the instance may be using SQL Server Trace for auditing, which remains an acceptable solution for the time being.  Note, however, that Microsoft intends to remove most aspects of Trace at some point after SQL Server 2016.  Note also that Trace does not support auditing of SELECT statements, whereas Audit does._x000A__x000A_Since Trace does not provide for tracking SELECT statements, it is necessary to provide this tracking at the application level, if Trace is used for audit purposes.</S>
      <S N="FixText">Where SQL Server Trace is in use, implement tracking of SELECTs on categorized data at the application level, using the system stored procedure sp_trace_generateevent to write the tracking records to the Trace used for audit purposes._x000A__x000A_If SQL Server Audit is in use, design and deploy an Audit that captures all auditable events and data items.  The script provided in the supplemental file Audit.sql can be used as the basis for this.  Supplement the standard audit data as necessary, using Extended Events and/or triggers._x000A__x000A_Alternatively, to add the necessary data capture to an existing server audit specification, run the script:_x000A_USE [master];_x000A_GO_x000A_ALTER SERVER AUDIT SPECIFICATION &lt;server_audit_specification_name&gt; WITH (STATE = OFF);_x000A_GO_x000A_ALTER SERVER AUDIT SPECIFICATION &lt;server_audit_specification_name&gt; ADD (SCHEMA_OBJECT_ACCESS_GROUP);_x000A_GO_x000A_ALTER SERVER AUDIT SPECIFICATION &lt;server_audit_specification_name&gt; WITH (STATE = ON);_x000A_GO</S>
      <S N="Check">Review the system documentation to determine whether it is required to track categories of information, such as classification or sensitivity level.  If it is not, this is not applicable (NA)._x000A__x000A_If neither SQL Server Audit nor SQL Server Trace is in use for audit purposes, this is a finding._x000A__x000A_If SQL Server Trace is in use for audit purposes, review the application(s) using the database to verify that all SELECT actions on categorized data are being audited, and that the tracking records are written to the SQL Server Trace.  If not, this is a finding._x000A__x000A__x000A_If SQL Server Audit is in use, proceed as follows._x000A__x000A_The basic SQL Server Audit configuration provided in the supplemental file Audit.sql uses the broad, server-level audit action group SCHEMA_OBJECT_ACCESS_GROUP for this purpose.  SQL Server Audit's flexibility makes other techniques possible._x000A__x000A_If an alternative technique is in use and demonstrated effective, this is not a finding._x000A__x000A_Determine the name(s) of the server audit specification(s) in use._x000A__x000A_To look at audits and audit specifications, in Management Studio's object explorer, expand _x000A_&lt;server name&gt; &gt;&gt; Security &gt;&gt; Audits_x000A_and_x000A_&lt;server name&gt; &gt;&gt; Security &gt;&gt; Server Audit Specifications._x000A_Also, _x000A_&lt;server name&gt; &gt;&gt; Databases &gt;&gt; &lt;database name&gt; &gt;&gt; Security &gt;&gt; Database Audit Specifications._x000A__x000A_Alternatively, review the contents of the system views with "audit" in their names._x000A__x000A_Run the following to verify that all SELECT, INSERT, UPDATE, and DELETE actions on tables and views are being audited:_x000A_USE [master];_x000A_GO_x000A_SELECT * FROM sys.server_audit_specification_details WHERE server_specification_id =_x000A_(SELECT server_specification_id FROM sys.server_audit_specifications WHERE [name] = '&lt;server_audit_specification_name&gt;')_x000A_AND audit_action_name = 'SCHEMA_OBJECT_ACCESS_GROUP';_x000A__x000A_If no row is returned, this is a finding._x000A__x000A_If the audited_result column is not "SUCCESS" or "SUCCESS AND FAILURE", this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="25">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Database</S>
      <S N="SqlVersion">2014</S>
      <S N="VulnID">V-67415</S>
      <S N="RuleID">SV-81905r2_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL4-00-035900</S>
      <S N="Title">Trace or Audit records must be generated  when unsuccessful attempts to access categorized information (e.g., classification levels/security levels) occur.</S>
      <S N="Description">Changes in categorized information must be tracked. Without an audit trail, unauthorized access to protected data could go undetected._x000A__x000A_To aid in diagnosis, it is necessary to keep track of failed attempts in addition to the successful ones._x000A__x000A_For detailed information on categorizing information, refer to FIPS Publication 199, Standards for Security Categorization of Federal Information and Information Systems, and FIPS Publication 200, Minimum Security Requirements for Federal Information and Information Systems._x000A__x000A_Use of SQL Server Audit is recommended.  All features of SQL Server Audit are available in the Enterprise and Developer editions of SQL Server 2014.  It is not available at the database level in other editions.  For this or legacy reasons, the instance may be using SQL Server Trace for auditing, which remains an acceptable solution for the time being.  Note, however, that Microsoft intends to remove most aspects of Trace at some point after SQL Server 2016.  Note also that Trace does not support auditing of SELECT statements, whereas Audit does._x000A__x000A_Since Trace does not provide for tracking SELECT statements, it is necessary to provide this tracking at the application level, if Trace is used for audit purposes._x000A__x000A_Use of SQL Server Audit's SCHEMA_OBJECT_ACCESS_GROUP causes capture of all accesses, successful and otherwise, to all schema-scoped objects.  The [Succeeded] column in the audit output indicates the success or failure of the attempted action.  Be aware, however, that it may report True in some cases where one would intuitively expect False.  For example, SELECT 1/0 FROM SYS.ALL_OBJECTS will appear in the audit trail as successful, if the user has permission to perform that action, even though it contains an invalid expression.  Some other actions that one would consider failures (such as selecting from a table that does not exist) may not appear at all.</S>
      <S N="FixText">Where SQL Server Trace is in use, implement tracking of SELECTs on categorized data at the application level, using the system stored procedure sp_trace_generateevent to write the tracking records to the Trace used for audit purposes. Include failed attempts in the tracking._x000A__x000A_If SQL Server Audit is in use, design and deploy an Audit that captures all auditable events and data items.  The script provided in the supplemental file Audit.sql can be used as the basis for this.  Supplement the standard audit data as necessary, using Extended Events and/or triggers._x000A__x000A_Alternatively, to add the necessary data capture to an existing server audit specification, run the script:_x000A_USE [master];_x000A_GO_x000A_ALTER SERVER AUDIT SPECIFICATION &lt;server_audit_specification_name&gt; WITH (STATE = OFF);_x000A_GO_x000A_ALTER SERVER AUDIT SPECIFICATION &lt;server_audit_specification_name&gt; ADD (SCHEMA_OBJECT_ACCESS_GROUP);_x000A_GO_x000A_ALTER SERVER AUDIT SPECIFICATION &lt;server_audit_specification_name&gt; WITH (STATE = ON);_x000A_GO</S>
      <S N="Check">Review the system documentation to determine whether it is required to track categories of information, such as classification or sensitivity level.  If it is not, this is not applicable (NA)._x000A__x000A_If neither SQL Server Audit nor SQL Server Trace is in use for audit purposes, this is a finding._x000A__x000A_If SQL Server Trace is in use for audit purposes, review the application(s) using the database to verify that all SELECT actions on categorized data, including unsuccessful attempts, are being audited;  and that the tracking records are written to the SQL Server Trace used for audit purposes.  If not, this is a finding._x000A__x000A__x000A_If SQL Server Audit is in use, proceed as follows._x000A__x000A_The basic SQL Server Audit configuration provided in the supplemental file Audit.sql uses the broad, server-level audit action group SCHEMA_OBJECT_ACCESS_GROUP for this purpose.  SQL Server Audit's flexibility makes other techniques possible._x000A__x000A_If an alternative technique is in use and demonstrated effective, this is not a finding._x000A__x000A_Determine the name(s) of the server audit specification(s) in use._x000A__x000A_To look at audits and audit specifications, in Management Studio's object explorer, expand _x000A_&lt;server name&gt; &gt;&gt; Security &gt;&gt; Audits_x000A_and_x000A_&lt;server name&gt; &gt;&gt; Security &gt;&gt; Server Audit Specifications._x000A_Also, _x000A_&lt;server name&gt; &gt;&gt; Databases &gt;&gt; &lt;database name&gt; &gt;&gt; Security &gt;&gt; Database Audit Specifications._x000A__x000A_Alternatively, review the contents of the system views with "audit" in their names._x000A__x000A_Run the following to verify that all SELECT, INSERT, UPDATE, and DELETE actions on tables and views are being audited:_x000A_USE [master];_x000A_GO_x000A_SELECT * FROM sys.server_audit_specification_details WHERE server_specification_id =_x000A_(SELECT server_specification_id FROM sys.server_audit_specifications WHERE [name] = '&lt;server_audit_specification_name&gt;')_x000A_AND audit_action_name = 'SCHEMA_OBJECT_ACCESS_GROUP';_x000A__x000A_If no row is returned, this is a finding._x000A__x000A_If the audited_result column is not "FAILURE" or "SUCCESS AND FAILURE", this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="26">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Database</S>
      <S N="SqlVersion">2014</S>
      <S N="VulnID">V-67417</S>
      <S N="RuleID">SV-81907r2_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL4-00-036200</S>
      <S N="Title">SQL Server must generate Trace or Audit records when privileges/permissions are modified via locally-defined security objects.</S>
      <S N="Description">Changes in the permissions, privileges, and roles granted to users and roles must be tracked. Without an audit trail, unauthorized elevation or restriction of privileges could go undetected. Elevated privileges give users access to information and functionality that they should not have; restricted privileges wrongly deny access to authorized users._x000A__x000A_In SQL Server, there is no distinction between modification of permissions and granting or dropping them.  However, native SQL Server security functionality may be supplemented with application-specific tables and logic, in which case the following actions on these tables and procedures/triggers/functions are also relevant:_x000A_UPDATE_x000A_EXECUTE_x000A__x000A_Use of SQL Server Audit is recommended.  All features of SQL Server Audit are available in the Enterprise and Developer editions of SQL Server 2014.  It is not available at the database level in other editions.  For this or legacy reasons, the instance may be using SQL Server Trace for auditing, which remains an acceptable solution for the time being.  Note, however, that Microsoft intends to remove most aspects of Trace at some point after SQL Server 2016.</S>
      <S N="FixText">Where SQL Server Trace is in use, define  and enable a trace that captures all auditable events.  The script provided in the supplemental file Trace.sql can be used to do this._x000A__x000A_Add blocks of code to Trace.sql for each custom event class (integers in the range 82-91; the same event class may be used for all such triggers) used in these triggers.  _x000A__x000A_Create triggers to raise a custom event on each locally-defined security table that requires tracking of Insert-Update-Delete operations.  The examples provided in the supplemental file CustomTraceEvents.sql can serve as the basis for these.  _x000A__x000A_Execute Trace.sql._x000A__x000A_Where SQL Server Audit is in use, design and deploy a SQL Server Audit that captures all auditable events.  The script provided in the supplemental file Audit.sql can be used for this._x000A__x000A_Alternatively, to add the necessary data capture to an existing server audit specification, run the script:_x000A_USE [master];_x000A_GO_x000A_ALTER SERVER AUDIT SPECIFICATION &lt;server_audit_specification_name&gt; WITH (STATE = OFF);_x000A_GO_x000A_ALTER SERVER AUDIT SPECIFICATION &lt;server_audit_specification_name&gt; ADD (SCHEMA_OBJECT_ACCESS_GROUP);_x000A_GO_x000A_ALTER SERVER AUDIT SPECIFICATION &lt;server_audit_specification_name&gt; WITH (STATE = ON);_x000A_GO</S>
      <S N="Check">Obtain the list of locally-defined security tables, procedures and functions that require tracking._x000A__x000A_If there are none, this is not a finding._x000A__x000A_If neither SQL Server Audit nor SQL Server Trace is in use for audit purposes, this is a finding._x000A__x000A_If SQL Server Trace is in use for audit purposes, review the locally-defined security tables for the existence of triggers to raise a custom event on each Update operation.  If such triggers are not present, this is a finding._x000A__x000A_Verify  that all required events are being audited.  From the query prompt:_x000A_SELECT * FROM sys.traces;_x000A__x000A_All currently defined traces for the SQL server instance will be listed. If no traces are returned, this is a finding._x000A__x000A_Determine the trace(s) being used for the auditing requirement._x000A_In the following, replace # with a trace ID being used for the auditing requirements._x000A_From the query prompt:_x000A_SELECT DISTINCT(eventid) FROM sys.fn_trace_geteventinfo(#);_x000A__x000A_The following required event IDs should be among those listed; if not, this is a finding:_x000A__x000A_42  -- SP:Starting_x000A_43  -- SP:Completed_x000A_82-91  -- User-defined Event _x000A_162  -- User error message_x000A__x000A__x000A_If SQL Server Audit is in use, proceed as follows._x000A__x000A_Verify that all EXECUTE actions on locally-defined permissions-related procedures are being audited.  If not, this is a finding._x000A__x000A_The basic SQL Server Audit configuration provided in the supplemental file Audit.sql uses the broad, server-level audit action group SCHEMA_OBJECT_ACCESS_GROUP for this purpose.  SQL Server Audit's flexibility makes other techniques possible.  If an alternative technique is in use and demonstrated effective, this is not a finding._x000A__x000A_Determine the name(s) of the server audit specification(s) in use.  _x000A_To look at audits and audit specifications, in Management Studio's object explorer, expand _x000A_&lt;server name&gt; &gt;&gt; Security &gt;&gt; Audits_x000A_and_x000A_&lt;server name&gt; &gt;&gt; Security &gt;&gt; Server Audit Specifications._x000A_Also, _x000A_&lt;server name&gt; &gt;&gt; Databases &gt;&gt; &lt;database name&gt; &gt;&gt; Security &gt;&gt; Database Audit Specifications._x000A_Alternatively, review the contents of the system views with "audit" in their names._x000A__x000A_Run the following to verify that all UPDATE and EXECUTE actions on any locally-defined permissions tables, procedures and functions are being audited:_x000A_USE [master];_x000A_GO_x000A_SELECT * FROM sys.server_audit_specification_details WHERE server_specification_id =_x000A_(SELECT server_specification_id FROM sys.server_audit_specifications WHERE [name] = '&lt;server_audit_specification_name&gt;')_x000A_AND audit_action_name = 'SCHEMA_OBJECT_ACCESS_GROUP';_x000A__x000A_If no row is returned, this is a finding._x000A__x000A_If the audited_result column is not "SUCCESS" or "SUCCESS AND FAILURE", this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="27">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Database</S>
      <S N="SqlVersion">2014</S>
      <S N="VulnID">V-67419</S>
      <S N="RuleID">SV-81909r2_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL4-00-036300</S>
      <S N="Title">SQL Server must generate Trace or Audit records when unsuccessful attempts to modify privileges/permissions via locally-defined security objects occur.</S>
      <S N="Description">Failed attempts to change the permissions, privileges, and roles granted to users and roles must be tracked. Without an audit trail, unauthorized attempts to elevate or restrict privileges could go undetected. _x000A__x000A_In SQL Server, there is no distinction between modification of permissions and granting or dropping them.  However, native SQL Server security functionality may be supplemented with application-specific tables and logic, in which case the following actions on these tables and procedures/triggers/functions are also relevant:_x000A_UPDATE_x000A_EXECUTE_x000A__x000A_To aid in diagnosis, it is necessary to keep track of failed attempts in addition to the successful ones._x000A__x000A_Use of SQL Server Audit is recommended.  All features of SQL Server Audit are available in the Enterprise and Developer editions of SQL Server 2014.  It is not available at the database level in other editions.  For this or legacy reasons, the instance may be using SQL Server Trace for auditing, which remains an acceptable solution for the time being.  Note, however, that Microsoft intends to remove most aspects of Trace at some point after SQL Server 2016._x000A__x000A_Use of SQL Server Audit's SCHEMA_OBJECT_ACCESS_GROUP causes capture of all accesses, successful and otherwise, to the system views (and all other schema-scoped objects).  The [Succeeded] column in the audit output indicates the success or failure of the attempted action.  Be aware, however, that it may report True in some cases where one would intuitively expect False.  For example, SELECT 1/0 FROM SYS.ALL_OBJECTS will appear in the audit trail as successful, if the user has permission to perform that action, even though it contains an invalid expression.  Some other actions that one would consider failures (such as selecting from a table that does not exist) may not appear at all.</S>
      <S N="FixText">Where SQL Server Trace is in use, define  and enable a trace that captures all auditable events.  The script provided in the supplemental file Trace.sql can be used to do this._x000A__x000A_Add blocks of code to Trace.sql for each custom event class (integers in the range 82-91; the same event class may be used for all such triggers) used in these triggers.  _x000A__x000A_Create triggers to raise a custom event on each locally-defined security table that requires tracking of Insert-Update-Delete operations.  The examples provided in the supplemental file CustomTraceEvents.sql can serve as the basis for these.  _x000A__x000A_Execute Trace.sql._x000A__x000A_Where SQL Server Audit is in use, design and deploy a SQL Server Audit that captures all auditable events.  The script provided in the supplemental file Audit.sql can be used for this._x000A__x000A_Alternatively, to add the necessary data capture to an existing server audit specification, run the script:_x000A_USE [master];_x000A_GO_x000A_ALTER SERVER AUDIT SPECIFICATION &lt;server_audit_specification_name&gt; WITH (STATE = OFF);_x000A_GO_x000A_ALTER SERVER AUDIT SPECIFICATION &lt;server_audit_specification_name&gt; ADD (SCHEMA_OBJECT_ACCESS_GROUP);_x000A_GO_x000A_ALTER SERVER AUDIT SPECIFICATION &lt;server_audit_specification_name&gt; WITH (STATE = ON);_x000A_GO</S>
      <S N="Check">Obtain the list of locally-defined security tables, procedures and functions that require tracking.  If there are none, this is not a finding._x000A__x000A_If neither SQL Server Audit nor SQL Server Trace is in use for audit purposes, this is a finding._x000A__x000A_If SQL Server Trace is in use for audit purposes, review the locally-defined security tables for the existence of triggers to raise a custom event on each Update operation.  If such triggers are not present, this is a finding._x000A__x000A_Verify  that all required events are being audited.  From the query prompt:_x000A_SELECT * FROM sys.traces;_x000A__x000A_All currently defined traces for the SQL server instance will be listed. If no traces are returned, this is a finding._x000A__x000A_Determine the trace(s) being used for the auditing requirement._x000A_In the following, replace # with a trace ID being used for the auditing requirements._x000A_From the query prompt:_x000A_SELECT DISTINCT(eventid) FROM sys.fn_trace_geteventinfo(#);_x000A__x000A_The following required event IDs should be among those listed; if not, this is a finding:_x000A__x000A_42  -- SP:Starting_x000A_43  -- SP:Completed_x000A_82-91  -- User-defined Event _x000A_162  -- User error message_x000A__x000A__x000A_If SQL Server Audit is in use, proceed as follows._x000A__x000A_Verify that all EXECUTE actions on locally-defined permissions-related procedures are being audited.  If not, this is a finding._x000A__x000A_The basic SQL Server Audit configuration provided in the supplemental file Audit.sql uses the broad, server-level audit action group SCHEMA_OBJECT_ACCESS_GROUP for this purpose.  SQL Server Audit's flexibility makes other techniques possible.  If an alternative technique is in use and demonstrated effective, this is not a finding._x000A__x000A_Determine the name(s) of the server audit specification(s) in use._x000A__x000A_To look at audits and audit specifications, in Management Studio's object explorer, expand _x000A_&lt;server name&gt; &gt;&gt; Security &gt;&gt; Audits_x000A_and_x000A_&lt;server name&gt; &gt;&gt; Security &gt;&gt; Server Audit Specifications._x000A_Also, _x000A_&lt;server name&gt; &gt;&gt; Databases &gt;&gt; &lt;database name&gt; &gt;&gt; Security &gt;&gt; Database Audit Specifications._x000A__x000A_Alternatively, review the contents of the system views with "audit" in their names._x000A__x000A_Run the following to verify that all UPDATE and EXECUTE actions on any locally-defined permissions tables, procedures and functions are being audited:_x000A_USE [master];_x000A_GO_x000A_SELECT * FROM sys.server_audit_specification_details WHERE server_specification_id =_x000A_(SELECT server_specification_id FROM sys.server_audit_specifications WHERE [name] = '&lt;server_audit_specification_name&gt;')_x000A_AND audit_action_name = 'SCHEMA_OBJECT_ACCESS_GROUP';_x000A__x000A_If no row is returned, this is a finding._x000A__x000A_If the audited_result column is not "FAILURE" or "SUCCESS AND FAILURE", this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="28">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Database</S>
      <S N="SqlVersion">2014</S>
      <S N="VulnID">V-67421</S>
      <S N="RuleID">SV-81911r2_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL4-00-036400</S>
      <S N="Title">SQL Server must generate Trace or Audit records when locally-defined security objects are modified.</S>
      <S N="Description">SQL Server protects its built-in security objects (tables, views, functions, procedures, etc.) from alteration by database users and administrators.  However, applications sometimes have additional, security-related objects defined in the database.  ALTER operations on these objects must be monitored._x000A__x000A_Use of SQL Server Audit is recommended.  All features of SQL Server Audit are available in the Enterprise and Developer editions of SQL Server 2014.  It is not available at the database level in other editions.  For this or legacy reasons, the instance may be using SQL Server Trace for auditing, which remains an acceptable solution for the time being.  Note, however, that Microsoft intends to remove most aspects of Trace at some point after SQL Server 2016.</S>
      <S N="FixText">Where SQL Server Trace is in use, define  and enable a trace that captures all auditable events.  The script provided in the supplemental file Trace.sql can be used to do this._x000A__x000A_Where SQL Server Audit is in use, design and deploy a SQL Server Audit that captures all auditable events.  The script provided in the supplemental file Audit.sql can be used for this._x000A__x000A_Alternatively, to add the necessary data capture to an existing server audit specification, run the script:_x000A_USE [master];_x000A_GO_x000A_ALTER SERVER AUDIT SPECIFICATION &lt;server_audit_specification_name&gt; WITH (STATE = OFF);_x000A_GO_x000A_ALTER SERVER AUDIT SPECIFICATION &lt;server_audit_specification_name&gt; ADD (SCHEMA_OBJECT_CHANGE_GROUP);_x000A_GO_x000A_ALTER SERVER AUDIT SPECIFICATION &lt;server_audit_specification_name&gt; WITH (STATE = ON);_x000A_GO</S>
      <S N="Check">If there are no locally-defined security tables or procedures, this is not a finding._x000A__x000A_If neither SQL Server Audit nor SQL Server Trace is in use for audit purposes, this is a finding._x000A__x000A_If SQL Server Trace is in use for audit purposes, verify  that all required events are being audited.  From the query prompt:_x000A_SELECT * FROM sys.traces;_x000A_All currently defined traces for the SQL server instance will be listed. If no traces are returned, this is a finding._x000A__x000A_Determine the trace(s) being used for the auditing requirement._x000A_In the following, replace # with a trace ID being used for the auditing requirements._x000A_From the query prompt:_x000A_SELECT DISTINCT(eventid) FROM sys.fn_trace_geteventinfo(#);_x000A__x000A_The following required event IDs should all be among those listed; if not, this is a finding:_x000A__x000A_46  -- Object:Created_x000A_47  -- Object:Deleted_x000A_162  -- User error message_x000A_164 -- Object:Altered_x000A__x000A__x000A_If SQL Server Audit is in use, proceed as follows._x000A__x000A_The basic SQL Server Audit configuration provided in the supplemental file Audit.sql uses the broad, server-level audit action group SCHEMA_OBJECT_CHANGE_GROUP for this purpose.  SQL Server Audit's flexibility makes other techniques possible.  If an alternative technique is in use and demonstrated effective, this is not a finding._x000A__x000A_Determine the name(s) of the server audit specification(s) in use._x000A__x000A_To look at audits and audit specifications, in Management Studio's object explorer, expand _x000A_&lt;server name&gt; &gt;&gt; Security &gt;&gt; Audits_x000A_and_x000A_&lt;server name&gt; &gt;&gt; Security &gt;&gt; Server Audit Specifications._x000A_Also, _x000A_&lt;server name&gt; &gt;&gt; Databases &gt;&gt; &lt;database name&gt; &gt;&gt; Security &gt;&gt; Database Audit Specifications._x000A__x000A_Alternatively, review the contents of the system views with "audit" in their names._x000A__x000A_Run the following to verify that all CREATE, ALTER, and DROP actions on any locally-defined permissions tables, procedures and functions are being audited:_x000A_USE [master];_x000A_GO_x000A_SELECT * FROM sys.server_audit_specification_details WHERE server_specification_id =_x000A_(SELECT server_specification_id FROM sys.server_audit_specifications WHERE [name] = '&lt;server_audit_specification_name&gt;')_x000A_AND audit_action_name = 'SCHEMA_OBJECT_CHANGE_GROUP';_x000A__x000A_If no row is returned, this is a finding._x000A__x000A_If the audited_result column is not "SUCCESS" or "SUCCESS AND FAILURE", this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="29">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Database</S>
      <S N="SqlVersion">2014</S>
      <S N="VulnID">V-67423</S>
      <S N="RuleID">SV-81913r3_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL4-00-038200</S>
      <S N="Title">SQL Server must generate Trace or Audit records when unsuccessful accesses to designated objects occur.</S>
      <S N="Description">Without tracking all or selected types of access to all or selected objects (tables, views, procedures, functions, etc.), it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one. _x000A__x000A_Types of access include, but are not necessarily limited to:_x000A_SELECT_x000A_INSERT_x000A_UPDATE_x000A_DELETE_x000A_EXECUTE_x000A__x000A_To aid in diagnosis, it is necessary to keep track of failed attempts in addition to the successful ones._x000A__x000A_Use of SQL Server Audit is recommended.  All features of SQL Server Audit are available in the Enterprise and Developer editions of SQL Server 2014.  It is not available at the database level in other editions.  For this or legacy reasons, the instance may be using SQL Server Trace for auditing, which remains an acceptable solution for the time being.  Note, however, that Microsoft intends to remove most aspects of Trace at some point after SQL Server 2016.</S>
      <S N="FixText">Where SQL Server Trace is in use, define and enable a trace that captures all auditable events.  The script provided in the supplemental file Trace.sql can be used to do this._x000A__x000A_If SQL Server Audit is in use, design and deploy an Audit that captures all auditable events and data items.  The script provided in the supplemental file Audit.sql can be used as the basis for this.  Supplement the standard audit data as necessary, using Extended Events and/or triggers._x000A__x000A_Alternatively, to add the necessary data capture to an existing server audit specification, run the script:_x000A_USE [master];_x000A_GO_x000A_ALTER SERVER AUDIT SPECIFICATION &lt;server_audit_specification_name&gt; WITH (STATE = OFF);_x000A_GO_x000A_ALTER SERVER AUDIT SPECIFICATION &lt;server_audit_specification_name&gt; ADD (SCHEMA_OBJECT_ACCESS_GROUP);_x000A_GO_x000A_ALTER SERVER AUDIT SPECIFICATION &lt;server_audit_specification_name&gt; WITH (STATE = ON);_x000A_GO</S>
      <S N="Check">If neither SQL Server Audit nor SQL Server Trace is in use for audit purposes, this is a finding._x000A__x000A_Obtain the list of objects (tables and stored procedures) where tracking of SELECT, INSERT, UPDATE, DELETE, or EXECUTE actions is required.  If there are none, this is not a finding._x000A__x000A_If SQL Server Trace is in use for audit purposes, verify that all required event classes are being audited.  From the query prompt:_x000A_SELECT * FROM sys.traces;_x000A__x000A_All currently defined traces for the SQL server instance will be listed. If no traces are returned, this is a finding._x000A__x000A_Determine the trace(s) being used for the auditing requirement._x000A_In the following, replace # with a trace ID being used for the auditing requirements._x000A_From the query prompt:_x000A_SELECT DISTINCT(eventid) FROM sys.fn_trace_geteventinfo(#);_x000A__x000A_The following required event ID should be among those listed; if not, this is a finding:_x000A__x000A_162 -- User error message_x000A__x000A_If SQL Server Audit is in use, proceed as follows._x000A__x000A_The basic SQL Server Audit configuration provided in the supplemental file Audit.sql uses the server-level audit action group SCHEMA_OBJECT_ACCESS_GROUP for this purpose.  SQL Server Audit's flexibility makes other techniques possible.  If an alternative technique is in use and demonstrated effective, this is not a finding._x000A__x000A_Determine the name(s) of the server audit specification(s) in use._x000A__x000A_To look at audits and audit specifications, in Management Studio's object explorer, expand _x000A_&lt;server name&gt; &gt;&gt; Security &gt;&gt; Audits_x000A_and_x000A_&lt;server name&gt; &gt;&gt; Security &gt;&gt; Server Audit Specifications._x000A_Also, _x000A_&lt;server name&gt; &gt;&gt; Databases &gt;&gt; &lt;database name&gt; &gt;&gt; Security &gt;&gt; Database Audit Specifications._x000A__x000A_Alternatively, review the contents of the system views with "audit" in their names._x000A__x000A_Run the following to verify that all logons and connections are being audited:_x000A_USE [master];_x000A_GO_x000A_SELECT * FROM sys.server_audit_specification_details WHERE server_specification_id =_x000A_(SELECT server_specification_id FROM sys.server_audit_specifications WHERE [name] = '&lt;server_audit_specification_name&gt;')_x000A_AND audit_action_name = 'SCHEMA_OBJECT_ACCESS_GROUP';_x000A_GO_x000A__x000A_If no row is returned, this is a finding._x000A__x000A_If the audited_result column is not "FAILURE" or "SUCCESS AND FAILURE", this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="30">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Database</S>
      <S N="SqlVersion">2014</S>
      <S N="VulnID">V-67425</S>
      <S N="RuleID">SV-81915r3_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL4-00-038100</S>
      <S N="Title">SQL Server must generate Trace or Audit records when successful accesses to designated objects occur.</S>
      <S N="Description">Without tracking all or selected types of access to all or selected objects (tables, views, procedures, functions, etc.), it would be difficult to establish, correlate, and investigate the events relating to an incident, or identify those responsible for one. _x000A__x000A_Types of access include, but are not necessarily limited to:_x000A_SELECT_x000A_INSERT_x000A_UPDATE_x000A_DELETE_x000A_EXECUTE_x000A__x000A_Use of SQL Server Audit is recommended.  All features of SQL Server Audit are available in the Enterprise and Developer editions of SQL Server 2014.  It is not available at the database level in other editions.  For this or legacy reasons, the instance may be using SQL Server Trace for auditing, which remains an acceptable solution for the time being.  Note, however, that Microsoft intends to remove most aspects of Trace at some point after SQL Server 2016._x000A__x000A_Trace does not offer tracking of SELECT operations, so where this is required it must be implemented at the application level.</S>
      <S N="FixText">Where SQL Server Trace is in use, implement tracking of SELECTs on designated tables at the application level, using the system stored procedure sp_trace_generateevent to write the tracking records to the Trace used for audit purposes._x000A__x000A_Create triggers to raise a custom event on each table that requires tracking of Insert-Update-Delete operations.  The examples provided in the supplemental file CustomTraceEvents.sql can serve as the basis for these.  _x000A__x000A_Add a block of code to the supplemental file Trace.sql for each custom event class (integers in the range 82-91; the same event class may be used for all such triggers) used in these triggers.  _x000A__x000A_Ensure that Trace.sql includes blocks of code for event classes 42, 43, and 162._x000A__x000A_Execute Trace.sql._x000A__x000A_If SQL Server Audit is in use, design and deploy an Audit that captures all auditable events and data items.  The script provided in the supplemental file Audit.sql can be used as the basis for this.  Supplement the standard audit data as necessary, using Extended Events and/or triggers._x000A__x000A_Alternatively, to add the necessary data capture to an existing server audit specification, run the script:_x000A_USE [master];_x000A_GO_x000A_ALTER SERVER AUDIT SPECIFICATION &lt;server_audit_specification_name&gt; WITH (STATE = OFF);_x000A_GO_x000A_ALTER SERVER AUDIT SPECIFICATION &lt;server_audit_specification_name&gt; ADD (SCHEMA_OBJECT_ACCESS_GROUP);_x000A_GO_x000A_ALTER SERVER AUDIT SPECIFICATION &lt;server_audit_specification_name&gt; WITH (STATE = ON);_x000A_GO</S>
      <S N="Check">If neither SQL Server Audit nor SQL Server Trace is in use for audit purposes, this is a finding._x000A__x000A_Obtain the list of objects (tables and stored procedures) where tracking of SELECT, INSERT, UPDATE, DELETE, or EXECUTE actions is required.  If there are none, this is not a finding._x000A__x000A_If SQL Server Trace is in use for audit purposes, review the application(s) using the database to verify that all SELECT actions on categorized data are being audited, and that the tracking records are written to the SQL Server Trace used for audit purposes.  If not, this is a finding._x000A__x000A_Review the designated tables for the existence of triggers to raise a custom event on each Insert-Update-Delete operation._x000A__x000A_If such triggers are not present, this is a finding._x000A__x000A_Check to see that all required event classes are being audited.  From the query prompt:_x000A_SELECT * FROM sys.traces;_x000A__x000A_All currently defined traces for the SQL server instance will be listed. If no traces are returned, this is a finding._x000A__x000A_Determine the trace(s) being used for the auditing requirement._x000A_In the following, replace # with a trace ID being used for the auditing requirements._x000A_From the query prompt:_x000A_SELECT DISTINCT(eventid) FROM sys.fn_trace_geteventinfo(#);_x000A__x000A_The following required event IDs should be among those listed; if not, this is a finding:_x000A__x000A_42  -- SP:Starting_x000A_43  -- SP:Completed_x000A_82-91  -- User-defined Event (at least one of these; 90 is used in the supplied script)_x000A_162 -- User error message_x000A__x000A_If SQL Server Audit is in use, verify that execution of all SELECT, INSERT, UPDATE, DELETE, or EXECUTE actions on the designated objects, is audited,._x000A__x000A_If any such actions are not audited, this is a finding._x000A__x000A_If SQL Server Audit is in use, proceed as follows._x000A__x000A_The basic SQL Server Audit configuration provided in the supplemental file Audit.sql uses the server-level audit action group SCHEMA_OBJECT_ACCESS_GROUP for this purpose.  SQL Server Audit's flexibility makes other techniques possible.  If an alternative technique is in use and demonstrated effective, this is not a finding._x000A__x000A_Determine the name(s) of the server audit specification(s) in use._x000A__x000A_To look at audits and audit specifications, in Management Studio's object explorer, expand _x000A_&lt;server name&gt; &gt;&gt; Security &gt;&gt; Audits_x000A_and_x000A_&lt;server name&gt; &gt;&gt; Security &gt;&gt; Server Audit Specifications._x000A_Also, _x000A_&lt;server name&gt; &gt;&gt; Databases &gt;&gt; &lt;database name&gt; &gt;&gt; Security &gt;&gt; Database Audit Specifications._x000A__x000A_Alternatively, review the contents of the system views with "audit" in their names._x000A__x000A_Run the following to verify that all logons and connections are being audited:_x000A_USE [master];_x000A_GO_x000A_SELECT * FROM sys.server_audit_specification_details WHERE server_specification_id =_x000A_(SELECT server_specification_id FROM sys.server_audit_specifications WHERE [name] = '&lt;server_audit_specification_name&gt;')_x000A_AND audit_action_name = 'SCHEMA_OBJECT_ACCESS_GROUP';_x000A_GO_x000A__x000A_If no row is returned, this is a finding._x000A__x000A_If the audited_result column is not "SUCCESS" or "SUCCESS AND FAILURE", this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="31">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Database</S>
      <S N="SqlVersion">2014</S>
      <S N="VulnID">V-67427</S>
      <S N="RuleID">SV-81917r2_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL4-00-037400</S>
      <S N="Title">Trace or Audit records must be generated when unsuccessful attempts to delete categorized information (e.g., classification levels/security levels) occur.</S>
      <S N="Description">Changes in categorized information must be tracked. Without an audit trail, unauthorized access to protected data could go undetected._x000A__x000A_To aid in diagnosis, it is necessary to keep track of failed attempts in addition to the successful ones._x000A__x000A_For detailed information on categorizing information, refer to FIPS Publication 199, Standards for Security Categorization of Federal Information and Information Systems, and FIPS Publication 200, Minimum Security Requirements for Federal Information and Information Systems._x000A__x000A_Use of SQL Server Audit is recommended.  All features of SQL Server Audit are available in the Enterprise and Developer editions of SQL Server 2014.  It is not available at the database level in other editions.  For this or legacy reasons, the instance may be using SQL Server Trace for auditing, which remains an acceptable solution for the time being.  Note, however, that Microsoft intends to remove most aspects of Trace at some point after SQL Server 2016._x000A__x000A_Since Trace does not provide for tracking SELECT statements, it is necessary to provide that part of the tracking at the application level.  Because of this, it may also be appropriate to audit DELETE actions at the application level.  However, to capture all DELETEs, whether they come from the application or bypass it, the Trace must be configured to cover them._x000A__x000A_Use of SQL Server Audit's SCHEMA_OBJECT_ACCESS_GROUP causes capture of all accesses, successful and otherwise, to all schema-scoped objects.  The [Succeeded] column in the audit output indicates the success or failure of the attempted action.  Be aware, however, that it may report True in some cases where one would intuitively expect False.  For example, SELECT 1/0 FROM SYS.ALL_OBJECTS will appear in the audit trail as successful, if the user has permission to perform that action, even though it contains an invalid expression.  Some other actions that one would consider failures (such as selecting from a table that does not exist) may not appear at all.</S>
      <S N="FixText">Where SQL Server Trace is in use, create triggers to raise a custom event for DELETEs on each table holding categorized information.  The examples provided in the supplemental file CustomTraceEvents.sql can serve as the basis for these. _x000A__x000A_Add a block of code to the supplemental file Trace.sql for each custom event class (integers in the range 82-91; the same event class may be used for all such triggers) used in these triggers.  Execute Trace.sql._x000A__x000A_If SQL Server Audit is in use, design and deploy an Audit that captures all auditable events and data items.  The script provided in the supplemental file Audit.sql can be used as the basis for this.  Supplement the standard audit data as necessary, using Extended Events and/or triggers._x000A__x000A_Alternatively, to add the necessary data capture to an existing server audit specification, run the script:_x000A_USE [master];_x000A_GO_x000A_ALTER SERVER AUDIT SPECIFICATION &lt;server_audit_specification_name&gt; WITH (STATE = OFF);_x000A_GO_x000A_ALTER SERVER AUDIT SPECIFICATION &lt;server_audit_specification_name&gt; ADD (SCHEMA_OBJECT_ACCESS_GROUP);_x000A_GO_x000A_ALTER SERVER AUDIT SPECIFICATION &lt;server_audit_specification_name&gt; WITH (STATE = ON);_x000A_GO</S>
      <S N="Check">Review the system documentation to determine whether it is required to track categories of information, such as classification or sensitivity level.  If it is not, this is not applicable (NA)._x000A__x000A_If neither SQL Server Audit nor SQL Server Trace is in use for audit purposes, this is a finding._x000A__x000A_If SQL Server Trace is in use for audit purposes, review the Trace settings, and the triggers on the tables holding categorized information, to determine whether all DELETE actions on these tables are traced, including failed attempts.  If not, this is a finding._x000A__x000A_Check to see that all required event classes are being audited.  From the query prompt:_x000A_SELECT * FROM sys.traces;_x000A__x000A_All currently defined traces for the SQL server instance will be listed. If no traces are returned, this is a finding._x000A__x000A_Determine the trace(s) being used for the auditing requirement._x000A_In the following, replace # with a trace ID being used for the auditing requirements._x000A_From the query prompt:_x000A_SELECT DISTINCT(eventid) FROM sys.fn_trace_geteventinfo(#);_x000A__x000A_The following required event IDs should be among those listed; if not, this is a finding:_x000A__x000A_82-91  -- User-defined Event (at least one of these, matching the triggers; 90 is used in the supplied script)_x000A_162 -- User error message_x000A__x000A__x000A_If SQL Server Audit is in use, proceed as follows._x000A__x000A_The basic SQL Server Audit configuration provided in the supplemental file Audit.sql uses the broad, server-level audit action group SCHEMA_OBJECT_ACCESS_GROUP for this purpose.  SQL Server Audit's flexibility makes other techniques possible.  If an alternative technique is in use and demonstrated effective, this is not a finding._x000A__x000A_Determine the name(s) of the server audit specification(s) in use._x000A__x000A_To look at audits and audit specifications, in Management Studio's object explorer, expand _x000A_&lt;server name&gt; &gt;&gt; Security &gt;&gt; Audits_x000A_and_x000A_&lt;server name&gt; &gt;&gt; Security &gt;&gt; Server Audit Specifications._x000A_Also, _x000A_&lt;server name&gt; &gt;&gt; Databases &gt;&gt; &lt;database name&gt; &gt;&gt; Security &gt;&gt; Database Audit Specifications._x000A__x000A_Alternatively, review the contents of the system views with "audit" in their names._x000A__x000A_Run the following to verify that all SELECT, INSERT, UPDATE, and DELETE actions on tables and views are being audited:_x000A_USE [master];_x000A_GO_x000A_SELECT * FROM sys.server_audit_specification_details WHERE server_specification_id =_x000A_(SELECT server_specification_id FROM sys.server_audit_specifications WHERE [name] = '&lt;server_audit_specification_name&gt;')_x000A_AND audit_action_name = 'SCHEMA_OBJECT_ACCESS_GROUP';_x000A__x000A_If no row is returned, this is a finding._x000A__x000A_If the audited_result column is not "FAILURE" or "SUCCESS AND FAILURE", this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="32">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Database</S>
      <S N="SqlVersion">2014</S>
      <S N="VulnID">V-67429</S>
      <S N="RuleID">SV-81919r2_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL4-00-037300</S>
      <S N="Title">Trace or Audit records must be generated when categorized information (e.g., classification levels/security levels) is deleted.</S>
      <S N="Description">Changes in categorized information must be tracked. Without an audit trail, unauthorized access to protected data could go undetected._x000A__x000A_For detailed information on categorizing information, refer to FIPS Publication 199, Standards for Security Categorization of Federal Information and Information Systems, and FIPS Publication 200, Minimum Security Requirements for Federal Information and Information Systems._x000A__x000A_Use of SQL Server Audit is recommended.  All features of SQL Server Audit are available in the Enterprise and Developer editions of SQL Server 2014.  It is not available at the database level in other editions.  For this or legacy reasons, the instance may be using SQL Server Trace for auditing, which remains an acceptable solution for the time being.  Note, however, that Microsoft intends to remove most aspects of Trace at some point after SQL Server 2016._x000A__x000A_Since Trace does not provide for tracking SELECT statements, it is necessary to provide that part of the tracking at the application level.  Because of this, it may also be appropriate to audit DELETE actions at the application level.  However, to capture all DELETEs, whether they come from the application or bypass it, the Trace must be configured to cover them.</S>
      <S N="FixText">Where SQL Server Trace is in use, create triggers to raise a custom event for DELETEs on each table holding categorized information.  The examples provided in the supplemental file CustomTraceEvents.sql can serve as the basis for these. _x000A__x000A_Add a block of code to the supplemental file Trace.sql for each custom event class (integers in the range 82-91; the same event class may be used for all such triggers) used in these triggers.  Execute Trace.sql._x000A__x000A_If SQL Server Audit is in use, design and deploy an Audit that captures all auditable events and data items.  The script provided in the supplemental file Audit.sql can be used as the basis for this.  Supplement the standard audit data as necessary, using Extended Events and/or triggers._x000A__x000A_Alternatively, to add the necessary data capture to an existing server audit specification, run the script:_x000A_USE [master];_x000A_GO_x000A_ALTER SERVER AUDIT SPECIFICATION &lt;server_audit_specification_name&gt; WITH (STATE = OFF);_x000A_GO_x000A_ALTER SERVER AUDIT SPECIFICATION &lt;server_audit_specification_name&gt; ADD (SCHEMA_OBJECT_ACCESS_GROUP);_x000A_GO_x000A_ALTER SERVER AUDIT SPECIFICATION &lt;server_audit_specification_name&gt; WITH (STATE = ON);_x000A_GO</S>
      <S N="Check">Review the system documentation to determine whether it is required to track categories of information, such as classification or sensitivity level.  If it is not, this is not applicable (NA)._x000A__x000A_If neither SQL Server Audit nor SQL Server Trace is in use for audit purposes, this is a finding._x000A__x000A_If SQL Server Trace is in use for audit purposes, review the triggers on all tables holding categorized information, to determine whether trace events are generated for all DELETE actions on these tables.  If not, this is a finding._x000A__x000A_Check to see that all required event classes are being audited.  From the query prompt:_x000A_SELECT * FROM sys.traces;_x000A__x000A_All currently defined traces for the SQL server instance will be listed. If no traces are returned, this is a finding._x000A__x000A_Determine the trace(s) being used for the auditing requirement._x000A__x000A_In the following, replace # with a trace ID being used for the auditing requirements._x000A__x000A_From the query prompt:_x000A_SELECT DISTINCT(eventid) FROM sys.fn_trace_geteventinfo(#);_x000A__x000A_The following required event IDs should be among those listed; if not, this is a finding:_x000A__x000A_82-91  -- User-defined Event (at least one of these, matching the triggers; 90 is used in the supplied script)_x000A_162 -- User error message_x000A__x000A__x000A_If SQL Server Audit is in use, proceed as follows._x000A__x000A_The basic SQL Server Audit configuration provided in the supplemental file Audit.sql uses the broad, server-level audit action group SCHEMA_OBJECT_ACCESS_GROUP for this purpose. SQL Server Audit's flexibility makes other techniques possible.  If an alternative technique is in use and demonstrated effective, this is not a finding._x000A__x000A_Determine the name(s) of the server audit specification(s) in use._x000A__x000A_To look at audits and audit specifications, in Management Studio's object explorer, expand _x000A_&lt;server name&gt; &gt;&gt; Security &gt;&gt; Audits_x000A_and_x000A_&lt;server name&gt; &gt;&gt; Security &gt;&gt; Server Audit Specifications._x000A_Also, _x000A_&lt;server name&gt; &gt;&gt; Databases &gt;&gt; &lt;database name&gt; &gt;&gt; Security &gt;&gt; Database Audit Specifications._x000A__x000A_Alternatively, review the contents of the system views with "audit" in their names._x000A__x000A_Run the following to verify that all SELECT, INSERT, UPDATE, and DELETE actions on tables and views are being audited:_x000A_USE [master];_x000A_GO_x000A_SELECT * FROM sys.server_audit_specification_details WHERE server_specification_id =_x000A_(SELECT server_specification_id FROM sys.server_audit_specifications WHERE [name] = '&lt;server_audit_specification_name&gt;')_x000A_AND audit_action_name = 'SCHEMA_OBJECT_ACCESS_GROUP';_x000A__x000A_If no row is returned, this is a finding._x000A__x000A_If the audited_result column is not "SUCCESS" or "SUCCESS AND FAILURE", this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="33">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Database</S>
      <S N="SqlVersion">2014</S>
      <S N="VulnID">V-67431</S>
      <S N="RuleID">SV-81921r3_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL4-00-037200</S>
      <S N="Title">SQL Server must generate Trace or Audit records when  unsuccessful attempts to drop locally-defined security objects occur.</S>
      <S N="Description">SQL Server protects its built-in security objects (tables, views, functions, procedures, etc.) from alteration by database users and administrators.  However, applications sometimes have additional, security-related objects defined in the database.  DROP operations on these objects must be monitored._x000A__x000A_To aid in diagnosis, it is necessary to keep track of failed attempts in addition to the successful ones._x000A__x000A_Use of SQL Server Audit is recommended.  All features of SQL Server Audit are available in the Enterprise and Developer editions of SQL Server 2014.  It is not available at the database level in other editions.  For this or legacy reasons, the instance may be using SQL Server Trace for auditing, which remains an acceptable solution for the time being.  Note, however, that Microsoft intends to remove most aspects of Trace at some point after SQL Server 2016._x000A__x000A_Use of SQL Server Audit's SCHEMA_OBJECT_CHANGE_GROUP causes capture of all attempts, successful and otherwise, to CREATE, ALTER, or DROP any schema-scoped objects.  The [Succeeded] column in the audit output indicates the success or failure of the attempted action.  Be aware, however, that it may report True in some cases where one would intuitively expect False.</S>
      <S N="FixText">Where SQL Server Trace is in use, define  and enable a trace that captures all auditable events.  The script provided in the supplemental file Trace.sql can be used to do this._x000A__x000A_Add blocks of code to Trace.sql for each custom event class (integers in the range 82-91; the same event class may be used for all such triggers) used in these triggers.  _x000A__x000A_Create triggers to raise a custom event on each locally-defined security table that requires tracking of Insert-Update-Delete operations.  The examples provided in the supplemental file CustomTraceEvents.sql can serve as the basis for these.  _x000A__x000A_Execute Trace.sql._x000A__x000A_Where SQL Server Audit is in use, design and deploy a SQL Server Audit that captures all auditable events.  The script provided in the supplemental file Audit.sql can be used for this._x000A__x000A_Alternatively, to add the necessary data capture to an existing server audit specification, run the script:_x000A_USE [master];_x000A_GO_x000A_ALTER SERVER AUDIT SPECIFICATION &lt;server_audit_specification_name&gt; WITH (STATE = OFF);_x000A_GO_x000A_ALTER SERVER AUDIT SPECIFICATION &lt;server_audit_specification_name&gt; ADD (SCHEMA_OBJECT_CHANGE_GROUP);_x000A_GO_x000A_ALTER SERVER AUDIT SPECIFICATION &lt;server_audit_specification_name&gt; WITH (STATE = ON);_x000A_GO</S>
      <S N="Check">If neither SQL Server Audit nor SQL Server Trace is in use for audit purposes, this is a finding._x000A__x000A_If there are no locally-defined security tables or procedures, this is not a finding._x000A__x000A_If SQL Server Trace is in use for audit purposes, verify that all required events are being audited.  From the query prompt:_x000A_SELECT * FROM sys.traces;_x000A__x000A_All currently defined traces for the SQL server instance will be listed. If no traces are returned, this is a finding._x000A__x000A_Determine the trace(s) being used for the auditing requirement._x000A_In the following, replace # with a trace ID being used for the auditing requirements._x000A_From the query prompt:_x000A_SELECT DISTINCT(eventid) FROM sys.fn_trace_geteventinfo(#);_x000A__x000A_The following required event IDs should all be among those listed; if not, this is a finding:_x000A__x000A_46  -- Object:Created_x000A_47  -- Object:Deleted_x000A_162  -- User error message_x000A_164 -- Object:Altered_x000A__x000A_If SQL Server Audit is in use, proceed as follows._x000A__x000A_The basic SQL Server Audit configuration provided in the supplemental file Audit.sql uses the broad, server-level audit action group SCHEMA_OBJECT_CHANGE_GROUP for this purpose.  SQL Server Audit's flexibility makes other techniques possible.  If an alternative technique is in use and demonstrated effective, this is not a finding._x000A__x000A_Determine the name(s) of the server audit specification(s) in use._x000A__x000A_To look at audits and audit specifications, in Management Studio's object explorer, expand _x000A_&lt;server name&gt; &gt;&gt; Security &gt;&gt; Audits_x000A_and_x000A_&lt;server name&gt; &gt;&gt; Security &gt;&gt; Server Audit Specifications._x000A_Also, _x000A_&lt;server name&gt; &gt;&gt; Databases &gt;&gt; &lt;database name&gt; &gt;&gt; Security &gt;&gt; Database Audit Specifications._x000A__x000A_Alternatively, review the contents of the system views with "audit" in their names._x000A__x000A_Run the following to verify that all CREATE, ALTER, and DROP actions on any locally-defined permissions tables, procedures and functions are being audited:_x000A_USE [master];_x000A_GO_x000A_SELECT * FROM sys.server_audit_specification_details WHERE server_specification_id =_x000A_(SELECT server_specification_id FROM sys.server_audit_specifications WHERE [name] = '&lt;server_audit_specification_name&gt;')_x000A_AND audit_action_name = 'SCHEMA_OBJECT_CHANGE_GROUP';_x000A__x000A_If no row is returned, this is a finding._x000A__x000A_If the audited_result column is not "FAILURE" or "SUCCESS AND FAILURE", this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="34">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Database</S>
      <S N="SqlVersion">2014</S>
      <S N="VulnID">V-67433</S>
      <S N="RuleID">SV-81923r3_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL4-00-037100</S>
      <S N="Title">SQL Server must generate Trace or Audit records when locally-defined security objects are dropped.</S>
      <S N="Description">SQL Server protects its built-in security objects (tables, views, functions, procedures, etc.) from alteration by database users and administrators.  However, applications sometimes have additional, security-related objects defined in the database.  DROP operations on these objects must be monitored._x000A__x000A_Use of SQL Server Audit is recommended.  All features of SQL Server Audit are available in the Enterprise and Developer editions of SQL Server 2014.  It is not available at the database level in other editions.  For this or legacy reasons, the instance may be using SQL Server Trace for auditing, which remains an acceptable solution for the time being.  Note, however, that Microsoft intends to remove most aspects of Trace at some point after SQL Server 2016.</S>
      <S N="FixText">Where SQL Server Trace is in use, define  and enable a trace that captures all auditable events.  The script provided in the supplemental file Trace.sql can be used to do this._x000A__x000A_Add blocks of code to Trace.sql for each custom event class (integers in the range 82-91; the same event class may be used for all such triggers) used in these triggers.  _x000A__x000A_Create triggers to raise a custom event on each locally-defined security table that requires tracking of Insert-Update-Delete operations.  The examples provided in the supplemental file CustomTraceEvents.sql can serve as the basis for these.  _x000A__x000A_Execute Trace.sql._x000A__x000A_Where SQL Server Audit is in use, design and deploy a SQL Server Audit that captures all auditable events.  The script provided in the supplemental file Audit.sql can be used for this._x000A__x000A_Alternatively, to add the necessary data capture to an existing server audit specification, run the script:_x000A_USE [master];_x000A_GO_x000A_ALTER SERVER AUDIT SPECIFICATION &lt;server_audit_specification_name&gt; WITH (STATE = OFF);_x000A_GO_x000A_ALTER SERVER AUDIT SPECIFICATION &lt;server_audit_specification_name&gt; ADD (SCHEMA_OBJECT_CHANGE_GROUP);_x000A_GO_x000A_ALTER SERVER AUDIT SPECIFICATION &lt;server_audit_specification_name&gt; WITH (STATE = ON);_x000A_GO</S>
      <S N="Check">If neither SQL Server Audit nor SQL Server Trace is in use for audit purposes, this is a finding._x000A__x000A_If there are no locally-defined security tables or procedures, this is not a finding._x000A__x000A_If SQL Server Trace is in use for audit purposes, verify that all required events are being audited.  From the query prompt:_x000A_SELECT * FROM sys.traces;_x000A_All currently defined traces for the SQL server instance will be listed._x000A__x000A_If no traces are returned, this is a finding._x000A__x000A_Determine the trace(s) being used for the auditing requirement._x000A_In the following, replace # with a trace ID being used for the auditing requirements._x000A_From the query prompt:_x000A_SELECT DISTINCT(eventid) FROM sys.fn_trace_geteventinfo(#);_x000A__x000A_The following required event IDs should all be among those listed; if not, this is a finding:_x000A__x000A_46  -- Object:Created_x000A_47  -- Object:Deleted_x000A_162  -- User error message_x000A_164 -- Object:Altered_x000A__x000A_If SQL Server Audit is in use, proceed as follows._x000A__x000A_The basic SQL Server Audit configuration provided in the supplemental file Audit.sql uses the broad, server-level audit action group SCHEMA_OBJECT_CHANGE_GROUP for this purpose.  SQL Server Audit's flexibility makes other techniques possible.  If an alternative technique is in use and demonstrated effective, this is not a finding._x000A__x000A_Determine the name(s) of the server audit specification(s) in use._x000A__x000A_To look at audits and audit specifications, in Management Studio's object explorer, expand _x000A_&lt;server name&gt; &gt;&gt; Security &gt;&gt; Audits_x000A_and_x000A_&lt;server name&gt; &gt;&gt; Security &gt;&gt; Server Audit Specifications._x000A_Also, _x000A_&lt;server name&gt; &gt;&gt; Databases &gt;&gt; &lt;database name&gt; &gt;&gt; Security &gt;&gt; Database Audit Specifications._x000A__x000A_Alternatively, review the contents of the system views with "audit" in their names._x000A__x000A_Run the following to verify that all CREATE, ALTER, and DROP actions on any locally-defined permissions tables, procedures and functions are being audited:_x000A_USE [master];_x000A_GO_x000A_SELECT * FROM sys.server_audit_specification_details WHERE server_specification_id =_x000A_(SELECT server_specification_id FROM sys.server_audit_specifications WHERE [name] = '&lt;server_audit_specification_name&gt;')_x000A_AND audit_action_name = 'SCHEMA_OBJECT_CHANGE_GROUP';_x000A__x000A_If no row is returned, this is a finding._x000A__x000A_If the audited_result column is not "SUCCESS" or "SUCCESS AND FAILURE", this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="35">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Database</S>
      <S N="SqlVersion">2014</S>
      <S N="VulnID">V-67435</S>
      <S N="RuleID">SV-81925r2_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL4-00-036500</S>
      <S N="Title">SQL Server must generate Trace or Audit records when unsuccessful attempts to modify locally-defined security objects occur.</S>
      <S N="Description">SQL Server protects its built-in security objects (tables, views, functions, procedures, etc.) from alteration by database users and administrators.  However, applications sometimes have additional, security-related objects defined in the database.  ALTER operations on these objects must be monitored._x000A__x000A_To aid in diagnosis, it is necessary to keep track of failed attempts in addition to the successful ones._x000A__x000A_Use of SQL Server Audit is recommended.  All features of SQL Server Audit are available in the Enterprise and Developer editions of SQL Server 2014.  It is not available at the database level in other editions.  For this or legacy reasons, the instance may be using SQL Server Trace for auditing, which remains an acceptable solution for the time being.  Note, however, that Microsoft intends to remove most aspects of Trace at some point after SQL Server 2016._x000A__x000A_Use of SQL Server Audit's SCHEMA_OBJECT_CHANGE_GROUP causes capture of all attempts, successful and otherwise, to CREATE, ALTER, or DROP any schema-scoped objects.  The [Succeeded] column in the audit output indicates the success or failure of the attempted action.  Be aware, however, that it may report True in some cases where one would intuitively expect False.</S>
      <S N="FixText">Where SQL Server Trace is in use, define  and enable a trace that captures all auditable events.  The script provided in the supplemental file Trace.sql can be used to do this._x000A__x000A_Where SQL Server Audit is in use, design and deploy a SQL Server Audit that captures all auditable events.  The script provided in the supplemental file Audit.sql can be used for this._x000A__x000A_Alternatively, to add the necessary data capture to an existing server audit specification, run the script:_x000A_USE [master];_x000A_GO_x000A_ALTER SERVER AUDIT SPECIFICATION &lt;server_audit_specification_name&gt; WITH (STATE = OFF);_x000A_GO_x000A_ALTER SERVER AUDIT SPECIFICATION &lt;server_audit_specification_name&gt; ADD (SCHEMA_OBJECT_CHANGE_GROUP);_x000A_GO_x000A_ALTER SERVER AUDIT SPECIFICATION &lt;server_audit_specification_name&gt; WITH (STATE = ON);_x000A_GO</S>
      <S N="Check">If there are no locally-defined security tables or procedures, this is not a finding._x000A__x000A_If neither SQL Server Audit nor SQL Server Trace is in use for audit purposes, this is a finding._x000A__x000A_If SQL Server Trace is in use for audit purposes, verify  that all required events are being audited.  From the query prompt:_x000A_SELECT * FROM sys.traces;_x000A__x000A_All currently defined traces for the SQL server instance will be listed. If no traces are returned, this is a finding._x000A__x000A_Determine the trace(s) being used for the auditing requirement._x000A_In the following, replace # with a trace ID being used for the auditing requirements._x000A_From the query prompt:_x000A_SELECT DISTINCT(eventid) FROM sys.fn_trace_geteventinfo(#);_x000A__x000A_The following required event IDs should all be among those listed; if not, this is a finding:_x000A__x000A_46  -- Object:Created_x000A_47  -- Object:Deleted_x000A_162  -- User error message_x000A_164 -- Object:Altered_x000A__x000A__x000A_If SQL Server Audit is in use, proceed as follows._x000A__x000A_The basic SQL Server Audit configuration provided in the supplemental file Audit.sql uses the broad, server-level audit action group SCHEMA_OBJECT_CHANGE_GROUP for this purpose.  SQL Server Audit's flexibility makes other techniques possible.  If an alternative technique is in use and demonstrated effective, this is not a finding._x000A__x000A_Determine the name(s) of the server audit specification(s) in use._x000A__x000A_To look at audits and audit specifications, in Management Studio's object explorer, expand _x000A_&lt;server name&gt; &gt;&gt; Security &gt;&gt; Audits_x000A_and_x000A_&lt;server name&gt; &gt;&gt; Security &gt;&gt; Server Audit Specifications._x000A_Also, _x000A_&lt;server name&gt; &gt;&gt; Databases &gt;&gt; &lt;database name&gt; &gt;&gt; Security &gt;&gt; Database Audit Specifications._x000A__x000A_Alternatively, review the contents of the system views with "audit" in their names._x000A__x000A_Run the following to verify that all CREATE, ALTER, and DROP actions on any locally-defined permissions tables, procedures and functions are being audited:_x000A_USE [master];_x000A_GO_x000A_SELECT * FROM sys.server_audit_specification_details WHERE server_specification_id =_x000A_(SELECT server_specification_id FROM sys.server_audit_specifications WHERE [name] = '&lt;server_audit_specification_name&gt;')_x000A_AND audit_action_name = 'SCHEMA_OBJECT_CHANGE_GROUP';_x000A__x000A_If no row is returned, this is a finding._x000A__x000A_If the audited_result column is not "FAILURE" or "SUCCESS AND FAILURE", this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="36">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Database</S>
      <S N="SqlVersion">2014</S>
      <S N="VulnID">V-67437</S>
      <S N="RuleID">SV-81927r2_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL4-00-036600</S>
      <S N="Title">Trace or Audit records must be generated when categorized information (e.g., classification levels/security levels) is created.</S>
      <S N="Description">Changes in categorized information must be tracked. Without an audit trail, unauthorized access to protected data could go undetected._x000A__x000A_For detailed information on categorizing information, refer to FIPS Publication 199, Standards for Security Categorization of Federal Information and Information Systems, and FIPS Publication 200, Minimum Security Requirements for Federal Information and Information Systems._x000A__x000A_Use of SQL Server Audit is recommended.  All features of SQL Server Audit are available in the Enterprise and Developer editions of SQL Server 2014.  It is not available at the database level in other editions.  For this or legacy reasons, the instance may be using SQL Server Trace for auditing, which remains an acceptable solution for the time being.  Note, however, that Microsoft intends to remove most aspects of Trace at some point after SQL Server 2016._x000A__x000A_Since Trace does not provide for tracking SELECT statements, it is necessary to provide that part of the tracking at the application level.  Because of this, it may also be appropriate to audit INSERT actions at the application level.  However, to capture all INSERTs, whether they come from the application or bypass it, the Trace must be configured to cover them.</S>
      <S N="FixText">Where SQL Server Trace is in use, create triggers to raise a custom event for INSERTs on each table holding categorized information.  The examples provided in the supplemental file CustomTraceEvents.sql can serve as the basis for these. _x000A__x000A_Add a block of code to the supplemental file Trace.sql for each custom event class (integers in the range 82-91; the same event class may be used for all such triggers) used in these triggers.  Execute Trace.sql._x000A__x000A_If SQL Server Audit is in use, design and deploy an Audit that captures all auditable events and data items.  The script provided in the supplemental file Audit.sql can be used as the basis for this.  Supplement the standard audit data as necessary, using Extended Events and/or triggers._x000A__x000A_Alternatively, to add the necessary data capture to an existing server audit specification, run the script:_x000A_USE [master];_x000A_GO_x000A_ALTER SERVER AUDIT SPECIFICATION &lt;server_audit_specification_name&gt; WITH (STATE = OFF);_x000A_GO_x000A_ALTER SERVER AUDIT SPECIFICATION &lt;server_audit_specification_name&gt; ADD (SCHEMA_OBJECT_ACCESS_GROUP);_x000A_GO_x000A_ALTER SERVER AUDIT SPECIFICATION &lt;server_audit_specification_name&gt; WITH (STATE = ON);_x000A_GO</S>
      <S N="Check">Review the system documentation to determine whether it is required to track categories of information, such as classification or sensitivity level.  If it is not, this is not applicable (NA)._x000A__x000A_If neither SQL Server Audit nor SQL Server Trace is in use for audit purposes, this is a finding._x000A__x000A_If SQL Server Trace is in use for audit purposes, review the Trace settings, and the triggers on the tables holding categorized information, to determine whether all INSERT actions on these tables are traced, including failed attempts.  If not, this is a finding._x000A__x000A_Check to see that all required event classes are being audited.  From the query prompt:_x000A_SELECT * FROM sys.traces;_x000A__x000A_All currently defined traces for the SQL server instance will be listed. If no traces are returned, this is a finding._x000A__x000A_Determine the trace(s) being used for the auditing requirement._x000A_In the following, replace # with a trace ID being used for the auditing requirements._x000A_From the query prompt:_x000A_SELECT DISTINCT(eventid) FROM sys.fn_trace_geteventinfo(#);_x000A__x000A_The following required event IDs should be among those listed; if not, this is a finding:_x000A__x000A_82-91  -- User-defined Event (at least one of these, matching the triggers; 90 is used in the supplied script)_x000A_162 -- User error message_x000A__x000A__x000A_If SQL Server Audit is in use, proceed as follows._x000A__x000A_The basic SQL Server Audit configuration provided in the supplemental file Audit.sql uses the broad, server-level audit action group SCHEMA_OBJECT_ACCESS_GROUP for this purpose.  SQL Server Audit's flexibility makes other techniques possible.  If an alternative technique is in use and demonstrated effective, this is not a finding._x000A__x000A_Determine the name(s) of the server audit specification(s) in use._x000A__x000A_To look at audits and audit specifications, in Management Studio's object explorer, expand _x000A_&lt;server name&gt; &gt;&gt; Security &gt;&gt; Audits_x000A_and_x000A_&lt;server name&gt; &gt;&gt; Security &gt;&gt; Server Audit Specifications._x000A_Also, _x000A_&lt;server name&gt; &gt;&gt; Databases &gt;&gt; &lt;database name&gt; &gt;&gt; Security &gt;&gt; Database Audit Specifications._x000A__x000A_Alternatively, review the contents of the system views with "audit" in their names._x000A__x000A_Run the following to verify that all SELECT, INSERT, UPDATE, and DELETE actions on tables and views are being audited:_x000A_USE [master];_x000A_GO_x000A_SELECT * FROM sys.server_audit_specification_details WHERE server_specification_id =_x000A_(SELECT server_specification_id FROM sys.server_audit_specifications WHERE [name] = '&lt;server_audit_specification_name&gt;')_x000A_AND audit_action_name = 'SCHEMA_OBJECT_ACCESS_GROUP';_x000A__x000A_If no row is returned, this is a finding._x000A__x000A_If the audited_result column is not "SUCCESS" or "SUCCESS AND FAILURE", this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="37">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Database</S>
      <S N="SqlVersion">2014</S>
      <S N="VulnID">V-67439</S>
      <S N="RuleID">SV-81929r2_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL4-00-036800</S>
      <S N="Title">Trace or Audit records must be generated when unsuccessful attempts to create categorized information (e.g., classification levels/security levels) occur.</S>
      <S N="Description">Changes in categorized information must be tracked. Without an audit trail, unauthorized access to protected data could go undetected._x000A__x000A_To aid in diagnosis, it is necessary to keep track of failed attempts in addition to the successful ones._x000A__x000A_For detailed information on categorizing information, refer to FIPS Publication 199, Standards for Security Categorization of Federal Information and Information Systems, and FIPS Publication 200, Minimum Security Requirements for Federal Information and Information Systems._x000A__x000A_Use of SQL Server Audit is recommended.  All features of SQL Server Audit are available in the Enterprise and Developer editions of SQL Server 2014.  It is not available at the database level in other editions.  For this or legacy reasons, the instance may be using SQL Server Trace for auditing, which remains an acceptable solution for the time being.  Note, however, that Microsoft intends to remove most aspects of Trace at some point after SQL Server 2016._x000A__x000A_Since Trace does not provide for tracking SELECT statements, it is necessary to provide that part of the tracking at the application level.  Because of this, it may also be appropriate to audit INSERT actions at the application level.  However, to capture all INSERTs, whether they come from the application or bypass it, the Trace must be configured to cover them._x000A__x000A_Use of SQL Server Audit's SCHEMA_OBJECT_ACCESS_GROUP causes capture of all accesses, successful and otherwise, to all schema-scoped objects.  The [Succeeded] column in the audit output indicates the success or failure of the attempted action.  Be aware, however, that it may report True in some cases where one would intuitively expect False; and some other actions that one would consider failures (such as selecting from a table that does not exist) may not appear at all.</S>
      <S N="FixText">Where SQL Server Trace is in use, create triggers to raise a custom event for INSERTs on each table holding categorized information.  The examples provided in the supplemental file CustomTraceEvents.sql can serve as the basis for these. _x000A__x000A_Add a block of code to the supplemental file Trace.sql for each custom event class (integers in the range 82-91; the same event class may be used for all such triggers) used in these triggers.  Execute Trace.sql._x000A__x000A_If SQL Server Audit is in use, design and deploy an Audit that captures all auditable events and data items.  The script provided in the supplemental file Audit.sql can be used as the basis for this.  Supplement the standard audit data as necessary, using Extended Events and/or triggers._x000A__x000A_Alternatively, to add the necessary data capture to an existing server audit specification, run the script:_x000A_USE [master];_x000A_GO_x000A_ALTER SERVER AUDIT SPECIFICATION &lt;server_audit_specification_name&gt; WITH (STATE = OFF);_x000A_GO_x000A_ALTER SERVER AUDIT SPECIFICATION &lt;server_audit_specification_name&gt; ADD (SCHEMA_OBJECT_ACCESS_GROUP);_x000A_GO_x000A_ALTER SERVER AUDIT SPECIFICATION &lt;server_audit_specification_name&gt; WITH (STATE = ON);_x000A_GO</S>
      <S N="Check">Review the system documentation to determine whether it is required to track categories of information, such as classification or sensitivity level.  If it is not, this is not applicable (NA)._x000A__x000A_If neither SQL Server Audit nor SQL Server Trace is in use for audit purposes, this is a finding._x000A__x000A_If SQL Server Trace is in use for audit purposes, review the Trace settings, and the triggers on the tables holding categorized information, to determine whether all INSERT actions on these tables are traced, including failed attempts.  If not, this is a finding._x000A__x000A_Check to see that all required event classes are being audited.  From the query prompt:_x000A_SELECT * FROM sys.traces;_x000A__x000A_All currently defined traces for the SQL server instance will be listed. If no traces are returned, this is a finding._x000A__x000A_Determine the trace(s) being used for the auditing requirement._x000A_In the following, replace # with a trace ID being used for the auditing requirements._x000A_From the query prompt:_x000A_SELECT DISTINCT(eventid) FROM sys.fn_trace_geteventinfo(#);_x000A__x000A_The following required event IDs should be among those listed; if not, this is a finding:_x000A__x000A_82-91  -- User-defined Event (at least one of these, matching the triggers; 90 is used in the supplied script)_x000A_162 -- User error message_x000A__x000A__x000A_If SQL Server Audit is in use, proceed as follows._x000A__x000A_The basic SQL Server Audit configuration provided in the supplemental file Audit.sql uses the broad, server-level audit action group SCHEMA_OBJECT_ACCESS_GROUP for this purpose.  SQL Server Audit's flexibility makes other techniques possible.  If an alternative technique is in use and demonstrated effective, this is not a finding._x000A__x000A_Determine the name(s) of the server audit specification(s) in use._x000A__x000A_To look at audits and audit specifications, in Management Studio's object explorer, expand _x000A_&lt;server name&gt; &gt;&gt; Security &gt;&gt; Audits_x000A_and_x000A_&lt;server name&gt; &gt;&gt; Security &gt;&gt; Server Audit Specifications._x000A_Also, _x000A_&lt;server name&gt; &gt;&gt; Databases &gt;&gt; &lt;database name&gt; &gt;&gt; Security &gt;&gt; Database Audit Specifications._x000A__x000A_Alternatively, review the contents of the system views with "audit" in their names._x000A__x000A_Run the following to verify that all SELECT, INSERT, UPDATE, and DELETE actions on tables and views are being audited:_x000A_USE [master];_x000A_GO_x000A_SELECT * FROM sys.server_audit_specification_details WHERE server_specification_id =_x000A_(SELECT server_specification_id FROM sys.server_audit_specifications WHERE [name] = '&lt;server_audit_specification_name&gt;')_x000A_AND audit_action_name = 'SCHEMA_OBJECT_ACCESS_GROUP';_x000A__x000A_If no row is returned, this is a finding._x000A__x000A_If the audited_result column is not "FAILURE" or "SUCCESS AND FAILURE", this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="38">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Database</S>
      <S N="SqlVersion">2014</S>
      <S N="VulnID">V-67441</S>
      <S N="RuleID">SV-81931r2_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL4-00-036650</S>
      <S N="Title">Trace or Audit records must be generated when categorized information (e.g., classification levels/security levels) is modified.</S>
      <S N="Description">Changes in categorized information must be tracked. Without an audit trail, unauthorized access to protected data could go undetected._x000A__x000A_For detailed information on categorizing information, refer to FIPS Publication 199, Standards for Security Categorization of Federal Information and Information Systems, and FIPS Publication 200, Minimum Security Requirements for Federal Information and Information Systems._x000A__x000A_Use of SQL Server Audit is recommended.  All features of SQL Server Audit are available in the Enterprise and Developer editions of SQL Server 2014.  It is not available at the database level in other editions.  For this or legacy reasons, the instance may be using SQL Server Trace for auditing, which remains an acceptable solution for the time being.  Note, however, that Microsoft intends to remove most aspects of Trace at some point after SQL Server 2016._x000A__x000A_Since Trace does not provide for tracking SELECT statements, it is necessary to provide that part of the tracking at the application level.  Because of this, it may also be appropriate to audit UPDATE actions at the application level.  However, to capture all UPDATEs, whether they come from the application or bypass it, the Trace must be configured to cover them.</S>
      <S N="FixText">Where SQL Server Trace is in use, create triggers to raise a custom event for UPDATEs on each table holding categorized information.  The examples provided in the supplemental file CustomTraceEvents.sql can serve as the basis for these. _x000A__x000A_Add a block of code to the supplemental file Trace.sql for each custom event class (integers in the range 82-91; the same event class may be used for all such triggers) used in these triggers.  Execute Trace.sql._x000A__x000A_If SQL Server Audit is in use, design and deploy an Audit that captures all auditable events and data items.  The script provided in the supplemental file Audit.sql can be used as the basis for this.  Supplement the standard audit data as necessary, using Extended Events and/or triggers._x000A__x000A_Alternatively, to add the necessary data capture to an existing server audit specification, run the script:_x000A_USE [master];_x000A_GO_x000A_ALTER SERVER AUDIT SPECIFICATION &lt;server_audit_specification_name&gt; WITH (STATE = OFF);_x000A_GO_x000A_ALTER SERVER AUDIT SPECIFICATION &lt;server_audit_specification_name&gt; ADD (SCHEMA_OBJECT_ACCESS_GROUP);_x000A_GO_x000A_ALTER SERVER AUDIT SPECIFICATION &lt;server_audit_specification_name&gt; WITH (STATE = ON);_x000A_GO</S>
      <S N="Check">Review the system documentation to determine whether it is required to track categories of information, such as classification or sensitivity level.  If it is not, this is not applicable (NA)._x000A__x000A_If neither SQL Server Audit nor SQL Server Trace is in use for audit purposes, this is a finding._x000A__x000A_If SQL Server Trace is in use for audit purposes, review the triggers on all tables holding categorized information, to determine whether trace events are generated for all UPDATE actions on these tables.  If not, this is a finding._x000A__x000A_Check to see that all required event classes are being audited.  From the query prompt:_x000A_SELECT * FROM sys.traces;_x000A__x000A_All currently defined traces for the SQL server instance will be listed. If no traces are returned, this is a finding._x000A__x000A_Determine the trace(s) being used for the auditing requirement._x000A_In the following, replace # with a trace ID being used for the auditing requirements._x000A_From the query prompt:_x000A_SELECT DISTINCT(eventid) FROM sys.fn_trace_geteventinfo(#);_x000A__x000A_The following required event IDs should be among those listed; if not, this is a finding:_x000A__x000A_82-91  -- User-defined Event (at least one of these, matching the triggers; 90 is used in the supplied script)_x000A_162 -- User error message_x000A__x000A__x000A_If SQL Server Audit is in use, proceed as follows._x000A__x000A_The basic SQL Server Audit configuration provided in the supplemental file Audit.sql uses the broad, server-level audit action group SCHEMA_OBJECT_ACCESS_GROUP for this purpose.  SQL Server Audit's flexibility makes other techniques possible.  If an alternative technique is in use and demonstrated effective, this is not a finding._x000A__x000A_Determine the name(s) of the server audit specification(s) in use._x000A__x000A_To look at audits and audit specifications, in Management Studio's object explorer, expand _x000A_&lt;server name&gt; &gt;&gt; Security &gt;&gt; Audits_x000A_and_x000A_&lt;server name&gt; &gt;&gt; Security &gt;&gt; Server Audit Specifications._x000A_Also, _x000A_&lt;server name&gt; &gt;&gt; Databases &gt;&gt; &lt;database name&gt; &gt;&gt; Security &gt;&gt; Database Audit Specifications._x000A__x000A_Alternatively, review the contents of the system views with "audit" in their names._x000A__x000A_Run the following to verify that all SELECT, INSERT, UPDATE, and DELETE actions on tables and views are being audited:_x000A_USE [master];_x000A_GO_x000A_SELECT * FROM sys.server_audit_specification_details WHERE server_specification_id =_x000A_(SELECT server_specification_id FROM sys.server_audit_specifications WHERE [name] = '&lt;server_audit_specification_name&gt;')_x000A_AND audit_action_name = 'SCHEMA_OBJECT_ACCESS_GROUP';_x000A__x000A_If no row is returned, this is a finding._x000A__x000A_If the audited_result column is not "SUCCESS" or "SUCCESS AND FAILURE", this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="39">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Database</S>
      <S N="SqlVersion">2014</S>
      <S N="VulnID">V-67443</S>
      <S N="RuleID">SV-81933r2_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL4-00-036850</S>
      <S N="Title">Trace or Audit records must be generated when unsuccessful attempts to modify categorized information (e.g., classification levels/security levels) occur.</S>
      <S N="Description">Changes in categorized information must be tracked. Without an audit trail, unauthorized access to protected data could go undetected._x000A__x000A_For detailed information on categorizing information, refer to FIPS Publication 199, Standards for Security Categorization of Federal Information and Information Systems, and FIPS Publication 200, Minimum Security Requirements for Federal Information and Information Systems._x000A__x000A_Use of SQL Server Audit is recommended.  All features of SQL Server Audit are available in the Enterprise and Developer editions of SQL Server 2014.  It is not available at the database level in other editions.  For this or legacy reasons, the instance may be using SQL Server Trace for auditing, which remains an acceptable solution for the time being.  Note, however, that Microsoft intends to remove most aspects of Trace at some point after SQL Server 2016._x000A__x000A_Since Trace does not provide for tracking SELECT statements, it is necessary to provide that part of the tracking at the application level.  Because of this, it may also be appropriate to audit UPDATE actions at the application level.  However, to capture all UPDATEs, whether they come from the application or bypass it, the Trace must be configured to cover them._x000A__x000A_Use of SQL Server Audit's SCHEMA_OBJECT_ACCESS_GROUP causes capture of all accesses, successful and otherwise, to all schema-scoped objects.  The [Succeeded] column in the audit output indicates the success or failure of the attempted action.  Be aware, however, that it may report True in some cases where one would intuitively expect False.  For example, SELECT 1/0 FROM SYS.ALL_OBJECTS will appear in the audit trail as successful, if the user has permission to perform that action, even though it contains an invalid expression.  Some other actions that one would consider failures (such as selecting from a table that does not exist) may not appear at all.</S>
      <S N="FixText">Where SQL Server Trace is in use, create triggers to raise a custom event for UPDATEs on each table holding categorized information.  The examples provided in the supplemental file CustomTraceEvents.sql can serve as the basis for these. _x000A__x000A_Add a block of code to the supplemental file Trace.sql for each custom event class (integers in the range 82-91; the same event class may be used for all such triggers) used in these triggers.  Execute Trace.sql._x000A__x000A_If SQL Server Audit is in use, design and deploy an Audit that captures all auditable events and data items.  The script provided in the supplemental file Audit.sql can be used as the basis for this.  Supplement the standard audit data as necessary, using Extended Events and/or triggers._x000A__x000A_Alternatively, to add the necessary data capture to an existing server audit specification, run the script:_x000A_USE [master];_x000A_GO_x000A_ALTER SERVER AUDIT SPECIFICATION &lt;server_audit_specification_name&gt; WITH (STATE = OFF);_x000A_GO_x000A_ALTER SERVER AUDIT SPECIFICATION &lt;server_audit_specification_name&gt; ADD (SCHEMA_OBJECT_ACCESS_GROUP);_x000A_GO_x000A_ALTER SERVER AUDIT SPECIFICATION &lt;server_audit_specification_name&gt; WITH (STATE = ON);_x000A_GO</S>
      <S N="Check">Review the system documentation to determine whether it is required to track categories of information, such as classification or sensitivity level.  If it is not, this is not applicable (NA)._x000A__x000A_If neither SQL Server Audit nor SQL Server Trace is in use for audit purposes, this is a finding._x000A__x000A_If SQL Server Trace is in use for audit purposes, review the Trace settings, and the triggers on the tables holding categorized information, to determine whether all UPDATE actions on these tables are traced, including failed attempts.  If not, this is a finding._x000A__x000A_Check to see that all required event classes are being audited.  From the query prompt:_x000A_SELECT * FROM sys.traces;_x000A__x000A_All currently defined traces for the SQL server instance will be listed. If no traces are returned, this is a finding._x000A__x000A_Determine the trace(s) being used for the auditing requirement._x000A_In the following, replace # with a trace ID being used for the auditing requirements._x000A_From the query prompt:_x000A_SELECT DISTINCT(eventid) FROM sys.fn_trace_geteventinfo(#);_x000A__x000A_The following required event IDs should be among those listed; if not, this is a finding:_x000A__x000A_82-91  -- User-defined Event (at least one of these, matching the triggers; 90 is used in the supplied script)_x000A_162 -- User error message_x000A__x000A__x000A_If SQL Server Audit is in use, proceed as follows._x000A__x000A_The basic SQL Server Audit configuration provided in the supplemental file Audit.sql uses the broad, server-level audit action group SCHEMA_OBJECT_ACCESS_GROUP for this purpose.  SQL Server Audit's flexibility makes other techniques possible.  If an alternative technique is in use and demonstrated effective, this is not a finding._x000A__x000A_Determine the name(s) of the server audit specification(s) in use._x000A_To look at audits and audit specifications, in Management Studio's object explorer, expand _x000A_&lt;server name&gt; &gt;&gt; Security &gt;&gt; Audits_x000A_and_x000A_&lt;server name&gt; &gt;&gt; Security &gt;&gt; Server Audit Specifications._x000A_Also, _x000A_&lt;server name&gt; &gt;&gt; Databases &gt;&gt; &lt;database name&gt; &gt;&gt; Security &gt;&gt; Database Audit Specifications._x000A_Alternatively, review the contents of the system views with "audit" in their names._x000A__x000A_Run the following to verify that all SELECT, INSERT, UPDATE, and DELETE actions on tables and views are being audited:_x000A_USE [master];_x000A_GO_x000A_SELECT * FROM sys.server_audit_specification_details WHERE server_specification_id =_x000A_(SELECT server_specification_id FROM sys.server_audit_specifications WHERE [name] = '&lt;server_audit_specification_name&gt;')_x000A_AND audit_action_name = 'SCHEMA_OBJECT_ACCESS_GROUP';_x000A__x000A_If no row is returned, this is a finding._x000A__x000A_If the audited_result column is not "SUCCESS" or "SUCCESS AND FAILURE", this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="40">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Database</S>
      <S N="SqlVersion">2014</S>
      <S N="VulnID">V-67877</S>
      <S N="RuleID">SV-82367r2_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL4-00-021300</S>
      <S N="Title">SQL Server must protect data at rest and ensure confidentiality and integrity of data.</S>
      <S N="Description">This control is intended to address the confidentiality and integrity of information at rest in non-mobile devices and covers user information and system information.  Information at rest refers to the state of information when it is located on a secondary storage device (e.g., disk drive, tape drive) within an organizational information system. Applications and application users generate information throughout the course of their application use._x000A__x000A_User-generated data, as well as, application-specific configuration data, needs to be protected. Configurations and/or rule sets for firewalls, gateways, intrusion detection/prevention systems, filtering routers, and authenticator content are examples of system information likely requiring protection. Organizations may choose to employ different mechanisms to achieve confidentiality and integrity protections, as appropriate._x000A__x000A_If the confidentiality and integrity of SQL Server data is not protected, the data will be open to compromise and unauthorized modification._x000A__x000A_Protective measures include encryption, physical security of the facility where the storage devices reside, operating system file permissions, and organizational controls.  Each of these should be applied as necessary and appropriate.</S>
      <S N="FixText">Apply appropriate controls to protect the confidentiality and integrity of data on a secondary device._x000A__x000A_Where encryption is required, this can be done by full-disk encryption or by database encryption. To enable database encryption, create a master key, create a database encryption key, and protect it by using mechanisms tied to the master key, and then set encryption on._x000A__x000A_Implement physical security measures, operating system access control lists and organizational controls appropriate to the sensitivity level of the data in the database(s).</S>
      <S N="Check">If the application owner and Authorizing Official have determined that encryption of data at rest is required, ensure the data on secondary devices is encrypted._x000A__x000A_If full-disk encryption is being used, this is not a finding._x000A__x000A_If DBMS data encryption is required, ensure the data is encrypted before being put on the secondary device by executing:_x000A__x000A_SELECT_x000A_      d.name AS [Database Name],_x000A_      CASE e.encryption_state_x000A_            WHEN 0 THEN 'No database encryption key present, no encryption'_x000A_            WHEN 1 THEN 'Unencrypted'_x000A_            WHEN 2 THEN 'Encryption in progress'_x000A_            WHEN 3 THEN 'Encrypted'_x000A_            WHEN 4 THEN 'Key change in progress'_x000A_            WHEN 5 THEN 'Decryption in progress'_x000A_            WHEN 6 THEN 'Protection change in progress'_x000A_      END AS [Encryption State]_x000A_FROM sys.dm_database_encryption_keys e_x000A_RIGHT JOIN sys.databases d ON DB_NAME(e.database_id) = d.name_x000A_WHERE d.name NOT IN ('master','model','msdb')_x000A_ORDER BY 1_x000A_;_x000A__x000A_For each user database where encryption is required, verify that encryption is in effect. If not, this is a finding._x000A__x000A_Verify that there are physical security measures, operating system access control lists and organizational controls appropriate to the sensitivity level of the data in the database(s). If not, this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="41">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2014</S>
      <S N="VulnID">V-67387</S>
      <S N="RuleID">SV-81877r2_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL4-00-024500</S>
      <S N="Title">The Service Master Key must be backed up, stored offline and off-site.</S>
      <S N="Description">Backup and recovery of the Service Master Key may be critical to the complete recovery of the database. Not having this key can lead to loss of data during recovery.</S>
      <S N="FixText">Document and implement procedures to safely back up and store the Service Master Key. Include in the procedures methods to establish evidence of backup and storage, and careful, restricted access and restoration of the Service Master Key. Also, include provisions to store the key off-site._x000A__x000A_BACKUP SERVICE MASTER KEY TO FILE = 'path_to_file'_x000A_ENCRYPTION BY PASSWORD = 'password';_x000A__x000A_As this requires a password, take care to ensure it is not exposed to unauthorized persons or stored as plain text.</S>
      <S N="Check">Review procedures for, and evidence of backup of, the SQL Server Service Master Key in the System Security Plan._x000A__x000A_If the procedures or evidence do not exist, this is a finding._x000A__x000A_If the procedures do not indicate offline and off-site storage of the Service Master Key, this is a finding._x000A__x000A_If procedures do not indicate access restrictions to the Service Master Key backup, this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="42">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2014</S>
      <S N="VulnID">V-67757</S>
      <S N="RuleID">SV-82247r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL4-00-000100</S>
      <S N="Title">The number of concurrent SQL Server sessions for each system account must be limited.</S>
      <S N="Description">A variety of technologies exist to limit or, in some cases, eliminate the effects of DoS attacks. For example, boundary protection devices can filter certain types of packets to protect devices on an organizationâ€™s internal network from being directly affected by DoS attacks._x000A__x000A_One way SQL Server can limit exposure to DoS attacks is to restrict the number of connections that can be opened by a single user. SQL Server supports this through the use of logon triggers. (Note, however, that this need not be the only, or even the principal, means for satisfying this requirement. Depending on the architecture and capabilities of the network and application, a network device or an application may be more suitable for providing this protection.)_x000A__x000A_When determining the appropriate values for this limit, take the characteristics of the various kinds of user into account, and bear in mind that some applications and some users may need to have multiple sessions open. For example, while a standard account using a simple application may never need more than, say, five connections, a database administrator using SQL Server Management Studio may need significantly more, because each tab in that application counts as a distinct session._x000A__x000A_Architectural note: In SQL Server, a count of active sessions by user can be obtained from one of the dynamic management views. For example:_x000A_      SELECT original_login_name, count(*)_x000A_      FROM sys.dm_exec_sessions_x000A_      WHERE is_user_process = 1_x000A_      GROUP BY original_login_name;_x000A_However, for this to return an accurate count in a logon trigger, the user would have to have the View Server State privilege. (Without this privilege, the trigger sees information only about the current session, so would always return a count of one.) View Server State would give that user access to a wide swath of information about the server.  One way to avoid this exposure is to create a summary table, and a view of that table that restricts each user to seeing his/her own count, and establish a frequently-run background job to refresh the table (using the above query or similar). The logon trigger then queries the view to obtain a count that is accurate enough for this purpose in most circumstances.</S>
      <S N="FixText">Establish the limit(s) appropriate to the type(s) of user account accessing the SQL Server instance, and record them in the system documentation._x000A__x000A_Implement one or more logon triggers to enforce the limit(s), without exposing the dynamic management views to general users.</S>
      <S N="Check">Review the system documentation to determine whether any limits have been defined. If not, this is a finding._x000A__x000A_If one limit has been defined but is not applied to all users, including privileged administrative accounts, this is a finding._x000A__x000A_If multiple limits have been defined, to accommodate different types of user, verify that together they cover all users. If not, this is a finding._x000A__x000A_If a mechanism other than a logon trigger is used, verify its correct operation by the appropriate means._x000A__x000A_If it does not work correctly, this is a finding._x000A__x000A_Otherwise, determine if a logon trigger exists:_x000A__x000A_EITHER, in SQL Server Management Studio's Object Explorer tree:_x000A_Expand [SQL Server Instance] &gt;&gt; Security &gt;&gt; Server Objects &gt;&gt; Triggers_x000A__x000A_OR run the query:_x000A_SELECT * FROM master.sys.server_triggers;_x000A__x000A_If no triggers are listed, this is a finding._x000A__x000A_If triggers are listed, identify the one(s) limiting the number of concurrent sessions per user._x000A__x000A_If none are found, this is a finding._x000A__x000A_If they are present but disabled, this is a finding._x000A__x000A_Examine the trigger source code for logical correctness and for compliance with the documented limit(s)._x000A__x000A_If errors or variances exist, this is a finding._x000A__x000A_Verify that the system does execute the trigger(s) each time a user session is established._x000A__x000A_If it does not operate correctly for all types of user, this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="43">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2014</S>
      <S N="VulnID">V-67759</S>
      <S N="RuleID">SV-82249r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL4-00-030300</S>
      <S N="Title">SQL Server authentication and identity management must be integrated with an organization-level authentication/access mechanism providing account management and automation for all users, groups, roles, and any other principals.</S>
      <S N="Description">Enterprise environments make account management for applications and databases challenging and complex. A manual process for account management functions adds the risk of a potential oversight or other error. Managing accounts for the same person in multiple places is inefficient and prone to problems with consistency and synchronization._x000A__x000A_A comprehensive application account management process that includes automation helps to ensure that accounts designated as requiring attention are consistently and promptly addressed. _x000A__x000A_Examples include, but are not limited to, using automation to take action on multiple accounts designated as inactive, suspended, or terminated, or by disabling accounts located in non-centralized account stores, such as multiple servers. Account management functions can also include: assignment of group or role membership; identifying account type; specifying user access authorizations (i.e., privileges); account removal, update, or termination; and administrative alerts. The use of automated mechanisms can include, for example: using email or text messaging to notify account managers when users are terminated or transferred; using the information system to monitor account usage; and using automated telephone notification to report atypical system account usage._x000A__x000A_Account management and authentication in a Windows environment normally use an LDAP-compatible directory service, usually Windows Active Directory.  This in turn, in the DoD environment, is typically integrated with the Public Key Infrastructure (PKI).  Additional technologies or products may be employed that when placed together constitute an overall mechanism supporting an organization's automated account management requirements.  An example is the use of Group Policy Objects to enforce rules concerning passwords._x000A__x000A_SQL Server must be configured to use Windows authentication, with SQL Server authentication disabled.  If circumstances (such as the architecture of a purchased application) make it necessary to have SQL Server authentication available, its use must be kept to a minimum.  The reasons for its use, and the measures taken to restrict it to only the necessary cases, must be documented, with AO approval._x000A__x000A_It is assumed throughout this STIG that this integration has been implemented.</S>
      <S N="FixText">If mixed mode is required, document the need and justification; describe the measures taken to ensure the use of SQL Server authentication is kept to a minimum; describe the measures taken to safeguard passwords; list or describe the SQL Logins used; obtain official approval._x000A__x000A_If mixed mode is not required, disable it as follows:_x000A__x000A_In the SSMS Object Explorer, right-click on the server instance; select Properties.  Select the Security page.  Click on the radio button for Windows Authentication Mode.  Click on "OK."  Restart the SQL Server instance._x000A__x000A_Alternatively, run the statement:_x000A_EXEC xp_instance_regwrite_x000A_    N'HKEY_LOCAL_MACHINE',_x000A_    N'Software\Microsoft\MSSQLServer\MSSQLServer',_x000A_    N'LoginMode', _x000A_    REG_DWORD, _x000A_    1;_x000A_Restart the SQL Server instance._x000A__x000A_For each account being managed by SQL Server but not requiring it, drop or disable the SQL Login.  Replace it with an appropriately configured account, as needed._x000A__x000A_To drop or disable a Login in the SSMS Object Explorer:_x000A_Navigate to &lt;server name&gt; &gt;&gt; Security &gt;&gt; Logins._x000A_Right-click on the Login name; click on Delete or Disable._x000A__x000A_To drop or disable a Login by using a query:_x000A_USE master;_x000A_DROP LOGIN &lt;login name&gt;; _x000A_ALTER LOGIN &lt;login name&gt; DISABLE;_x000A__x000A_Dropping a Login does not delete the equivalent database User(s).  There may be more than one database containing a User mapped to the Login.  Drop the User(s) unless still needed.._x000A__x000A_To drop a User in the SSMS Object Explorer:_x000A_Navigate to &lt;server name&gt; &gt;&gt; Databases &gt;&gt; &lt;database name&gt; &gt;&gt; Security &gt;&gt; Users._x000A_Right-click on the User name; click on Delete._x000A__x000A_To drop a User via a query:_x000A_USE &lt;database name&gt;;_x000A_DROP USER &lt;user name&gt;;</S>
      <S N="Check">Determine whether SQL Server is configured to use only Windows authentication._x000A__x000A_In the Object Explorer in SQL Server Management Studio (SSMS), right-click on the server instance; select Properties.  Select the Security page._x000A__x000A_If Windows Authentication Mode is selected, this is not a finding._x000A__x000A_Alternatively, in a query interface such as the SSMS Transact-SQL editor, run the statement:_x000A_EXECUTE xp_instance_regread _x000A_    N'HKEY_LOCAL_MACHINE',_x000A_    N'Software\Microsoft\MSSQLServer\MSSQLServer', _x000A_    N'LoginMode'; _x000A__x000A_If the returned value in the "Data" column is 1, this is not a finding._x000A__x000A_Mixed mode (both SQL Server authentication and Windows authentication) is in use._x000A__x000A_If the need for mixed mode has not been documented and approved, this is a finding._x000A__x000A_From the documentation, obtain the list of accounts authorized to be managed by SQL Server._x000A__x000A_Determine the accounts (SQL Logins) actually managed by SQL Server.  Run the statement:_x000A_SELECT_x000A_    name_x000A_FROM _x000A_    sys.sql_logins _x000A_WHERE_x000A_    type_desc = 'SQL_LOGIN'_x000A_    AND is_disabled = 0;_x000A__x000A_If any accounts listed by the query are not listed in the documentation, this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="44">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2014</S>
      <S N="VulnID">V-67761</S>
      <S N="RuleID">SV-82251r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL4-00-002010</S>
      <S N="Title">SQL Server must enforce approved authorizations for logical access to server-level system resources in accordance with applicable access control policies.</S>
      <S N="Description">Authentication with a DoD-approved PKI certificate does not necessarily imply authorization to access the SQL Server instance and server-level resources.  To mitigate the risk of unauthorized access to sensitive information by entities that have been issued certificates by DoD-approved PKIs, all DoD systems, including SQL Server instances, must be properly configured to implement access control policies. _x000A__x000A_Successful authentication must not automatically give an entity access to an asset or security boundary. Authorization procedures and controls must be implemented to ensure each authenticated entity also has a validated and current authorization. Authorization is the process of determining whether an entity, once authenticated, is permitted to access a specific asset. Information systems use access control policies and enforcement mechanisms to implement this requirement. _x000A__x000A_Access control policies include identity-based policies, role-based policies, and attribute-based policies. Access enforcement mechanisms include access control lists, access control matrices, and cryptography. These policies and mechanisms must be employed by the application to control access between users (or processes acting on behalf of users) and objects (e.g., devices, files, records, processes, programs, and domains) in the information system. _x000A__x000A_This requirement is applicable to access control enforcement applications, a category that includes SQL Server.  If SQL Server is not configured to follow applicable policy when approving access, it may be in conflict with networks or other applications in the information system. This may result in users either gaining or being denied access inappropriately and in conflict with applicable policy.</S>
      <S N="FixText">Use GRANT, REVOKE, DENY, ALTER SERVER ROLE â€¦ ADD MEMBER â€¦  and/or  ALTER SERVER ROLE  â€¦. DROP MEMBER statements to add and remove permissions on server-level securables, bringing them into line with the documented requirements.</S>
      <S N="Check">Review the system documentation to determine the required levels of protection for DBMS server securables, by type of login._x000A__x000A_Review the permissions actually in place on the server. _x000A__x000A_The server permission functions and views provided in the supplemental file Permissions.sql can help with this._x000A__x000A_If the actual permissions do not match the documented requirements, this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="45">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2014</S>
      <S N="VulnID">V-67763</S>
      <S N="RuleID">SV-82253r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL4-00-023700</S>
      <S N="Title">SQL Server must protect against an individual using a shared account from falsely denying having performed a particular action.</S>
      <S N="Description">Non-repudiation of actions taken is required in order to maintain application integrity. Examples of particular actions taken by individuals include creating information, sending a message, approving information (e.g., indicating concurrence or signing a contract), and receiving a message._x000A__x000A_Non-repudiation protects against later claims by a user of not having created, modified, or deleted a particular data item or collection of data in the database._x000A__x000A_Use of shared accounts does not provide individual accountability for actions taken on the DBMS or data. Whenever a single database account is used to connect to the database, a secondary authentication method that provides individual accountability is required. This scenario most frequently occurs when an externally hosted application authenticates individual users to the application and the application uses a single account to retrieve or update database information on behalf of the individual users (as in connection pooling)._x000A__x000A_When shared accounts are utilized without another means of identifying individual users, users may deny having performed a particular action._x000A__x000A_(Shared accounts should not be confused with Windows groups, which are used in role-based access control.)</S>
      <S N="FixText">Remove user-accessible shared accounts and use individual userids._x000A__x000A_Build/configure applications to ensure successful individual authentication prior to shared account access._x000A__x000A_Ensure each user's identity is received and used in audit data in all relevant circumstances._x000A__x000A_Design, develop, and implement a method to log use of any account to which more than one person has access. Restrict interactive access to shared accounts to the fewest persons possible.</S>
      <S N="Check">Obtain the list of authorized SQL Server accounts in the system documentation._x000A__x000A_If accounts are determined to be shared, determine if individuals are first individually authenticated._x000A__x000A_If individuals are not individually authenticated before using the shared account (e.g., by the operating system or possibly by an application making calls to the database), this is a finding._x000A__x000A_The key is individual accountability. If this can be traced, this is not a finding._x000A__x000A_If accounts are determined to be shared, determine if they are directly accessible to end users.  If so, this is a finding._x000A__x000A_Review contents of audit logs, traces and data tables to confirm that the identity of the individual user performing the action is captured._x000A__x000A_If shared identifiers are found, and not accompanied by individual identifiers, this is a finding._x000A__x000A_Note:  Privileged installation accounts may be required to be accessed by the DBA or other administrators for system maintenance. In these cases, each use of the account must be logged in some manner to assign accountability for any actions taken during the use of the account.</S>
    </MS>
  </Obj>
  <Obj RefId="46">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2014</S>
      <S N="VulnID">V-67765</S>
      <S N="RuleID">SV-82255r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL4-00-011300</S>
      <S N="Title">Where SQL Server Trace is in use for auditing purposes, SQL Server must allow only the ISSM (or individuals or roles appointed by the ISSM) to select which auditable events are to be traced.</S>
      <S N="Description">Without the capability to restrict which roles and individuals can select which events are audited, unauthorized personnel may be able to prevent or interfere with the auditing of critical events._x000A__x000A_Suppression of auditing could permit an adversary to evade detection._x000A__x000A_Misconfigured audits can degrade the system's performance by overwhelming the audit log. Misconfigured audits may also make it more difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one._x000A__x000A_Use of SQL Server Audit is recommended.  All features of SQL Server Audit are available in the Enterprise and Developer editions of SQL Server 2014.  It is not available at the database level in other editions.  For this or legacy reasons, the instance may be using SQL Server Trace for auditing, which remains an acceptable solution for the time being.  Note, however, that Microsoft intends to remove most aspects of Trace at some point after SQL Server 2016._x000A__x000A_This version of the requirement deals with Trace-based audit trails.</S>
      <S N="FixText">Create a server role specifically for audit maintainers, and give it permission to maintain traces, without granting it unnecessary permissions:_x000A_    USE master;_x000A_    GO_x000A_    CREATE SERVER ROLE SERVER_AUDIT_MAINTAINERS;_x000A_    GO_x000A_    GRANT ALTER TRACE TO SERVER_AUDIT_MAINTAINERS;_x000A_    -- Next line only if required:_x000A_    GRANT CREATE TRACE EVENT NOTIFICATION TO SERVER_AUDIT_MAINTAINERS;_x000A_    GO_x000A_(The role name used here is an example; other names may be used.)_x000A__x000A_Use REVOKE and/or DENY and/or ALTER SERVER ROLE ... DROP MEMBER ... statements to remove the ALTER TRACE and CREATE TRACE EVENT NOTIFICATION permissions from all logins._x000A__x000A_Then, for each authorized login, run the statement:_x000A_    ALTER SERVER ROLE SERVER_AUDIT_MAINTAINERS ADD MEMBER &lt;login name&gt;;_x000A_    GO</S>
      <S N="Check">If SQL Server Trace is not in use for audit purposes, this is not a finding._x000A__x000A_Obtain the list of approved audit maintainers from the system documentation._x000A__x000A_Review the server roles and individual logins that have the following permissions, all of which enable the ability to create and maintain audit definitions (the views and functions provided in the supplemental fine Permissions.sql can assist in this):_x000A_ALTER TRACE_x000A_CREATE TRACE EVENT NOTIFICATION_x000A__x000A_The functions and views provided in the supplemental file Permissions.sql can assist in this review.  In the following, "STIG" stands for the schema where you have deployed these views and functions.  To see which logins and server roles have been granted these permissions:_x000A_    SELECT_x000A_        *_x000A_    FROM_x000A_        STIG.server_permissions P_x000A_    WHERE_x000A_        P.[Permission] IN_x000A_        (_x000A_        'ALTER TRACE',_x000A_        'CREATE TRACE EVENT NOTIFICATION'_x000A_        );_x000A__x000A_To see what logins and server roles inherit these permissions from the server roles reported by the previous query, repeat the following for each one:_x000A_    SELECT * FROM STIG.members_of_server_role(&lt;server role name&gt;);_x000A__x000A_To see all the permissions in effect for a server principal (server role or login):_x000A_    SELECT * FROM STIG.server_effective_permissions(&lt;principal name&gt;); _x000A__x000A_If designated personnel are not able to configure auditable events, this is a finding._x000A__x000A_If unapproved personnel are able to configure auditable events, this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="47">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2014</S>
      <S N="VulnID">V-67767</S>
      <S N="RuleID">SV-82257r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL4-00-011310</S>
      <S N="Title">Where SQL Server Audit is in use, SQL Server must allow only the ISSM (or individuals or roles appointed by the ISSM) to select which auditable events are to be audited at the server level.</S>
      <S N="Description">Without the capability to restrict which roles and individuals can select which events are audited, unauthorized personnel may be able to prevent or interfere with the auditing of critical events._x000A__x000A_Suppression of auditing could permit an adversary to evade detection._x000A__x000A_Misconfigured audits can degrade the system's performance by overwhelming the audit log. Misconfigured audits may also make it more difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one._x000A__x000A_Use of SQL Server Audit is recommended.  All features of SQL Server Audit are available in the Enterprise and Developer editions of SQL Server 2014.  It is not available at the database level in other editions.  For this or legacy reasons, the instance may be using SQL Server Trace for auditing, which remains an acceptable solution for the time being.  Note, however, that Microsoft intends to remove most aspects of Trace at some point after SQL Server 2016._x000A__x000A_This version of the requirement deals with SQL Server Audit-based audit trails.</S>
      <S N="FixText">Create a server role specifically for audit maintainers, and give it permission to maintain audits, without granting it unnecessary permissions:_x000A_    USE master;_x000A_    GO_x000A_    CREATE SERVER ROLE SERVER_AUDIT_MAINTAINERS;_x000A_    GO_x000A_    GRANT ALTER ANY SERVER AUDIT TO SERVER_AUDIT_MAINTAINERS;_x000A_    GO_x000A_(The role name used here is an example; other names may be used.)_x000A__x000A_Use REVOKE and/or DENY and/or ALTER SERVER ROLE ... DROP MEMBER ... statements to remove the ALTER ANY SERVER AUDIT permission from all logins._x000A__x000A_Then, for each authorized login, run the statement:_x000A_    ALTER SERVER ROLE SERVER_AUDIT_MAINTAINERS ADD MEMBER &lt;login name&gt;;_x000A_    GO_x000A__x000A_Use REVOKE and/or DENY and/or ALTER SERVER ROLE ... DROP MEMBER ... statements to remove CONTROL SERVER, ALTER ANY DATABASE and CREATE ANY DATABASE permissions from logins that do not need them.</S>
      <S N="Check">If SQL Server Audit is not in use, this is not a finding._x000A__x000A_Obtain the list of approved audit maintainers from the system documentation._x000A__x000A_Review the server roles and individual logins that have the following permissions, all of which enable the ability to create and maintain audit definitions (the views and functions provided in the supplemental fine Permissions.sql can assist in this):_x000A_ALTER ANY SERVER AUDIT_x000A_CONTROL SERVER_x000A_ALTER ANY DATABASE_x000A_CREATE ANY DATABASE_x000A__x000A_The functions and views provided in the supplemental file Permissions.sql can assist in this review.  In the following, "STIG" stands for the schema where you have deployed these views and functions.  To see which logins and server roles have been granted these permissions:_x000A_    SELECT_x000A_        *_x000A_    FROM_x000A_        STIG.server_permissions P_x000A_    WHERE_x000A_        P.[Permission] IN_x000A_        (_x000A_        'ALTER ANY SERVER AUDIT',_x000A_        'CONTROL SERVER',_x000A_        'ALTER ANY DATABASE',_x000A_        'CREATE ANY DATABASE'_x000A_        );_x000A__x000A_To see what logins and server roles inherit these permissions from the server roles reported by the previous query, repeat the following for each one:_x000A_    SELECT * FROM STIG.members_of_server_role(&lt;server role name&gt;);_x000A__x000A_To see all the permissions in effect for a server principal (server role or login):_x000A_    SELECT * FROM STIG.server_effective_permissions(&lt;principal name&gt;); _x000A__x000A_If designated personnel are not able to configure auditable events, this is a finding._x000A__x000A_If unapproved personnel are able to configure auditable events, this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="48">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2014</S>
      <S N="VulnID">V-67769</S>
      <S N="RuleID">SV-82259r2_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL4-00-011410</S>
      <S N="Title">Where SQL Server Audit is in use, SQL Server must generate audit records when privileges/permissions are retrieved.</S>
      <S N="Description">The system must monitor who/what is reading privilege/permission/role information._x000A__x000A_This requirement addresses explicit requests for privilege/permission/role membership information. It does not refer to the implicit retrieval of privileges/permissions/role memberships that SQL Server continually performs to determine if any and every action on the database is permitted._x000A__x000A_Use of SQL Server Audit is recommended.  All features of SQL Server Audit are available in the Enterprise and Developer editions of SQL Server 2014.  It is not available at the database level in other editions.  For this or legacy reasons, the instance may be using SQL Server Trace for auditing, which remains an acceptable solution for the time being.  Note, however, that Microsoft intends to remove most aspects of Trace at some point after SQL Server 2016._x000A__x000A_This requirement applies to SQL Server Audit-based audit trails; Trace does not have this capability.</S>
      <S N="FixText">Design and deploy a SQL Server Audit that captures all auditable events.  The script provided in the supplemental file Audit.sql can be used for this._x000A__x000A_Alternatively, to add the necessary data capture to an existing server audit specification, run the script:_x000A_USE [master];_x000A_GO_x000A_ALTER SERVER AUDIT SPECIFICATION &lt;server_audit_specification_name&gt; WITH (STATE = OFF);_x000A_GO_x000A_ALTER SERVER AUDIT SPECIFICATION &lt;server_audit_specification_name&gt; ADD (SCHEMA_OBJECT_ACCESS_GROUP);_x000A_GO_x000A_ALTER SERVER AUDIT SPECIFICATION &lt;server_audit_specification_name&gt; WITH (STATE = ON);_x000A_GO</S>
      <S N="Check">If SQL Server Trace is in use for audit purposes, and SQL Server Audit is not in use, this is not a finding._x000A__x000A_The basic SQL Server Audit configuration provided in the supplemental file Audit.sql uses the broad, server-level audit action group SCHEMA_OBJECT_ACCESS_GROUP for this purpose.  SQL Server Audit's flexibility makes other techniques possible.  If an alternative technique is in use and demonstrated effective, this is not a finding._x000A__x000A_Determine the name(s) of the server audit specification(s) in use._x000A__x000A_To look at audits and audit specifications, in Management Studio's object explorer, expand _x000A_&lt;server name&gt; &gt;&gt; Security &gt;&gt; Audits_x000A_and_x000A_&lt;server name&gt; &gt;&gt; Security &gt;&gt; Server Audit Specifications._x000A_Also, _x000A_&lt;server name&gt; &gt;&gt; Databases &gt;&gt; &lt;database name&gt; &gt;&gt; Security &gt;&gt; Database Audit Specifications._x000A__x000A_Alternatively, review the contents of the system views with "audit" in their names._x000A__x000A_Run the following to verify that all SELECT actions on the permissions-related system views, and any locally-defined permissions tables, are being audited:_x000A__x000A_USE [master];_x000A_GO_x000A_SELECT * FROM sys.server_audit_specification_details WHERE server_specification_id =_x000A_(SELECT server_specification_id FROM sys.server_audit_specifications WHERE [name] = '&lt;server_audit_specification_name&gt;')_x000A_AND audit_action_name = 'SCHEMA_OBJECT_ACCESS_GROUP';_x000A__x000A_If no row is returned, this is a finding._x000A__x000A_If the audited_result column is not "SUCCESS" or "SUCCESS AND FAILURE", this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="49">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2014</S>
      <S N="VulnID">V-67771</S>
      <S N="RuleID">SV-82261r2_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL4-00-030410</S>
      <S N="Title">Where SQL Server Audit is in use, SQL Server must generate audit records when unsuccessful attempts to retrieve privileges/permissions occur.</S>
      <S N="Description">Under some circumstances, it may be useful to monitor who/what is reading privilege/permission/role information. Therefore, it must be possible to configure auditing to do this. DBMSs typically make such information available through views or functions._x000A__x000A_This requirement addresses explicit requests for privilege/permission/role membership information. It does not refer to the implicit retrieval of privileges/permissions/role memberships that the DBMS continually performs to determine if any and every action on the database is permitted._x000A__x000A_To aid in diagnosis, it is necessary to keep track of failed attempts in addition to the successful ones._x000A__x000A_Use of SQL Server Audit is recommended.  All features of SQL Server Audit are available in the Enterprise and Developer editions of SQL Server 2014.  It is not available at the database level in other editions.  For this or legacy reasons, the instance may be using SQL Server Trace for auditing, which remains an acceptable solution for the time being.  Note, however, that Microsoft intends to remove most aspects of Trace at some point after SQL Server 2016._x000A__x000A_This requirement applies to SQL Server Audit-based audit trails; Trace does not have this capability._x000A__x000A_Use of SQL Server Audit's SCHEMA_OBJECT_ACCESS_GROUP causes capture of all accesses, successful and otherwise, to the system views (and all other schema-scoped objects).  The [Succeeded] column in the audit output indicates the success or failure of the attempted action.  Be aware, however, that it may report True in some cases where one would intuitively expect False.  For example, SELECT 1/0 FROM SYS.ALL_OBJECTS will appear in the audit trail as successful, if the user has permission to perform that action, even though it contains an invalid expression.  Some other actions that one would consider failures (such as selecting from a table that does not exist) may not appear at all.</S>
      <S N="FixText">Design and deploy a SQL Server Audit that captures all auditable events.  The script provided in the supplemental file Audit.sql can be used for this._x000A__x000A_Alternatively, to add the necessary data capture to an existing server audit specification, run the script:_x000A_USE [master];_x000A_GO_x000A_ALTER SERVER AUDIT SPECIFICATION &lt;server_audit_specification_name&gt; WITH (STATE = OFF);_x000A_GO_x000A_ALTER SERVER AUDIT SPECIFICATION &lt;server_audit_specification_name&gt; ADD (SCHEMA_OBJECT_ACCESS_GROUP);_x000A_GO_x000A_ALTER SERVER AUDIT SPECIFICATION &lt;server_audit_specification_name&gt; WITH (STATE = ON);_x000A_GO</S>
      <S N="Check">If SQL Server Trace is in use for audit purposes, and SQL Server Audit is not in use, this is not a finding._x000A__x000A_The basic SQL Server Audit configuration provided in the supplemental file Audit.sql uses the broad, server-level audit action group SCHEMA_OBJECT_ACCESS_GROUP for this purpose.  SQL Server Audit's flexibility makes other techniques possible.  If an alternative technique is in use and demonstrated effective, this is not a finding._x000A__x000A_Determine the name(s) of the server audit specification(s) in use._x000A__x000A_To look at audits and audit specifications, in Management Studio's object explorer, expand _x000A_&lt;server name&gt; &gt;&gt; Security &gt;&gt; Audits_x000A_and_x000A_&lt;server name&gt; &gt;&gt; Security &gt;&gt; Server Audit Specifications._x000A_Also, _x000A_&lt;server name&gt; &gt;&gt; Databases &gt;&gt; &lt;database name&gt; &gt;&gt; Security &gt;&gt; Database Audit Specifications._x000A__x000A_Alternatively, review the contents of the system views with "audit" in their names._x000A__x000A_Run the following to verify that all SELECT actions on the permissions-related system views, and any locally-defined permissions tables, are being audited:_x000A__x000A_USE [master];_x000A_GO_x000A_SELECT * FROM sys.server_audit_specification_details WHERE server_specification_id =_x000A_(SELECT server_specification_id FROM sys.server_audit_specifications WHERE [name] = '&lt;server_audit_specification_name&gt;')_x000A_AND audit_action_name = 'SCHEMA_OBJECT_ACCESS_GROUP';_x000A_GO_x000A__x000A_If no row is returned, this is a finding._x000A__x000A_If the audited_result column is not "FAILURE" or "SUCCESS AND FAILURE", this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="50">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2014</S>
      <S N="VulnID">V-67773</S>
      <S N="RuleID">SV-82263r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL4-00-011900</S>
      <S N="Title">SQL Server must produce Trace or Audit records containing sufficient information to establish when the events occurred.</S>
      <S N="Description">Information system auditing capability is critical for accurate forensic analysis. Audit record content which may be necessary to satisfy the requirement of this control includes, but is not limited to:  time stamps, source and destination addresses, user/process identifiers, event descriptions, success/fail indications, file names involved, and access control or flow control rules invoked._x000A__x000A_SQL Server is capable of a range of actions on data stored within the database. It is important, for accurate forensic analysis, to know exactly when actions were performed. This requires specific information regarding the date and time an audit record is referring to. If date and time information is not recorded and stored with the audit record, the record itself is of very limited use._x000A__x000A_Use of SQL Server Audit is recommended.  All features of SQL Server Audit are available in the Enterprise and Developer editions of SQL Server 2014.  It is not available at the database level in other editions.  For this or legacy reasons, the instance may be using SQL Server Trace for auditing, which remains an acceptable solution for the time being.  Note, however, that Microsoft intends to remove most aspects of Trace at some point after SQL Server 2016.</S>
      <S N="FixText">Design and deploy a SQL Server Audit or a Trace that captures Start Time and (where relevant) End Time for all auditable events.  _x000A__x000A_The script provided in the supplemental file Trace.sql can be used to create a trace._x000A__x000A_The script provided in the supplemental file Audit.sql can be used to create an audit..</S>
      <S N="Check">If neither SQL Server Audit nor SQL Server Trace is in use for audit purposes, this is a finding._x000A__x000A_If SQL Server Audit is in use, the event time and date are always captured: this is not a finding._x000A__x000A_If SQL Server Trace is in use for audit purposes, verify that for all events it captures the start and (where relevant) end time._x000A_From the query prompt:_x000A_SELECT * FROM sys.traces; _x000A__x000A_All currently defined traces for the SQL server instance will be listed._x000A__x000A_If no traces are returned, this is a finding._x000A__x000A_Determine the trace(s) being used for the auditing requirement._x000A_In the following, replace # with a trace ID being used for the auditing requirements._x000A_From the query prompt:_x000A_WITH _x000A_EC AS (SELECT eventid, columnid FROM sys.fn_trace_geteventinfo(2)),_x000A_E AS (SELECT DISTINCT eventid FROM EC)_x000A_SELECT_x000A_    E.eventid,_x000A_       CASE WHEN EC14.columnid IS NULL THEN 'Start Time (14) missing' ELSE '14 OK' END AS field14,_x000A_       CASE WHEN EC15.columnid IS NULL THEN 'End Time (15) missing' ELSE '15 OK' END AS field15_x000A_FROM E E _x000A_    LEFT OUTER JOIN EC EC14_x000A_        ON  EC14.eventid = E.eventid_x000A_        AND EC14.columnid = 14 _x000A_    LEFT OUTER JOIN EC EC15_x000A_        ON  EC15.eventid = E.eventid_x000A_        AND EC15.columnid = 15_x000A_WHERE_x000A_       EC14.columnid IS NULL OR EC15.columnid IS NULL;_x000A__x000A_If the resulting list indicates any field specifications are missing, this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="51">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2014</S>
      <S N="VulnID">V-67775</S>
      <S N="RuleID">SV-82265r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL4-00-012000</S>
      <S N="Title">SQL Server must produce Trace or Audit records containing sufficient information to establish where the events occurred.</S>
      <S N="Description">Information system auditing capability is critical for accurate forensic analysis. Audit record content which may be necessary to satisfy the requirement of this control includes, but is not limited to:  time stamps, source and destination addresses, user/process identifiers, event descriptions, success/fail indications, file names involved, and access control or flow control rules invoked._x000A__x000A_SQL Server is capable of a range of actions on data stored within the database. It is important, for accurate forensic analysis, to know exactly where actions were performed. This requires specific information regarding the event location an audit record is referring to. If event location information is not recorded and stored with the audit record, the record itself is of very limited use._x000A__x000A_An event location can be a database instance, table, column, row, etc. Without sufficient information establishing where the audit events occurred, investigation into the cause of events is severely hindered. If SQL Server Audit is enabled, SQL Server does capture the event location-specific information in all audit records._x000A__x000A_Use of SQL Server Audit is recommended.  All features of SQL Server Audit are available in the Enterprise and Developer editions of SQL Server 2014.  It is not available at the database level in other editions.  For this or legacy reasons, the instance may be using SQL Server Trace for auditing, which remains an acceptable solution for the time being.  Note, however, that Microsoft intends to remove most aspects of Trace at some point after SQL Server 2016.</S>
      <S N="FixText">Design and deploy a SQL Server Audit or Trace that captures the server name, database name, object type, object name and object owner (each where relevant) for all auditable events.  _x000A__x000A_The script provided in the supplemental file Trace.sql can be used to create a trace._x000A__x000A_The script provided in the supplemental file Audit.sql can be used to create an audit..</S>
      <S N="Check">If neither SQL Server Audit nor SQL Server Trace is in use for audit purposes, this is a finding._x000A__x000A_If SQL Server Audit is in use, the server instance, database, schema, and object names are each automatically captured when applicable; this is not a finding._x000A__x000A_If SQL Server Trace is in use for audit purposes, verify that for all events it captures the server name, database name, object type, object name and object owner (each where relevant)._x000A_From the query prompt:_x000A_SELECT * FROM sys.traces; _x000A__x000A_All currently defined traces for the SQL server instance will be listed._x000A__x000A_If no traces are returned, this is a finding._x000A__x000A_Determine the trace(s) being used for the auditing requirement._x000A_In the following, replace # with a trace ID being used for the auditing requirements._x000A_From the query prompt:_x000A_WITH _x000A_EC AS (SELECT eventid, columnid FROM sys.fn_trace_geteventinfo(2)),_x000A_E AS (SELECT DISTINCT eventid FROM EC)_x000A_SELECT_x000A_    E.eventid,_x000A_    CASE WHEN EC26.columnid IS NULL THEN 'Server Name (26) missing' ELSE '26 OK' END AS field26,_x000A_    CASE WHEN EC35.columnid IS NULL THEN 'Database Name (35) missing' ELSE '35 OK' END AS field35,_x000A_    CASE WHEN EC28.columnid IS NULL THEN 'Object Type (28) missing' ELSE '28 OK' END AS field28,_x000A_    CASE WHEN EC34.columnid IS NULL THEN 'Object Name (34) missing' ELSE '34 OK' END AS field34,_x000A_    CASE WHEN EC37.columnid IS NULL THEN 'Object Owner (37) missing' ELSE '34 OK' END AS field37_x000A_FROM E E _x000A_    LEFT OUTER JOIN EC EC26_x000A_        ON  EC26.eventid = E.eventid_x000A_        AND EC26.columnid = 26 _x000A_    LEFT OUTER JOIN EC EC35_x000A_        ON  EC35.eventid = E.eventid_x000A_        AND EC35.columnid = 35_x000A_    LEFT OUTER JOIN EC EC28_x000A_        ON  EC28.eventid = E.eventid_x000A_        AND EC28.columnid = 28_x000A_    LEFT OUTER JOIN EC EC34_x000A_        ON  EC34.eventid = E.eventid_x000A_        AND EC34.columnid = 34_x000A_    LEFT OUTER JOIN EC EC37_x000A_        ON  EC37.eventid = E.eventid_x000A_        AND EC37.columnid = 37_x000A_WHERE_x000A_       EC26.columnid IS NULL OR EC35.columnid IS NULL OR EC28.columnid IS NULL OR EC34.columnid IS NULL OR EC37.columnid IS NULL;_x000A__x000A_If the resulting list indicates any field specifications are missing, this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="52">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2014</S>
      <S N="VulnID">V-67777</S>
      <S N="RuleID">SV-82267r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL4-00-012100</S>
      <S N="Title">SQL Server must produce Trace or Audit records containing sufficient information to establish the sources (origins) of the events.</S>
      <S N="Description">Information system auditing capability is critical for accurate forensic analysis. Audit record content which may be necessary to satisfy the requirement of this control includes, but is not limited to:  time stamps, source and destination addresses, user/process identifiers, event descriptions, success/fail indications, file names involved, and access control or flow control rules invoked._x000A__x000A_SQL Server is capable of a range of actions on data stored within the database. It is important, for accurate forensic analysis, to know exactly who performed what actions. This requires specific information regarding the source of the event an audit record is referring to. If the source of the event information is not recorded and stored with the audit record, the record itself is of very limited use._x000A__x000A_The source of the event can be a user account and sometimes a system account when timed jobs are run. Without information establishing the source of activity, the value of audit records from a forensics perspective is questionable. If Trace is enabled for auditing, SQL Server does capture the source of the event-specific information in all audit records._x000A__x000A_Use of SQL Server Audit is recommended.  All features of SQL Server Audit are available in the Enterprise and Developer editions of SQL Server 2014.  It is not available at the database level in other editions.  For this or legacy reasons, the instance may be using SQL Server Trace for auditing, which remains an acceptable solution for the time being.  Note, however, that Microsoft intends to remove most aspects of Trace at some point after SQL Server 2016.</S>
      <S N="FixText">Design and deploy a SQL Server Audit or Trace that captures the NT User Name, NT Domain Name, Host Name, Client Process ID, Application Name, Login Name, SPID, DB User Name, and Login SID (each where relevant) for all auditable events.  _x000A__x000A_The script provided in the supplemental file Trace.sql can be used to create a trace._x000A__x000A_If SQL Server Audit is intended to be in use, design and deploy an Audit that captures all auditable events. The code provided in the supplemental file Audit.sql can be used as the basis for creating an Audit.</S>
      <S N="Check">If neither SQL Server Audit nor SQL Server Trace is in use for audit purposes, this is a finding._x000A__x000A_If SQL Server Audit is in use, this is not a finding._x000A__x000A_If SQL Server Trace is in use for audit purposes, verify that for all events it captures the NT User Name, NT Domain Name, Host Name, Client Process ID, Application Name, Login Name, SPID, DB User Name, and Login SID (each where relevant)._x000A_From the query prompt:_x000A_SELECT * FROM sys.traces; _x000A__x000A_All currently defined traces for the SQL server instance will be listed. _x000A__x000A_If no traces are returned, this is a finding._x000A__x000A_Determine the trace(s) being used for the auditing requirement._x000A_In the following, replace # with a trace ID being used for the auditing requirements._x000A_From the query prompt:_x000A_WITH _x000A_EC AS (SELECT eventid, columnid FROM sys.fn_trace_geteventinfo(2)),_x000A_E AS (SELECT DISTINCT eventid FROM EC)_x000A_SELECT_x000A_    E.eventid,_x000A_    CASE WHEN EC6.columnid IS NULL THEN 'NT User Name (6) missing' ELSE '6 OK' END AS field26,_x000A_    CASE WHEN EC7.columnid IS NULL THEN 'NT Domain Name (7) missing' ELSE '7 OK' END AS field7,_x000A_    CASE WHEN EC8.columnid IS NULL THEN 'Host Name (8) missing' ELSE '8 OK' END AS field8,_x000A_    CASE WHEN EC9.columnid IS NULL THEN 'Client Process ID (9) missing' ELSE '9 OK' END AS field9,_x000A_    CASE WHEN EC10.columnid IS NULL THEN 'Application Name (10) missing' ELSE '10 OK' END AS field10,_x000A_    CASE WHEN EC11.columnid IS NULL THEN 'Login Name (11) missing' ELSE '11 OK' END AS field11,_x000A_    CASE WHEN EC12.columnid IS NULL THEN 'SPID (12) missing' ELSE '12 OK' END AS field12,_x000A_    CASE WHEN EC40.columnid IS NULL THEN 'DB User Name (40) missing' ELSE '40 OK' END AS field40,_x000A_    CASE WHEN EC41.columnid IS NULL THEN 'Login SID (41) missing' ELSE '41 OK' END AS field41_x000A_FROM E E _x000A_    LEFT OUTER JOIN EC EC6_x000A_        ON  EC6.eventid = E.eventid_x000A_        AND EC6.columnid = 6 _x000A_    LEFT OUTER JOIN EC EC7_x000A_        ON  EC7.eventid = E.eventid_x000A_        AND EC7.columnid = 7_x000A_    LEFT OUTER JOIN EC EC8_x000A_        ON  EC8.eventid = E.eventid_x000A_        AND EC8.columnid = 8_x000A_    LEFT OUTER JOIN EC EC9_x000A_        ON  EC9.eventid = E.eventid_x000A_        AND EC9.columnid = 9_x000A_    LEFT OUTER JOIN EC EC10_x000A_        ON  EC10.eventid = E.eventid_x000A_        AND EC10.columnid = 10_x000A_    LEFT OUTER JOIN EC EC11_x000A_        ON  EC11.eventid = E.eventid_x000A_        AND EC11.columnid = 11_x000A_    LEFT OUTER JOIN EC EC12_x000A_        ON  EC12.eventid = E.eventid_x000A_        AND EC12.columnid = 12_x000A_    LEFT OUTER JOIN EC EC40_x000A_        ON  EC40.eventid = E.eventid_x000A_        AND EC40.columnid = 40_x000A_    LEFT OUTER JOIN EC EC41_x000A_        ON  EC41.eventid = E.eventid_x000A_        AND EC41.columnid = 41_x000A_WHERE_x000A_                EC6.columnid IS NULL OR EC7.columnid IS NULL OR EC8.columnid IS NULL OR EC9.columnid IS NULL_x000A_                OR EC10.columnid IS NULL OR EC11.columnid IS NULL OR EC12.columnid IS NULL_x000A_                OR EC40.columnid IS NULL OR EC41.columnid IS NULL;_x000A__x000A_If the resulting list indicates any field specifications are missing, this is a finding._x000A__x000A_If SQL Server Audit is in use, check to see that all audit records include enough information to establish the sources of the events; if not, this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="53">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2014</S>
      <S N="VulnID">V-67779</S>
      <S N="RuleID">SV-82269r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL4-00-012200</S>
      <S N="Title">SQL Server must produce Trace or Audit records containing sufficient information to establish the outcome (success or failure) of the events.</S>
      <S N="Description">Information system auditing capability is critical for accurate forensic analysis. Audit record content which may be necessary to satisfy the requirement of this control includes, but is not limited to:  time stamps, source and destination addresses, user/process identifiers, event descriptions, success/fail indications, file names involved, and access control or flow control rules invoked._x000A__x000A_SQL Server is capable of a range of actions on data stored within the database. It is important, for accurate forensic analysis, to know the outcome of attempted actions. This requires specific information regarding the outcome of the action or event that the audit record is referring to. If outcome status information is not recorded and stored with the audit record, the record itself is of very limited use._x000A__x000A_Success and failure indicators ascertain the outcome of a particular event. As such, they also provide a means to measure the impact of an event and help authorized personnel to determine the appropriate response. Without knowing the outcome of audit events, it is very difficult to accurately recreate the series of events during forensic analysis._x000A__x000A_Use of SQL Server Audit is recommended.  All features of SQL Server Audit are available in the Enterprise and Developer editions of SQL Server 2014.  It is not available at the database level in other editions.  For this or legacy reasons, the instance may be using SQL Server Trace for auditing, which remains an acceptable solution for the time being.  Note, however, that Microsoft intends to remove most aspects of Trace at some point after SQL Server 2016._x000A__x000A_If Trace is enabled for auditing, SQL Server does capture the outcome status information in all audit records._x000A__x000A_If SQL Server Audit is enabled, the [Succeeded] column in the audit output indicates the success or failure of the attempted action.  Be aware, however, that it may report True in some cases where one would intuitively expect False.  For example, SELECT 1/0 FROM SYS.ALL_OBJECTS will appear in the audit trail as successful, if the user has permission to perform that action, even though it contains an invalid expression.  Some other actions that one would consider failures (such as selecting from a table that does not exist) may not appear at all.</S>
      <S N="FixText">If Trace is in use for audit purposes, design and deploy a Trace  that captures the NT User Name, NT Domain Name, Host Name, Login Name, DB User Name and Login SID (each where relevant) for all auditable events.  The script provided in the supplemental file Trace.sql can be used to create a trace._x000A__x000A_If SQL Server Audit is intended to be in use, design and deploy an Audit that captures all auditable events. The code provided in the supplemental file Audit.sql can be used as the basis for creating an Audit.</S>
      <S N="Check">If neither SQL Server Audit nor SQL Server Trace is in use for audit purposes, this is a finding._x000A__x000A_If SQL Server Audit is in use, the Succeeded column is populated for all relevant events:  this is not a finding._x000A__x000A_If SQL Server Trace is in use for audit purposes, verify that for all events it captures the Success flag (successful use of permissions), State and Error number (each where relevant)._x000A_From the query prompt:_x000A_SELECT * FROM sys.traces; _x000A__x000A_All currently defined traces for the SQL server instance will be listed._x000A__x000A_If no traces are returned, this is a finding._x000A__x000A_Determine the trace(s) being used for the auditing requirement._x000A_In the following, replace # with a trace ID being used for the auditing requirements._x000A_From the query prompt:_x000A_WITH _x000A_EC AS (SELECT eventid, columnid FROM sys.fn_trace_geteventinfo(2)),_x000A_E AS (SELECT DISTINCT eventid FROM EC)_x000A_SELECT_x000A_    E.eventid,_x000A_    CASE WHEN EC23.columnid IS NULL THEN 'Success (successful use of permissions) (23) missing' ELSE '23 OK' END AS field23,_x000A_    CASE WHEN EC30.columnid IS NULL THEN 'State (30) missing' ELSE '30 OK' END AS field30,_x000A_    CASE WHEN EC31.columnid IS NULL THEN 'Error (31) missing' ELSE '31 OK' END AS field31_x000A_FROM E E _x000A_    LEFT OUTER JOIN EC EC23_x000A_        ON  EC23.eventid = E.eventid_x000A_        AND EC23.columnid = 23_x000A_    LEFT OUTER JOIN EC EC30_x000A_        ON  EC30.eventid = E.eventid_x000A_        AND EC30.columnid = 30_x000A_    LEFT OUTER JOIN EC EC31_x000A_        ON  EC31.eventid = E.eventid_x000A_        AND EC31.columnid = 31_x000A_WHERE_x000A_       EC23.columnid IS NULL OR EC30.columnid IS NULL OR EC31.columnid IS NULL;_x000A__x000A_If the resulting list indicates any field specifications are missing, this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="54">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2014</S>
      <S N="VulnID">V-67781</S>
      <S N="RuleID">SV-82271r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL4-00-012300</S>
      <S N="Title">SQL Server must produce Trace or Audit records containing sufficient information to establish the identity of any user/subject associated with the event.</S>
      <S N="Description">Information system auditing capability is critical for accurate forensic analysis. Audit record content which may be necessary to satisfy the requirement of this control includes:  time stamps, source and destination addresses, user/process identifiers, event descriptions, success/fail indications, file names involved, and access control or flow control rules invoked._x000A__x000A_Database software is capable of a range of actions on data stored within the database. It is important, for accurate forensic analysis, to know exactly who performed a given action. If user identification information is not recorded and stored with the audit record, the record itself is of very limited use._x000A__x000A_Use of SQL Server Audit is recommended.  All features of SQL Server Audit are available in the Enterprise and Developer editions of SQL Server 2014.  It is not available at the database level in other editions.  For this or legacy reasons, the instance may be using SQL Server Trace for auditing, which remains an acceptable solution for the time being.  Note, however, that Microsoft intends to remove most aspects of Trace at some point after SQL Server 2016.</S>
      <S N="FixText">If Trace is in use for audit purposes, design and deploy a Trace  that captures the NT User Name, NT Domain Name, Host Name, Login Name, DB User Name and Login SID (each where relevant) for all auditable events.  The script provided in the supplemental file Trace.sql can be used to create a trace._x000A__x000A_If SQL Server Audit is intended to be in use, design and deploy an Audit that captures all auditable events. The code provided in the supplemental file Audit.sql can be used as the basis for creating an Audit.</S>
      <S N="Check">If neither SQL Server Audit nor SQL Server Trace is in use for audit purposes, this is a finding._x000A__x000A_If SQL Server Audit is in use, the Principal Name columns are populated for all relevant events:  this is not a finding._x000A__x000A_If SQL Server Trace is in use for audit purposes, verify that for all events it captures the NT User Name, NT Domain Name, Host Name, Login Name, DB User Name and Login SID (each where relevant)._x000A_From the query prompt:_x000A_SELECT * FROM sys.traces; _x000A__x000A_All currently defined traces for the SQL server instance will be listed._x000A__x000A_If no traces are returned, this is a finding._x000A__x000A_Determine the trace(s) being used for the auditing requirement._x000A_In the following, replace # with a trace ID being used for the auditing requirements._x000A_From the query prompt:_x000A_WITH _x000A_EC AS (SELECT eventid, columnid FROM sys.fn_trace_geteventinfo(2)),_x000A_E AS (SELECT DISTINCT eventid FROM EC)_x000A_SELECT_x000A_    E.eventid,_x000A_    CASE WHEN EC6.columnid IS NULL THEN 'NT User Name (6) missing' ELSE '6 OK' END AS field26,_x000A_    CASE WHEN EC7.columnid IS NULL THEN 'NT Domain Name (7) missing' ELSE '7 OK' END AS field7,_x000A_    CASE WHEN EC8.columnid IS NULL THEN 'Host Name (8) missing' ELSE '8 OK' END AS field8,_x000A_    CASE WHEN EC11.columnid IS NULL THEN 'Login Name (11) missing' ELSE '11 OK' END AS field11,_x000A_    CASE WHEN EC40.columnid IS NULL THEN 'DB User Name (40) missing' ELSE '40 OK' END AS field40,_x000A_    CASE WHEN EC41.columnid IS NULL THEN 'Login SID (41) missing' ELSE '41 OK' END AS field41_x000A_FROM E E _x000A_    LEFT OUTER JOIN EC EC6_x000A_        ON  EC6.eventid = E.eventid_x000A_        AND EC6.columnid = 6 _x000A_    LEFT OUTER JOIN EC EC7_x000A_        ON  EC7.eventid = E.eventid_x000A_        AND EC7.columnid = 7_x000A_    LEFT OUTER JOIN EC EC8_x000A_        ON  EC8.eventid = E.eventid_x000A_        AND EC8.columnid = 8_x000A_    LEFT OUTER JOIN EC EC11_x000A_        ON  EC11.eventid = E.eventid_x000A_        AND EC11.columnid = 11_x000A_    LEFT OUTER JOIN EC EC40_x000A_        ON  EC40.eventid = E.eventid_x000A_        AND EC40.columnid = 40_x000A_    LEFT OUTER JOIN EC EC41_x000A_        ON  EC41.eventid = E.eventid_x000A_        AND EC41.columnid = 41_x000A_WHERE_x000A_    EC6.columnid IS NULL OR EC7.columnid IS NULL OR EC8.columnid IS NULL_x000A_    OR EC11.columnid IS NULL OR EC40.columnid IS NULL OR EC41.columnid IS NULL;_x000A__x000A_If the resulting list indicates any field specifications are missing, this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="55">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2014</S>
      <S N="VulnID">V-67783</S>
      <S N="RuleID">SV-82273r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL4-00-012400</S>
      <S N="Title">SQL Server must include organization-defined additional, more detailed information in Trace or Audit records for events identified by type, location, or subject.</S>
      <S N="Description">SQL Server auditing capability is critical for accurate forensic analysis. Audit record content which may be necessary to satisfy the requirement of this control includes:  time stamps, source and destination addresses, user/process identifiers, event descriptions, success/fail indications, file names involved, and access control or flow control rules invoked._x000A__x000A_SQL Server does have a means available to add organizationally defined additional, more detailed information in the audit event records. These events may be identified by type, location, or subject. An example of more detailed information the organization may require in audit records could be the name of the application where the request is coming from._x000A__x000A_Some organizations may determine that more detailed information is required for specific database event types. If this information is not available, it could negatively impact forensic investigations into user actions or other malicious events._x000A__x000A_Use of SQL Server Audit is recommended.  All features of SQL Server Audit are available in the Enterprise and Developer editions of SQL Server 2014.  It is not available at the database level in other editions.  For this or legacy reasons, the instance may be using SQL Server Trace for auditing, which remains an acceptable solution for the time being.  Note, however, that Microsoft intends to remove most aspects of Trace at some point after SQL Server 2016.</S>
      <S N="FixText">If Trace is in use for audit purposes, where SQL Server's trace facilities can provide the necessary data, define and enable a trace that captures all organization-defined auditable events and fields.  The script provided in the supplemental file Trace.sql can be used for this, after appropriate editing._x000A__x000A_Where SQL Server's trace facilities cannot provide the necessary data, designate the event code(s) that will be used (Microsoft provides codes 82 through 91 for this purpose), design and deploy triggers that will recognize the events and invoke sp_trace_generateevent to populate the trace with the necessary information.  Add a block of sp_trace_setevent calls to the trace script for each event code designated for this purpose._x000A__x000A_If SQL Server Audit is in use, design and deploy an Audit that captures all auditable events and data items.  The script provided in the supplemental file Audit.sql can be used as the basis for this.  Supplement the standard audit data as necessary, using database audit specifications, Extended Events and/or triggers.</S>
      <S N="Check">If neither SQL Server Audit nor SQL Server Trace is in use for audit purposes, this is a finding._x000A__x000A_Review system documentation to determine whether SQL Server is required to audit any events, and any fields, in addition to those in the standard audit or audit-oriented trace._x000A__x000A_If there are none specified, this is not a finding._x000A__x000A_If SQL Server Trace is in use for audit purposes, review the audit-oriented trace definition script(s) to identify any events and/or fields that are required but not in the script._x000A__x000A_If any such are identified, this is a finding._x000A__x000A_If SQL Server Audit is in use, compare the audit specification(s) with the documented requirements._x000A__x000A_If any such requirement is not satisfied by the audit specification(s) (or by supplemental, locally-deployed mechanisms), this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="56">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2014</S>
      <S N="VulnID">V-67785</S>
      <S N="RuleID">SV-82275r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL4-00-013000</S>
      <S N="Title">Unless it has been determined that availability is paramount, SQL Server must shut down upon the failure of an Audit, or a Trace used for auditing purposes, to include the unavailability of space for more audit/trace log records.</S>
      <S N="Description">It is critical that when SQL Server is at risk of failing to process audit logs as required, it take action to mitigate the failure. Audit processing failures include: software/hardware errors; failures in the audit capturing mechanisms; and audit storage capacity being reached or exceeded. Responses to audit failure depend upon the nature of the failure mode. _x000A__x000A_When the need for system availability does not outweigh the need for a complete audit trail, SQL Server should shut down immediately, rolling back all in-flight transactions._x000A__x000A_Systems where audit trail completeness is paramount will most likely be at a lower MAC level than MAC I; the final determination is the prerogative of the application owner, subject to Authorizing Official concurrence. In any case, sufficient auditing resources must be allocated to avoid a shutdown in all but the most extreme situations._x000A__x000A_Use of SQL Server Audit is recommended.  All features of SQL Server Audit are available in the Enterprise and Developer editions of SQL Server 2014.  It is not available at the database level in other editions.  For this or legacy reasons, the instance may be using SQL Server Trace for auditing, which remains an acceptable solution for the time being.  Note, however, that Microsoft intends to remove most aspects of Trace at some point after SQL Server 2016.</S>
      <S N="FixText">If Trace is in use for audit purposes, redefine the trace, with @options = 6.  The script provided in the supplemental file Trace.sql can be used to do this._x000A__x000A_If SQL Server Audit is in use, configure SQL Server Audit to shut SQL Server down upon audit failure, to include running out of space for audit logs.  Run this T-SQL script for each identified audit:_x000A_ALTER SERVER AUDIT &lt;server_audit_name&gt; WITH (STATE = OFF);_x000A_GO_x000A_ALTER SERVER AUDIT &lt;server_audit_name&gt; WITH (ON_FAILURE = SHUTDOWN);_x000A_GO_x000A_ALTER SERVER AUDIT &lt;server_audit_name&gt; WITH (STATE = ON);_x000A_GO_x000A_The audit defined in the supplemental file Audit.sql includes this setting.</S>
      <S N="Check">If neither SQL Server Audit nor SQL Server Trace is in use for audit purposes, this is a finding._x000A__x000A_If the system documentation indicates that availability takes precedence over audit trail completeness, this is not applicable (NA)._x000A__x000A_If SQL Server Trace is in use for audit purposes, run the statement:_x000A_SELECT * FROM sys.traces;_x000A__x000A_In the results of the SELECT, identify the row representing the trace used for audit purposes.  Examine the values in that row._x000A__x000A_If is_shutdown = 0, this is a finding._x000A__x000A_If SQL Server Audit is in use, review the defined server audits by running the statement:_x000A_SELECT * FROM sys.server_audits;_x000A_By observing the [name] and [is_state_enabled] columns, identify the row or rows in use._x000A__x000A_If the [on_failure_desc] is "SHUTDOWN SERVER INSTANCE" on this/these row(s), this is not a finding.  Otherwise, this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="57">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2014</S>
      <S N="VulnID">V-67787</S>
      <S N="RuleID">SV-82277r2_rule</S>
      <S N="Severity">high</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL4-00-030600</S>
      <S N="Title">Where availability is paramount, the SQL Server must continue processing (preferably overwriting existing records, oldest first), in the event of lack of space for more Audit/Trace log records; and must keep processing after any failure of an Audit/Trace.</S>
      <S N="Description">It is critical that when SQL Server is at risk of failing to process audit logs as required, it take action to mitigate the failure. Audit processing failures include: software/hardware errors; failures in the audit capturing mechanisms; and audit storage capacity being reached or exceeded. Responses to audit failure depend upon the nature of the failure mode. _x000A__x000A_When availability is an overriding concern, approved actions in response to an audit failure are as follows: _x000A__x000A_(i) If the failure was caused by the lack of audit record storage capacity, the DBMS must continue generating audit records, if possible (automatically restarting the audit service if necessary), preferably overwriting the oldest audit records in a first-in-first-out manner._x000A__x000A_(ii) If audit records are sent to a centralized collection server and communication with this server is lost or the server fails, the DBMS must queue audit records locally until communication is restored or until the audit records are retrieved manually. Upon restoration of the connection to the centralized collection server, action should be taken to synchronize the local audit data with the collection server._x000A__x000A_Systems where availability is paramount will most likely be MAC I; the final determination is the prerogative of the application owner, subject to Authorizing Official concurrence. In any case, sufficient auditing resources must be allocated to avoid audit data loss in all but the most extreme situations._x000A__x000A_Use of SQL Server Audit is recommended.  All features of SQL Server Audit are available in the Enterprise and Developer editions of SQL Server 2014.  It is not available at the database level in other editions.  For this or legacy reasons, the instance may be using SQL Server Trace for auditing, which remains an acceptable solution for the time being.  Note that Microsoft intends to remove most aspects of Trace at some point after SQL Server 2016._x000A__x000A_However, although Trace supports FIFO rollover, SQL Server Audit does not:  its CONTINUE option stops the production of new audit records when there is an audit failure.</S>
      <S N="FixText">If Trace is in use for audit purposes, redefine the trace, with @options = 2.  Modify the script provided in the supplemental file Trace.sql to do this._x000A__x000A_If SQL Server Audit is in use, configure SQL Server Audit to shut SQL Server down upon audit failure, to include running out of space for audit logs.  Run this T-SQL script for each identified audit:_x000A_ALTER SERVER AUDIT &lt;server_audit_name&gt; WITH (STATE = OFF);_x000A_GO_x000A_ALTER SERVER AUDIT &lt;server_audit_name&gt; WITH (ON_FAILURE = CONTINUE);_x000A_GO_x000A_ALTER SERVER AUDIT &lt;server_audit_name&gt; WITH (STATE = ON);_x000A_GO_x000A_The audit defined in the supplemental file Audit.sql does not include this setting, and will need to be modified before use.</S>
      <S N="Check">If neither SQL Server Audit nor SQL Server Trace is in use for audit purposes, this is a finding._x000A__x000A_If the system documentation indicates that availability takes precedence over audit trail completeness, this is not applicable (NA)._x000A__x000A_If SQL Server Trace is in use for audit purposes, run the statement:_x000A_SELECT * FROM sys.traces;_x000A__x000A_In the results of the SELECT, identify the row representing the trace used for audit purposes.  Examine the values in that row._x000A__x000A_If is_shutdown = 1, this is a finding._x000A__x000A_If SQL Server Audit is in use, review the defined server audits by running the statement:_x000A_SELECT * FROM sys.server_audits;_x000A_By observing the [name] and [is_state_enabled] columns, identify the row or rows in use._x000A__x000A_If the [on_failure_desc] is "SHUTDOWN SERVER INSTANCE" on this/these row(s), this is not a finding.  Otherwise, this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="58">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2014</S>
      <S N="VulnID">V-67789</S>
      <S N="RuleID">SV-82279r2_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL4-00-013600</S>
      <S N="Title">The audit information produced by SQL Server must be protected from unauthorized read access.</S>
      <S N="Description">If audit data were to become compromised, competent forensic analysis and discovery of the true source of potentially malicious system activity would be difficult, if not impossible, to achieve. In addition, access to audit records provides information an attacker could potentially use to his or her advantage._x000A__x000A_To ensure the veracity of audit data, the information system and/or the application must protect audit information from any and all unauthorized access. This includes read, write, copy, etc._x000A__x000A_SQL Server and third-party tools are examples of applications that are easily able to view and manipulate audit file data. Additionally, applications with user interfaces to audit records should not allow unfettered manipulation of, or access to, those records via any application. If an application provides access to the audit data, the application becomes accountable for ensuring that audit information is protected from unauthorized access._x000A__x000A_This requirement can be achieved through multiple methods, which will depend upon system architecture and design. Some commonly employed methods include ensuring log files enjoy the proper file system permissions utilizing file system protections, and limiting log data location._x000A__x000A_Audit information includes all information (e.g., audit records, audit settings, and audit reports) needed to successfully audit information system activity.</S>
      <S N="FixText">Edit the system security plan to include justification and authorization for any less restrictive permissions that are present and needed.  (An example might be where Auditors need "Read &amp; Execute" rather than "Read" alone.)_x000A__x000A_Modify audit file permissions to meet the requirement to protect against unauthorized access._x000A__x000A_Navigate to audit folder location(s) using a command prompt or Windows Explorer. Right-click on the file, click Properties._x000A_On the Security tab, modify the security permissions to:_x000A_Administrator(read)_x000A_Users (none)_x000A_Audit Administrator(Full Control)_x000A_Auditors group (Read)_x000A_SQL Server Service SID OR Service Account (Full Control) [Notes 1, 2]_x000A_SQL Server SQL Agent Service SID OR Service Account, if SQL Server Agent is in use. (Read, Execute, Write) [Notes 1, 2]_x000A__x000A_-----_x000A__x000A_Note 1: It is highly advisable to use a separate account for each service. When installing SQL Server in single-server mode, you can opt to have these provisioned for you. These automatically-generated accounts are referred to as virtual accounts. Each virtual account has an equivalent Service SID, with the same name. The installer also creates an equivalent SQL Server login, also with the same name. Applying folder and file permissions to Service SIDs, rather than to domain accounts or local computer accounts, provides tighter control, because these permissions are available only to the specific service when it is running, and not in any other context. (However, when using failover clustering, a domain account must be specified at installation, rather than a virtual account.) For more on this topic, see http://msdn.microsoft.com/en-us/library/ms143504(v=sql.120).aspx._x000A__x000A_Note 2: Tips for adding a service SID/virtual account to a folder's permission list._x000A_1) In Windows Explorer, right-click on the folder and select "Properties."_x000A_2) Select the "Security" tab_x000A_3) Click "Edit"_x000A_4) Click "Add"_x000A_5) Click "Locations"_x000A_6) Select the computer name_x000A_7) Search for the name_x000A_7.a) SQL Server Service_x000A_7.a.i) Type "NT SERVICE\MSSQL" and click "Check Names". (What you have just typed in is the first 16 characters of the name. At least one character must follow "NT SERVICE\"; you will be presented with a list of all matches. If you have typed in the full, correct name, step 7.a.ii is bypassed.)_x000A_7.a.ii) Select the "MSSQL$&lt;instance name&gt;" user and click OK_x000A_7.b) SQL Agent Service_x000A_7.b.i) Type "NT SERVICE\SQL" and click "Check Names"_x000A_7.b.ii) Select the "SQLAgent$&lt;instance name&gt;" user and click OK_x000A_8) Click OK_x000A_9) Permission like a normal user from here</S>
      <S N="Check">Obtain the SQL Server audit file location(s) by running the following SQL script:_x000A_SELECT DISTINCT_x000A_LEFT(path, (LEN(path) - CHARINDEX('\',REVERSE(path)) + 1)) AS "Audit Path"_x000A_FROM sys.traces_x000A_UNION_x000A_SELECT log_file_path AS "Audit Path"_x000A_FROM sys.server_file_audits_x000A__x000A_For each audit, the path column will give the location of the file._x000A__x000A_Verify that all audit files have the correct permissions by doing the following for each audit file: Navigate to audit folder location(s) using a command prompt or Windows Explorer._x000A__x000A_Right-click the file/folder, click Properties. On the Security tab, verify that at most the following permissions are applied:_x000A_Administrator(read)_x000A_Users (none)_x000A_Audit Administrator (Full Control)_x000A_Auditors group (Read)_x000A_SQL Server Service SID OR Service Account (Full Control) [Notes 1, 2]_x000A_SQL Server SQL Agent Service SID OR Service Account, if SQL Server Agent is in use. (Read, Execute, Write) [Notes 1, 2]_x000A__x000A_If any less restrictive permissions are present and not specifically justified and approved in the system security plan, this is a finding. _x000A__x000A_If less restrictive permissions are present and specifically justified and approved in the system security plan, this is not a finding._x000A__x000A__x000A_-----_x000A__x000A_Note 1: It is highly advisable to use a separate account for each service. When installing SQL Server in single-server mode, you can opt to have these provisioned for you. These automatically-generated accounts are referred to as virtual accounts. Each virtual account has an equivalent Service SID, with the same name. The installer also creates an equivalent SQL Server login, also with the same name. Applying folder and file permissions to Service SIDs, rather than to domain accounts or local computer accounts, provides tighter control, because these permissions are available only to the specific service when it is running, and not in any other context. (However, when using failover clustering, a domain account must be specified at installation, rather than a virtual account.) For more on this topic, see http://msdn.microsoft.com/en-us/library/ms143504(v=sql.120).aspx._x000A__x000A_Note 2: Tips for adding a service SID/virtual account to a folder's permission list._x000A_1) In Windows Explorer, right-click on the folder and select "Properties."_x000A_2) Select the "Security" tab_x000A_3) Click "Edit"_x000A_4) Click "Add"_x000A_5) Click "Locations"_x000A_6) Select the computer name_x000A_7) Search for the name_x000A_7.a) SQL Server Service_x000A_7.a.i) Type "NT SERVICE\MSSQL" and click "Check Names". (What you have just typed in is the first 16 characters of the name. At least one character must follow "NT SERVICE\"; you will be presented with a list of all matches. If you have typed in the full, correct name, step 7.a.ii is bypassed.)_x000A_7.a.ii) Select the "MSSQL$&lt;instance name&gt;" user and click OK_x000A_7.b) SQL Agent Service_x000A_7.b.i) Type "NT SERVICE\SQL" and click "Check Names"_x000A_7.b.ii) Select the "SQLAgent$&lt;instance name&gt;" user and click OK_x000A_8) Click OK_x000A_9) Permission like a normal user from here</S>
    </MS>
  </Obj>
  <Obj RefId="59">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2014</S>
      <S N="VulnID">V-67791</S>
      <S N="RuleID">SV-82281r2_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL4-00-013700</S>
      <S N="Title">The audit information produced by  SQL Server must be protected from unauthorized modification.</S>
      <S N="Description">If audit data were to become compromised, competent forensic analysis and discovery of the true source of potentially malicious system activity would be impossible to achieve._x000A__x000A_To ensure the veracity of audit data, the information system and/or the application must protect audit information from unauthorized modification._x000A__x000A_This requirement can be achieved through multiple methods, which will depend upon system architecture and design. Some commonly employed methods include ensuring log files enjoy the proper file system permissions, and limiting log data locations._x000A__x000A_Applications providing a user interface to audit data will leverage user permissions and roles identifying the user accessing the data and the corresponding rights that the user enjoys in order to make decisions regarding the modification of audit data._x000A__x000A_Audit information includes all information (e.g., audit records, audit settings, and audit reports) needed to successfully audit information system activity._x000A__x000A_Modification of database audit data could mask the theft or unauthorized modification of sensitive data stored in the database.</S>
      <S N="FixText">Edit the system security plan to include justification and authorization for any less restrictive permissions that are present and needed.  (An example might be where Auditors need "Read &amp; Execute" rather than "Read" alone.)_x000A__x000A_Modify audit file permissions to meet the requirement to protect against unauthorized modification._x000A__x000A_Navigate to audit folder location(s) using a command prompt or Windows Explorer. Right-click on the file, click Properties. On the Security tab, modify the security permissions to:_x000A_Administrator(read)_x000A_Users (none)_x000A_Audit Administrator(Full Control)_x000A_Auditors group (Read)_x000A_SQL Server Service SID OR Service Account (Full Control) [Notes 1, 2]_x000A_SQL Server SQL Agent Service SID OR Service Account, if SQL Server Agent is in use. (Read, Execute, Write) [Notes 1, 2]_x000A__x000A_-----_x000A__x000A_Note 1: It is highly advisable to use a separate account for each service. When installing SQL Server in single-server mode, you can opt to have these provisioned for you. These automatically-generated accounts are referred to as virtual accounts. Each virtual account has an equivalent Service SID, with the same name. The installer also creates an equivalent SQL Server login, also with the same name. Applying folder and file permissions to Service SIDs, rather than to domain accounts or local computer accounts, provides tighter control, because these permissions are available only to the specific service when it is running, and not in any other context. (However, when using failover clustering, a domain account must be specified at installation, rather than a virtual account.) For more on this topic, see http://msdn.microsoft.com/en-us/library/ms143504(v=sql.120).aspx._x000A__x000A_Note 2: Tips for adding a service SID/virtual account to a folder's permission list._x000A_1) In Windows Explorer, right-click on the folder and select "Properties."_x000A_2) Select the "Security" tab_x000A_3) Click "Edit"_x000A_4) Click "Add"_x000A_5) Click "Locations"_x000A_6) Select the computer name_x000A_7) Search for the name_x000A_7.a) SQL Server Service_x000A_7.a.i) Type "NT SERVICE\MSSQL" and click "Check Names". (What you have just typed in is the first 16 characters of the name. At least one character must follow "NT SERVICE\"; you will be presented with a list of all matches. If you have typed in the full, correct name, step 7.a.ii is bypassed.)_x000A_7.a.ii) Select the "MSSQL$&lt;instance name&gt;" user and click OK_x000A_7.b) SQL Agent Service_x000A_7.b.i) Type "NT SERVICE\SQL" and click "Check Names"_x000A_7.b.ii) Select the "SQLAgent$&lt;instance name&gt;" user and click OK_x000A_8) Click OK_x000A_9) Permission like a normal user from here</S>
      <S N="Check">Obtain the SQL Server audit file location(s) by running the following SQL script:_x000A_SELECT DISTINCT_x000A_LEFT(path, (LEN(path) - CHARINDEX('\',REVERSE(path)) + 1)) AS "Audit Path"_x000A_FROM sys.traces_x000A_UNION_x000A_SELECT log_file_path AS "Audit Path"_x000A_FROM sys.server_file_audits_x000A__x000A_For each audit, the Audit Path column will give the location of the file._x000A__x000A_Verify that all audit files have the correct permissions by doing the following for each audit file: Navigate to audit folder location(s) using a command prompt or Windows Explorer. The following instructions assume Windows Explorer is used._x000A__x000A_Right-click the file/folder, click Properties. On the Security tab, verify that at most the following permissions are applied:_x000A_Administrator(read)_x000A_Users (none)_x000A_Audit Administrator (Full Control)_x000A_Auditors group (Read)_x000A_SQL Server Service SID OR Service Account (Full Control) [Notes 1, 2]_x000A_SQL Server SQL Agent Service SID OR Service Account, if SQL Server Agent is in use. (Read, Execute, Write) [Notes 1, 2]_x000A__x000A_If any less restrictive permissions are present and not specifically justified and approved in the system security plan, this is a finding. _x000A__x000A_If less restrictive permissions are present and specifically justified and approved in the system security plan, this is not a finding._x000A__x000A_If Trace is in use, SQL Server creates each trace file with a standard set of permissions, overriding the folder permissions.  It grants full control to OWNER RIGHTS, Administrators and &lt;SQL Server Instance name&gt;._x000A__x000A_Since this is not configurable, this is not a finding._x000A__x000A_-----_x000A__x000A_Note 1: It is highly advisable to use a separate account for each service. When installing SQL Server in single-server mode, you can opt to have these provisioned for you. These automatically-generated accounts are referred to as virtual accounts. Each virtual account has an equivalent Service SID, with the same name. The installer also creates an equivalent SQL Server login, also with the same name. Applying folder and file permissions to Service SIDs, rather than to domain accounts or local computer accounts, provides tighter control, because these permissions are available only to the specific service when it is running, and not in any other context. (However, when using failover clustering, a domain account must be specified at installation, rather than a virtual account.) For more on this topic, see http://msdn.microsoft.com/en-us/library/ms143504(v=sql.120).aspx._x000A__x000A_Note 2: Tips for adding a service SID/virtual account to a folder's permission list._x000A_1) In Windows Explorer, right-click on the folder and select "Properties."_x000A_2) Select the "Security" tab_x000A_3) Click "Edit"_x000A_4) Click "Add"_x000A_5) Click "Locations"_x000A_6) Select the computer name_x000A_7) Search for the name_x000A_7.a) SQL Server Service_x000A_7.a.i) Type "NT SERVICE\MSSQL" and click "Check Names". (What you have just typed in is the first 16 characters of the name. At least one character must follow "NT SERVICE\"; you will be presented with a list of all matches. If you have typed in the full, correct name, step 7.a.ii is bypassed.)_x000A_7.a.ii) Select the "MSSQL$&lt;instance name&gt;" user and click OK_x000A_7.b) SQL Agent Service_x000A_7.b.i) Type "NT SERVICE\SQL" and click "Check Names"_x000A_7.b.ii) Select the "SQLAgent$&lt;instance name&gt;" user and click OK_x000A_8) Click OK_x000A_9) Permission like a normal user from here</S>
    </MS>
  </Obj>
  <Obj RefId="60">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2014</S>
      <S N="VulnID">V-67793</S>
      <S N="RuleID">SV-82283r2_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL4-00-013800</S>
      <S N="Title">The audit information produced by SQL Server must be protected from unauthorized deletion.</S>
      <S N="Description">If audit data were to become compromised, competent forensic analysis and discovery of the true source of potentially malicious system activity would be impossible to achieve._x000A__x000A_To ensure the veracity of audit data, the information system and/or the application must protect audit information from unauthorized deletion. This requirement can be achieved through multiple methods, which will depend upon system architecture and design._x000A__x000A_Some commonly employed methods include ensuring log files enjoy the proper file system permissions utilizing file system protections, restricting access, and backing up log data to ensure log data is retained._x000A__x000A_Applications providing a user interface to audit data will leverage user permissions and roles identifying the user accessing the data and the corresponding rights the user enjoys in order to make decisions regarding the deletion of audit data._x000A__x000A_Audit information includes all information (e.g., audit records, audit settings, and audit reports) needed to successfully audit information system activity._x000A__x000A_Deletion of database audit data could mask the theft or unauthorized modification of sensitive data stored in the database.</S>
      <S N="FixText">Modify audit file permissions to meet the requirement to protect against unauthorized deletion._x000A__x000A_Navigate to audit folder location(s) using a command prompt or Windows Explorer. Right-click on the file, click Properties._x000A_On the Security tab, modify the security permissions to:_x000A_Administrator(read)_x000A_Users (none)_x000A_Audit Administrator(Full Control)_x000A_Auditors group (Read)_x000A_SQL Server Service SID OR Service Account (Full Control) [Notes 1, 2]_x000A_SQL Server SQL Agent Service SID OR Service Account, if SQL Server Agent is in use. (Read, Execute, Write) [Notes 1, 2]_x000A__x000A_-----_x000A__x000A_Note 1: It is highly advisable to use a separate account for each service. When installing SQL Server in single-server mode, you can opt to have these provisioned for you. These automatically-generated accounts are referred to as virtual accounts. Each virtual account has an equivalent Service SID, with the same name. The installer also creates an equivalent SQL Server login, also with the same name. Applying folder and file permissions to Service SIDs, rather than to domain accounts or local computer accounts, provides tighter control, because these permissions are available only to the specific service when it is running, and not in any other context. (However, when using failover clustering, a domain account must be specified at installation, rather than a virtual account.) For more on this topic, see http://msdn.microsoft.com/en-us/library/ms143504(v=sql.120).aspx._x000A__x000A_Note 2: Tips for adding a service SID/virtual account to a folder's permission list._x000A_1) In Windows Explorer, right-click on the folder and select "Properties."_x000A_2) Select the "Security" tab_x000A_3) Click "Edit"_x000A_4) Click "Add"_x000A_5) Click "Locations"_x000A_6) Select the computer name_x000A_7) Search for the name_x000A_7.a) SQL Server Service_x000A_7.a.i) Type "NT SERVICE\MSSQL" and click "Check Names". (What you have just typed in is the first 16 characters of the name. At least one character must follow "NT SERVICE\"; you will be presented with a list of all matches. If you have typed in the full, correct name, step 7.a.ii is bypassed.)_x000A_7.a.ii) Select the "MSSQL$&lt;instance name&gt;" user and click OK_x000A_7.b) SQL Agent Service_x000A_7.b.i) Type "NT SERVICE\SQL" and click "Check Names"_x000A_7.b.ii) Select the "SQLAgent$&lt;instance name&gt;" user and click OK_x000A_8) Click OK_x000A_9) Permission like a normal user from here</S>
      <S N="Check">Obtain the SQL Server audit file location(s) by running the following SQL script:_x000A_SELECT DISTINCT_x000A_LEFT(path, (LEN(path) - CHARINDEX('\',REVERSE(path)) + 1)) AS "Audit Path"_x000A_FROM sys.traces_x000A_UNION_x000A_SELECT log_file_path AS "Audit Path"_x000A_FROM sys.server_file_audits_x000A__x000A_For each audit, the path column will give the location of the file._x000A__x000A_Verify that all audit files have the correct permissions by doing the following for each audit file: Navigate to audit folder location(s) using a command prompt or Windows Explorer._x000A__x000A_Right-click the file/folder, click Properties. On the Security tab, verify that at most the following permissions are applied:_x000A_Administrator(read)_x000A_Users (none)_x000A_Audit Administrator (Full Control)_x000A_Auditors group (Read)_x000A_SQL Server Service SID OR Service Account (Full Control) [Notes 1, 2]_x000A_SQL Server SQL Agent Service SID OR Service Account, if SQL Server Agent is in use. (Read, Execute, Write) [Notes 1, 2]_x000A__x000A_If any less restrictive permissions are present and not specifically justified and approved in the system security plan, this is a finding. _x000A__x000A_If less restrictive permissions are present and specifically justified and approved in the system security plan, this is not a finding._x000A__x000A_-----_x000A__x000A_Note 1: It is highly advisable to use a separate account for each service. When installing SQL Server in single-server mode, you can opt to have these provisioned for you. These automatically-generated accounts are referred to as virtual accounts. Each virtual account has an equivalent Service SID, with the same name. The installer also creates an equivalent SQL Server login, also with the same name. Applying folder and file permissions to Service SIDs, rather than to domain accounts or local computer accounts, provides tighter control, because these permissions are available only to the specific service when it is running, and not in any other context. (However, when using failover clustering, a domain account must be specified at installation, rather than a virtual account.) For more on this topic, see http://msdn.microsoft.com/en-us/library/ms143504(v=sql.120).aspx._x000A__x000A_Note 2: Tips for adding a service SID/virtual account to a folder's permission list._x000A_1) In Windows Explorer, right-click on the folder and select "Properties."_x000A_2) Select the "Security" tab_x000A_3) Click "Edit"_x000A_4) Click "Add"_x000A_5) Click "Locations"_x000A_6) Select the computer name_x000A_7) Search for the name_x000A_7.a) SQL Server Service_x000A_7.a.i) Type "NT SERVICE\MSSQL" and click "Check Names". (What you have just typed in is the first 16 characters of the name. At least one character must follow "NT SERVICE\"; you will be presented with a list of all matches. If you have typed in the full, correct name, step 7.a.ii is bypassed.)_x000A_7.a.ii) Select the "MSSQL$&lt;instance name&gt;" user and click OK_x000A_7.b) SQL Agent Service_x000A_7.b.i) Type "NT SERVICE\SQL" and click "Check Names"_x000A_7.b.ii) Select the "SQLAgent$&lt;instance name&gt;" user and click OK_x000A_8) Click OK_x000A_9) Permission like a normal user from here</S>
    </MS>
  </Obj>
  <Obj RefId="61">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2014</S>
      <S N="VulnID">V-67795</S>
      <S N="RuleID">SV-82285r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL4-00-013900</S>
      <S N="Title">SQL Server must protect its audit features from unauthorized access, modification, or removal.</S>
      <S N="Description">Protecting audit data also includes identifying and protecting the tools used to view and manipulate log data. _x000A__x000A_Depending upon the log format and application, system and application log tools may provide the only means to manipulate and manage application and system log data. It is, therefore, imperative that access to audit tools be controlled and protected from unauthorized access. _x000A__x000A_If an attacker were to gain access to audit tools, he could analyze audit logs for system weaknesses or weaknesses in the auditing itself. An attacker could also manipulate logs to hide evidence of malicious activity._x000A__x000A_This focuses on audit/trace log tools within SQL Server.  Other STIG requirements govern operating system settings to control access to external tools.</S>
      <S N="FixText">Use REVOKE and/or DENY statements to remove audit-related permissions from individuals and roles not authorized to have them.</S>
      <S N="Check">Review the SQL Server permissions granted to principals.  The views and functions provided in the supplemental file Permissions.sql can help with this.  Look for permissions such as ALTER ANY SERVER AUDIT, ALTER ANY DATABASE AUDIT, ALTER TRACE; or EXECUTE on the stored procedures with names beginning "SP_TRACE", or on scopes including those procedures._x000A__x000A_If unauthorized accounts have these privileges, this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="62">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2014</S>
      <S N="VulnID">V-67797</S>
      <S N="RuleID">SV-82287r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL4-00-013910</S>
      <S N="Title">SQL Server Profiler must be protected  from unauthorized access, modification, or removal.</S>
      <S N="Description">Protecting audit data also includes identifying and protecting the tools used to view and manipulate log data.  SQL Server Profiler is one such tool._x000A__x000A_If an attacker were to gain access to audit tools, he could analyze audit logs for system weaknesses or weaknesses in the auditing itself. An attacker could also manipulate logs to hide evidence of malicious activity.</S>
      <S N="FixText">Apply or modify permissions on PROFILER.EXE to make it accessible by authorized personnel only.</S>
      <S N="Check">In Windows Explorer, navigate to &lt;drive&gt;:\Program Files (x86)\Microsoft SQL Server\120\Tools\Binn.  Right-click on the file PROFILER.EXE; select Properties.  Click on the Security tab.  Review the users and groups listed, and the permissions granted to each._x000A__x000A_If PROFILER.EXE can be executed or modified by any unauthorized users, this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="63">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2014</S>
      <S N="VulnID">V-67799</S>
      <S N="RuleID">SV-82289r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL4-00-013920</S>
      <S N="Title">Audit tools used in conjunction with SQL Server  must be protected  from unauthorized access.</S>
      <S N="Description">Protecting audit data also includes identifying and protecting the tools used to view and manipulate log data. _x000A__x000A_Depending upon the log format and application, system and application log tools may provide the only means to manipulate and manage application and system log data. It is, therefore, imperative that access to audit tools be controlled and protected from unauthorized access. _x000A__x000A_Applications providing tools to interface with audit data will leverage user permissions and roles identifying the user accessing the tools and the corresponding rights the user enjoys in order make access decisions regarding the access to audit tools._x000A__x000A_Audit tools include, but are not limited to, OS-provided audit tools, vendor-provided audit tools, and open source audit tools needed to successfully view and manipulate audit information system activity and records. _x000A__x000A_If an attacker were to gain access to audit tools, he could analyze audit logs for system weaknesses or weaknesses in the auditing itself. An attacker could also manipulate logs to hide evidence of malicious activity._x000A__x000A_This focuses on external tools for log maintenance and review.  Other STIG requirements govern SQL Server privileges to maintain trace or audit definitions.</S>
      <S N="FixText">Apply or modify Windows permissions on tools used to view or modify audit log data (to include traces used for audit purposes), to make them accessible by authorized personnel only.</S>
      <S N="Check">In Windows, review the access permissions to tools used to view or modify audit log data (to include traces used for audit purposes)._x000A__x000A_If appropriate permissions and access controls to prevent unauthorized read actions and executions are not applied to these tools, this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="64">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2014</S>
      <S N="VulnID">V-67803</S>
      <S N="RuleID">SV-82293r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL4-00-014000</S>
      <S N="Title">SQL Server and/or the operating system must protect its audit configuration from unauthorized modification.</S>
      <S N="Description">Protecting audit data also includes identifying and protecting the tools used to view and manipulate log data. Therefore, protecting audit tools is necessary to prevent unauthorized operation on audit data._x000A__x000A_Applications providing tools to interface with audit data will leverage user permissions and roles identifying the user accessing the tools and the corresponding rights the user enjoys in order make access decisions regarding the modification of audit tools._x000A__x000A_Audit tools include, but are not limited to, vendor-provided and open source audit tools needed to successfully view and manipulate audit information system activity and records. Audit tools include custom queries and report generators._x000A__x000A_This focuses on external tools for log maintenance and review.  Other STIG requirements govern SQL Server privileges to maintain trace or audit definitions.</S>
      <S N="FixText">Apply or modify Windows permissions on tools used to view or modify audit log data (to include traces used for audit purposes), to make them accessible by authorized personnel only.</S>
      <S N="Check">In Windows, review the access permissions to tools used to view or modify audit log data (to include traces used for audit purposes)._x000A__x000A_If appropriate permissions and access controls to prevent unauthorized changes are not applied to these tools, this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="65">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2014</S>
      <S N="VulnID">V-67805</S>
      <S N="RuleID">SV-82295r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL4-00-014100</S>
      <S N="Title">SQL Server and the operating system must protect SQL Server audit features from unauthorized removal.</S>
      <S N="Description">Protecting audit data also includes identifying and protecting the tools used to view and manipulate log data. Therefore, protecting audit tools is necessary to prevent unauthorized operation on audit data._x000A__x000A_Applications providing tools to interface with audit data will leverage user permissions and roles identifying the user accessing the tools and the corresponding rights the user enjoys in order make access decisions regarding the deletion of audit tools._x000A__x000A_Audit tools include, but are not limited to, vendor-provided and open source audit tools needed to successfully view and manipulate audit information system activity and records. Audit tools include custom queries and report generators._x000A__x000A_This focuses on external tools for log maintenance and review.  Other STIG requirements govern SQL Server privileges to maintain trace or audit definitions.</S>
      <S N="FixText">Apply or modify Windows permissions on tools used to view or modify audit log data (to include traces used for audit purposes), to make them accessible by authorized personnel only.</S>
      <S N="Check">In Windows, review the access permissions to tools used to view or modify audit log data (to include traces used for audit purposes)._x000A__x000A_If appropriate permissions and access controls to prevent unauthorized deletions are not applied to these tools, this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="66">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2014</S>
      <S N="VulnID">V-67807</S>
      <S N="RuleID">SV-82297r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL4-00-015350</S>
      <S N="Title">Software, applications, and configuration files that are part of, or related to, the SQL Server  installation must be monitored to discover unauthorized changes.</S>
      <S N="Description">When dealing with change control issues, it should be noted, any changes to the hardware, software, and/or firmware components of applications and tools related to SQL Server can potentially have significant effects on the overall security of the system. Only qualified and authorized individuals shall be allowed to obtain access to components related to SQL Server for purposes of initiating changes, including upgrades and modifications._x000A__x000A_Unmanaged changes that occur to the software libraries or configuration can lead to unauthorized or compromised installations._x000A__x000A_Of particular note in this context is that any software installed for auditing and/or audit file management must be protected and monitored.</S>
      <S N="FixText">Include locations of all files, libraries, scripts, and executables that are part of, or related to, the SQL Server 2014 installation in the documentation._x000A__x000A_Ensure that files and folders that are part of, or related to, the SQL Server 2014 installation have only the following privileges. Right-click the file/folder, click Properties. On the Security tab, modify the security permissions, so that at most the following permissions are present:_x000A_Trusted Installer (Full Control)_x000A_SYSTEM (FULL CONTROL)_x000A_Administrators (FULL CONTROL)_x000A_Users (READ, LIST FOLDER CONTENTS, READ &amp; EXECUTE)_x000A_Creator Owner (Special Permissions - Full control - Subfolders and files only)_x000A_All Application Packages (Read &amp; Execute) [Only as needed - see Note 2]_x000A__x000A_Ensure that files and folders that are part of, or related to, the SQL Server 2014 installation have auditing enabled. Right-click on the file/folder, click Properties. On the Security tab, click Advanced. On the Auditing tab, use the Add or Edit buttons and the dialogs that follow from them, to set up the following on at least one audit:_x000A_Type: All_x000A_Principal: Everyone_x000A_Access: Modify_x000A_Applies to: This Folder, subfolder, and files [where applicable]_x000A__x000A_Deploy a third-party security and data integrity tool for monitoring and alerting files and folders based on cryptographic hashes, to verify files/folder locations as listed in the documentation._x000A__x000A_Note 1: In the interest of separation of responsibilities with least privilege, consider granting Full Control only to SQL Database Administrators (or another appropriate group of administrators) and providing the local Administrators group with Read access only._x000A__x000A_Note 2: Some files also require 'ALL APPLICATION PACKAGES (READ, EXECUTE)' permissions for certain functionality to work appropriately, and this is considered acceptable where those permissions are required. (All SQL Server files that require this access reside by default in the ..\Microsoft SQL Server\110\ directory.)</S>
      <S N="Check">Verify that files and folders that are part of, or related to, the SQL Server 2014 installation have only the appropriate privileges. In Windows Explorer, right-click the file/folder, click Properties. On the Security tab, modify the security permissions, so that at most the following permissions are present:_x000A_Trusted Installer (Full Control)_x000A_SYSTEM (Full Control)_x000A_Administrators (Full Control) [See Note 1]_x000A_Users (Read, List Folder Contents, Read &amp; Execute)_x000A_Creator Owner (Special Permissions - Full control - Subfolders and files only)_x000A_All Application Packages (Read &amp; Execute) [Only as needed - see Note 2] _x000A__x000A_If any less restrictive permissions are present (and not specifically justified and approved), this is a finding._x000A__x000A_Verify that files and folders that are part of, or related to, the SQL Server 2014 installation have auditing enabled. Right-click on the file/folder, click Properties. On the Security tab, click Advanced. On the Auditing tab, verify that the following is set up on at least one audit:_x000A_Type: All_x000A_Principal: Everyone_x000A_Access: Modify_x000A_Applies to: This Folder, subfolder, and files [where applicable]_x000A__x000A_If the required audit settings are not configured, there is a risk that unauthorized changes to the software will go undetected, and this is a finding._x000A__x000A_If a third-party security and data integrity tool is not used for monitoring and alerting files and folders based on cryptographic hashes, this is a finding._x000A__x000A_If the tool does not verify files/folder locations as listed in the documentation, this is a finding._x000A__x000A_Note 1: In the interest of separation of responsibilities with least privilege, consider granting Full Control only to SQL Database Administrators (or another appropriate group of administrators) and providing the local Administrators group with Read access only._x000A__x000A_Note 2: Some files also require 'ALL APPLICATION PACKAGES (READ, EXECUTE)' permissions for certain functionality to work appropriately, and this is considered acceptable where those permissions are required. (All SQL Server files that require this access reside by default in the ..\Microsoft SQL Server\110\ directory.)</S>
    </MS>
  </Obj>
  <Obj RefId="67">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2014</S>
      <S N="VulnID">V-67809</S>
      <S N="RuleID">SV-82299r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL4-00-015300</S>
      <S N="Title">SQL Server security-relevant configuration settings must be monitored to discover unauthorized changes.</S>
      <S N="Description">When dealing with change control issues, it should be noted, any changes to security-relevant configuration settings of SQL Server can potentially have significant effects on the overall security of the system._x000A__x000A_If SQL Server were to allow any user to make changes to configuration settings, then those changes might be implemented without undergoing the appropriate testing and approvals that are part of a robust change management process. This requirement is contingent upon the configuration of SQL Server's hosted application and the security-relevant configuration settings of SQL Server._x000A__x000A_Accordingly, only qualified and authorized individuals shall be allowed to obtain access to these security-relevant configuration settings for purposes of initiating changes, including upgrades and modifications._x000A__x000A_Unmanaged changes that occur to SQL Server software libraries or configuration can lead to unauthorized or compromised installations.</S>
      <S N="FixText">Document the monitoring of security-relevant configuration settings to discover unauthorized changes within the system documentation._x000A__x000A_Document the specific users or types of security personnel that are able to monitor security-relevant configuration settings to discover unauthorized changes._x000A__x000A_Deploy and implement a third-party tool or some other SQL Server method of monitoring security-relevant configuration settings to discover unauthorized changes.</S>
      <S N="Check">Verify within the system documentation that SQL Server is monitored for security-relevant configuration settings to discover unauthorized changes._x000A__x000A_This can be done by a third-party tool or a SQL script that does baselining and then comparisons._x000A__x000A_If the monitoring of security-relevant configuration settings to discover unauthorized changes is not implemented on SQL Server, this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="68">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2014</S>
      <S N="VulnID">V-67811</S>
      <S N="RuleID">SV-82301r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL4-00-015400</S>
      <S N="Title">SQL Server software installation account(s) must be restricted to authorized users.</S>
      <S N="Description">When dealing with change control issues, it should be noted, any changes to the hardware, software, and/or firmware components of the information system and/or application can potentially have significant effects on the overall security of the system._x000A__x000A_If the application were to allow any user to make changes to software libraries, then those changes might be implemented without undergoing the appropriate testing and approvals that are part of a robust change management process._x000A__x000A_This requirement is contingent upon the language in which the application is programmed, as many application architectures in use today incorporate their software libraries into, and make them inseparable from, their compiled distributions, rendering them static and version dependent. However, this requirement does apply to applications with software libraries accessible and configurable, as in the case of interpreted languages._x000A__x000A_Accordingly, only qualified and authorized individuals shall be allowed to obtain access to information system components for purposes of initiating changes, including upgrades and modifications._x000A__x000A_DBA and other privileged administrative or application owner accounts are granted privileges that allow actions that can have a greater impact on SQL Server security and operation. It is especially important to grant access to privileged accounts to only those persons who are qualified and authorized to use them.</S>
      <S N="FixText">From a Command Prompt, open lusrmgr.msc.  Navigate to Users &gt;&gt; right-click individual user &gt;&gt; Properties &gt;&gt; Member Of._x000A__x000A_Configure SQL Server &amp; OS settings and access controls, to restrict user access to objects and data that the user is authorized to view or interact with._x000A__x000A_Develop, document, and implement procedures to restrict use of the DBMS software installation account.</S>
      <S N="Check">Check system documentation for policy and procedures to restrict use of the SQL Server software installation account._x000A__x000A_Check OS settings to determine whether users are restricted from accessing SQL Server objects and data they are not authorized to access by checking the local OS user accounts._x000A__x000A_From a Command Prompt, open lusrmgr.msc. Navigate to Users &gt;&gt; right-click individual user &gt;&gt; Properties &gt;&gt; Member Of._x000A__x000A_If appropriate access controls for all users are not implemented to restrict access to only authorized users and to restrict the access of those users to objects and data they are authorized, this is a finding._x000A__x000A_Review procedures for controlling and granting access to use of the SQL Server software installation account._x000A__x000A_If access or use of this account is not restricted to the minimum number of personnel required, or unauthorized access to this account has been granted, this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="69">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2014</S>
      <S N="VulnID">V-67813</S>
      <S N="RuleID">SV-82303r2_rule</S>
      <S N="Severity">low</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL4-00-015500</S>
      <S N="Title">Database software directories, including SQL Server configuration files, must be stored in dedicated directories, separate from the host OS and other applications.</S>
      <S N="Description">When dealing with change control issues, it should be noted, any changes to the hardware, software, and/or firmware components of the information system and/or application can potentially have significant effects on the overall security of the system._x000A__x000A_Multiple applications can provide a cumulative negative effect. A vulnerability and subsequent exploit of one application can lead to an exploit of other applications sharing the same security context. For example, an exploit of a web server process that leads to unauthorized administrative access to host system directories can most likely lead to a compromise of all applications hosted by the same system. Database software not installed using dedicated directories both threatens and is threatened by other hosted applications. Access controls defined for one application may by default provide access to other applicationsâ€™ database objects or directories. Any method that provides any level of separation of security context assists in the protection between applications.</S>
      <S N="FixText">Separate database files (software, data) into dedicated directories.</S>
      <S N="Check">Verify the SQL Server installations present on the server._x000A__x000A_From a Command Prompt, type regedit.exe, and press [ENTER]._x000A__x000A_Navigate to HKEY_LOCAL_MACHINE &gt;&gt; SOFTWARE &gt;&gt; Microsoft &gt;&gt; Microsoft SQL Server &gt;&gt; Instance Names. Each instance installed on the server possesses a key inside a folder under this registry entry._x000A__x000A_Analysis Services Instances are registered in the OLAP subfolder._x000A_Reporting Services Instances are registered in the RS subfolder._x000A_Standard SQL Server (database engine) Instances are registered in the SQL subfolder._x000A__x000A_Inside each one of these folders, a single key is used to reference an Instance's specific Windows Registry tree. Each key will have its own registry tree at the following registry location: HKEY_LOCAL_MACHINE &gt;&gt; SOFTWARE &gt;&gt; Microsoft &gt;&gt; Microsoft SQL Server &gt;&gt; [INSTANCE NAME]._x000A__x000A_An [INSTANCE NAME] is listed as the Data component of a key found in one of the above OLAP, RS, or SQL folders._x000A__x000A_To find the installation location of a particular instance, navigate to the following location in the Windows Registry:_x000A__x000A_HKEY_LOCAL_MACHINE &gt;&gt; SOFTWARE &gt;&gt; Microsoft &gt;&gt; Microsoft SQL Server &gt;&gt; [INSTANCE NAME] &gt;&gt; Setup. Examine the value of the 'SqlProgramDir' key. The value of the 'SqlProgramDir' key is the SQL Server installation directory for that SQL Server Instance._x000A__x000A_Navigate to that folder location using a Command Prompt or Windows Explorer. Only applications that are required for the functioning and administration, not use, of SQL Server should be located on the same directory node as the SQL Server software libraries._x000A__x000A_If any files or subfolders that are not part of the SQL Server installation are in the folder, this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="70">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2014</S>
      <S N="VulnID">V-67815</S>
      <S N="RuleID">SV-82305r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL4-00-030700</S>
      <S N="Title">The role(s)/group(s) used to modify database structure (including but not necessarily limited to tables, indexes, storage, etc.) and logic modules (stored procedures, functions, triggers, links to software external to SQL Server, etc.) must be restricted to authorized users.</S>
      <S N="Description">If SQL Server were to allow any user to make changes to database structure or logic, then those changes might be implemented without undergoing the appropriate testing and approvals that are part of a robust change management process._x000A__x000A_Accordingly, only qualified and authorized individuals shall be allowed to obtain access to information system components for purposes of initiating changes, including upgrades and modifications._x000A__x000A_Unmanaged changes that occur to the database software libraries or configuration can lead to unauthorized or compromised installations.</S>
      <S N="FixText">Revoke unauthorized memberships in the group(s)/role(s) designated for DBMS and database modification._x000A__x000A_Syntax examples:_x000A__x000A_ALTER ROLE Power DROP MEMBER JenUser; -- the member is a database role or database user._x000A_ALTER SERVER ROLE GreatPower DROP MEMBER Irresponsibility; -- the member is a server role or login.</S>
      <S N="Check">Using the system security plan, identify the group(s)/role(s) established for SQL Server DBMS and database modification, and the individuals authorized to modify the DBMS and database(s).  If helpful, the views STIG.server_permissions and STIG.database_permissions, provided in the supplemental file Permissions.sql, can be used to search for the relevant roles:  look for Permission values containing "Alter," "Create," "Control," etc._x000A__x000A_Obtain the list of users in those group(s)/roles.  The provided functions STIG.members_of_db_role() and STIG.members_of_server_role(), can be used for this._x000A__x000A_If unauthorized access to the group(s)/role(s) has been granted, this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="71">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2014</S>
      <S N="VulnID">V-67817</S>
      <S N="RuleID">SV-82307r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL4-00-016200</S>
      <S N="Title">SQL Server must have the publicly available Northwind sample database removed.</S>
      <S N="Description">Information systems are capable of providing a wide variety of functions and services. Some of the functions and services, provided by default, may not be necessary to support essential organizational operations (e.g., key missions, functions)._x000A__x000A_It is detrimental for applications to provide, or install by default, functionality exceeding requirements or mission objectives. Examples include, but are not limited to, installing advertising software, demonstrations, or browser plug-ins not related to requirements and providing a wide array of functionality not required for every mission, but which cannot be disabled._x000A__x000A_Applications must adhere to the principles of least functionality by providing only essential capabilities. Even though the very popular "Northwind" database is no longer installed by default, it introduces a vulnerability to SQL Server and must be removed, if present._x000A__x000A_Demonstration and sample database objects and applications present publicly known attack points for malicious users. These demonstration and sample objects are meant to provide simple examples of coding specific functions and are not developed to prevent vulnerabilities from being introduced to the SQL Server and the OS.</S>
      <S N="FixText">Remove the publicly available "Northwind" database from SQL Server by running the following script:_x000A__x000A_USE master;_x000A_GO_x000A_DROP DATABASE Northwind;_x000A_GO</S>
      <S N="Check">Check SQL Server for the existence of the publicly available "Northwind" database by performing the following query:_x000A__x000A_SELECT name FROM sysdatabases WHERE name LIKE 'Northwind%';_x000A__x000A_If the "Northwind" database is present, this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="72">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2014</S>
      <S N="VulnID">V-67819</S>
      <S N="RuleID">SV-82309r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL4-00-016300</S>
      <S N="Title">SQL Server must have the publicly available pubs sample database removed.</S>
      <S N="Description">Information systems are capable of providing a wide variety of functions and services. Some of the functions and services, provided by default, may not be necessary to support essential organizational operations (e.g., key missions, functions)._x000A__x000A_It is detrimental for applications to provide, or install by default, functionality exceeding requirements or mission objectives. Examples include, but are not limited to, installing advertising software, demonstrations, or browser plug-ins not related to requirements and providing a wide array of functionality not required for every mission, but which cannot be disabled._x000A__x000A_Applications must adhere to the principles of least functionality by providing only essential capabilities. Even though the formerly popular "pubs" database is no longer installed by default, it introduces a vulnerability to SQL Server and must be removed, if present._x000A__x000A_Demonstration and sample database objects and applications present publicly known attack points for malicious users. These demonstration and sample objects are meant to provide simple examples of coding specific functions and are not developed to prevent vulnerabilities from being introduced to the SQL Server and the OS.</S>
      <S N="FixText">Remove the publicly available "pubs" database from SQL Server by running the following script:_x000A__x000A_USE master;_x000A_GO_x000A_DROP DATABASE pubs;_x000A_GO</S>
      <S N="Check">Check SQL Server for the existence of the publicly available "pubs" database by performing the following query:_x000A__x000A_SELECT name FROM sysdatabases WHERE name LIKE 'pubs%';_x000A__x000A_If the "pubs" database is present, this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="73">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2014</S>
      <S N="VulnID">V-67821</S>
      <S N="RuleID">SV-82311r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL4-00-016310</S>
      <S N="Title">SQL Server must have the publicly available AdventureWorks sample database removed.</S>
      <S N="Description">Information systems are capable of providing a wide variety of functions and services. Some of the functions and services, provided by default, may not be necessary to support essential organizational operations (e.g., key missions, functions)._x000A__x000A_It is detrimental for applications to provide, or install by default, functionality exceeding requirements or mission objectives. Examples include, but are not limited to, installing advertising software, demonstrations, or browser plug-ins not related to requirements and providing a wide array of functionality not required for every mission, but which cannot be disabled._x000A__x000A_Applications must adhere to the principles of least functionality by providing only essential capabilities. Even though the very popular "AdventureWorks" database is no longer installed by default, it introduces a vulnerability to SQL Server and must be removed, if present._x000A__x000A_Demonstration and sample database objects and applications present publicly known attack points for malicious users. These demonstration and sample objects are meant to provide simple examples of coding specific functions and are not developed to prevent vulnerabilities from being introduced to the SQL Server and the OS.</S>
      <S N="FixText">Remove the publicly available "AdventureWorks" database from SQL Server by running the following script:_x000A__x000A_USE master;_x000A_GO_x000A_DROP DATABASE AdventureWorks;_x000A_GO</S>
      <S N="Check">Check SQL Server for the existence of the publicly available "AdventureWorks" database by performing the following query:_x000A__x000A_SELECT name FROM sysdatabases WHERE name LIKE 'AdventureWorks%';_x000A__x000A_If the "AdventureWorks" database is present, this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="74">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2014</S>
      <S N="VulnID">V-67823</S>
      <S N="RuleID">SV-82313r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL4-00-016500</S>
      <S N="Title">SQL Server must have the SQL Server Data Tools (SSDT) software component removed if it is unused.</S>
      <S N="Description">Information systems are capable of providing a wide variety of functions and services. Some of the functions and services, provided by default or selected for installation by an administrator, may not be necessary to support essential organizational operations (e.g., key missions, functions)._x000A__x000A_Applications must adhere to the principles of least functionality by providing only essential capabilities.  Unused and unnecessary SQL Server components increase the number of available attack vectors.  By minimizing the services and applications installed on the system, the number of potential vulnerabilities is reduced._x000A__x000A_The SQL Server Data Tools (SSDT) software component must be removed from SQL Server if it is unused.</S>
      <S N="FixText">Document the requirement for SQL Server Data Tools to reside on this server._x000A__x000A_If it is not required, using an account with System Administrator privileges, from Command Prompt, open control.exe._x000A__x000A_Navigate to Programs and Features. Remove the following entries in the 'Uninstall or change a program' window._x000A__x000A_Microsoft SQL Server Data Tools - Database Projects - Web installer entry point_x000A_Prerequisites for SSDT</S>
      <S N="Check">Review the list of components and features installed with the database. Using an account with System Administrator privileges, from Command Prompt, open control.exe._x000A__x000A_Navigate to Programs and Features. Check for the following entries in the 'Uninstall or change a program' window._x000A__x000A_Microsoft SQL Server Data Tools - Database Projects - Web installer entry point_x000A_Prerequisites for SSDT_x000A__x000A_If SQL Server Data Tools is not documented as a server requirement, and these entries exist, this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="75">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2014</S>
      <S N="VulnID">V-67825</S>
      <S N="RuleID">SV-82315r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL4-00-016600</S>
      <S N="Title">SQL Server must have the SQL Server Reporting Services (SSRS) software component removed if it is unused.</S>
      <S N="Description">Information systems are capable of providing a wide variety of functions and services. Some of the functions and services, provided by default or selected for installation by an administrator, may not be necessary to support essential organizational operations (e.g., key missions, functions)._x000A__x000A_Applications must adhere to the principles of least functionality by providing only essential capabilities.  Unused and unnecessary SQL Server components increase the number of available attack vectors.  By minimizing the services and applications installed on the system, the number of potential vulnerabilities is reduced._x000A__x000A_The SQL Server Reporting Services (SSRS) software component must be removed from SQL Server if it is unused.</S>
      <S N="FixText">Either using the Start menu or via the command "control.exe", open the Windows Control Panel.  Open Programs and Features.  Double-click on Microsoft SQL Server 2014.  In the dialog box that appears, select Remove.  Wait for the Remove wizard to appear._x000A__x000A_Select the relevant SQL Server instance; click Next._x000A__x000A_Select Reporting Services - Native; select Reporting Services Add-in for SharePoint Products if it is present; click Next._x000A__x000A_Follow the remaining prompts, to remove SQL Server Reporting Services from SQL Server.</S>
      <S N="Check">If the SQL Server service "SQL Server Reporting Services (&lt;Instance Name&gt;)" is used and satisfies organizational requirements, this is not a finding._x000A__x000A_From a command prompt or the Start menu, using an account with System Administrator Privilege, open services.msc.  Look for: "SQL Server Reporting Services (&lt;Instance Name&gt;)"._x000A__x000A_If the "SQL Server Reporting Services (&lt;Instance Name&gt;)" service exists, this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="76">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2014</S>
      <S N="VulnID">V-67827</S>
      <S N="RuleID">SV-82317r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL4-00-016700</S>
      <S N="Title">SQL Server must have the SQL Server Integration Services (SSIS) software component removed if it is unused.</S>
      <S N="Description">Information systems are capable of providing a wide variety of functions and services. Some of the functions and services, provided by default or selected for installation by an administrator, may not be necessary to support essential organizational operations (e.g., key missions, functions)._x000A__x000A_Applications must adhere to the principles of least functionality by providing only essential capabilities.  Unused and unnecessary SQL Server components increase the number of available attack vectors.  By minimizing the services and applications installed on the system, the number of potential vulnerabilities is reduced._x000A__x000A_The SQL Server Integration Services (SSIS) software component must be removed from SQL Server if it is unused.</S>
      <S N="FixText">Either using the Start menu or via the command "control.exe", open the Windows Control Panel.  Open Programs and Features.  Double-click on Microsoft SQL Server 2014.  In the dialog box that appears, select Remove.  Wait for the Remove wizard to appear._x000A__x000A_Select '&lt;&lt; Remove shared features only &gt;&gt;'; click Next.  Note: all SQL Server 2014 instances will be affected by this action._x000A__x000A_Select Integration Services; click Next._x000A__x000A_Follow the remaining prompts, to remove SQL Server Integration Services from SQL Server.</S>
      <S N="Check">If the SQL Server service "SQL Server Integration Services 12.0" is used and satisfies organizational requirements, this is not a finding._x000A__x000A_From a command prompt or the Start menu, using an account with System Administrator Privilege, open services.msc.  Look for: "SQL Server Integration Services 12.0"._x000A__x000A_If the "SQL Server Integration Services 12.0" service exists, this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="77">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2014</S>
      <S N="VulnID">V-67829</S>
      <S N="RuleID">SV-82319r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL4-00-016800</S>
      <S N="Title">SQL Server must have the SQL Server Analysis Services (SSAS) software component removed if it is unused.</S>
      <S N="Description">Information systems are capable of providing a wide variety of functions and services. Some of the functions and services, provided by default or selected for installation by an administrator, may not be necessary to support essential organizational operations (e.g., key missions, functions)._x000A__x000A_Applications must adhere to the principles of least functionality by providing only essential capabilities.  Unused and unnecessary SQL Server components increase the number of available attack vectors.  By minimizing the services and applications installed on the system, the number of potential vulnerabilities is reduced._x000A__x000A_The SQL Server Analysis Service (SSAS) software component removed from SQL Server if it is unused.</S>
      <S N="FixText">Either using the Start menu or via the command "control.exe", open the Windows Control Panel.  Open Programs and Features.  Double-click on Microsoft SQL Server 2014.  In the dialog box that appears, select Remove.  Wait for the Remove wizard to appear._x000A__x000A_Select the relevant SQL Server instance; click Next._x000A__x000A_Select Analysis Services; click Next._x000A__x000A_Follow the remaining prompts, to remove SQL Server Analysis Services from SQL Server.</S>
      <S N="Check">If the SQL Server service "SQL Server Analysis Services (&lt;Instance Name&gt;)" is used and satisfies organizational requirements, this is not a finding._x000A__x000A_From a command prompt or the Start menu, using an account with System Administrator Privilege, open services.msc.  Look for: "SQL Server Analysis Services (&lt;Instance Name&gt;)"._x000A__x000A_If the "SQL Server Analysis Services (&lt;Instance Name&gt;)" service exists, this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="78">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2014</S>
      <S N="VulnID">V-67831</S>
      <S N="RuleID">SV-82321r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL4-00-016805</S>
      <S N="Title">SQL Server must have the SQL Server Distributed Replay Client software component removed if it is unused.</S>
      <S N="Description">Information systems are capable of providing a wide variety of functions and services. Some of the functions and services, provided by default or selected for installation by an administrator, may not be necessary to support essential organizational operations (e.g., key missions, functions)._x000A__x000A_Applications must adhere to the principles of least functionality by providing only essential capabilities.  Unused and unnecessary SQL Server components increase the number of available attack vectors.  By minimizing the services and applications installed on the system, the number of potential vulnerabilities is reduced._x000A__x000A_The SQL Server Distributed Replay Client software component must be removed if it is unused.</S>
      <S N="FixText">Either using the Start menu or via the command "control.exe", open the Windows Control Panel.  Open Programs and Features.  Double-click on Microsoft SQL Server 2014.  In the dialog box that appears, select Remove.  Wait for the Remove wizard to appear._x000A__x000A_Select a SQL Server instance; click Next.  (Note: all instances of SQL Server 2012 or higher may be affected by this action.)_x000A__x000A_Select Distributed Replay Client; click Next._x000A__x000A_Follow the remaining prompts, to remove Distributed Replay Client from SQL Server.</S>
      <S N="Check">If the SQL Server service "SQL Server Distributed Replay Client" is used and satisfies organizational requirements, this is not a finding._x000A__x000A_From a command prompt or the Start menu, using an account with System Administrator Privilege, open services.msc.  Look for: "SQL Server Distributed Replay Client"._x000A__x000A_If the "SQL Server Distributed Replay Client" service exists, this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="79">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2014</S>
      <S N="VulnID">V-67833</S>
      <S N="RuleID">SV-82323r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL4-00-016810</S>
      <S N="Title">SQL Server must have the SQL Server Distributed Replay Controller software component removed if it is unused.</S>
      <S N="Description">Information systems are capable of providing a wide variety of functions and services. Some of the functions and services, provided by default or selected for installation by an administrator, may not be necessary to support essential organizational operations (e.g., key missions, functions)._x000A__x000A_Applications must adhere to the principles of least functionality by providing only essential capabilities.  Unused and unnecessary SQL Server components increase the number of available attack vectors.  By minimizing the services and applications installed on the system, the number of potential vulnerabilities is reduced._x000A__x000A_The SQL Server Distributed Replay Controller software component must be removed if it is unused.</S>
      <S N="FixText">Either using the Start menu or via the command "control.exe", open the Windows Control Panel.  Open Programs and Features.  Double-click on Microsoft SQL Server 2014.  In the dialog box that appears, select Remove.  Wait for the Remove wizard to appear._x000A__x000A_Select '&lt;&lt; Remove shared features only &gt;&gt;'; click Next.  (Note: all instances of SQL Server 2012 or higher may be affected by this action.)_x000A__x000A_Select Distributed Replay Controller; click Next._x000A__x000A_Follow the remaining prompts, to remove Distributed Replay Controller from SQL Server.</S>
      <S N="Check">If the SQL Server service "SQL Server Distributed Replay Controller" is used and satisfies organizational requirements, this is not a finding._x000A__x000A_From a command prompt or the Start menu, using an account with System Administrator Privilege, open services.msc.  Look for: "SQL Server Distributed Replay Controller"._x000A__x000A_If the "SQL Server Distributed Replay Controller" service exists, this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="80">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2014</S>
      <S N="VulnID">V-67835</S>
      <S N="RuleID">SV-82325r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL4-00-016815</S>
      <S N="Title">SQL Server must have the Full-Text Search software component removed if it is unused.</S>
      <S N="Description">Information systems are capable of providing a wide variety of functions and services. Some of the functions and services, provided by default or selected for installation by an administrator, may not be necessary to support essential organizational operations (e.g., key missions, functions)._x000A__x000A_Applications must adhere to the principles of least functionality by providing only essential capabilities.  Unused and unnecessary SQL Server components increase the number of available attack vectors.  By minimizing the services and applications installed on the system, the number of potential vulnerabilities is reduced._x000A__x000A_The Full-Text Search software component must be removed from SQL Server if it is unused.</S>
      <S N="FixText">Either using the Start menu or via the command "control.exe", open the Windows Control Panel.  Open Programs and Features.  Double-click on Microsoft SQL Server 2014.  In the dialog box that appears, select Remove.  Wait for the Remove wizard to appear._x000A__x000A_Select the relevant SQL Server instance; click Next._x000A__x000A_Select Full-Text and Semantic Extractions for Search; click Next._x000A__x000A_Follow the remaining prompts, to remove Full-Text and Semantic Extractions for Search from SQL Server.</S>
      <S N="Check">If the SQL Server full-text search feature is used and satisfies organizational requirements, this is not a finding._x000A__x000A_From a command prompt or the Start menu, using an account with System Administrator Privilege, open services.msc.  Look for: "SQL Full-text Daemon Launcher(&lt;Instance name&gt;)"._x000A__x000A_If the "SQL Full-text Daemon Launcher(&lt;Instance name&gt;)" service exists, this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="81">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2014</S>
      <S N="VulnID">V-67837</S>
      <S N="RuleID">SV-82327r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL4-00-016820</S>
      <S N="Title">SQL Server must have the Master Data Services software component removed if it is unused.</S>
      <S N="Description">Information systems are capable of providing a wide variety of functions and services. Some of the functions and services, provided by default or selected for installation by an administrator, may not be necessary to support essential organizational operations (e.g., key missions, functions)._x000A__x000A_Applications must adhere to the principles of least functionality by providing only essential capabilities.  Unused and unnecessary SQL Server components increase the number of available attack vectors.  By minimizing the services and applications installed on the system, the number of potential vulnerabilities is reduced._x000A__x000A_The Master Data Services software component must be removed from SQL Server if it is unused.</S>
      <S N="FixText">Either using the Start menu or via the command "control.exe", open the Windows Control Panel.  Open Programs and Features.  Double-click on Microsoft SQL Server 2014.  In the dialog box that appears, select Remove.  Wait for the Remove wizard to appear._x000A__x000A_Select '&lt;&lt; Remove shared features only &gt;&gt;'; click Next.  Note: all SQL Server 2014 instances will be affected by this action.)_x000A__x000A_Select Master Data Services; click Next._x000A__x000A_Follow the remaining prompts, to remove Master Data Services from SQL Server.</S>
      <S N="Check">If the Master Data Services feature is used and satisfies organizational requirements, this is not a finding._x000A__x000A_Click on the Start button.  Navigate to &gt;&gt; Microsoft SQL Server 2014 &gt;&gt; Master Data Services._x000A__x000A_If the "Master Data Services" folder exists and contains any programs, this is a finding._x000A__x000A_In Windows Explorer, navigate to &lt;drive where SQL Server is installed&gt;:\Program Files\Microsoft SQL Server\120\Master Data Services\._x000A__x000A_If this exists and contains any files, this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="82">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2014</S>
      <S N="VulnID">V-67839</S>
      <S N="RuleID">SV-82329r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL4-00-016826</S>
      <S N="Title">SQL Server must have the SQL Server Replication software component removed if it is unused.</S>
      <S N="Description">Information systems are capable of providing a wide variety of functions and services. Some of the functions and services, provided by default or selected for installation by an administrator, may not be necessary to support essential organizational operations (e.g., key missions, functions)._x000A__x000A_Applications must adhere to the principles of least functionality by providing only essential capabilities.  Unused and unnecessary SQL Server components increase the number of available attack vectors.  By minimizing the services and applications installed on the system, the number of potential vulnerabilities is reduced._x000A__x000A_The SQL Server Replication software component must be removed from SQL Server if it is unused.</S>
      <S N="FixText">Either using the Start menu or via the command "control.exe", open the Windows Control Panel.  Open Programs and Features.  Double-click on Microsoft SQL Server 2014.  In the dialog box that appears, select Remove.  Wait for the Remove wizard to appear._x000A__x000A_Select the relevant SQL Server instance; click Next._x000A__x000A_Select SQL Server Replication; click Next._x000A__x000A_Follow the remaining prompts, to remove SQL Server Replication from SQL Server.</S>
      <S N="Check">If the SQL Server Replication feature is used and satisfies organizational requirements, this is not a finding._x000A__x000A_In SQL Server Management Studio, Object Explorer, expand  the instance.  Right-click Replication &gt;&gt; New &gt;&gt; Publication._x000A__x000A_If the Publication Wizard appears, with no error message, this is a finding._x000A__x000A_Right-click Replication &gt;&gt; New &gt;&gt; Subscription._x000A__x000A_If the Subscription Wizard appears, with no error message, this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="83">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2014</S>
      <S N="VulnID">V-67841</S>
      <S N="RuleID">SV-82331r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL4-00-016830</S>
      <S N="Title">SQL Server must have the Data Quality Client software component removed if it is unused.</S>
      <S N="Description">Information systems are capable of providing a wide variety of functions and services. Some of the functions and services, provided by default or selected for installation by an administrator, may not be necessary to support essential organizational operations (e.g., key missions, functions)._x000A__x000A_Applications must adhere to the principles of least functionality by providing only essential capabilities.  Unused and unnecessary SQL Server components increase the number of available attack vectors.  By minimizing the services and applications installed on the system, the number of potential vulnerabilities is reduced._x000A__x000A_The Data Quality Client software component must be removed from SQL Server if it is unused.</S>
      <S N="FixText">Either using the Start menu or via the command "control.exe", open the Windows Control Panel.  Open Programs and Features.  Double-click on Microsoft SQL Server 2014.  In the dialog box that appears, select Remove.  Wait for the Remove wizard to appear._x000A__x000A_Select the relevant SQL Server instance; click Next._x000A__x000A_Select Data Quality Client; click Next._x000A__x000A_Follow the remaining prompts, to remove Data Quality Client from SQL Server.</S>
      <S N="Check">If the Data Quality Client feature is used and satisfies organizational requirements, this is not a finding._x000A__x000A_In Windows Server 2008 R2 or lower, click on the Start button.  In the Start menu, navigate to All Programs &gt;&gt; Microsoft SQL Server 2014._x000A__x000A_If the "Data Quality Services" folder exists and contains the Data Quality Client program, this is a finding._x000A__x000A_In Windows Server 2012 or higher, click on the Start button.  In the Start menu, navigate to Apps &gt;&gt; Microsoft SQL Server 2014._x000A__x000A_If the Data Quality Client program is listed, this is a finding._x000A__x000A_In Windows Explorer, navigate to &lt;drive where SQL Server is installed&gt;:\Program Files (x86)\Microsoft SQL Server\120\Tools\Binn\DQ\_x000A__x000A_If this folder exists and contains the file DataQualityServices.exe, this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="84">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2014</S>
      <S N="VulnID">V-67843</S>
      <S N="RuleID">SV-82333r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL4-00-016835</S>
      <S N="Title">SQL Server must have the Data Quality Services software component removed if it is unused.</S>
      <S N="Description">Information systems are capable of providing a wide variety of functions and services. Some of the functions and services, provided by default or selected for installation by an administrator, may not be necessary to support essential organizational operations (e.g., key missions, functions)._x000A__x000A_Applications must adhere to the principles of least functionality by providing only essential capabilities.  Unused and unnecessary SQL Server components increase the number of available attack vectors.  By minimizing the services and applications installed on the system, the number of potential vulnerabilities is reduced._x000A__x000A_The Data Quality Services software component must be removed from SQL Server if it is unused.</S>
      <S N="FixText">Either using the Start menu or via the command "control.exe", open the Windows Control Panel.  Open Programs and Features.  Double-click on Microsoft SQL Server 2014.  In the dialog box that appears, select Remove.  Wait for the Remove wizard to appear._x000A__x000A_Select the relevant SQL Server instance; click Next._x000A__x000A_Select Data Quality Services; click Next._x000A__x000A_Follow the remaining prompts, to remove Data Quality Services from SQL Server._x000A__x000A_Then run the following script:_x000A_USE master;_x000A_GO_x000A_DROP DATABASE DQS_STAGING;_x000A_GO_x000A_DROP DATABASE DQS_PROJECTS;_x000A_GO_x000A_DROP DATABASE DQS_MAIN;_x000A_GO_x000A__x000A_Restart the server.</S>
      <S N="Check">If the Data Quality Services feature is used and satisfies organizational requirements, this is not a finding._x000A__x000A_Run the query:_x000A_SELECT * FROM sys.databases WHERE name in ('DQS_MAIN', 'DQS_PROJECTS', 'DQS_STAGING_DATA'); _x000A__x000A_If any rows are returned, this is a finding._x000A__x000A_In Windows Server 2008 R2 or lower, click on the Start button.  In the Start menu, navigate to All Programs &gt;&gt; Microsoft SQL Server 2014._x000A__x000A_If the "Data Quality Services" folder exists and contains the Data Quality Server Installer program, this is a finding._x000A__x000A_In Windows Server 2012 or higher, click on the Start button.  In the Start menu, navigate to Apps &gt;&gt; Microsoft SQL Server 2014._x000A__x000A_If the Data Quality Server Installer program is listed, this is a finding._x000A__x000A_In Windows Explorer, navigate to &lt;drive where SQL Server is installed&gt;:\Program Files\Microsoft SQL Server\MSSQL12.&lt;Instance name&gt;\MSSQL\Binn\_x000A__x000A_If this contains the file DQSInstaller.exe, this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="85">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2014</S>
      <S N="VulnID">V-67845</S>
      <S N="RuleID">SV-82335r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL4-00-016845</S>
      <S N="Title">SQL Server must have the Client Tools SDK software component removed if it is unused.</S>
      <S N="Description">Information systems are capable of providing a wide variety of functions and services. Some of the functions and services, provided by default or selected for installation by an administrator, may not be necessary to support essential organizational operations (e.g., key missions, functions)._x000A__x000A_Applications must adhere to the principles of least functionality by providing only essential capabilities.  Unused and unnecessary SQL Server components increase the number of available attack vectors.  By minimizing the services and applications installed on the system, the number of potential vulnerabilities is reduced._x000A__x000A_The Client Tools Software Development Kit must be removed from SQL Server if it is unused.</S>
      <S N="FixText">Either using the Start menu or via the command "control.exe", open the Windows Control Panel.  Open Programs and Features.  Double-click on Microsoft SQL Server 2014.  In the dialog box that appears, select Remove.  Wait for the Remove wizard to appear._x000A__x000A_Select '&lt;&lt; Remove shared features only &gt;&gt;'; click Next.  Note: all SQL Server 2014 instances will be affected by this action.)_x000A__x000A_Select Client Tools Software Development Kit; click Next._x000A__x000A_Follow the remaining prompts, to remove the Client Tools Software Development Kit from SQL Server.</S>
      <S N="Check">If the Client Tools Software Development Kit is used and satisfies  organizational requirements, this is not a finding._x000A__x000A_Either using the Start menu or via the command "control.exe", open the Windows Control Panel.  Open Programs and Features.  Double-click on Microsoft SQL Server 2014.  In the dialog box that appears, select Remove.  Wait for the Remove wizard to appear._x000A__x000A_Select '&lt;&lt; Remove shared features only &gt;&gt;'; click Next._x000A__x000A_If the list of shared features includes Client Tools SDK, this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="86">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2014</S>
      <S N="VulnID">V-67847</S>
      <S N="RuleID">SV-82337r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL4-00-016850</S>
      <S N="Title">SQL Server must have the Management Tools software component removed if it is unused.</S>
      <S N="Description">Information systems are capable of providing a wide variety of functions and services. Some of the functions and services, provided by default or selected for installation by an administrator, may not be necessary to support essential organizational operations (e.g., key missions, functions)._x000A__x000A_Applications must adhere to the principles of least functionality by providing only essential capabilities.  Unused and unnecessary SQL Server components increase the number of available attack vectors.  By minimizing the services and applications installed on the system, the number of potential vulnerabilities is reduced._x000A__x000A_Management Tools is an indispensable software component on any server running the SQL Server DBMS, if the database administrator logs on to the Windows server to do his/her work.  However, it is also possible to use the management tools on a separate machine and still connect to SQL Server.  If this approach is used and DBAs never need to use the Management Tools directly on the server, then the Management Tools software component must be removed from the server.</S>
      <S N="FixText">Either using the Start menu or via the command "control.exe", open the Windows Control Panel.  Open Programs and Features.  Double-click on Microsoft SQL Server 2014.  In the dialog box that appears, select Remove.  Wait for the Remove wizard to appear._x000A__x000A_Select the relevant SQL Server instance; click Next._x000A__x000A_Select Management Tools - Basic and Management Tools - Complete; click Next._x000A__x000A_Follow the remaining prompts, to remove Management Tools from SQL Server.</S>
      <S N="Check">If the SQL Server Management Tools are used and satisfy organizational requirements, this is not a finding._x000A__x000A_In Windows Server 2008 R2 or lower, click on the Start button.  In the Start menu, navigate to All Programs &gt;&gt; Microsoft SQL Server 2014._x000A__x000A_If the SQL Server Management Studio is listed, this is a finding._x000A__x000A_In Windows Server 2012 or higher, click on the Start button.  In the Start menu, navigate to Apps &gt;&gt; Microsoft SQL Server 2014._x000A__x000A_If the SQL Server Management Studio is listed, this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="87">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2014</S>
      <S N="VulnID">V-67849</S>
      <S N="RuleID">SV-82339r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL4-00-016855</S>
      <S N="Title">SQL Server must have the Filestream feature disabled if it is unused.</S>
      <S N="Description">Information systems are capable of providing a wide variety of functions and services. Some of the functions and services, provided by default or selected for installation by an administrator, may not be necessary to support essential organizational operations (e.g., key missions, functions)._x000A__x000A_Applications must adhere to the principles of least functionality by providing only essential capabilities.  Unused and unnecessary SQL Server components increase the number of available attack vectors.  By minimizing the services and applications installed on the system, the number of potential vulnerabilities is reduced._x000A__x000A_The Filestream feature must be disabled if it is unused.</S>
      <S N="FixText">Either, in SQL Server Management Studio, Object Explorer, right-click on the SQL Server instance; select Properties; examine the Filestream section._x000A__x000A_If Filestream is not required, set Filestream Access Level to "Disabled."_x000A__x000A_If Filestream is required only at the Transact-SQL query level, set Filestream Access Level to "Transact-SQL access enabled."_x000A__x000A_Restart the SQL Server instance._x000A__x000A_Or, in a query tool, run this script, substituting the correct value for &lt;Level&gt;:_x000A_     EXEC sys.sp_configure N'filestream access level', N'&lt;Level&gt;';_x000A_     GO_x000A_     RECONFIGURE WITH OVERRIDE;_x000A_     GO_x000A__x000A_The &lt;Level&gt; values are:_x000A_0 - Disabled_x000A_1 - Transact-SQL access enabled_x000A_2 - Full access enabled</S>
      <S N="Check">Determine whether Filestream is required to support the database(s) in this instance of SQL Server._x000A__x000A_Either, in SQL Server Management Studio, Object Explorer, right-click on the SQL Server instance; select Properties; examine the Filestream section._x000A__x000A_If Filestream Access Level is "Disabled", this is not a finding._x000A__x000A_If Filestream Access Level is "Transact-SQL access enabled" or "Full access enabled," and Filestream is not required, this is a finding._x000A__x000A_If Filestream Access Level is "Full access enabled," but only Transact-SQL access is required, this is a finding._x000A__x000A_Or, in a query tool, run this code:_x000A_     EXEC sys.sp_configure N'filestream access level';_x000A__x000A_Review the number in the config_value column.  If it is 0, this is not a finding._x000A__x000A_If config_value is 1 or 2, and Filestream is not required, this is a finding._x000A__x000A_If config_value is 2, but only Transact-SQL access is required, this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="88">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2014</S>
      <S N="VulnID">V-67851</S>
      <S N="RuleID">SV-82341r2_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL4-00-017000</S>
      <S N="Title">Unused database components that are integrated in SQL Server and cannot be uninstalled must be disabled.</S>
      <S N="Description">SQL Server is capable of providing a wide variety of functions and services. Some of the functions and services, provided by default, may not be necessary to support essential organizational operations (e.g., key missions, functions)._x000A__x000A_It is detrimental for applications to provide, or install by default, functionality exceeding requirements or mission objectives. Examples include, but are not limited to, installing advertising software demonstrations, or browser plug-ins not related to requirements or providing a wide array of functionality not required for every mission, but which cannot be disabled._x000A__x000A_Applications must adhere to the principles of least functionality by providing only essential capabilities._x000A__x000A_Unused and unnecessary SQL Server components increase the number of available attack vectors to SQL Server by introducing additional targets for attack. By minimizing the services and applications installed on the system, the number of potential vulnerabilities is reduced. Components of the system that are unused and cannot be uninstalled must be disabled.</S>
      <S N="FixText">If any components or features of SQL Server are required for operation of applications that will be accessing SQL Server data or configuration, include them in the system documentation._x000A__x000A_If any unused components or features of SQL Server are installed and cannot be uninstalled or removed, then disable those components or features.</S>
      <S N="Check">Review the components and features included in SQL Server and capable of being disabled (by configuration settings, permissions and privileges, etc.).  Take note of those which are enabled._x000A__x000A_Review the system documentation to verify that the enabled components or features are documented and authorized.  If any enabled components or features are not authorized, this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="89">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2014</S>
      <S N="VulnID">V-67853</S>
      <S N="RuleID">SV-82343r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL4-00-017100</S>
      <S N="Title">The SQL Server default account [sa] must be disabled.</S>
      <S N="Description">SQL Server's [sa] account has special privileges required to administer the database. The [sa] account is a well-known SQL Server account and is likely to be targeted by attackers and thus more prone to providing unauthorized access to the database._x000A__x000A_This [sa] default account is administrative and could lead to catastrophic consequences, including the complete loss of control over SQL Server._x000A__x000A_If the [sa] default account is not disabled, an attacker might be able to gain access through the account. SQL Server by default, at installation, disables the [sa] account._x000A__x000A_Some applications that run on SQL Server require the [sa] account to be enabled in order for the application to function properly. These applications that require the [sa] account to be enabled are usually legacy systems.</S>
      <S N="FixText">Modify the enabled flag of SQL Server's [sa] (system administrator) account by running the following script. If the account name has been changed per SQL4-00-010200, replace the letters "sa" in the query with the new name._x000A__x000A_USE master;_x000A_GO_x000A_ALTER LOGIN [sa] DISABLE;_x000A_GO</S>
      <S N="Check">Check SQL Server settings to determine if the [sa] (system administrator) account has been disabled by executing the following query:_x000A__x000A_USE master;_x000A_GO_x000A_SELECT name, is_disabled_x000A_FROM sys.sql_logins_x000A_WHERE principal_id = 1;_x000A_GO_x000A__x000A_Verify that the "name" column contains the current name of the [sa] database server account (see note)._x000A__x000A_If the "is_disabled" column is not set to 1, this is a finding._x000A__x000A_Note: If the [sa] account name has been changed per SQL4-00-010200, its new name should appear in the query results.</S>
    </MS>
  </Obj>
  <Obj RefId="90">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2014</S>
      <S N="VulnID">V-67855</S>
      <S N="RuleID">SV-82345r1_rule</S>
      <S N="Severity">low</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL4-00-010200</S>
      <S N="Title">SQL Server default account [sa] must have its name changed.</S>
      <S N="Description">SQL Server's [sa] account has special privileges required to administer the database. The [sa] account is a well-known SQL Server account name and is likely to be targeted by attackers, and is thus more prone to providing unauthorized access to the database._x000A__x000A_Since the SQL Server [sa] is administrative in nature, the compromise of a default account can have catastrophic consequences, including the complete loss of control over SQL Server. Since SQL Server needs for this account to exist and it should not be removed, one way to mitigate this risk is to change the [sa] account name.</S>
      <S N="FixText">Modify the SQL Server's [sa] (system administrator) account by running the following script:_x000A__x000A_USE master;_x000A_GO_x000A_ALTER LOGIN [sa] WITH NAME = &lt;new name&gt;;_x000A_GO</S>
      <S N="Check">Verify the SQL Server default [sa] (system administrator) account name has been changed by executing the following query:_x000A__x000A_USE master;_x000A_GO_x000A_SELECT *_x000A_FROM sys.sql_logins_x000A_WHERE [name] = 'sa' OR [principal_id] = 1;_x000A_GO_x000A__x000A_If the login account name "SA" or "sa" appears in the query output, this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="91">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2014</S>
      <S N="VulnID">V-67857</S>
      <S N="RuleID">SV-82347r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL4-00-017200</S>
      <S N="Title">Access to xp_cmdshell must be disabled, unless specifically required and approved.</S>
      <S N="Description">Information systems are capable of providing a wide variety of functions and services. Some of the functions and services, provided by default, may not be necessary to support essential organizational operations (e.g., key missions, functions)._x000A__x000A_It is detrimental for applications to provide, or install by default, functionality exceeding requirements or mission objectives._x000A__x000A_Applications must adhere to the principles of least functionality by providing only essential capabilities._x000A__x000A_DBMSs may spawn additional external processes to execute procedures that are defined in the DBMS, but stored in external host files (external procedures). The spawned process used to execute the external procedure may operate within a different OS security context than the DBMS and provide unauthorized access to the host system._x000A__x000A_The xp_cmdshell extended stored procedure allows execution of host executables outside the controls of database access permissions. This access may be exploited by malicious users who have compromised the integrity of the SQL Server database process to control the host operating system to perpetrate additional malicious activity.</S>
      <S N="FixText">To disable the use of xp_cmdshell, from the query prompt:_x000A_     EXEC sp_configure 'show advanced options', 1;_x000A_     GO_x000A_     RECONFIGURE;_x000A_     GO_x000A_     EXEC sp_configure 'xp_cmdshell', 0;_x000A_     GO_x000A_     RECONFIGURE;_x000A_     GO</S>
      <S N="Check">To determine if xp_cmdshell is enabled, execute the following commands:_x000A__x000A_     EXEC SP_CONFIGURE 'show advanced options', '1';_x000A_     RECONFIGURE WITH OVERRIDE;_x000A_     EXEC SP_CONFIGURE 'xp_cmdshell';_x000A__x000A_If the value of config_value is 0, this is not a finding._x000A__x000A_Review the system documentation to determine whether the use of xp_cmdshell is required and approved.  If it is not approved, this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="92">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2014</S>
      <S N="VulnID">V-67859</S>
      <S N="RuleID">SV-82349r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL4-00-017400</S>
      <S N="Title">SQL Server must be configured to prohibit or restrict the use of unauthorized network protocols.</S>
      <S N="Description">Information systems are capable of providing a wide variety of functions and services. Some of the functions and services, provided by default, may not be necessary to support essential organizational operations (e.g., key missions, functions)._x000A__x000A_Additionally, it is sometimes convenient to provide multiple services from a single component of an information system (e.g., email and web services) but doing so increases risk over limiting the services provided by any one component._x000A__x000A_To support the requirements and principles of least functionality, the application must support the organizational requirements providing only essential capabilities and limiting the use of ports, protocols, and/or services to only those required, authorized, and approved to conduct official business or to address authorized quality of life issues._x000A__x000A_Database Management Systems using ports, protocols, and services deemed unsafe are open to attack through those ports, protocols, and services. This can allow unauthorized access to the database and, through the database, to other components of the information system._x000A__x000A_For information on approved and prohibited ports, protocols, and services, see the Ports, Protocols, and Services Management (PPSM) section of the Information Assurance Support Environment (IASE) web site:  http://iase.disa.mil/ppsm/Pages/index.aspx._x000A__x000A_"Functions" in this requirement refers to system and infrastructure functionality, not to functions in mathematics and programming languages.</S>
      <S N="FixText">In SQL Server Configuration Manager, right-click on each listed protocol that is enabled but not authorized; select Disable.</S>
      <S N="Check">Open SQL Server Configuration Manager. Navigate to SQL Server Network Configuration &gt;  Protocols for &lt;instance name&gt;, where &lt;instance name&gt; is a placeholder for the SQL Server instance name._x000A__x000A_If any listed protocol is enabled but not authorized, this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="93">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2014</S>
      <S N="VulnID">V-67861</S>
      <S N="RuleID">SV-82351r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL4-00-017410</S>
      <S N="Title">SQL Server and Windows must be configured to prohibit or restrict the use of unauthorized network ports.</S>
      <S N="Description">Information systems are capable of providing a wide variety of functions and services. Some of the functions and services, provided by default, may not be necessary to support essential organizational operations (e.g., key missions, functions)._x000A__x000A_Additionally, it is sometimes convenient to provide multiple services from a single component of an information system (e.g., email and web services) but doing so increases risk over limiting the services provided by any one component._x000A__x000A_To support the requirements and principles of least functionality, the application must support the organizational requirements providing only essential capabilities and limiting the use of ports, protocols, and/or services to only those required, authorized, and approved to conduct official business or to address authorized quality of life issues._x000A__x000A_Database Management Systems using ports, protocols, and services deemed unsafe are open to attack through those ports, protocols, and services. This can allow unauthorized access to the database and, through the database, to other components of the information system._x000A__x000A_For information on approved and prohibited ports, protocols, and services, see the Ports, Protocols, and Services Management (PPSM) section of the Information Assurance Support Environment (IASE) web site:  http://iase.disa.mil/ppsm/Pages/index.aspx._x000A__x000A_"Functions" in this requirement refers to system and infrastructure functionality, not to functions in mathematics and programming languages.</S>
      <S N="FixText">Change the ports used by SQL Server to comply with PPSM guidance, or document the need for other ports, and obtain written approval.  Close ports no longer needed.</S>
      <S N="Check">Review the ports used by SQL Server._x000A__x000A_If these are in conflict with PPSM guidance, and not explained and approved in the system documentation, this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="94">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2014</S>
      <S N="VulnID">V-67863</S>
      <S N="RuleID">SV-82353r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL4-00-018400</S>
      <S N="Title">SQL Server must uniquely identify and authenticate organizational users (or processes acting on behalf of organizational users).</S>
      <S N="Description">To ensure accountability and prevent unauthorized SQL Server access, organizational users shall be identified and authenticated._x000A__x000A_Organizational users include organizational employees and individuals the organization deems to have equivalent status of employees (e.g., contractors, guest researchers, individuals from allied nations)._x000A__x000A_Users (and any processes acting on behalf of users) must be uniquely identified and authenticated for all accesses other than those accesses explicitly identified and documented by the organization, which must outline specific user actions that can be performed on SQL Server without identification or authentication.</S>
      <S N="FixText">Remove user-accessible shared accounts and use individual userids._x000A__x000A_Build/configure applications to ensure successful individual authentication prior to shared account access._x000A__x000A_Ensure each user's identity is received and used in audit data in all relevant circumstances.</S>
      <S N="Check">Review SQL Server users to determine whether shared accounts exist. (This does not include the case where SQL Server has a guest or public account that is providing access to publicly available information.)_x000A__x000A_If accounts are determined to be shared, determine if individuals are first individually authenticated._x000A__x000A_If individuals are not individually authenticated before using the shared account (e.g., by the operating system or possibly by an application making calls to the database), this is a finding._x000A__x000A_If accounts are determined to be shared, determine if they are directly accessible to end users.  If so, this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="95">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2014</S>
      <S N="VulnID">V-67867</S>
      <S N="RuleID">SV-82357r2_rule</S>
      <S N="Severity">high</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL4-00-039010</S>
      <S N="Title">Applications must obscure feedback of authentication information during the authentication process to protect the information from possible exploitation/use by unauthorized individuals.</S>
      <S N="Description">To prevent the compromise of authentication information, such as passwords and PINs, during the authentication process, the feedback from the information system must not provide any information that would allow an unauthorized user to compromise the authentication mechanism._x000A__x000A_Obfuscation of user-provided information when typed into the system is a method used in addressing this risk._x000A__x000A_For example, displaying asterisks when a user types in a password or PIN, is an example of obscuring feedback of authentication information._x000A__x000A_Database applications may allow for entry of the account name and password as a visible parameter of the application execution command. This practice must be prohibited and disabled to prevent shoulder surfing._x000A__x000A_This calls for review of applications, which will require collaboration with the application developers. It is recognized that in many cases, the database administrator (DBA) is organizationally separate from the application developers and may have limited, if any, access to source code. Nevertheless, protections of this type are so important to the secure operation of databases that they must not be ignored. At a minimum, the DBA must attempt to obtain assurances from the development organization that this issue has been addressed and must document what has been discovered.</S>
      <S N="FixText">Configure or modify applications to prohibit display of passwords in clear text.</S>
      <S N="Check">Determine whether any applications that access the database allow for entry of the account name and password, or PIN._x000A__x000A_If any do, determine whether these applications obfuscate authentication data; if they do not, this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="96">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2014</S>
      <S N="VulnID">V-67869</S>
      <S N="RuleID">SV-82359r1_rule</S>
      <S N="Severity">high</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL4-00-039020</S>
      <S N="Title">When using command-line tools such as SQLCMD in a mixed-mode authentication environment, users must use a logon method that does not expose the password.</S>
      <S N="Description">To prevent the compromise of authentication information, such as passwords and PINs, during the authentication process, the feedback from the information system must not provide any information that would allow an unauthorized user to compromise the authentication mechanism._x000A__x000A_Obfuscation of user-provided information when typed into the system is a method used in addressing this risk._x000A__x000A_For example, displaying asterisks when a user types in a password or PIN, is an example of obscuring feedback of authentication information._x000A__x000A_This requirement is applicable when mixed-mode authentication is enabled.  When this is the case, password-authenticated accounts can be created in and authenticated by SQL Server.  Other STIG requirements prohibit the use of mixed-mode authentication except when justified and approved.  This deals with the exceptions._x000A__x000A_SQLCMD and other command-line tools are part of any SQL Server installation. These tools can accept a plain-text password, but do offer alternative techniques. Since the typical user of these tools is a database administrator, the consequences of password compromise are particularly serious. Therefore, the use of plain-text passwords must be prohibited, as a matter of practice and procedure.</S>
      <S N="FixText">Where possible, change the login mode to Windows-only:_x000A_USE [master]_x000A_GO_x000A_EXEC xp_instance_regwrite N'HKEY_LOCAL_MACHINE', N'Software\Microsoft\MSSQLServer\MSSQLServer', N'LoginMode', REG_DWORD, 1;_x000A_GO_x000A__x000A_If mixed-mode authentication is necessary, then for SQLCMD, which cannot be configured not to accept a plain-text password when mixed-mode authentication is enabled, and any other essential tool with the same limitation:_x000A_1) Document the need for it, who uses it, and any relevant mitigations, and obtain AO approval._x000A_2) Train all users of the tool in the importance of not using the plain-text password option and in how to keep the password hidden.</S>
      <S N="Check">Run this query to determine whether SQL Server authentication is enabled:_x000A_EXEC master.sys.xp_loginconfig 'login mode'; _x000A__x000A_If the config_value returned is "Windows NT Authentication", this is not a finding._x000A__x000A_For SQLCMD, which cannot be configured not to accept a plain-text password, and any other essential tool with the same limitation, verify that the system documentation explains the need for the tool, who uses it, and any relevant mitigations; and that AO approval has been obtained; if not, this is a finding._x000A__x000A_Request evidence that all users of the tool are trained in the importance of not using the plain-text password option and in how to keep the password hidden; and that they adhere to this practice; if not, this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="97">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2014</S>
      <S N="VulnID">V-67871</S>
      <S N="RuleID">SV-82361r1_rule</S>
      <S N="Severity">high</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL4-00-031100</S>
      <S N="Title">SQL Server must use NIST FIPS 140-2 validated cryptographic modules for cryptographic operations.</S>
      <S N="Description">Use of weak or not validated cryptographic algorithms undermines the purposes of utilizing encryption and digital signatures to protect data.  Weak algorithms can be easily broken and not validated cryptographic modules may not implement algorithms correctly. Unapproved cryptographic modules or algorithms should not be relied on for authentication, confidentiality or integrity. Weak cryptography could allow an attacker to gain access to and modify data stored in the database as well as the administration settings of SQL Server._x000A__x000A_Applications, including DBMSs, utilizing cryptography are required to use approved NIST FIPS 140-2 validated cryptographic modules that meet the requirements of applicable federal laws, Executive Orders, directives, policies, regulations, standards, and guidance.  _x000A__x000A_Operations that require the use of cryptography include the provisioning of digital signatures, the generation and validation of cryptographic hashes, and the protection of data by storing and transmitting it in encrypted form._x000A__x000A_The security functions validated as part of FIPS 140-2 for cryptographic modules are described in FIPS 140-2 Annex A._x000A__x000A_SQL Server complies with FIPS 140-2 if Windows is configured to do so._x000A__x000A_NSA Type-X (where X=1, 2, 3, 4) products are NSA-certified, hardware-based encryption modules.</S>
      <S N="FixText">In Windows, open Administrative Tools &gt;&gt; Local Security Policy.  Expand  Local Policies &gt;&gt; Security Options.  In the right-side pane, double-click on "System cryptography: Use FIPS compliant algorithms for encryption, hashing, and signing"._x000A__x000A_In the dialog box that appears, if the radio buttons are active, click Enabled, and then click Apply.  If the radio buttons are grayed out, use Group Policy Management (on the appropriate server for this domain) to enforce the Enabled policy, and deploy it to the server(s) running SQL Server.</S>
      <S N="Check">In Windows, open Administrative Tools &gt;&gt; Local Security Policy.  Expand  Local Policies &gt;&gt; Security Options.  In the right-side pane, find "System cryptography: Use FIPS compliant algorithms for encryption, hashing, and signing". _x000A__x000A_If, in the Security Setting column, the value is "Disabled," this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="98">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2014</S>
      <S N="VulnID">V-67873</S>
      <S N="RuleID">SV-82363r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL4-00-018900</S>
      <S N="Title">SQL Server must uniquely identify and authenticate non-organizational users (or processes acting on behalf of non-organizational users).</S>
      <S N="Description">Non-organizational users include all information system users other than organizational users, which include organizational employees or individuals the organization deems to have equivalent status of employees (e.g., contractors, guest researchers, individuals from allied nations)._x000A__x000A_Non-organizational users shall be uniquely identified and authenticated for all accesses other than those accesses explicitly identified and documented by the organization when related to the use of anonymous access, such as accessing a web server._x000A__x000A_This may be accomplished by a code embedded within the userid, or via a flag or code column in a table of users, or by some other means. In any case, the user must be individually identified to, and within, SQL Server via a mapping to an individual account and not mapping to a shared account._x000A__x000A_Accordingly, a risk assessment is used in determining the authentication needs of the organization._x000A__x000A_Scalability, practicality, and security are simultaneously considered in balancing the need to ensure ease of use for access to federal information and information systems with the need to protect and adequately mitigate risk to organizational operations, organizational assets, individuals, and other organizations.</S>
      <S N="FixText">Configure SQL Server to uniquely identify and authenticate all non-organizational users who log onto the system. This likely would be done via a combination of the operating system with unique accounts and the SQL Server by ensuring mapping to individual accounts.</S>
      <S N="Check">Review documentation, SQL Server settings and authentication system settings to determine if non-organizational users are individually identified and authenticated when logging onto the system._x000A__x000A_If the documentation indicates that this is a public-facing, read-only (from the point of view of public users) database that does not require individual authentication, this is not a finding._x000A__x000A_If non-organizational users are not uniquely identified and authenticated, this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="99">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2014</S>
      <S N="VulnID">V-67875</S>
      <S N="RuleID">SV-82365r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL4-00-020500</S>
      <S N="Title">SQL Server must be configured to separate user functionality (including user interface services) from database management functionality.</S>
      <S N="Description">Information system management functionality includes functions necessary to administer databases, network components, workstations, or servers and typically requires privileged user access. _x000A__x000A_The separation of user functionality from information system management functionality is either physical or logical and is accomplished by using different computers, different central processing units, different instances of the operating system, different network addresses, combinations of these methods, or other methods, as appropriate. _x000A__x000A_An example of this type of separation is observed in web administrative interfaces that use separate authentication methods for users of any other information system resources. _x000A__x000A_This may include isolating the administrative interface on a different domain and with additional access controls._x000A__x000A_If administrative functionality or information regarding DBMS management is presented on an interface available for users, information on DBMS settings may be inadvertently made available to the user.</S>
      <S N="FixText">Establish one or more locally-defined server roles and one or more locally-defined database roles for organizing administrative permissions.  Grant administrative permissions to these roles.  Assign the appropriate administrative users to these roles.  Do not grant the roles and permissions to general users.</S>
      <S N="Check">Check SQL Server permission settings to verify that administrative functionality is kept separate from user functionality.  The views and functions provided in the supplemental file Permissions.sql can help with this review._x000A__x000A_If administrator and general user functionality are not separated either physically or logically, this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="100">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2014</S>
      <S N="VulnID">V-67879</S>
      <S N="RuleID">SV-82369r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL4-00-021500</S>
      <S N="Title">SQL Server must isolate security functions from nonsecurity functions.</S>
      <S N="Description">An isolation boundary provides access control and protects the integrity of the hardware, software, and firmware that perform security functions. _x000A__x000A_Security functions are defined as "the hardware, software, and/or firmware of the information system responsible for enforcing the system security policy and supporting the isolation of code and data on which the protection is based"._x000A__x000A_Developers and implementers can increase the assurance in security functions by employing well-defined security policy models; structured, disciplined, and rigorous hardware and software development techniques; and sound system/security engineering principles._x000A__x000A_Database Management Systems typically separate security functionality from nonsecurity functionality via separate databases or schemas.  SQL Server's [master] database and [sys] schema are examples of this.  Further granularity of access protection is provided by assigning logins and users to appropriate server roles and database roles_x000A__x000A_Database objects or code implementing security functionality should not be commingled with objects or code implementing application logic. When security and nonsecurity functionality is commingled, users who have access to nonsecurity functionality may be able to access security functionality.</S>
      <S N="FixText">Where possible, locate security-related database objects and code in a separate database, schema, or other separate security domain from database objects and code implementing application logic._x000A__x000A_In all cases, use GRANT, REVOKE, DENY, ALTER ROLE â€¦ ADD MEMBER â€¦  and/or  ALTER ROLE  â€¦. DROP MEMBER statements to add and remove permissions on server-level and database-level security-related objects to provide effective isolation.</S>
      <S N="Check">Determine application-specific security objects (lists of permissions, additional authentication information, stored procedures, application specific auditing, etc.) which are being housed inside SQL server in addition to the built-in security objects._x000A__x000A_Review permissions, both direct and indirect, on the security objects, both built-in and application-specific.  The functions and views provided in the supplemental file Permissions.sql can help with this._x000A__x000A_If the database(s), schema(s) and permissions on security objects are not organized to provide effective isolation of security functions from nonsecurity functions, this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="101">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2014</S>
      <S N="VulnID">V-67881</S>
      <S N="RuleID">SV-82371r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL4-00-031400</S>
      <S N="Title">Access to database files must be limited to relevant processes and to authorized, administrative users.</S>
      <S N="Description">Applications, including DBMSs, must prevent unauthorized and unintended information transfer via shared system resources. Permitting only DBMS processes and authorized, administrative users to have access to the files where the database resides helps ensure that those files are not shared inappropriately and are not open to backdoor access and manipulation.</S>
      <S N="FixText">Configure the permissions granted by the operating system/file system on the database files, database transaction log files, database audit log files, and database backup files so that only relevant system accounts and authorized system administrators and database administrators with a need to know are permitted to read/view these files.</S>
      <S N="Check">Review the permissions granted to users by the operating system/file system on the database files, database transaction log files, database audit log files, and database backup files. _x000A__x000A_If any user/role who is not an authorized system administrator with a need to know or database administrator with a need to know, or a system account for running DBMS processes, is permitted to read/view any of these files, this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="102">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2014</S>
      <S N="VulnID">V-67883</S>
      <S N="RuleID">SV-82373r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL4-00-031700</S>
      <S N="Title">SQL Server must automatically terminate a user session after organization-defined conditions or trigger events requiring session disconnect.</S>
      <S N="Description">This addresses the termination of user-initiated logical sessions in contrast to the termination of network connections that are associated with communications sessions (i.e., network disconnect). A logical session (for local, network, and remote access) is initiated whenever a user (or process acting on behalf of a user) accesses an organizational information system. Such user sessions can be terminated (and thus terminate user access) without terminating network sessions. _x000A__x000A_Session termination ends all processes associated with a user's logical session except those batch processes/jobs that are specifically created by the user (i.e., session owner) to continue after the session is terminated. _x000A__x000A_Conditions or trigger events requiring automatic session termination can include, for example, organization-defined periods of user inactivity, targeted responses to certain types of incidents, and time-of-day restrictions on information system use._x000A__x000A_This capability is typically reserved for specific cases where the system owner, data owner, or organization requires additional assurance.</S>
      <S N="FixText">Configure SQL Server, Windows and/or third-party tools to automatically terminate a user session after organization-defined conditions or trigger events requiring session termination.</S>
      <S N="Check">Review system documentation to obtain the organization's definition of circumstances requiring automatic session termination._x000A__x000A_If the documentation explicitly states that such termination is not required or is prohibited, this is not a finding._x000A__x000A_If the documentation requires automatic session termination, but SQL Server and Windows (or third-party tools) are not configured accordingly, this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="103">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2014</S>
      <S N="VulnID">V-67885</S>
      <S N="RuleID">SV-82375r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL4-00-032500</S>
      <S N="Title">SQL Server must prevent non-privileged users from executing privileged functionality, to include disabling, circumventing, or altering implemented security safeguards/countermeasures.</S>
      <S N="Description">Preventing non-privileged users from executing privileged functions mitigates the risk that unauthorized individuals or processes may gain unnecessary access to information or privileges. _x000A__x000A_System documentation should include a definition of the functionality considered privileged._x000A__x000A_Depending on circumstances, privileged functions can include, for example, establishing accounts, performing system integrity checks, or administering cryptographic key management activities. Non-privileged users are individuals that do not possess appropriate authorizations. Circumventing intrusion detection and prevention mechanisms or malicious code protection mechanisms are examples of privileged functions that require protection from non-privileged users._x000A__x000A_A privileged function in the DBMS/database context is any operation that modifies the structure of the database, its built-in logic, or its security settings. This would include all Data Definition Language (DDL) statements and all security-related statements. In SQL Server, it encompasses, but is not necessarily limited to: _x000A_CREATE_x000A_ALTER_x000A_DROP_x000A_GRANT_x000A_REVOKE_x000A_DENY_x000A__x000A_There may also be Data Manipulation Language (DML) statements that, subject to context, should be regarded as privileged. Possible examples include:_x000A__x000A_TRUNCATE TABLE;_x000A_DELETE, or_x000A_DELETE affecting more than n rows, for some n, or_x000A_DELETE without a WHERE clause;_x000A__x000A_UPDATE or_x000A_UPDATE affecting more than n rows, for some n, or_x000A_UPDATE without a WHERE clause;_x000A__x000A_any SELECT, INSERT, UPDATE, or DELETE to an application-defined security table executed by other than a security principal._x000A__x000A_Depending on the design of the database and associated applications, the prevention of unauthorized use of privileged functions may be achieved by means of DBMS security features, database triggers, other mechanisms, or a combination of these.</S>
      <S N="FixText">Use REVOKE and/or DENY and/or ALTER SERVER ROLE ... DROP MEMBER ... statements to align EXECUTE permissions (and any other relevant permissions) with documented requirements.</S>
      <S N="Check">Review the system documentation to obtain the definition of the SQL Server database/DBMS functionality considered privileged in the context of the system in question._x000A__x000A_Review the SQL Server security configuration and/or other means used to protect privileged functionality from unauthorized use._x000A__x000A_If the configuration does not protect all of the actions defined as privileged, this is a finding._x000A__x000A_The database permission functions and views provided in the supplemental file Permissions.sql can help with this.</S>
    </MS>
  </Obj>
  <Obj RefId="104">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2014</S>
      <S N="VulnID">V-67887</S>
      <S N="RuleID">SV-82377r2_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL4-00-032600</S>
      <S N="Title">Execution of software modules (to include stored procedures, functions, and triggers) with elevated privileges must be restricted to necessary cases only.</S>
      <S N="Description">In certain situations, to provide required functionality, a DBMS needs to execute internal logic (stored procedures, functions, triggers, etc.) and/or external code modules with elevated privileges. However, if the privileges required for execution are at a higher level than the privileges assigned to organizational users invoking the functionality applications/programs, those users are indirectly provided with greater privileges than assigned by organizations._x000A__x000A_Privilege elevation must be utilized only where necessary and protected from misuse._x000A__x000A_This calls for inspection of application source code, which will require collaboration with the application developers. It is recognized that in many cases, the database administrator (DBA) is organizationally separate from the application developers and may have limited, if any, access to source code. Nevertheless, protections of this type are so important to the secure operation of databases that they must not be ignored. At a minimum, the DBA must attempt to obtain assurances from the development organization that this issue has been addressed and must document what has been discovered.</S>
      <S N="FixText">Determine where, when, how, and by what principals/subjects elevated privilege is needed. _x000A__x000A_Modify documentation as necessary to align it with the actual need for privilege elevation._x000A__x000A_Modify the database and DBMS security configuration, stored procedures, functions, and triggers, external modules invoked by the DBMS, and the application(s) using the database, so that privilege elevation is used only as required.</S>
      <S N="Check">Review the system documentation, SQL Server instance and database security configuration, source code for stored procedures, functions, and triggers, source code of external modules invoked by the DBMS, and source code of the application(s) using the database._x000A__x000A_If elevation of DBMS privileges is utilized but not documented, this is a finding._x000A__x000A_If elevation of DBMS privileges is documented, but not implemented as described in the documentation, this is a finding._x000A__x000A_If the privilege-elevation logic can be invoked in ways other than intended, or in contexts other than intended, or by subjects/principals other than intended, this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="105">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2014</S>
      <S N="VulnID">V-67889</S>
      <S N="RuleID">SV-82379r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL4-00-032800</S>
      <S N="Title">SQL Server must utilize centralized management of the content captured in audit records generated by all components of the DBMS.</S>
      <S N="Description">Without the ability to centrally manage the content captured in the audit records, identification, troubleshooting, and correlation of suspicious behavior would be difficult and could lead to a delayed or incomplete analysis of an ongoing attack._x000A__x000A_The content captured in audit records must be managed from a central location (necessitating automation). Centralized management of audit records and logs provides for efficiency in maintenance and management of records, as well as the backup and archiving of those records. _x000A__x000A_SQL Server may write audit records to files in the file system, to other kinds of local repository, or directly to a centralized log management system. (If the Trace facility is used for auditing - this is no longer recommended, but may be in place for legacy reasons - a trace table is another possible destination.)  Whatever the method used, it must be compatible with off-loading the records to the centralized system.</S>
      <S N="FixText">Configure and/or deploy software tools to ensure that SQL Server audit records (to include traces used for audit purposes) are written directly to or systematically transferred to a centralized log management system.</S>
      <S N="Check">Review the system documentation for a description of how audit records are off-loaded and how local audit log space is managed._x000A__x000A_If the SQL Server audit records (to include traces used for audit purposes) are not written directly to or systematically transferred to a centralized log management system, this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="106">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2014</S>
      <S N="VulnID">V-67891</S>
      <S N="RuleID">SV-82381r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL4-00-033000</S>
      <S N="Title">SQL Server must allocate audit record storage capacity in accordance with organization-defined audit record storage requirements.</S>
      <S N="Description">In order to ensure sufficient storage capacity for the audit logs, SQL Server must be able to allocate audit record storage capacity. Although another requirement (SRG-APP-000515-DB-000318) mandates that audit data be off-loaded to a centralized log management system, it remains necessary to provide space on the database server to serve as a buffer against outages and capacity limits of the off-loading mechanism._x000A__x000A_In determining the capacity requirements, consider such factors as: total number of users; expected number of concurrent users during busy periods; number and type of events being monitored; types and amounts of data being captured; the frequency/speed with which audit records are off-loaded to the central log management system; and any limitations that exist on the ability to reuse the space formerly occupied by off-loaded records._x000A__x000A_As noted elsewhere in this document, SQL Server's Audit and/or Trace features can be used for auditing purposes.  This requirement applies to both.</S>
      <S N="FixText">Allocate sufficient audit storage space to support peak demand.</S>
      <S N="Check">Investigate whether there have been any incidents where the system ran out of audit log space (to include traces used for audit purposes) since the last time the space was allocated or other corrective measures were taken._x000A__x000A_If there have been, this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="107">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2014</S>
      <S N="VulnID">V-67893</S>
      <S N="RuleID">SV-82383r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL4-00-033400</S>
      <S N="Title">SQL Server, the operating system, or the storage system must provide a warning to appropriate support staff when allocated audit record storage volume reaches 75% of maximum audit record storage capacity.</S>
      <S N="Description">Organizations are required to use a central log management system, so, under normal conditions, the audit space allocated to SQL Server on its own server will not be an issue. However, space will still be required on the DBMS server for audit records in transit, and, under abnormal conditions, this could fill up. Since a requirement exists to halt processing upon audit failure, a service outage would result._x000A__x000A_As noted elsewhere in this document, SQL Server's Audit and/or Trace features can be used for auditing purposes.  This requirement applies to both._x000A__x000A_If support personnel are not notified immediately upon storage volume utilization reaching 75%, they are unable to plan for storage capacity expansion. _x000A__x000A_The monitoring and alerting may be done at the database level, the operating system level, or by specialized monitoring tools. _x000A__x000A_The appropriate support staff include, at a minimum, the ISSO and the DBA/SA.</S>
      <S N="FixText">Configure the system to notify appropriate support staff immediately upon storage volume utilization reaching 75%.</S>
      <S N="Check">Review system configuration._x000A__x000A_If appropriate support staff are not notified immediately upon storage volume utilization reaching 75%, this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="108">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2014</S>
      <S N="VulnID">V-67895</S>
      <S N="RuleID">SV-82385r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL4-00-033500</S>
      <S N="Title">SQL Server or software monitoring SQL Server must provide an immediate real-time alert to appropriate support staff of all audit failure events requiring real-time alerts.</S>
      <S N="Description">It is critical for the appropriate personnel to be aware if a system is at risk of failing to process audit logs as required. Without a real-time alert, security personnel may be unaware of an impending failure of the audit capability, and system operation may be adversely affected. _x000A__x000A_As noted elsewhere in this document, SQL Server's Audit and/or Trace features can be used for auditing purposes.  This requirement applies to both._x000A__x000A_The appropriate support staff include, at a minimum, the ISSO and the DBA/SA._x000A__x000A_Alerts provide organizations with urgent messages. Real-time alerts provide these messages immediately (i.e., the time from event detection to alert occurs in seconds or less).</S>
      <S N="FixText">Configure the system to provide an immediate real-time alert to appropriate support staff when a specified audit failure occurs.</S>
      <S N="Check">Review the system documentation to determine which audit failure events require real-time alerts._x000A__x000A_Review settings in SQL Server, Windows, and any monitoring software. If the real-time alerting that is specified in the documentation is not enabled, this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="109">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2014</S>
      <S N="VulnID">V-67897</S>
      <S N="RuleID">SV-82387r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL4-00-033600</S>
      <S N="Title">SQL Server must produce time stamps that can be mapped to Coordinated Universal Time (UTC, formerly GMT).</S>
      <S N="Description">If time stamps are not consistently applied and there is no common time reference, it is difficult to perform forensic analysis, in audit files, trace files/tables, and application data tables._x000A__x000A_Time is commonly expressed in Coordinated Universal Time (UTC), a modern continuation of Greenwich Mean Time (GMT), or local time with an offset from UTC.  SQL Server obtains the date and time from the Windows operating system.  In a normal configuration, the OS obtains them from an official time server, using Network Time Protocol (NTP).  The ultimate source is the United States Naval Observatory Master Clock._x000A__x000A_SQL Server built-in functions for retrieving current timestamps are:  (high precision) sysdatetime(), sysdatetimeoffset(), sysutcdatetime();  (lower precision) CURRENT_TIMESTAMP or getdate(), getutcdate()._x000A__x000A_Provided the operating system is synchronized with an official time server, these timestamp-retrieval functions are automatically compliant with this requirement, as are SQL Server's audit and trace capabilities.</S>
      <S N="FixText">Where possible, configure the operating system to automatic synchronize with an official time server, using NTP._x000A__x000A_Where there is reason not to implement automatic synchronization with an official time server, using NTP, document the reason, and the procedure for maintaining the correct time, and obtain AO approval.  Enforce the procedure.</S>
      <S N="Check">Verify that the Windows operating system is configured to synchronize with an official time server, using Network Time Protocol (NTP)._x000A__x000A_If it is not, and this is not documented, with justification and AO authorization, this is a finding._x000A__x000A_If the OS does not synchronize with a time server, review the procedure for maintaining accurate time on the system._x000A__x000A_If such a procedure does not exist, this is a finding._x000A__x000A_If the procedure exists, review evidence that the correct time is actually maintained._x000A__x000A_If the evidence indicates otherwise, this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="110">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2014</S>
      <S N="VulnID">V-67899</S>
      <S N="RuleID">SV-82389r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL4-00-033800</S>
      <S N="Title">SQL Server must prohibit user installation of logic modules (stored procedures, functions, triggers, views, etc.) without explicit privileged status.</S>
      <S N="Description">Allowing regular users to install software, without explicit privileges, creates the risk that untested or potentially malicious software will be installed on the system. Explicit privileges (escalated or administrative privileges) provide the regular user with explicit capabilities and control that exceed the rights of a regular user._x000A__x000A_The nature and requirements of databases will vary; so while users are not permitted to install unapproved software, there may be instances where the organization allows the user to install approved software packages such as from an approved software repository. The requirements for production servers will be more restrictive than those used for development and research._x000A__x000A_SQL Server must control software installation by users based upon what types of software installations are permitted (e.g., updates and security patches to existing software) and what types of installations are prohibited (e.g., software whose pedigree with regard to being potentially malicious is unknown or suspect) by the organization). _x000A__x000A_In the case of a database management system, this requirement covers stored procedures, functions, triggers, views, etc.</S>
      <S N="FixText">Document and obtain approval for any non-administrative users who require the ability to create, alter or replace logic modules._x000A__x000A_Implement the approved permissions. Revoke (or Deny) any unapproved permissions, and remove any unauthorized role memberships.</S>
      <S N="Check">If the SQL Server instance supports only software development, experimentation and/or developer-level testing (that is, excluding production systems, integration testing, stress testing, and user acceptance testing), this is not a finding._x000A__x000A_Review the SQL Server instance and database security settings with respect to non-administrative users' ability to create, alter, or replace logic modules, to include but not necessarily only stored procedures, functions, triggers, and views.  The database permission functions and views provided in the supplemental file Permissions.sql can help with this._x000A__x000A_If any such permissions exist and are not documented and approved, this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="111">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2014</S>
      <S N="VulnID">V-67901</S>
      <S N="RuleID">SV-82391r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL4-00-033900</S>
      <S N="Title">SQL Server and Windows must enforce access restrictions associated with changes to the configuration of the SQL Server instance or database(s).</S>
      <S N="Description">Failure to provide logical access restrictions associated with changes to configuration may have significant effects on the overall security of the system. _x000A__x000A_When dealing with access restrictions pertaining to change control, it should be noted that any changes to the hardware, software, and/or firmware components of the information system can potentially have significant effects on the overall security of the system. _x000A__x000A_Accordingly, SQL Server and Windows must allow only qualified and authorized individuals to obtain access to system components for the purposes of initiating changes, including upgrades and modifications.</S>
      <S N="FixText">Configure SQL Server to enforce access restrictions associated with changes to the configuration of the SQL Server instance and database(s).</S>
      <S N="Check">Review the security configuration of the SQL Server instance and database(s)._x000A__x000A_If unauthorized Windows users can start the SQL Server Configuration Manager or SQL Server Management Studio, this is a finding._x000A__x000A_If SQL Server does not enforce access restrictions associated with changes to the configuration of the SQL Server instance or database(s), this is a finding._x000A__x000A_- - - - - _x000A__x000A_To assist in conducting reviews of permissions, the following views and permissions are defined in the supplemental file Permissions.sql, provided with this STIG:_x000A_database_permissions_x000A_database_role_members_x000A_server_permissions_x000A_server_role_members_x000A_database_effective_permissions('&lt;database user/role name&gt;')_x000A_database_roles_of('&lt;database user/role name&gt;')_x000A_members_of_db_role('&lt;database role name&gt;')_x000A_members_of_server_role('&lt;server role name&gt;')_x000A_server_effective_permissions('&lt;server login/role name&gt;')_x000A_server_roles_of('&lt;server login/role name&gt;')_x000A__x000A_Permissions of concern in this respect include the following, and possibly others:_x000A_- any server permission except CONNECT SQL, but including CONNECT ANY DATABASE_x000A_- any database permission beginning with "CREATE" or "ALTER"_x000A_- CONTROL_x000A_- INSERT, UPDATE, DELETE, EXECUTE on locally-defined tables and procedures designed for supplemental configuration and security purposes.</S>
    </MS>
  </Obj>
  <Obj RefId="112">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2014</S>
      <S N="VulnID">V-67903</S>
      <S N="RuleID">SV-82393r3_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL4-00-034000</S>
      <S N="Title">SQL Server must produce Trace or Audit records of its enforcement of access restrictions associated with changes to the configuration of the DBMS or database(s).</S>
      <S N="Description">Without auditing the enforcement of access restrictions against changes to configuration, it would be difficult to identify attempted attacks and an audit trail would not be available for forensic investigation for after-the-fact actions. _x000A__x000A_Enforcement actions are the methods or mechanisms used to prevent unauthorized changes to configuration settings. Enforcement action methods may be as simple as denying access to a file based on the application of file permissions (access restriction). Audit items may consist of lists of actions blocked by access restrictions or changes identified after the fact._x000A__x000A_Use of SQL Server Audit is recommended.  All features of SQL Server Audit are available in the Enterprise and Developer editions of SQL Server 2014.  It is not available at the database level in other editions.  For this or legacy reasons, the instance may be using SQL Server Trace for auditing, which remains an acceptable solution for the time being.  Note, however, that Microsoft intends to remove most aspects of Trace at some point after SQL Server 2016.</S>
      <S N="FixText">Design and deploy a SQL Server Audit or Trace that captures all auditable events.  The script provided in the supplemental file Trace.sql can be used to create a trace._x000A__x000A_Where SQL Server Audit is in use, design and deploy a SQL Server Audit that captures all auditable events.  The script provided in the supplemental file Audit.sql can be used for this._x000A__x000A_Alternatively, to add the necessary data capture to an existing server audit specification, run the script:_x000A_USE [master];_x000A_GO_x000A_ALTER SERVER AUDIT SPECIFICATION &lt;server_audit_specification_name&gt; WITH (STATE = OFF);_x000A_GO_x000A_ALTER SERVER AUDIT SPECIFICATION &lt;server_audit_specification_name&gt;_x000A_ ADD (APPLICATION_ROLE_CHANGE_PASSWORD_GROUP),_x000A_ ADD (AUDIT_CHANGE_GROUP),_x000A_ ADD (BACKUP_RESTORE_GROUP),_x000A_ ADD (DATABASE_CHANGE_GROUP),_x000A_ ADD (DATABASE_OBJECT_ACCESS_GROUP),_x000A_ ADD (DATABASE_OBJECT_CHANGE_GROUP),_x000A_ ADD (DATABASE_OBJECT_OWNERSHIP_CHANGE_GROUP),_x000A_ ADD (DATABASE_OBJECT_PERMISSION_CHANGE_GROUP),_x000A_ ADD (DATABASE_OPERATION_GROUP),_x000A_ ADD (DATABASE_OWNERSHIP_CHANGE_GROUP),_x000A_ ADD (DATABASE_PERMISSION_CHANGE_GROUP),_x000A_ ADD (DATABASE_PRINCIPAL_CHANGE_GROUP),_x000A_ ADD (DATABASE_PRINCIPAL_IMPERSONATION_GROUP),_x000A_ ADD (DATABASE_ROLE_MEMBER_CHANGE_GROUP),_x000A_ ADD (DBCC_GROUP),_x000A_ ADD (LOGIN_CHANGE_PASSWORD_GROUP),_x000A_ ADD (SCHEMA_OBJECT_CHANGE_GROUP),_x000A_ ADD (SCHEMA_OBJECT_OWNERSHIP_CHANGE_GROUP),_x000A_ ADD (SCHEMA_OBJECT_PERMISSION_CHANGE_GROUP),_x000A_ ADD (SERVER_OBJECT_CHANGE_GROUP),_x000A_ ADD (SERVER_OBJECT_OWNERSHIP_CHANGE_GROUP),_x000A_ ADD (SERVER_OBJECT_PERMISSION_CHANGE_GROUP),_x000A_ ADD (SERVER_OPERATION_GROUP),_x000A_ ADD (SERVER_PERMISSION_CHANGE_GROUP),_x000A_ ADD (SERVER_PRINCIPAL_IMPERSONATION_GROUP),_x000A_ ADD (SERVER_STATE_CHANGE_GROUP),_x000A_ ADD (SERVER_ROLE_MEMBER_CHANGE_GROUP),_x000A_ ADD (TRACE_CHANGE_GROUP)_x000A_;_x000A_GO_x000A_ALTER SERVER AUDIT SPECIFICATION &lt;server_audit_specification_name&gt; WITH (STATE = ON);_x000A_GO</S>
      <S N="Check">If neither SQL Server Audit nor SQL Server Trace is in use for audit purposes, this is a finding._x000A__x000A_If SQL Server Trace is in use for audit purposes, verify that all required events are being audited.  From the query prompt:_x000A_SELECT * FROM sys.traces;_x000A_All currently defined traces for the SQL server instance will be listed._x000A__x000A_If no traces are returned, this is a finding._x000A__x000A_Determine the trace(s) being used for the auditing requirement._x000A_In the following, replace # with a trace ID being used for the auditing requirements._x000A_From the query prompt:_x000A_SELECT DISTINCT(eventid) FROM sys.fn_trace_geteventinfo(#);_x000A__x000A_The following required event IDs should be among those listed; if not, this is a finding:_x000A__x000A_102 -- Audit Statement GDR Event_x000A_103 -- Audit Object GDR Event_x000A_104 -- Audit AddLogin Event_x000A_105 -- Audit Login GDR Event_x000A_106 -- Audit Login Change Property Event_x000A_107 -- Audit Login Change Password Event_x000A_108 -- Audit Add Login to Server Role Event_x000A_109 -- Audit Add DB User Event_x000A_110 -- Audit Add Member to DB Role Event_x000A_111 -- Audit Add Role Event_x000A_112 -- Audit App Role Change Password Event_x000A_113 -- Audit Statement Permission Event_x000A_115 -- Audit Backup/Restore Event_x000A_116 -- Audit DBCC Event_x000A_117 -- Audit Change Audit Event_x000A_118 -- Audit Object Derived Permission Event_x000A_128 -- Audit Database Management Event_x000A_129 -- Audit Database Object Management Event_x000A_130 -- Audit Database Principal Management Event_x000A_131 -- Audit Schema Object Management Event_x000A_132 -- Audit Server Principal Impersonation Event_x000A_133 -- Audit Database Principal Impersonation Event_x000A_134 -- Audit Server Object Take Ownership Event_x000A_135 -- Audit Database Object Take Ownership Event_x000A_152 -- Audit Change Database Owner_x000A_153 -- Audit Schema Object Take Ownership Event_x000A_162 -- User error message_x000A_170 -- Audit Server Scope GDR Event_x000A_171 -- Audit Server Object GDR Event_x000A_172 -- Audit Database Object GDR Event_x000A_173 -- Audit Server Operation Event_x000A_175 -- Audit Server Alter Trace Event_x000A_176 -- Audit Server Object Management Event_x000A_177 -- Audit Server Principal Management Event_x000A__x000A__x000A_If SQL Server Audit is in use, proceed as follows._x000A__x000A_The basic SQL Server Audit configuration provided in the supplemental file Audit.sql uses broad, server-level audit action groups for this purpose.  SQL Server Audit's flexibility makes other techniques possible.  If an alternative technique is in use and demonstrated effective, this is not a finding._x000A__x000A_Determine the name(s) of the server audit specification(s) in use._x000A__x000A_To look at audits and audit specifications, in Management Studio's object explorer, expand _x000A_&lt;server name&gt; &gt;&gt; Security &gt;&gt; Audits_x000A_and_x000A_&lt;server name&gt; &gt;&gt; Security &gt;&gt; Server Audit Specifications._x000A_Also, _x000A_&lt;server name&gt; &gt;&gt; Databases &gt;&gt; &lt;database name&gt; &gt;&gt; Security &gt;&gt; Database Audit Specifications._x000A__x000A_Alternatively, review the contents of the system views with "audit" in their names._x000A__x000A_Run the following code to verify that all configuration-related actions are being audited:_x000A_USE [master];_x000A_GO_x000A_SELECT * FROM sys.server_audit_specification_details WHERE server_specification_id =_x000A_(SELECT server_specification_id FROM sys.server_audit_specifications WHERE [name] = '&lt;server_audit_specification_name&gt;')_x000A_AND audit_action_name IN_x000A_(_x000A_'APPLICATION_ROLE_CHANGE_PASSWORD_GROUP',_x000A_'AUDIT_CHANGE_GROUP',_x000A_'BACKUP_RESTORE_GROUP',_x000A_'DATABASE_CHANGE_GROUP',_x000A_'DATABASE_OBJECT_ACCESS_GROUP',_x000A_'DATABASE_OBJECT_CHANGE_GROUP',_x000A_'DATABASE_OBJECT_OWNERSHIP_CHANGE_GROUP',_x000A_'DATABASE_OBJECT_PERMISSION_CHANGE_GROUP',_x000A_'DATABASE_OPERATION_GROUP',_x000A_'DATABASE_OWNERSHIP_CHANGE_GROUP',_x000A_'DATABASE_PERMISSION_CHANGE_GROUP',_x000A_'DATABASE_PRINCIPAL_CHANGE_GROUP',_x000A_'DATABASE_PRINCIPAL_IMPERSONATION_GROUP',_x000A_'DATABASE_ROLE_MEMBER_CHANGE_GROUP',_x000A_'DBCC_GROUP',_x000A_'LOGIN_CHANGE_PASSWORD_GROUP',_x000A_'SCHEMA_OBJECT_CHANGE_GROUP',_x000A_'SCHEMA_OBJECT_OWNERSHIP_CHANGE_GROUP',_x000A_'SCHEMA_OBJECT_PERMISSION_CHANGE_GROUP',_x000A_'SERVER_OBJECT_CHANGE_GROUP',_x000A_'SERVER_OBJECT_OWNERSHIP_CHANGE_GROUP',_x000A_'SERVER_OBJECT_PERMISSION_CHANGE_GROUP',_x000A_'SERVER_OPERATION_GROUP',_x000A_'SERVER_PERMISSION_CHANGE_GROUP',_x000A_'SERVER_PRINCIPAL_IMPERSONATION_GROUP',_x000A_'SERVER_ROLE_MEMBER_CHANGE_GROUP',_x000A_'SERVER_STATE_CHANGE_GROUP',_x000A_'TRACE_CHANGE_GROUP'_x000A_);_x000A_GO_x000A__x000A_Examine the list produced by the query._x000A__x000A_If any of the audit action groups specified in the WHERE clause are not included in the list, this is a finding._x000A__x000A_If the audited_result column is not  "SUCCESS AND FAILURE" on every row, this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="113">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2014</S>
      <S N="VulnID">V-67905</S>
      <S N="RuleID">SV-82395r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL4-00-034200</S>
      <S N="Title">SQL Server must disable communication protocols not required for operation.</S>
      <S N="Description">Having unnecessary protocols enabled exposes the system to avoidable threats.  In a typical installation, only TCP/IP will be required.</S>
      <S N="FixText">In SQL Server Configuration Manager, right-click on each enabled protocol that is not required.  Select Disabled._x000A__x000A_Close SQL Server Configuration Manager.  Restart SQL Server.</S>
      <S N="Check">Review the system security plan to determine the communication protocols used by the SQL Server instance._x000A__x000A_Open SQL Server Configuration Manager from the Windows Start menu or by entering "SQLServerManager12.msc" in a Command Prompt window or in the Run dialog box.  Select SQL Server Network Configuration &gt;&gt; Protocols for &lt;instance name&gt;.  Review the list of protocols._x000A__x000A_If any that are not required are shown as enabled, this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="114">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2014</S>
      <S N="VulnID">V-67907</S>
      <S N="RuleID">SV-82397r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL4-00-034800</S>
      <S N="Title">SQL Server must implement and/or support cryptographic mechanisms preventing the unauthorized disclosure of organization-defined information at rest on organization-defined information system components.</S>
      <S N="Description">DBMSs handling data requiring "data at rest" protections must employ cryptographic mechanisms to prevent unauthorized disclosure and modification of the information at rest. These cryptographic mechanisms may be native to the DBMS or implemented via additional software or operating system/file system settings, as appropriate to the situation._x000A__x000A_Selection of a cryptographic mechanism is based on the need to protect the integrity of organizational information. The strength of the mechanism is commensurate with the security category and/or classification of the information. Organizations have the flexibility to either encrypt all information on storage devices (i.e., full disk encryption) or encrypt specific data structures (e.g., files, records, or fields). _x000A__x000A_The decision whether and what to encrypt rests with the data owner and is also influenced by the physical measures taken to secure the equipment and media on which the information resides.</S>
      <S N="FixText">Where full-disk encryption is required, configure Windows and/or the storage system to provide this._x000A__x000A_Where transparent data encryption (TDE) is required, deploy the necessary stack of certificates and keys, and set the Encryption Enabled to True.  For guidance from the Microsoft Developer Network on how to do this, perform a web search for "SQL Server 2014 TDE"._x000A__x000A_Where column encryption is required, deploy the necessary stack of certificates and keys, and enable encryption on the columns in question.  For guidance from the Microsoft Developer Network on how to do this, perform a web search for "SQL Server 2014 Encrypt a Column of Data".</S>
      <S N="Check">Review the system documentation to determine whether the organization has defined the information at rest that is to be protected from modification, which must include, at a minimum, PII and classified information._x000A__x000A_If no information is identified as requiring such protection, this is not a finding._x000A__x000A_Review the configuration of SQL Server, Windows, and additional software as relevant._x000A__x000A_If full-disk encryption is required, and Windows or the storage system is not configured for this, this is a finding._x000A__x000A_If database transparent data encryption (TDE) is called for, check whether it is enabled:_x000A_In SQL Server Management Studio, Object Explorer, expand the instance and right-click on the database name; select properties.  Select the Options page, State section, Encryption Enabled parameter._x000A__x000A_If the value displayed is False, this is a finding._x000A__x000A_If column encryption, done via SQL Server features, is required, review the definitions and contents of the relevant tables and columns.  _x000A__x000A_If any of the information defined as requiring cryptographic protection is not encrypted in a manner that provides the required level of protection, this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="115">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2014</S>
      <S N="VulnID">V-67909</S>
      <S N="RuleID">SV-82399r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL4-00-035000</S>
      <S N="Title">The confidentiality and integrity of information managed by SQL Server must be maintained during preparation for transmission.</S>
      <S N="Description">Information can be either unintentionally or maliciously disclosed or modified during preparation for transmission, including, for example, during aggregation, at protocol transformation points, and during packing/unpacking. These unauthorized disclosures or modifications compromise the confidentiality or integrity of the information._x000A__x000A_Use of this requirement will be limited to situations where the data owner has a strict requirement for ensuring data integrity and confidentiality is maintained at every step of the data transfer and handling process. _x000A__x000A_When transmitting data, SQL Server, associated applications, and infrastructure must leverage transmission protection mechanisms.</S>
      <S N="FixText">Implement protective measures against unauthorized disclosure and modification during preparation for transmission.</S>
      <S N="Check">If the data owner does not have a strict requirement for ensuring data integrity and confidentiality is maintained at every step of the data transfer and handling process, this is not a finding._x000A__x000A_If SQL Server, associated applications, and infrastructure do not employ protective measures against unauthorized disclosure and modification during preparation for transmission, this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="116">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2014</S>
      <S N="VulnID">V-67911</S>
      <S N="RuleID">SV-82401r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL4-00-035100</S>
      <S N="Title">The confidentiality and integrity of information managed by SQL Server must be maintained during reception.</S>
      <S N="Description">Information can be either unintentionally or maliciously disclosed or modified during reception, including, for example, during aggregation, at protocol transformation points, and during packing/unpacking. These unauthorized disclosures or modifications compromise the confidentiality or integrity of the information._x000A__x000A_This requirement applies only to those applications that are either distributed or can allow access to data nonlocally. Use of this requirement will be limited to situations where the data owner has a strict requirement for ensuring data integrity and confidentiality is maintained at every step of the data transfer and handling process. _x000A__x000A_When receiving data, SQL Server, associated applications, and infrastructure must leverage protection mechanisms.</S>
      <S N="FixText">Implement protective measures against unauthorized disclosure and modification during reception.</S>
      <S N="Check">If the data owner does not have a strict requirement for ensuring data integrity and confidentiality is maintained at every step of the data transfer and handling process, this is not a finding._x000A__x000A_If SQL Server, associated applications, and infrastructure do not employ protective measures against unauthorized disclosure and modification during reception, this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="117">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2014</S>
      <S N="VulnID">V-67913</S>
      <S N="RuleID">SV-82403r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL4-00-035400</S>
      <S N="Title">Security-relevant software updates to SQL Server must be installed within the time period directed by an authoritative source (e.g., IAVM, CTOs, DTMs, and STIGs).</S>
      <S N="Description">Security flaws with software applications, including database management systems, are discovered daily. Vendors are constantly updating and patching their products to address newly discovered security vulnerabilities. Organizations (including any contractor to the organization) are required to promptly install security-relevant software updates (e.g., patches, service packs, and hot fixes). Flaws discovered during security assessments, continuous monitoring, incident response activities, or information system error handling must also be addressed expeditiously. _x000A__x000A_Organization-defined time periods for updating security-relevant software may vary based on a variety of factors including, for example, the security category of the information system or the criticality of the update (i.e., severity of the vulnerability related to the discovered flaw). _x000A__x000A_Patch criticality, as well as system criticality, will vary. Therefore, the tactical situations regarding the patch management process will also vary. This means that the time period utilized must be a configurable parameter. Time frames for application of security-relevant software updates may be dependent upon the Information Assurance Vulnerability Management (IAVM) process._x000A__x000A_The application will be configured to check for and install security-relevant software updates within an identified time period from the availability of the update. The specific time period will be defined by an authoritative source (e.g. IAVM, CTOs, DTMs, and STIGs).</S>
      <S N="FixText">Institute and adhere to policies and procedures to ensure that patches are consistently applied to SQL Server within the time allowed.</S>
      <S N="Check">Obtain evidence that software patches are consistently applied to SQL Server within the time frame defined for each patch._x000A__x000A_If such evidence cannot be obtained, or the evidence that is obtained indicates a pattern of noncompliance, this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="118">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2014</S>
      <S N="VulnID">V-67915</S>
      <S N="RuleID">SV-82405r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL4-00-035500</S>
      <S N="Title">Software updates to SQL Server must be tested before being applied to production systems.</S>
      <S N="Description">While it is important to apply SQL Server updates in a timely manner, it is also incumbent upon the database administrator and/or system administrator to ensure that their deployment will not interfere with the operation of the database and its applications.  Other than in emergency situations, SQL Server updates must be applied to appropriately configured non-production systems, and the resulting version of SQL Server assessed for correct operation.</S>
      <S N="FixText">Institute and adhere to policies and procedures to ensure that SQL Server updates are tested prior to installation on production servers.</S>
      <S N="Check">Obtain evidence that SQL Server software updates are tested before being applied to production servers, and that any exceptions are approved by the ISSM._x000A__x000A_If such evidence cannot be obtained, or the evidence that is obtained indicates a pattern of noncompliance, this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="119">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2014</S>
      <S N="VulnID">V-67917</S>
      <S N="RuleID">SV-82407r2_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL4-00-035600</S>
      <S N="Title">SQL Server must produce Trace or Audit records when security objects are accessed.</S>
      <S N="Description">Changes to the security configuration must be tracked. _x000A__x000A_This requirement applies to situations where security data is retrieved or modified via data manipulation operations, as opposed to via SQL Server's built-in security functionality (GRANT, REVOKE, DENY, ALTER [SERVER] ROLE ... ADD/DROP MEMBER ..., etc.)._x000A__x000A_In SQL Server, types of access include, but are not necessarily limited to:_x000A_SELECT_x000A_INSERT_x000A_UPDATE_x000A_DELETE_x000A_EXECUTE_x000A__x000A_Since the system views are read-only, and the underlying tables are kept hidden by SQL Server, the Insert, Update and Delete cases are relevant only where the database includes user-defined tables to support additional security functionality._x000A__x000A_Use of SQL Server Audit is recommended.  All features of SQL Server Audit are available in the Enterprise and Developer editions of SQL Server 2014.  It is not available at the database level in other editions.  For this or legacy reasons, the instance may be using SQL Server Trace for auditing, which remains an acceptable solution for the time being.  Note, however, that Microsoft intends to remove most aspects of Trace at some point after SQL Server 2016.  Note also that Trace does not support auditing of SELECT statements, whereas Audit does.</S>
      <S N="FixText">Where SQL Server Trace is in use, create triggers to raise a custom event on each table that requires tracking of Insert-Update-Delete operations.  The examples provided in the supplemental file CustomTraceEvents.sql can serve as the basis for these._x000A__x000A_Add a block of code to the supplemental file Trace.sql for each custom event class (integers in the range 82-91; the same event class may be used for all such triggers) used in these triggers.  Execute Trace.sql._x000A__x000A_If SQL Server Audit is in use, design and deploy an Audit that captures all auditable events and data items.  The script provided in the supplemental file Audit.sql can be used as the basis for this.  Supplement the standard audit data as necessary, using Extended Events and/or triggers._x000A__x000A_Alternatively, to add the necessary data capture to an existing server audit specification, run the script:_x000A_USE [master];_x000A_GO_x000A_ALTER SERVER AUDIT SPECIFICATION &lt;server_audit_specification_name&gt; WITH (STATE = OFF);_x000A_GO_x000A_ALTER SERVER AUDIT SPECIFICATION &lt;server_audit_specification_name&gt; ADD (SCHEMA_OBJECT_ACCESS_GROUP);_x000A_GO_x000A_ALTER SERVER AUDIT SPECIFICATION &lt;server_audit_specification_name&gt; WITH (STATE = ON);_x000A_GO</S>
      <S N="Check">If there are no locally-defined security tables, functions, or procedures, this is not applicable._x000A__x000A_If neither SQL Server Audit nor SQL Server Trace is in use for audit purposes, this is a finding._x000A__x000A_Obtain the list of locally-defined security tables that require tracking of Insert-Update-Delete operations._x000A__x000A_If SQL Server Trace is in use for audit purposes, review these tables for the existence of triggers to raise a custom event on each Insert-Update-Delete operation._x000A__x000A_If such triggers are not present, this is a finding._x000A__x000A_Check to see that all required event classes are being audited.  From the query prompt:_x000A_SELECT * FROM sys.traces; _x000A__x000A_All currently defined traces for the SQL server instance will be listed._x000A__x000A_If no traces are returned, this is a finding._x000A__x000A_Determine the trace(s) being used for the auditing requirement._x000A__x000A_In the following, replace # with a trace ID being used for the auditing requirements._x000A_From the query prompt:_x000A_SELECT DISTINCT(eventid) FROM sys.fn_trace_geteventinfo(#);_x000A__x000A_The following required event IDs should be among those listed; if not, this is a finding:_x000A__x000A_42  -- SP:Starting_x000A_43  -- SP:Completed_x000A_82-91  -- User-defined Event (at least one of these; 90 is used in the supplied script)_x000A_162 -- User error message_x000A__x000A__x000A_If SQL Server Audit is in use, proceed as follows._x000A__x000A_The basic SQL Server Audit configuration provided in the supplemental file Audit.sql uses the broad, server-level audit action group SCHEMA_OBJECT_ACCESS_GROUP for this purpose.  SQL Server Audit's flexibility makes other techniques possible.  If an alternative technique is in use and demonstrated effective, this is not a finding._x000A__x000A_Determine the name(s) of the server audit specification(s) in use._x000A__x000A_To look at audits and audit specifications, in Management Studio's object explorer, expand _x000A_&lt;server name&gt; &gt;&gt; Security &gt;&gt; Audits_x000A_and_x000A_&lt;server name&gt; &gt;&gt; Security &gt;&gt; Server Audit Specifications._x000A_Also, _x000A_&lt;server name&gt; &gt;&gt; Databases &gt;&gt; &lt;database name&gt; &gt;&gt; Security &gt;&gt; Database Audit Specifications._x000A__x000A_Alternatively, review the contents of the system views with "audit" in their names._x000A__x000A_Run the following to verify that all SELECT, INSERT, UPDATE, and DELETE actions on locally-defined permissions tables, and EXECUTE actions on locally-defined permissions functions and procedures, are being audited:_x000A__x000A_USE [master];_x000A_GO_x000A_SELECT * FROM sys.server_audit_specification_details WHERE server_specification_id =_x000A_(SELECT server_specification_id FROM sys.server_audit_specifications WHERE [name] = '&lt;server_audit_specification_name&gt;')_x000A_AND audit_action_name = 'SCHEMA_OBJECT_ACCESS_GROUP';_x000A__x000A_If no row is returned, this is a finding._x000A__x000A_If the audited_result column is not "SUCCESS" or "SUCCESS AND FAILURE", this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="120">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2014</S>
      <S N="VulnID">V-67919</S>
      <S N="RuleID">SV-82409r2_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL4-00-035700</S>
      <S N="Title">SQL Server must produce Trace or Audit records when unsuccessful attempts to access security objects occur.</S>
      <S N="Description">Changes to the security configuration must be tracked.  To aid in diagnosis, it is necessary to keep track of failed attempts in addition to the successful ones._x000A__x000A_This requirement applies to situations where security data is retrieved or modified via data manipulation operations, as opposed to via SQL Server's built-in security functionality (GRANT, REVOKE, DENY, ALTER [SERVER] ROLE ... ADD/DROP MEMBER ..., etc.)._x000A__x000A_In SQL Server, types of access include, but are not necessarily limited to:_x000A_SELECT_x000A_INSERT_x000A_UPDATE_x000A_DELETE_x000A_EXECUTE_x000A__x000A_Since the system views are read-only, and the underlying tables are kept hidden by SQL Server, the Insert, Update and Delete cases are relevant only where the database includes user-defined tables to support additional security functionality._x000A__x000A_Use of SQL Server Audit is recommended.  All features of SQL Server Audit are available in the Enterprise and Developer editions of SQL Server 2014.  It is not available at the database level in other editions.  For this or legacy reasons, the instance may be using SQL Server Trace for auditing, which remains an acceptable solution for the time being.  Note, however, that Microsoft intends to remove most aspects of Trace at some point after SQL Server 2016.  Note also that Trace does not support auditing of SELECT statements, whereas Audit does._x000A__x000A_Use of SQL Server Audit's SCHEMA_OBJECT_ACCESS_GROUP causes capture of all accesses, successful and otherwise, to all schema-scoped objects.  The [Succeeded] column in the audit output indicates the success or failure of the attempted action.  Be aware, however, that it may report True in some cases where one would intuitively expect False.  For example, SELECT 1/0 FROM SYS.ALL_OBJECTS will appear in the audit trail as successful, if the user has permission to perform that action, even though it contains an invalid expression.  Some other actions that one would consider failures (such as selecting from a table that does not exist) may not appear at all.</S>
      <S N="FixText">Where SQL Server Trace is in use, create triggers to raise a custom event on each table that requires tracking of Insert-Update-Delete operations.  The examples provided in the supplemental file CustomTraceEvents.sql can serve as the basis for these.  _x000A__x000A_Add a block of code to the supplemental file Trace.sql for each custom event class (integers in the range 82-91; the same event class may be used for all such triggers) used in these triggers.  Execute Trace.sql._x000A__x000A_If SQL Server Audit is in use, design and deploy an Audit that captures all auditable events and data items.  The script provided in the supplemental file Audit.sql can be used as the basis for this.  Supplement the standard audit data as necessary, using Extended Events and/or triggers._x000A__x000A_Alternatively, to add the necessary data capture to an existing server audit specification, run the script:_x000A_USE [master];_x000A_GO_x000A_ALTER SERVER AUDIT SPECIFICATION &lt;server_audit_specification_name&gt; WITH (STATE = OFF);_x000A_GO_x000A_ALTER SERVER AUDIT SPECIFICATION &lt;server_audit_specification_name&gt; ADD (SCHEMA_OBJECT_ACCESS_GROUP);_x000A_GO_x000A_ALTER SERVER AUDIT SPECIFICATION &lt;server_audit_specification_name&gt; WITH (STATE = ON);_x000A_GO</S>
      <S N="Check">If there are no locally-defined security tables, functions, or procedures, this is not applicable (NA)._x000A__x000A_If neither SQL Server Audit nor SQL Server Trace is in use for audit purposes, this is a finding._x000A__x000A_Obtain the list of locally-defined security tables that require tracking of Insert-Update-Delete operations.  _x000A__x000A_If SQL Server Trace is in use for audit purposes, review these tables for the existence of triggers to raise a custom event on each Insert-Update-Delete operation._x000A__x000A_If such triggers are not present, this is a finding._x000A__x000A_Check to see that all required event classes are being audited.  From the query prompt:_x000A_SELECT * FROM sys.traces; _x000A__x000A_All currently defined traces for the SQL server instance will be listed._x000A__x000A_If no traces are returned, this is a finding._x000A__x000A_Determine the trace(s) being used for the auditing requirement._x000A_In the following, replace # with a trace ID being used for the auditing requirements._x000A_From the query prompt:_x000A_SELECT DISTINCT(eventid) FROM sys.fn_trace_geteventinfo(#);_x000A__x000A_The following required event IDs should be among those listed; if not, this is a finding:_x000A__x000A_42  -- SP:Starting_x000A_43  -- SP:Completed_x000A_82-91  -- User-defined Event (at least one of these; 90 is used in the supplied script)_x000A_162 -- User error message_x000A__x000A__x000A_If SQL Server Audit is in use, proceed as follows._x000A__x000A_The basic SQL Server Audit configuration provided in the supplemental file Audit.sql uses the broad, server-level audit action group SCHEMA_OBJECT_ACCESS_GROUP for this purpose.  SQL Server Audit's flexibility makes other techniques possible.  If an alternative technique is in use and demonstrated effective, this is not a finding._x000A__x000A_Determine the name(s) of the server audit specification(s) in use._x000A__x000A_To look at audits and audit specifications, in Management Studio's object explorer, expand _x000A_&lt;server name&gt; &gt;&gt; Security &gt;&gt; Audits_x000A_and_x000A_&lt;server name&gt; &gt;&gt; Security &gt;&gt; Server Audit Specifications._x000A_Also, _x000A_&lt;server name&gt; &gt;&gt; Databases &gt;&gt; &lt;database name&gt; &gt;&gt; Security &gt;&gt; Database Audit Specifications._x000A__x000A_Alternatively, review the contents of the system views with "audit" in their names._x000A__x000A_Run the following to verify that all SELECT, INSERT, UPDATE, and DELETE actions on locally-defined permissions tables, and EXECUTE actions on locally-defined permissions functions and procedures, are being audited:_x000A__x000A_USE [master];_x000A_GO_x000A_SELECT * FROM sys.server_audit_specification_details WHERE server_specification_id =_x000A_(SELECT server_specification_id FROM sys.server_audit_specifications WHERE [name] = '&lt;server_audit_specification_name&gt;')_x000A_AND audit_action_name = 'SCHEMA_OBJECT_ACCESS_GROUP';_x000A__x000A_If no row is returned, this is a finding._x000A__x000A_If the audited_result column is not "FAILURE" or "SUCCESS AND FAILURE", this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="121">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2014</S>
      <S N="VulnID">V-67921</S>
      <S N="RuleID">SV-82411r2_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL4-00-036000</S>
      <S N="Title">SQL Server must generate Trace or Audit records when privileges/permissions are added.</S>
      <S N="Description">Changes in the permissions, privileges, and roles granted to users and roles must be tracked. Without an audit trail, unauthorized elevation or restriction of privileges could go undetected. Elevated privileges give users access to information and functionality that they should not have; restricted privileges wrongly deny access to authorized users._x000A__x000A_In SQL Server, adding permissions is typically done via the GRANT command, or, in the negative, DENY; or with the ALTER SERVER ROLE . . . ADD MEMBER . . .,  and/or  ALTER ROLE . . . ADD MEMBER . . . commands.  Native SQL Server security functionality may be supplemented with application-specific tables and logic, in which case the following actions on these tables and procedures/triggers/functions are also relevant:_x000A_INSERT_x000A_UPDATE (in cases where more than one permission can be represented in a single row)_x000A_EXECUTE_x000A__x000A_Use of SQL Server Audit is recommended.  All features of SQL Server Audit are available in the Enterprise and Developer editions of SQL Server 2014.  It is not available at the database level in other editions.  For this or legacy reasons, the instance may be using SQL Server Trace for auditing, which remains an acceptable solution for the time being.  Note, however, that Microsoft intends to remove most aspects of Trace at some point after SQL Server 2016.</S>
      <S N="FixText">Where SQL Server Trace is in use, define and enable a trace that captures all auditable events.  The script provided in the supplemental file Trace.sql can be used to do this._x000A__x000A_Create triggers to raise a custom event on each locally-defined security table that requires tracking of Insert-Update-Delete operations.  The examples provided in the supplemental file CustomTraceEvents.sql can serve as the basis for these._x000A__x000A_Add blocks of code to Trace.sql for each custom event class (integers in the range 82-91; the same event class may be used for all such triggers) used in these triggers.  Execute Trace.sql._x000A__x000A_Where SQL Server Audit is in use, design and deploy a SQL Server Audit that captures all auditable events.  The script provided in the supplemental file Audit.sql can be used for this._x000A__x000A_Alternatively, to add the necessary data capture to an existing server audit specification, run the script:_x000A_USE [master];_x000A_GO_x000A_ALTER SERVER AUDIT SPECIFICATION &lt;server_audit_specification_name&gt; WITH (STATE = OFF);_x000A_GO_x000A_ALTER SERVER AUDIT SPECIFICATION &lt;server_audit_specification_name&gt;_x000A_ ADD (DATABASE_OBJECT_OWNERSHIP_CHANGE_GROUP),_x000A_ ADD (DATABASE_OBJECT_PERMISSION_CHANGE_GROUP),_x000A_ ADD (DATABASE_OWNERSHIP_CHANGE_GROUP),_x000A_ ADD (DATABASE_PERMISSION_CHANGE_GROUP),_x000A_ ADD (DATABASE_ROLE_MEMBER_CHANGE_GROUP),_x000A_ ADD (SCHEMA_OBJECT_OWNERSHIP_CHANGE_GROUP),_x000A_ ADD (SCHEMA_OBJECT_PERMISSION_CHANGE_GROUP),_x000A_ ADD (SERVER_OBJECT_OWNERSHIP_CHANGE_GROUP),_x000A_ ADD (SERVER_OBJECT_PERMISSION_CHANGE_GROUP),_x000A_ ADD (SERVER_PERMISSION_CHANGE_GROUP),_x000A_ ADD (SERVER_ROLE_MEMBER_CHANGE_GROUP)_x000A_;_x000A_GO_x000A_ALTER SERVER AUDIT SPECIFICATION &lt;server_audit_specification_name&gt; WITH (STATE = ON);_x000A_GO</S>
      <S N="Check">If neither SQL Server Audit nor SQL Server Trace is in use for audit purposes, this is a finding._x000A__x000A_Obtain the list of locally-defined security tables, procedures and functions (if any) that require tracking._x000A__x000A_If SQL Server Trace is in use for audit purposes, verify that all required events are being audited.  From the query prompt:_x000A_SELECT * FROM sys.traces;_x000A__x000A_All currently defined traces for the SQL server instance will be listed._x000A__x000A_If no traces are returned, this is a finding._x000A__x000A_Determine the trace(s) being used for the auditing requirement._x000A_In the following, replace # with a trace ID being used for the auditing requirements._x000A_From the query prompt:_x000A_SELECT DISTINCT(eventid) FROM sys.fn_trace_geteventinfo(#);_x000A__x000A_The following required event IDs should all be among those listed; if not, this is a finding:_x000A__x000A_42  -- SP:Starting_x000A_43  -- SP:Completed_x000A_82-91  -- User-defined Event (required only where there are locally-defined security tables or procedures)_x000A_102  -- Audit Database Scope GDR_x000A_103  -- Audit Object GDR Event_x000A_104  -- Audit AddLogin Event_x000A_105  -- Audit Login GDR Event_x000A_108  -- Audit Add Login to Server Role Event_x000A_109  -- Audit Add DB User Event_x000A_110  -- Audit Add Member to DB Role Event_x000A_111  -- Audit Add Role Event_x000A_162  -- User error message_x000A_170  -- Audit Server Scope GDR Event_x000A_171  -- Audit Server Object GDR Event_x000A_172  -- Audit Database Object GDR Event_x000A_173  -- Audit Server Operation Event_x000A_177  -- Audit Server Principal Management Event_x000A__x000A_Review the locally-defined security tables (if any) for the existence of triggers to raise a custom event on each Insert-Update-Delete operation._x000A__x000A_If such triggers are not present, this is a finding._x000A__x000A__x000A_If SQL Server Audit is in use, proceed as follows._x000A__x000A_The basic SQL Server Audit configuration provided in the supplemental file Audit.sql uses broad, server-level audit action groups for this purpose.  SQL Server Audit's flexibility makes other techniques possible.  If an alternative technique is in use and demonstrated effective, this is not a finding._x000A__x000A_Determine the name(s) of the server audit specification(s) in use._x000A__x000A_To look at audits and audit specifications, in Management Studio's object explorer, expand _x000A_&lt;server name&gt; &gt;&gt; Security &gt;&gt; Audits_x000A_and_x000A_&lt;server name&gt; &gt;&gt; Security &gt;&gt; Server Audit Specifications._x000A_Also, _x000A_&lt;server name&gt; &gt;&gt; Databases &gt;&gt; &lt;database name&gt; &gt;&gt; Security &gt;&gt; Database Audit Specifications._x000A__x000A_Alternatively, review the contents of the system views with "audit" in their names._x000A__x000A_Run the following code to verify that all GRANT, ALTER SERVER ROLE . . . ADD MEMBER . . .,  and/or  ALTER ROLE . . . ADD MEMBER . . .  actions, all INSERT and UPDATE actions on any locally-defined permissions tables, and all EXECUTE actions on any system or locally-defined permissions-related procedures and functions, are being audited:_x000A_USE [master];_x000A_GO_x000A_SELECT * FROM sys.server_audit_specification_details WHERE server_specification_id =_x000A_(SELECT server_specification_id FROM sys.server_audit_specifications WHERE [name] = '&lt;server_audit_specification_name&gt;')_x000A_AND audit_action_name IN_x000A_(_x000A_'DATABASE_OBJECT_OWNERSHIP_CHANGE_GROUP',_x000A_'DATABASE_OBJECT_PERMISSION_CHANGE_GROUP',_x000A_'DATABASE_OWNERSHIP_CHANGE_GROUP',_x000A_'DATABASE_PERMISSION_CHANGE_GROUP',_x000A_'DATABASE_ROLE_MEMBER_CHANGE_GROUP',_x000A_'SCHEMA_OBJECT_OWNERSHIP_CHANGE_GROUP',_x000A_'SCHEMA_OBJECT_PERMISSION_CHANGE_GROUP',_x000A_'SERVER_OBJECT_OWNERSHIP_CHANGE_GROUP',_x000A_'SERVER_OBJECT_PERMISSION_CHANGE_GROUP',_x000A_'SERVER_PERMISSION_CHANGE_GROUP',_x000A_'SERVER_ROLE_MEMBER_CHANGE_GROUP',_x000A_'SCHEMA_OBJECT_ACCESS_GROUP'_x000A_);_x000A_GO_x000A__x000A_Examine the list produced by the query._x000A__x000A_If any locally-defined permissions tables, procedures, or functions exist, and the list does not include the audit action group SCHEMA_OBJECT_ACCESS_GROUP, this is a finding._x000A__x000A_If any of the other audit action groups specified in the WHERE clause are not included in the list, this is a finding._x000A__x000A_If the audited_result column is not "SUCCESS" or "SUCCESS AND FAILURE" on every row, this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="122">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2014</S>
      <S N="VulnID">V-67923</S>
      <S N="RuleID">SV-82413r2_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL4-00-036100</S>
      <S N="Title">SQL Server must generate Trace or Audit records when unsuccessful attempts to add privileges/permissions occur.</S>
      <S N="Description">Failed attempts to change the permissions, privileges, and roles granted to users and roles must be tracked. Without an audit trail, unauthorized attempts to elevate or restrict privileges could go undetected. _x000A__x000A_In SQL Server, adding permissions is typically done via the GRANT command, or, in the negative, DENY; or with the ALTER SERVER ROLE . . . ADD MEMBER . . .,  and/or  ALTER ROLE . . . ADD MEMBER . . . commands.  Native security functionality may be supplemented with application-specific tables and logic, in which case the following actions on these tables and procedures/triggers/functions are also relevant:_x000A_INSERT_x000A_UPDATE_x000A_EXECUTE_x000A__x000A_To aid in diagnosis, it is necessary to keep track of failed attempts in addition to the successful ones._x000A__x000A_Use of SQL Server Audit is recommended.  All features of SQL Server Audit are available in the Enterprise and Developer editions of SQL Server 2014.  It is not available at the database level in other editions.  For this or legacy reasons, the instance may be using SQL Server Trace for auditing, which remains an acceptable solution for the time being.  Note, however, that Microsoft intends to remove most aspects of Trace at some point after SQL Server 2016.</S>
      <S N="FixText">Where SQL Server Trace is in use, define and enable a trace that captures all auditable events.  The script provided in the supplemental file Trace.sql can be used to do this._x000A__x000A_Create triggers to raise a custom event on each locally-defined security table that requires tracking of Insert-Update-Delete operations.  The examples provided in the supplemental file CustomTraceEvents.sql can serve as the basis for these._x000A__x000A_Add blocks of code to Trace.sql for each custom event class (integers in the range 82-91; the same event class may be used for all such triggers) used in these triggers.  Execute Trace.sql._x000A__x000A_Where SQL Server Audit is in use, design and deploy a SQL Server Audit that captures all auditable events.  The script provided in the supplemental file Audit.sql can be used for this._x000A__x000A_Alternatively, to add the necessary data capture to an existing server audit specification, run the script:_x000A_USE [master];_x000A_GO_x000A_ALTER SERVER AUDIT SPECIFICATION &lt;server_audit_specification_name&gt; WITH (STATE = OFF);_x000A_GO_x000A_ALTER SERVER AUDIT SPECIFICATION &lt;server_audit_specification_name&gt;_x000A_ ADD (DATABASE_OBJECT_OWNERSHIP_CHANGE_GROUP),_x000A_ ADD (DATABASE_OBJECT_PERMISSION_CHANGE_GROUP),_x000A_ ADD (DATABASE_OWNERSHIP_CHANGE_GROUP),_x000A_ ADD (DATABASE_PERMISSION_CHANGE_GROUP),_x000A_ ADD (DATABASE_ROLE_MEMBER_CHANGE_GROUP),_x000A_ ADD (SCHEMA_OBJECT_OWNERSHIP_CHANGE_GROUP),_x000A_ ADD (SCHEMA_OBJECT_PERMISSION_CHANGE_GROUP),_x000A_ ADD (SERVER_OBJECT_OWNERSHIP_CHANGE_GROUP),_x000A_ ADD (SERVER_OBJECT_PERMISSION_CHANGE_GROUP),_x000A_ ADD (SERVER_PERMISSION_CHANGE_GROUP),_x000A_ ADD (SERVER_ROLE_MEMBER_CHANGE_GROUP)_x000A_;_x000A_GO_x000A_ALTER SERVER AUDIT SPECIFICATION &lt;server_audit_specification_name&gt; WITH (STATE = ON);_x000A_GO</S>
      <S N="Check">If neither SQL Server Audit nor SQL Server Trace is in use for audit purposes, this is a finding._x000A__x000A_Obtain the list of locally-defined security tables, procedures and functions (if any) that require tracking._x000A__x000A_If SQL Server Trace is in use for audit purposes, verify that all required events are being audited.  From the query prompt:_x000A_SELECT * FROM sys.traces; _x000A__x000A_All currently defined traces for the SQL server instance will be listed._x000A__x000A_If no traces are returned, this is a finding._x000A__x000A_Determine the trace(s) being used for the auditing requirement._x000A_In the following, replace # with a trace ID being used for the auditing requirements._x000A_From the query prompt:_x000A_SELECT DISTINCT(eventid) FROM sys.fn_trace_geteventinfo(#);_x000A__x000A_The following required event IDs should all be among those listed; if not, this is a finding:_x000A__x000A_42  -- SP:Starting_x000A_43  -- SP:Completed_x000A_82-91  -- User-defined Event (required only where there are locally-defined security tables or procedures)_x000A_102  -- Audit Database Scope GDR_x000A_103  -- Audit Object GDR Event_x000A_104  -- Audit AddLogin Event_x000A_105  -- Audit Login GDR Event_x000A_108  -- Audit Add Login to Server Role Event_x000A_109  -- Audit Add DB User Event_x000A_110  -- Audit Add Member to DB Role Event_x000A_111  -- Audit Add Role Event_x000A_162  -- User error message_x000A_170  -- Audit Server Scope GDR Event_x000A_171  -- Audit Server Object GDR Event_x000A_172  -- Audit Database Object GDR Event_x000A_173  -- Audit Server Operation Event_x000A_177  -- Audit Server Principal Management Event_x000A__x000A_Review the locally-defined security tables (if any) for the existence of triggers to raise a custom event on each Insert-Update-Delete operation._x000A__x000A_If such triggers are not present, this is a finding._x000A__x000A__x000A_If SQL Server Audit is in use, proceed as follows._x000A__x000A_The basic SQL Server Audit configuration provided in the supplemental file Audit.sql uses broad, server-level audit action groups for this purpose.  SQL Server Audit's flexibility makes other techniques possible.  If an alternative technique is in use and demonstrated effective, this is not a finding._x000A__x000A_Determine the name(s) of the server audit specification(s) in use._x000A__x000A_To look at audits and audit specifications, in Management Studio's object explorer, expand _x000A_&lt;server name&gt; &gt;&gt; Security &gt;&gt; Audits_x000A_and_x000A_&lt;server name&gt; &gt;&gt; Security &gt;&gt; Server Audit Specifications._x000A_Also, _x000A_&lt;server name&gt; &gt;&gt; Databases &gt;&gt; &lt;database name&gt; &gt;&gt; Security &gt;&gt; Database Audit Specifications._x000A__x000A_Alternatively, review the contents of the system views with "audit" in their names._x000A__x000A_Run the following code to verify that all GRANT, ALTER SERVER ROLE . . . ADD MEMBER . . .,  and/or  ALTER ROLE . . . ADD MEMBER . . .  actions, all INSERT and UPDATE actions on any locally-defined permissions tables, and all EXECUTE actions on any system or locally-defined permissions-related procedures and functions, are being audited:_x000A_USE [master];_x000A_GO_x000A_SELECT * FROM sys.server_audit_specification_details WHERE server_specification_id =_x000A_(SELECT server_specification_id FROM sys.server_audit_specifications WHERE [name] = '&lt;server_audit_specification_name&gt;')_x000A_AND audit_action_name IN_x000A_(_x000A_'DATABASE_OBJECT_OWNERSHIP_CHANGE_GROUP',_x000A_'DATABASE_OBJECT_PERMISSION_CHANGE_GROUP',_x000A_'DATABASE_OWNERSHIP_CHANGE_GROUP',_x000A_'DATABASE_PERMISSION_CHANGE_GROUP',_x000A_'DATABASE_ROLE_MEMBER_CHANGE_GROUP',_x000A_'SCHEMA_OBJECT_OWNERSHIP_CHANGE_GROUP',_x000A_'SCHEMA_OBJECT_PERMISSION_CHANGE_GROUP',_x000A_'SERVER_OBJECT_OWNERSHIP_CHANGE_GROUP',_x000A_'SERVER_OBJECT_PERMISSION_CHANGE_GROUP',_x000A_'SERVER_PERMISSION_CHANGE_GROUP',_x000A_'SERVER_ROLE_MEMBER_CHANGE_GROUP',_x000A_'SCHEMA_OBJECT_ACCESS_GROUP'_x000A_);_x000A_GO_x000A__x000A_Examine the list produced by the query._x000A__x000A_If any locally-defined permissions tables, procedures, or functions exist, and the list does not include the audit action group SCHEMA_OBJECT_ACCESS_GROUP, this is a finding._x000A__x000A_If any of the other audit action groups specified in the WHERE clause are not included in the list, this is a finding._x000A__x000A_If the audited_result column is not "FAILURE" or "SUCCESS AND FAILURE" on every row, this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="123">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2014</S>
      <S N="VulnID">V-67925</S>
      <S N="RuleID">SV-82415r2_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL4-00-036900</S>
      <S N="Title">SQL Server must generate Trace or Audit records when privileges/permissions are deleted.</S>
      <S N="Description">Changes in the permissions, privileges, and roles granted to users and roles must be tracked. Without an audit trail, unauthorized elevation or restriction of privileges could go undetected. Elevated privileges give users access to information and functionality that they should not have; restricted privileges wrongly deny access to authorized users._x000A__x000A_In SQL Server, deleting permissions is typically done via the REVOKE or DENY command; or with the ALTER SERVER ROLE . . . DROP MEMBER . . . and/or ALTER ROLE . . . DROP MEMBER . . . statements.  However, native SQL Server security functionality may be supplemented with application-specific tables and logic, in which case the following actions on these tables and procedures/triggers/functions are also relevant:_x000A_DELETE_x000A_EXECUTE_x000A__x000A_Use of SQL Server Audit is recommended.  All features of SQL Server Audit are available in the Enterprise and Developer editions of SQL Server 2014.  It is not available at the database level in other editions.  For this or legacy reasons, the instance may be using SQL Server Trace for auditing, which remains an acceptable solution for the time being.  Note, however, that Microsoft intends to remove most aspects of Trace at some point after SQL Server 2016.</S>
      <S N="FixText">Where SQL Server Trace is in use, define and enable a trace that captures all auditable events.  The script provided in the supplemental file Trace.sql can be used to do this._x000A__x000A_Add blocks of code to Trace.sql for each custom event class (integers in the range 82-91; the same event class may be used for all such triggers) used in these triggers.  _x000A__x000A_Create triggers to raise a custom event on each locally-defined security table that requires tracking of Insert-Update-Delete operations.  The examples provided in the supplemental file CustomTraceEvents.sql can serve as the basis for these.  _x000A__x000A_Execute Trace.sql._x000A__x000A_Where SQL Server Audit is in use, design and deploy a SQL Server Audit that captures all auditable events.  The script provided in the supplemental file Audit.sql can be used for this._x000A__x000A_Alternatively, to add the necessary data capture to an existing server audit specification, run the script:_x000A_USE [master];_x000A_GO_x000A_ALTER SERVER AUDIT SPECIFICATION &lt;server_audit_specification_name&gt; WITH (STATE = OFF);_x000A_GO_x000A_ALTER SERVER AUDIT SPECIFICATION &lt;server_audit_specification_name&gt; ADD (SCHEMA_OBJECT_ACCESS_GROUP);_x000A_GO_x000A_ALTER SERVER AUDIT SPECIFICATION &lt;server_audit_specification_name&gt; WITH (STATE = ON);_x000A_GO</S>
      <S N="Check">If neither SQL Server Audit nor SQL Server Trace is in use for audit purposes, this is a finding._x000A__x000A_Obtain the list of locally-defined security tables (if any) that require tracking of Insert-Update-Delete operations._x000A__x000A_If SQL Server Trace is in use for audit purposes, review these tables for the existence of triggers to raise a custom event on each Insert-Update-Delete operation._x000A__x000A_If such triggers are not present, this is a finding._x000A__x000A_Check to see that all required events are being audited.  From the query prompt:_x000A_SELECT * FROM sys.traces; _x000A__x000A_All currently defined traces for the SQL server instance will be listed._x000A__x000A_If no traces are returned, this is a finding._x000A__x000A_Determine the trace(s) being used for the auditing requirement._x000A_In the following, replace # with a trace ID being used for the auditing requirements._x000A_From the query prompt:_x000A_SELECT DISTINCT(eventid) FROM sys.fn_trace_geteventinfo(#);_x000A__x000A_The following required event IDs should all be among those listed; if not, this is a finding:_x000A__x000A_42  -- SP:Starting_x000A_43  -- SP:Completed_x000A_82-91  -- User-defined Event (required only where there are locally-defined security tables or procedures)_x000A_102  -- Audit Database Scope GDR_x000A_103  -- Audit Object GDR Event_x000A_104  -- Audit AddLogin Event_x000A_105  -- Audit Login GDR Event_x000A_108  -- Audit Add Login to Server Role Event_x000A_109  -- Audit Add DB User Event_x000A_110  -- Audit Add Member to DB Role Event_x000A_111  -- Audit Add Role Event_x000A_162  -- User error message_x000A_170  -- Audit Server Scope GDR Event_x000A_171  -- Audit Server Object GDR Event_x000A_172  -- Audit Database Object GDR Event_x000A_173  -- Audit Server Operation Event_x000A_177  -- Audit Server Principal Management Event_x000A__x000A__x000A_If SQL Server Audit is in use, proceed as follows._x000A__x000A_The basic SQL Server Audit configuration provided in the supplemental file Audit.sql uses broad, server-level audit action groups for this purpose.  SQL Server Audit's flexibility makes other techniques possible.  If an alternative technique is in use and demonstrated effective, this is not a finding._x000A__x000A_Determine the name(s) of the server audit specification(s) in use._x000A__x000A_To look at audits and audit specifications, in Management Studio's object explorer, expand _x000A_&lt;server name&gt; &gt;&gt; Security &gt;&gt; Audits_x000A_and_x000A_&lt;server name&gt; &gt;&gt; Security &gt;&gt; Server Audit Specifications._x000A_Also, _x000A_&lt;server name&gt; &gt;&gt; Databases &gt;&gt; &lt;database name&gt; &gt;&gt; Security &gt;&gt; Database Audit Specifications._x000A__x000A_Alternatively, review the contents of the system views with "audit" in their names._x000A__x000A_Run the following code to verify that all GRANT, ALTER SERVER ROLE . . . ADD MEMBER . . .,  and/or  ALTER ROLE . . . ADD MEMBER . . .  actions, all INSERT and UPDATE actions on any locally-defined permissions tables, and all EXECUTE actions on any system or locally-defined permissions-related procedures and functions, are being audited:_x000A_USE [master];_x000A_GO_x000A_SELECT * FROM sys.server_audit_specification_details WHERE server_specification_id =_x000A_(SELECT server_specification_id FROM sys.server_audit_specifications WHERE [name] = '&lt;server_audit_specification_name&gt;')_x000A_AND audit_action_name IN_x000A_(_x000A_'DATABASE_OBJECT_OWNERSHIP_CHANGE_GROUP',_x000A_'DATABASE_OBJECT_PERMISSION_CHANGE_GROUP',_x000A_'DATABASE_OWNERSHIP_CHANGE_GROUP',_x000A_'DATABASE_PERMISSION_CHANGE_GROUP',_x000A_'DATABASE_ROLE_MEMBER_CHANGE_GROUP',_x000A_'SCHEMA_OBJECT_OWNERSHIP_CHANGE_GROUP',_x000A_'SCHEMA_OBJECT_PERMISSION_CHANGE_GROUP',_x000A_'SERVER_OBJECT_OWNERSHIP_CHANGE_GROUP',_x000A_'SERVER_OBJECT_PERMISSION_CHANGE_GROUP',_x000A_'SERVER_PERMISSION_CHANGE_GROUP',_x000A_'SERVER_ROLE_MEMBER_CHANGE_GROUP',_x000A_'SCHEMA_OBJECT_ACCESS_GROUP'_x000A_);_x000A_GO_x000A__x000A_Examine the list produced by the query._x000A__x000A_If any locally-defined permissions tables, procedures, or functions exist, and the list does not include the audit action group SCHEMA_OBJECT_ACCESS_GROUP, this is a finding._x000A__x000A_If any of the other audit action groups specified in the WHERE clause are not included in the list, this is a finding._x000A__x000A_If the audited_result column is not "SUCCESS" or "SUCCESS AND FAILURE" on every row, this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="124">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2014</S>
      <S N="VulnID">V-67927</S>
      <S N="RuleID">SV-82417r2_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL4-00-037000</S>
      <S N="Title">SQL Server must generate Trace or Audit records when unsuccessful attempts to delete privileges/permissions occur.</S>
      <S N="Description">Changes in the permissions, privileges, and roles granted to users and roles must be tracked. Without an audit trail, unauthorized elevation or restriction of privileges could go undetected. Elevated privileges give users access to information and functionality that they should not have; restricted privileges wrongly deny access to authorized users._x000A__x000A_In SQL Server, deleting permissions is typically done via the REVOKE or DENY command; or with the ALTER SERVER ROLE . . . DROP MEMBER . . . and/or ALTER ROLE . . . DROP MEMBER . . . statements._x000A__x000A_To aid in diagnosis, it is necessary to keep track of failed attempts in addition to the successful ones._x000A__x000A_Use of SQL Server Audit is recommended.  All features of SQL Server Audit are available in the Enterprise and Developer editions of SQL Server 2014.  It is not available at the database level in other editions.  For this or legacy reasons, the instance may be using SQL Server Trace for auditing, which remains an acceptable solution for the time being.  Note, however, that Microsoft intends to remove most aspects of Trace at some point after SQL Server 2016.</S>
      <S N="FixText">Where SQL Server Trace is in use, define and enable a trace that captures all auditable events.  The script provided in the supplemental file Trace.sql can be used to do this._x000A__x000A_Add blocks of code to Trace.sql for each custom event class (integers in the range 82-91; the same event class may be used for all such triggers) used in these triggers.  _x000A__x000A_Create triggers to raise a custom event on each locally-defined security table that requires tracking of Insert-Update-Delete operations.  The examples provided in the supplemental file CustomTraceEvents.sql can serve as the basis for these.  _x000A__x000A_Execute Trace.sql_x000A__x000A_Where SQL Server Audit is in use, design and deploy a SQL Server Audit that captures all auditable events.  The script provided in the supplemental file Audit.sql can be used for this._x000A__x000A_Alternatively, to add the necessary data capture to an existing server audit specification, run the script:_x000A_USE [master];_x000A_GO_x000A_ALTER SERVER AUDIT SPECIFICATION &lt;server_audit_specification_name&gt; WITH (STATE = OFF);_x000A_GO_x000A_ALTER SERVER AUDIT SPECIFICATION &lt;server_audit_specification_name&gt; ADD (SCHEMA_OBJECT_ACCESS_GROUP);_x000A_GO_x000A_ALTER SERVER AUDIT SPECIFICATION &lt;server_audit_specification_name&gt; WITH (STATE = ON);_x000A_GO</S>
      <S N="Check">If neither SQL Server Audit nor SQL Server Trace is in use for audit purposes, this is a finding._x000A__x000A_Obtain the list of locally-defined security tables (if any) that require tracking of Insert-Update-Delete operations._x000A__x000A_If SQL Server Trace is in use for audit purposes, review these tables for the existence of triggers to raise a custom event on each Insert-Update-Delete operation._x000A__x000A_If such triggers are not present, this is a finding._x000A__x000A_Check to see that all required events are being audited.  From the query prompt:_x000A_SELECT * FROM sys.traces; _x000A__x000A_All currently defined traces for the SQL server instance will be listed._x000A__x000A_If no traces are returned, this is a finding._x000A__x000A_Determine the trace(s) being used for the auditing requirement._x000A_In the following, replace # with a trace ID being used for the auditing requirements._x000A_From the query prompt:_x000A_SELECT DISTINCT(eventid) FROM sys.fn_trace_geteventinfo(#);_x000A__x000A_The following required event IDs should all be among those listed; if not, this is a finding:_x000A__x000A_42  -- SP:Starting_x000A_43  -- SP:Completed_x000A_82-91  -- User-defined Event (required only where there are locally-defined security tables or procedures)_x000A_102  -- Audit Database Scope GDR_x000A_103  -- Audit Object GDR Event_x000A_104  -- Audit AddLogin Event_x000A_105  -- Audit Login GDR Event_x000A_108  -- Audit Add Login to Server Role Event_x000A_109  -- Audit Add DB User Event_x000A_110  -- Audit Add Member to DB Role Event_x000A_111  -- Audit Add Role Event_x000A_162  -- User error message_x000A_170  -- Audit Server Scope GDR Event_x000A_171  -- Audit Server Object GDR Event_x000A_172  -- Audit Database Object GDR Event_x000A_173  -- Audit Server Operation Event_x000A_177  -- Audit Server Principal Management Event_x000A__x000A__x000A_If SQL Server Audit is in use, proceed as follows._x000A__x000A_The basic SQL Server Audit configuration provided in the supplemental file Audit.sql uses broad, server-level audit action groups for this purpose.  SQL Server Audit's flexibility makes other techniques possible.  If an alternative technique is in use and demonstrated effective, this is not a finding._x000A__x000A_Determine the name(s) of the server audit specification(s) in use._x000A__x000A_To look at audits and audit specifications, in Management Studio's object explorer, expand _x000A_&lt;server name&gt; &gt;&gt; Security &gt;&gt; Audits_x000A_and_x000A_&lt;server name&gt; &gt;&gt; Security &gt;&gt; Server Audit Specifications._x000A_Also, _x000A_&lt;server name&gt; &gt;&gt; Databases &gt;&gt; &lt;database name&gt; &gt;&gt; Security &gt;&gt; Database Audit Specifications._x000A__x000A_Alternatively, review the contents of the system views with "audit" in their names._x000A__x000A_Run the following code to verify that all GRANT, ALTER SERVER ROLE . . . ADD MEMBER . . .,  and/or  ALTER ROLE . . . ADD MEMBER . . .  actions, all INSERT and UPDATE actions on any locally-defined permissions tables, and all EXECUTE actions on any system or locally-defined permissions-related procedures and functions, are being audited:_x000A_USE [master];_x000A_GO_x000A_SELECT * FROM sys.server_audit_specification_details WHERE server_specification_id =_x000A_(SELECT server_specification_id FROM sys.server_audit_specifications WHERE [name] = '&lt;server_audit_specification_name&gt;')_x000A_AND audit_action_name IN_x000A_(_x000A_'DATABASE_OBJECT_OWNERSHIP_CHANGE_GROUP',_x000A_'DATABASE_OBJECT_PERMISSION_CHANGE_GROUP',_x000A_'DATABASE_OWNERSHIP_CHANGE_GROUP',_x000A_'DATABASE_PERMISSION_CHANGE_GROUP',_x000A_'DATABASE_ROLE_MEMBER_CHANGE_GROUP',_x000A_'SCHEMA_OBJECT_OWNERSHIP_CHANGE_GROUP',_x000A_'SCHEMA_OBJECT_PERMISSION_CHANGE_GROUP',_x000A_'SERVER_OBJECT_OWNERSHIP_CHANGE_GROUP',_x000A_'SERVER_OBJECT_PERMISSION_CHANGE_GROUP',_x000A_'SERVER_PERMISSION_CHANGE_GROUP',_x000A_'SERVER_ROLE_MEMBER_CHANGE_GROUP',_x000A_'SCHEMA_OBJECT_ACCESS_GROUP'_x000A_);_x000A_GO_x000A__x000A_Examine the list produced by the query._x000A__x000A_If any locally-defined permissions tables, procedures, or functions exist, and the list does not include the audit action group SCHEMA_OBJECT_ACCESS_GROUP, this is a finding._x000A__x000A_If any of the other audit action groups specified in the WHERE clause are not included in the list, this is a finding._x000A__x000A_If the audited_result column is not "FAILURE" or "SUCCESS AND FAILURE" on every row, this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="125">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2014</S>
      <S N="VulnID">V-67929</S>
      <S N="RuleID">SV-82419r2_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL4-00-037500</S>
      <S N="Title">SQL Server must generate Trace or Audit records when successful logons or connections occur.</S>
      <S N="Description">For completeness of forensic analysis, it is necessary to track who/what (a user or other principal) logs on to SQL Server._x000A__x000A_Use of SQL Server Audit is recommended.  All features of SQL Server Audit are available in the Enterprise and Developer editions of SQL Server 2014.  It is not available at the database level in other editions.  For this or legacy reasons, the instance may be using SQL Server Trace for auditing, which remains an acceptable solution for the time being.  Note, however, that Microsoft intends to remove most aspects of Trace at some point after SQL Server 2016.</S>
      <S N="FixText">Where SQL Server Trace is in use, define and enable a trace that captures all auditable events.  The script provided in the supplemental file Trace.sql can be used to do this._x000A__x000A_Where SQL Server Audit is in use, design and deploy a SQL Server Audit that captures all auditable events.  The script provided in the supplemental file Audit.sql can be used for this._x000A__x000A_Alternatively, to add the necessary data capture to an existing server audit specification, run the script:_x000A_USE [master];_x000A_GO_x000A_ALTER SERVER AUDIT SPECIFICATION &lt;server_audit_specification_name&gt; WITH (STATE = OFF);_x000A_GO_x000A_ALTER SERVER AUDIT SPECIFICATION &lt;server_audit_specification_name&gt; ADD (SUCCESSFUL_LOGIN_GROUP);_x000A_GO_x000A_ALTER SERVER AUDIT SPECIFICATION &lt;server_audit_specification_name&gt; WITH (STATE = ON);_x000A_GO</S>
      <S N="Check">If neither SQL Server Audit nor SQL Server Trace is in use for audit purposes, this is a finding._x000A__x000A_If SQL Server Trace is in use for audit purposes, verify that all required events are being audited.  From the query prompt:_x000A_SELECT * FROM sys.traces; _x000A__x000A_All currently defined traces for the SQL server instance will be listed._x000A__x000A_If no traces are returned, this is a finding._x000A__x000A_Determine the trace(s) being used for the auditing requirement._x000A_In the following, replace # with a trace ID being used for the auditing requirements._x000A_From the query prompt:_x000A_SELECT DISTINCT(eventid) FROM sys.fn_trace_geteventinfo(#);_x000A__x000A_The following required event IDs should all be among those listed; if not, this is a finding:_x000A__x000A_14  -- Audit Login_x000A_15  -- Audit Logout_x000A_16  -- Attention_x000A_17  -- ExistingConnection_x000A__x000A__x000A_If SQL Server Audit is in use, proceed as follows._x000A__x000A_The basic SQL Server Audit configuration provided in the supplemental file Audit.sql uses the server-level audit action group SUCCESSFUL_LOGIN_GROUP for this purpose.  SQL Server Audit's flexibility makes other techniques possible.  If an alternative technique is in use and demonstrated effective, this is not a finding._x000A__x000A_Determine the name(s) of the server audit specification(s) in use._x000A__x000A_To look at audits and audit specifications, in Management Studio's object explorer, expand _x000A_&lt;server name&gt; &gt;&gt; Security &gt;&gt; Audits_x000A_and_x000A_&lt;server name&gt; &gt;&gt; Security &gt;&gt; Server Audit Specifications._x000A_Also, _x000A_&lt;server name&gt; &gt;&gt; Databases &gt;&gt; &lt;database name&gt; &gt;&gt; Security &gt;&gt; Database Audit Specifications._x000A__x000A_Alternatively, review the contents of the system views with "audit" in their names._x000A__x000A_Run the following to verify that all logons and connections are being audited:_x000A_USE [master];_x000A_GO_x000A_SELECT * FROM sys.server_audit_specification_details WHERE server_specification_id =_x000A_(SELECT server_specification_id FROM sys.server_audit_specifications WHERE [name] = '&lt;server_audit_specification_name&gt;')_x000A_AND audit_action_name = 'SUCCESSFUL_LOGIN_GROUP';_x000A_GO_x000A__x000A_If no row is returned, this is a finding._x000A__x000A_If the audited_result column is not "SUCCESS" or "SUCCESS AND FAILURE", this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="126">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2014</S>
      <S N="VulnID">V-67931</S>
      <S N="RuleID">SV-82421r2_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL4-00-037600</S>
      <S N="Title">SQL Server must generate Trace or Audit records when unsuccessful logons or connection attempts occur.</S>
      <S N="Description">For completeness of forensic analysis, it is necessary to track failed attempts to log on to SQL Server. While positive identification may not be possible in a case of failed authentication, as much information as possible about the incident must be captured._x000A__x000A_Use of SQL Server Audit is recommended.  All features of SQL Server Audit are available in the Enterprise and Developer editions of SQL Server 2014.  It is not available at the database level in other editions.  For this or legacy reasons, the instance may be using SQL Server Trace for auditing, which remains an acceptable solution for the time being.  Note, however, that Microsoft intends to remove most aspects of Trace at some point after SQL Server 2016.</S>
      <S N="FixText">Where SQL Server Trace is in use, define and enable a trace that captures all auditable events.  The script provided in the supplemental file Trace.sql can be used to do this._x000A__x000A_Where SQL Server Audit is in use, design and deploy a SQL Server Audit that captures all auditable events.  The script provided in the supplemental file Audit.sql can be used for this._x000A__x000A_Alternatively, to add the necessary data capture to an existing server audit specification, run the script:_x000A_USE [master];_x000A_GO_x000A_ALTER SERVER AUDIT SPECIFICATION &lt;server_audit_specification_name&gt; WITH (STATE = OFF);_x000A_GO_x000A_ALTER SERVER AUDIT SPECIFICATION &lt;server_audit_specification_name&gt; ADD (FAILED_LOGIN_GROUP);_x000A_GO_x000A_ALTER SERVER AUDIT SPECIFICATION &lt;server_audit_specification_name&gt; WITH (STATE = ON);_x000A_GO</S>
      <S N="Check">If neither SQL Server Audit nor SQL Server Trace is in use for audit purposes, this is a finding._x000A__x000A_If SQL Server Trace is in use for audit purposes, verify that all required events are being audited.  From the query prompt:_x000A_SELECT * FROM sys.traces;_x000A_All currently defined traces for the SQL server instance will be listed._x000A__x000A_If no traces are returned, this is a finding._x000A__x000A_Determine the trace(s) being used for the auditing requirement._x000A_In the following, replace # with a trace ID being used for the auditing requirements._x000A_From the query prompt:_x000A_SELECT DISTINCT(eventid) FROM sys.fn_trace_geteventinfo(#);_x000A__x000A_The following required event ID should be among those listed; if not, this is a finding:_x000A__x000A_20  -- Audit Login Failed_x000A__x000A__x000A_If SQL Server Audit is in use, proceed as follows._x000A__x000A_The basic SQL Server Audit configuration provided in the supplemental file Audit.sql uses the server-level audit action group FAILED_LOGIN_GROUP for this purpose.  SQL Server Audit's flexibility makes other techniques possible.  If an alternative technique is in use and demonstrated effective, this is not a finding._x000A__x000A_Determine the name(s) of the server audit specification(s) in use._x000A__x000A_To look at audits and audit specifications, in Management Studio's object explorer, expand _x000A_&lt;server name&gt; &gt;&gt; Security &gt;&gt; Audits_x000A_and_x000A_&lt;server name&gt; &gt;&gt; Security &gt;&gt; Server Audit Specifications._x000A_Also, _x000A_&lt;server name&gt; &gt;&gt; Databases &gt;&gt; &lt;database name&gt; &gt;&gt; Security &gt;&gt; Database Audit Specifications._x000A__x000A_Alternatively, review the contents of the system views with "audit" in their names._x000A__x000A_Run the following to verify that all logons and connections are being audited:_x000A_USE [master];_x000A_GO_x000A_SELECT * FROM sys.server_audit_specification_details WHERE server_specification_id =_x000A_(SELECT server_specification_id FROM sys.server_audit_specifications WHERE [name] = '&lt;server_audit_specification_name&gt;')_x000A_AND audit_action_name = 'FAILED_LOGIN_GROUP';_x000A_GO_x000A__x000A_If no row is returned, this is a finding._x000A__x000A_If the audited_result column is not "FAILURE" or "SUCCESS AND FAILURE", this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="127">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2014</S>
      <S N="VulnID">V-67933</S>
      <S N="RuleID">SV-82423r2_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL4-00-037700</S>
      <S N="Title">SQL Server must generate Trace or Audit records for all privileged activities or other system-level access.</S>
      <S N="Description">Without tracking privileged activity, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one. _x000A__x000A_System documentation should include a definition of the functionality considered privileged._x000A__x000A_A privileged function in this context is any operation that modifies the structure of the database, its built-in logic, or its security settings. This would include all Data Definition Language (DDL) statements and all security-related statements. This encompasses, but is not necessarily limited to:_x000A_CREATE_x000A_ALTER_x000A_DROP_x000A_GRANT_x000A_REVOKE_x000A_DENY_x000A__x000A_There may also be Data Manipulation Language (DML) statements that, subject to context, should be regarded as privileged. Possible examples in SQL include:_x000A__x000A_TRUNCATE TABLE;_x000A_DELETE, or_x000A_DELETE affecting more than n rows, for some n, or_x000A_DELETE without a WHERE clause;_x000A__x000A_UPDATE or_x000A_UPDATE affecting more than n rows, for some n, or_x000A_UPDATE without a WHERE clause;_x000A__x000A_any SELECT, INSERT, UPDATE, or DELETE to an application-defined security table executed by other than a security principal._x000A__x000A_Note that it is particularly important to audit, and tightly control, any action that weakens the implementation of this requirement itself, since the objective is to have a complete audit trail of all administrative activity._x000A__x000A_Use of SQL Server Audit is recommended.  All features of SQL Server Audit are available in the Enterprise and Developer editions of SQL Server 2014.  It is not available at the database level in other editions.  For this or legacy reasons, the instance may be using SQL Server Trace for auditing, which remains an acceptable solution for the time being.  Note, however, that Microsoft intends to remove most aspects of Trace at some point after SQL Server 2016.</S>
      <S N="FixText">Where SQL Server Trace is in use, define  and enable a trace that captures all auditable events.  The script provided in the supplemental file Trace.sql can be used to do this._x000A__x000A_For additional actions considered privileged, identify the available event class IDs, or define custom event class IDs (integers in the range 82-91).  Add blocks of code for these event IDs to Trace.sql._x000A__x000A_Execute Trace.sql._x000A__x000A_Define triggers as necessary to support data capture. _x000A__x000A_Where SQL Server Audit is in use, design and deploy a SQL Server Audit that captures all auditable events.  The script provided in the supplemental file Audit.sql can be used to create an audit; supplement it as necessary to capture any additional, locally-defined privileged activity.</S>
      <S N="Check">If neither SQL Server Audit nor SQL Server Trace is in use for audit purposes, this is a finding._x000A__x000A_If SQL Server Trace is in use for audit purposes, verify that all required events are being audited.  From the query prompt:_x000A_SELECT * FROM sys.traces; _x000A__x000A_All currently defined traces for the SQL server instance will be listed. If no traces are returned, this is a finding._x000A__x000A_Determine the trace(s) being used for the auditing requirement._x000A_In the following, replace # with a trace ID being used for the auditing requirements._x000A_From the query prompt:_x000A_SELECT DISTINCT(eventid) FROM sys.fn_trace_geteventinfo(#);_x000A__x000A_The following required event IDs should all be among those listed; if not, this is a finding:_x000A__x000A_46  -- Object:Created_x000A_47  -- Object:Deleted_x000A_82-91  -- User-defined Event (required only where there are locally-defined auditable actions)_x000A_115  -- Audit Backup/Restore Event_x000A_116  -- Audit DBCC Event_x000A_117  -- Audit Change Audit Event_x000A_118  -- Audit Object Derived Permission Event_x000A_128  -- Audit Database Management Event_x000A_129  -- Audit Database Object Management Event_x000A_130  -- Audit Database Principal Management Event_x000A_131  -- Audit Schema Object Management Event_x000A_164  -- Object:Altered_x000A_170  -- Audit Server Scope GDR Event_x000A_171  -- Audit Server Object GDR Event_x000A_172  -- Audit Database Object GDR Event_x000A_173  -- Audit Server Operation Event_x000A_175  -- Audit Server Alter Trace Event_x000A_176  -- Audit Server Object Management Event_x000A_177  -- Audit Server Principal Management Event_x000A__x000A_From the system security plan, obtain the list of any other actions considered privileged.  For each, verify that event IDs (and triggers, where necessary) have been defined to capture audit information for these._x000A__x000A_If they have not, this is a finding._x000A__x000A__x000A_If SQL Server Audit is in use, verify that execution of all CREATE, ALTER, DROP, GRANT, REVOKE and DENY statements, all execution of security-related functions and procedures, and all other actions locally defined as privileged, is audited._x000A__x000A_If any such actions are not audited, this is a finding._x000A__x000A_The basic SQL Server Audit configuration provided in the supplemental file Audit.sql uses broad, server-level audit action groups for this purpose.  SQL Server Audit's flexibility makes other techniques possible.  If an alternative technique is in use and demonstrated effective, this is not a finding._x000A__x000A_Determine the name(s) of the server audit specification(s) in use._x000A__x000A_To look at audits and audit specifications, in Management Studio's object explorer, expand _x000A_&lt;server name&gt; &gt;&gt; Security &gt;&gt; Audits_x000A_and_x000A_&lt;server name&gt; &gt;&gt; Security &gt;&gt; Server Audit Specifications._x000A_Also, _x000A_&lt;server name&gt; &gt;&gt; Databases &gt;&gt; &lt;database name&gt; &gt;&gt; Security &gt;&gt; Database Audit Specifications._x000A__x000A_Alternatively, review the contents of the system views with "audit" in their names._x000A__x000A_Run the following code to verify that all configuration-related actions are being audited:_x000A_USE [master];_x000A_GO_x000A_SELECT * FROM sys.server_audit_specification_details WHERE server_specification_id =_x000A_(SELECT server_specification_id FROM sys.server_audit_specifications WHERE [name] = '&lt;server_audit_specification_name&gt;');_x000A_GO_x000A__x000A_Examine the list produced by the query._x000A__x000A_If the audited_result column is not  "SUCCESS" or "SUCCESS AND FAILURE" on every row, this is a finding._x000A__x000A_If any of the audit action groups listed below is not included in the query results, this is a finding._x000A__x000A_If there are locally-defined privileged activities not encompassed by the list below and not tracked in any other way, this is a finding. _x000A__x000A_APPLICATION_ROLE_CHANGE_PASSWORD_GROUP_x000A_AUDIT_CHANGE_GROUP_x000A_BACKUP_RESTORE_GROUP_x000A_DATABASE_CHANGE_GROUP_x000A_DATABASE_OBJECT_ACCESS_GROUP_x000A_DATABASE_OBJECT_OWNERSHIP_CHANGE_GROUP_x000A_DATABASE_OBJECT_PERMISSION_CHANGE_GROUP_x000A_DATABASE_OPERATION_GROUP_x000A_DATABASE_OWNERSHIP_CHANGE_GROUP_x000A_DATABASE_PERMISSION_CHANGE_GROUP_x000A_DATABASE_PRINCIPAL_CHANGE_GROUP_x000A_DATABASE_PRINCIPAL_IMPERSONATION_GROUP_x000A_DATABASE_ROLE_MEMBER_CHANGE_GROUP_x000A_DBCC_GROUP_x000A_FAILED_LOGIN_GROUP_x000A_LOGIN_CHANGE_PASSWORD_GROUP_x000A_LOGOUT_GROUP_x000A_SCHEMA_OBJECT_ACCESS_GROUP_x000A_SCHEMA_OBJECT_CHANGE_GROUP_x000A_SCHEMA_OBJECT_OWNERSHIP_CHANGE_GROUP_x000A_SCHEMA_OBJECT_PERMISSION_CHANGE_GROUP_x000A_SERVER_OBJECT_CHANGE_GROUP_x000A_SERVER_OBJECT_OWNERSHIP_CHANGE_GROUP_x000A_SERVER_OBJECT_PERMISSION_CHANGE_GROUP_x000A_SERVER_OPERATION_GROUP_x000A_SERVER_PERMISSION_CHANGE_GROUP_x000A_SERVER_PRINCIPAL_CHANGE_GROUP_x000A_SERVER_PRINCIPAL_IMPERSONATION_GROUP_x000A_SERVER_ROLE_MEMBER_CHANGE_GROUP_x000A_SERVER_STATE_CHANGE_GROUP_x000A_SUCCESSFUL_LOGIN_GROUP_x000A_TRACE_CHANGE_GROUP</S>
    </MS>
  </Obj>
  <Obj RefId="128">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2014</S>
      <S N="VulnID">V-67935</S>
      <S N="RuleID">SV-82425r2_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL4-00-037800</S>
      <S N="Title">SQL Server must generate Trace or Audit records when unsuccessful attempts to execute privileged activities or other system-level access occur.</S>
      <S N="Description">Without tracking privileged activity, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one. _x000A__x000A_To aid in diagnosis, it is necessary to keep track of failed attempts in addition to the successful ones._x000A__x000A_System documentation should include a definition of the functionality considered privileged._x000A__x000A_A privileged function in this context is any operation that modifies the structure of the database, its built-in logic, or its security settings. This would include all Data Definition Language (DDL) statements and all security-related statements. This encompasses, but is not necessarily limited to:_x000A_CREATE_x000A_ALTER_x000A_DROP_x000A_GRANT_x000A_REVOKE_x000A_DENY_x000A__x000A_There may also be Data Manipulation Language (DML) statements that, subject to context, should be regarded as privileged. Possible examples in SQL include:_x000A__x000A_TRUNCATE TABLE;_x000A_DELETE, or_x000A_DELETE affecting more than n rows, for some n, or_x000A_DELETE without a WHERE clause;_x000A__x000A_UPDATE or_x000A_UPDATE affecting more than n rows, for some n, or_x000A_UPDATE without a WHERE clause;_x000A__x000A_any SELECT, INSERT, UPDATE, or DELETE to an application-defined security table executed by other than a security principal._x000A__x000A_Note that it is particularly important to audit, and tightly control, any action that weakens the implementation of this requirement itself, since the objective is to have a complete audit trail of all administrative activity._x000A__x000A_Use of SQL Server Audit is recommended.  All features of SQL Server Audit are available in the Enterprise and Developer editions of SQL Server 2014.  It is not available at the database level in other editions.  For this or legacy reasons, the instance may be using SQL Server Trace for auditing, which remains an acceptable solution for the time being.  Note, however, that Microsoft intends to remove most aspects of Trace at some point after SQL Server 2016.</S>
      <S N="FixText">Where SQL Server Trace is in use, define  and enable a trace that captures all auditable events.  The script provided in the supplemental file Trace.sql can be used to do this._x000A__x000A_For additional actions considered privileged, identify the available event class IDs, or define custom event class IDs (integers in the range 82-91).  Add blocks of code for these event IDs to Trace.sql._x000A__x000A_Execute Trace.sql._x000A__x000A_Define triggers as necessary to support data capture. _x000A__x000A_Where SQL Server Audit is in use, design and deploy a SQL Server Audit that captures all auditable events.  The script provided in the supplemental file Audit.sql can be used to create an audit; supplement it as necessary to capture any additional, locally-defined privileged activity.</S>
      <S N="Check">If neither SQL Server Audit nor SQL Server Trace is in use for audit purposes, this is a finding._x000A__x000A_If SQL Server Trace is in use for audit purposes, verify that all required events are being audited.  From the query prompt:_x000A_SELECT * FROM sys.traces;_x000A_All currently defined traces for the SQL server instance will be listed._x000A__x000A_If no traces are returned, this is a finding._x000A__x000A_Determine the trace(s) being used for the auditing requirement._x000A_In the following, replace # with a trace ID being used for the auditing requirements._x000A_From the query prompt:_x000A_SELECT DISTINCT(eventid) FROM sys.fn_trace_geteventinfo(#);_x000A__x000A_The following required event IDs should all be among those listed; if not, this is a finding:_x000A__x000A_46  -- Object:Created_x000A_47  -- Object:Deleted_x000A_82-91  -- User-defined Event (required only where there are locally-defined auditable actions)_x000A_115  -- Audit Backup/Restore Event_x000A_116  -- Audit DBCC Event_x000A_117  -- Audit Change Audit Event_x000A_118  -- Audit Object Derived Permission Event_x000A_128  -- Audit Database Management Event_x000A_129  -- Audit Database Object Management Event_x000A_130  -- Audit Database Principal Management Event_x000A_131  -- Audit Schema Object Management Event_x000A_164  -- Object:Altered_x000A_170  -- Audit Server Scope GDR Event_x000A_171  -- Audit Server Object GDR Event_x000A_172  -- Audit Database Object GDR Event_x000A_173  -- Audit Server Operation Event_x000A_175  -- Audit Server Alter Trace Event_x000A_176  -- Audit Server Object Management Event_x000A_177  -- Audit Server Principal Management Event_x000A__x000A_From the system security plan, obtain the list of any other actions considered privileged.  For each, verify that event IDs (and triggers, where necessary) have been defined to capture audit information for these._x000A__x000A_If they have not been defined to capture audit information, this is a finding._x000A__x000A__x000A_If SQL Server Audit is in use, proceed as follows._x000A__x000A_The basic SQL Server Audit configuration provided in the supplemental file Audit.sql uses broad, server-level audit action groups for this purpose.  SQL Server Audit's flexibility makes other techniques possible.  If an alternative technique is in use and demonstrated effective, this is not a finding._x000A__x000A_Determine the name(s) of the server audit specification(s) in use._x000A__x000A_To look at audits and audit specifications, in Management Studio's object explorer, expand _x000A_&lt;server name&gt; &gt;&gt; Security &gt;&gt; Audits_x000A_and_x000A_&lt;server name&gt; &gt;&gt; Security &gt;&gt; Server Audit Specifications._x000A_Also, _x000A_&lt;server name&gt; &gt;&gt; Databases &gt;&gt; &lt;database name&gt; &gt;&gt; Security &gt;&gt; Database Audit Specifications._x000A__x000A_Alternatively, review the contents of the system views with "audit" in their names._x000A__x000A_Run the following code to verify that all configuration-related actions are being audited:_x000A_USE [master];_x000A_GO_x000A_SELECT * FROM sys.server_audit_specification_details WHERE server_specification_id =_x000A_(SELECT server_specification_id FROM sys.server_audit_specifications WHERE [name] = '&lt;server_audit_specification_name&gt;');_x000A_GO_x000A__x000A_Examine the list produced by the query.._x000A__x000A_If the audited_result column is not  "FAILURE" or "SUCCESS AND FAILURE" on every row, this is a finding._x000A__x000A_If any of the audit action groups listed below is not included in the query results, this is a finding._x000A__x000A_If there are locally-defined privileged activities not encompassed by the list below and not tracked in any other way, this is a finding. _x000A__x000A_APPLICATION_ROLE_CHANGE_PASSWORD_GROUP_x000A_AUDIT_CHANGE_GROUP_x000A_BACKUP_RESTORE_GROUP_x000A_DATABASE_CHANGE_GROUP_x000A_DATABASE_OBJECT_ACCESS_GROUP_x000A_DATABASE_OBJECT_OWNERSHIP_CHANGE_GROUP_x000A_DATABASE_OBJECT_PERMISSION_CHANGE_GROUP_x000A_DATABASE_OPERATION_GROUP_x000A_DATABASE_OWNERSHIP_CHANGE_GROUP_x000A_DATABASE_PERMISSION_CHANGE_GROUP_x000A_DATABASE_PRINCIPAL_CHANGE_GROUP_x000A_DATABASE_PRINCIPAL_IMPERSONATION_GROUP_x000A_DATABASE_ROLE_MEMBER_CHANGE_GROUP_x000A_DBCC_GROUP_x000A_FAILED_LOGIN_GROUP_x000A_LOGIN_CHANGE_PASSWORD_GROUP_x000A_LOGOUT_GROUP_x000A_SCHEMA_OBJECT_ACCESS_GROUP_x000A_SCHEMA_OBJECT_CHANGE_GROUP_x000A_SCHEMA_OBJECT_OWNERSHIP_CHANGE_GROUP_x000A_SCHEMA_OBJECT_PERMISSION_CHANGE_GROUP_x000A_SERVER_OBJECT_CHANGE_GROUP_x000A_SERVER_OBJECT_OWNERSHIP_CHANGE_GROUP_x000A_SERVER_OBJECT_PERMISSION_CHANGE_GROUP_x000A_SERVER_OPERATION_GROUP_x000A_SERVER_PERMISSION_CHANGE_GROUP_x000A_SERVER_PRINCIPAL_CHANGE_GROUP_x000A_SERVER_PRINCIPAL_IMPERSONATION_GROUP_x000A_SERVER_ROLE_MEMBER_CHANGE_GROUP_x000A_SERVER_STATE_CHANGE_GROUP_x000A_SUCCESSFUL_LOGIN_GROUP_x000A_TRACE_CHANGE_GROUP</S>
    </MS>
  </Obj>
  <Obj RefId="129">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2014</S>
      <S N="VulnID">V-67937</S>
      <S N="RuleID">SV-82427r2_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL4-00-037900</S>
      <S N="Title">SQL Server must generate Trace or Audit records when logoffs or disconnections occur.</S>
      <S N="Description">For completeness of forensic analysis, it is necessary to track who/what (a user or other principal) logs on to and off from SQL Server._x000A__x000A_Use of SQL Server Audit is recommended.  All features of SQL Server Audit are available in the Enterprise and Developer editions of SQL Server 2014.  It is not available at the database level in other editions.  For this or legacy reasons, the instance may be using SQL Server Trace for auditing, which remains an acceptable solution for the time being.  Note, however, that Microsoft intends to remove most aspects of Trace at some point after SQL Server 2016.</S>
      <S N="FixText">Where SQL Server Trace is in use, define and enable a trace that captures all auditable events.  The script provided in the supplemental file Trace.sql can be used to do this._x000A__x000A_Where SQL Server Audit is in use, design and deploy a SQL Server Audit that captures all auditable events.  The script provided in the supplemental file Audit.sql can be used for this._x000A__x000A_Alternatively, to add the necessary data capture to an existing server audit specification, run the script:_x000A_USE [master];_x000A_GO_x000A_ALTER SERVER AUDIT SPECIFICATION &lt;server_audit_specification_name&gt; WITH (STATE = OFF);_x000A_GO_x000A_ALTER SERVER AUDIT SPECIFICATION &lt;server_audit_specification_name&gt; ADD (LOGOUT_GROUP);_x000A_GO_x000A_ALTER SERVER AUDIT SPECIFICATION &lt;server_audit_specification_name&gt; WITH (STATE = ON);_x000A_GO</S>
      <S N="Check">If neither SQL Server Audit nor SQL Server Trace is in use for audit purposes, this is a finding._x000A__x000A_If SQL Server Trace is in use for audit purposes, verify that all required events are being audited.  From the query prompt:_x000A_SELECT * FROM sys.traces; _x000A__x000A_All currently defined traces for the SQL server instance will be listed._x000A__x000A_If no traces are returned, this is a finding._x000A__x000A_Determine the trace(s) being used for the auditing requirement._x000A_In the following, replace # with a trace ID being used for the auditing requirements._x000A_From the query prompt:_x000A_SELECT DISTINCT(eventid) FROM sys.fn_trace_geteventinfo(#);_x000A__x000A_The following required event IDs should be among those listed; if not, this is a finding:_x000A__x000A_14  -- Audit Login_x000A_15  -- Audit Logout_x000A_16  -- Attention_x000A_17  -- ExistingConnection_x000A__x000A__x000A_If SQL Server Audit is in use, proceed as follows._x000A__x000A_The basic SQL Server Audit configuration provided in the supplemental file Audit.sql uses the server-level audit action group LOGOUT_GROUP for this purpose.  SQL Server Audit's flexibility makes other techniques possible.  If an alternative technique is in use and demonstrated effective, this is not a finding._x000A__x000A_Determine the name(s) of the server audit specification(s) in use._x000A__x000A_To look at audits and audit specifications, in Management Studio's object explorer, expand _x000A_&lt;server name&gt; &gt;&gt; Security &gt;&gt; Audits_x000A_and_x000A_&lt;server name&gt; &gt;&gt; Security &gt;&gt; Server Audit Specifications._x000A_Also, _x000A_&lt;server name&gt; &gt;&gt; Databases &gt;&gt; &lt;database name&gt; &gt;&gt; Security &gt;&gt; Database Audit Specifications._x000A__x000A_Alternatively, review the contents of the system views with "audit" in their names._x000A__x000A_Run the following to verify that all logons and connections are being audited:_x000A_USE [master];_x000A_GO_x000A_SELECT * FROM sys.server_audit_specification_details WHERE server_specification_id =_x000A_(SELECT server_specification_id FROM sys.server_audit_specifications WHERE [name] = '&lt;server_audit_specification_name&gt;')_x000A_AND audit_action_name = 'LOGOUT_GROUP';_x000A_GO_x000A__x000A_If no row is returned, this is a finding._x000A__x000A_If the audited_result column is not "SUCCESS AND FAILURE", this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="130">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2014</S>
      <S N="VulnID">V-67939</S>
      <S N="RuleID">SV-82429r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL4-00-038000</S>
      <S N="Title">SQL Server must generate Trace or Audit records when concurrent logons/connections by the same user from different workstations occur.</S>
      <S N="Description">For completeness of forensic analysis, it is necessary to track who logs on to SQL Server._x000A__x000A_Concurrent connections by the same user from multiple workstations may be valid use of the system; or such connections may be due to improper circumvention of the requirement to use the CAC for authentication; or they may indicate unauthorized account sharing; or they may be because an account has been compromised._x000A__x000A_If the fact of multiple, concurrent logons by a given user can be reliably reconstructed from the log entries for other events (logons/connections; voluntary and involuntary disconnections), then it is not mandatory to create additional log entries specifically for this._x000A__x000A_Use of SQL Server Audit is recommended.  All features of SQL Server Audit are available in the Enterprise and Developer editions of SQL Server 2014.  It is not available at the database level in other editions.  For this or legacy reasons, the instance may be using SQL Server Trace for auditing, which remains an acceptable solution for the time being.  Note, however, that Microsoft intends to remove most aspects of Trace at some point after SQL Server 2016.</S>
      <S N="FixText">Where SQL Server Trace is in use, define and enable a trace that captures all auditable events.  The script provided in the supplemental file Trace.sql can be used to do this._x000A__x000A_Where SQL Server Audit is in use, enable the SUCCESSFUL_LOGIN_GROUP and LOGOUT_GROUP, as described in other STIG requirements.</S>
      <S N="Check">If neither SQL Server Audit nor SQL Server Trace is in use for audit purposes, this is a finding._x000A__x000A_If SQL Server Trace is in use for audit purposes, verify that all required events are being audited.  From the query prompt:_x000A_SELECT * FROM sys.traces;_x000A_All currently defined traces for the SQL server instance will be listed._x000A__x000A_If no traces are returned, this is a finding._x000A__x000A_Determine the trace(s) being used for the auditing requirement._x000A_In the following, replace # with a trace ID being used for the auditing requirements._x000A_From the query prompt:_x000A_SELECT DISTINCT(eventid) FROM sys.fn_trace_geteventinfo(#);_x000A__x000A_The following required event IDs should be among those listed; if not, this is a finding:_x000A__x000A_14  -- Audit Login_x000A_15  -- Audit Logout_x000A_16  -- Attention_x000A_17  -- ExistingConnection_x000A__x000A_If SQL Server Audit is in use, verify that the SUCCESSFUL_LOGIN_GROUP and LOGOUT_GROUP are enabled, as described in other STIG requirements; if not, this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="131">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2014</S>
      <S N="VulnID">V-67941</S>
      <S N="RuleID">SV-82431r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL4-00-038700</S>
      <S N="Title">SQL Server must off-load audit data to a separate log management facility; this must be continuous and in near real time for systems with a network connection to the storage facility and weekly or more often for stand-alone systems.</S>
      <S N="Description">Information stored in one location is vulnerable to accidental or incidental deletion or alteration._x000A__x000A_Off-loading is a common process in information systems with limited audit storage capacity. _x000A__x000A_The DBMS may write audit records to database tables, to files in the file system, to other kinds of local repository, or directly to a centralized log management system. Whatever the method used, it must be compatible with off-loading the records to the centralized system._x000A__x000A_This applies to all data output for audit trail purposes, whether produced by SQL Server Audit, Trace, or other means; but excluding audit-trail information built into application data.</S>
      <S N="FixText">Deploy and configure software tools to transfer audit records to a centralized log management system, continuously and in near-real time where a continuous network connection to the log management system exists, or at least weekly in the absence of such a connection.</S>
      <S N="Check">Review the system documentation for a description of how audit records are off-loaded._x000A__x000A_If the database server has a continuous network connection to the centralized log management system, but the SQL Server audit records are not written directly to the centralized log management system or transferred in near-real-time, this is a finding._x000A__x000A_If the database server  does not have a continuous network connection to the centralized log management system, and the SQL Server audit records are not transferred to the centralized log management system weekly or more often, this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="132">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2014</S>
      <S N="VulnID">V-67943</S>
      <S N="RuleID">SV-82433r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL4-00-038900</S>
      <S N="Title">If SQL Server authentication, using passwords, is employed, SQL Server must enforce the DoD standards for password complexity.</S>
      <S N="Description">Windows domain/enterprise authentication and identification must be used (SQL4-00-030300).  Native SQL Server authentication may be used only when circumstances make it unavoidable; and must be documented and AO-approved._x000A__x000A_The DoD standard for authentication is DoD-approved PKI certificates.  Authentication based on User ID and Password may be used only when it is not possible to employ a PKI certificate, and requires AO approval._x000A__x000A_In such cases, the DoD standards for password complexity must be implemented.  _x000A__x000A_The requirements for password complexity are:_x000A_a. minimum of 15 Characters, 1 of each of the following character sets:_x000A_- Upper-case_x000A_- Lower-case_x000A_- Numeric_x000A_- Special characters (e.g. ~ ! @ # $ % ^ &amp; * ( ) _ + = - ' [ ] / ? &gt; </S>
      <S N="FixText">For each SQL Server Login identified in the Check as out of compliance:_x000A_In SQL Server Management Studio Object Explorer, navigate to &lt;SQL Server instance name&gt; &gt;&gt; Security &gt;&gt; Logins &gt;&gt; &lt;login name&gt;.  Right-click, select Properties.  Select the check box Enforce Password Policy.  Click OK._x000A__x000A_Alternatively, for each identified Login, run the statement:_x000A_ALTER LOGIN &lt;login name&gt; CHECK_POLICY = ON;</S>
      <S N="Check">Run the statement:_x000A_SELECT_x000A_    name_x000A_FROM _x000A_    sys.sql_logins _x000A_WHERE_x000A_    type_desc = 'SQL_LOGIN'_x000A_    AND is_disabled = 0_x000A_    AND is_policy_checked = 0 ; _x000A__x000A_If no account names are listed, this is not a finding._x000A__x000A_For each account name listed, determine whether it is documented as requiring exemption from the standard password complexity rules, if it is not, this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="133">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2014</S>
      <S N="VulnID">V-67945</S>
      <S N="RuleID">SV-82435r2_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL4-00-038910</S>
      <S N="Title">If SQL Server authentication, using passwords, is employed, SQL Server must enforce the DoD standards for password lifetime.</S>
      <S N="Description">Windows domain/enterprise authentication and identification must be used (SQL4-00-030300).  Native SQL Server authentication may be used only when circumstances make it unavoidable; and must be documented and AO-approved._x000A__x000A_The DoD standard for authentication is DoD-approved PKI certificates.  Authentication based on User ID and Password may be used only when it is not possible to employ a PKI certificate, and requires AO approval._x000A__x000A_In such cases, the DoD standards for password lifetime must be implemented.  _x000A__x000A_The requirements for password lifetime are:_x000A_a. Password lifetime limits for interactive accounts:  Minimum 24 hours, Maximum 60 days_x000A_b. Password lifetime limits for non-interactive accounts:  Minimum 24 hours, Maximum 365 days_x000A_c. Number of password changes before an old one may be reused:  Minimum of 5._x000A__x000A_To enforce this in SQL Server, configure each DBMS-managed login to inherit the rules from Windows.</S>
      <S N="FixText">For each SQL Server Login identified in the Check as out of compliance:_x000A_In SQL Server Management Studio Object Explorer, navigate to &lt;SQL Server instance name&gt; &gt;&gt; Security &gt;&gt; Logins &gt;&gt; &lt;login name&gt;.  Right-click, select Properties.  Select the check box Enforce Password Expiration.  Click OK._x000A__x000A_Alternatively, for each identified Login, run the statement:_x000A_ALTER LOGIN &lt;login name&gt;  CHECK_EXPIRATION = ON;</S>
      <S N="Check">Run the statement:_x000A_SELECT_x000A_    name_x000A_FROM _x000A_    sys.sql_logins _x000A_WHERE_x000A_    type_desc = 'SQL_LOGIN'_x000A_    AND is_disabled = 0_x000A_    AND is_expiration_checked = 0; _x000A__x000A_If no account names are listed, this is not a finding._x000A__x000A_For each account name listed, determine whether it is documented as requiring exemption from the standard password lifetime rules, if it is not, this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="134">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2014</S>
      <S N="VulnID">V-70623</S>
      <S N="RuleID">SV-85245r1_rule</S>
      <S N="Severity">low</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL4-00-039100</S>
      <S N="Title">The SQL Server Browser service must be disabled if its use is not necessary..</S>
      <S N="Description">The SQL Server Browser simplifies the administration of SQL Server, particularly when multiple instances of SQL Server coexist on the same computer.  It avoids the need to hard-assign port numbers to the instances and to set and maintain those port numbers in client systems.  It enables administrators and authorized users to discover database management system instances, and the databases they support, over the network._x000A__x000A_This convenience also presents the possibility of unauthorized individuals gaining knowledge of the available SQL Server resources.  Therefore, it is necessary to consider whether the SQL Server Browser is needed.  Typically, if only a single instance is installed, using the default name (MSSQLSERVER) and port assignment (1433), the Browser is not adding any value.   The more complex the installation, the more likely SQL Server Browser is to be helpful._x000A__x000A_This requirement is not intended to prohibit use of the Browser service in any circumstances; rather, it calls for administrators and management to consider whether the benefits of its use outweigh the potential negative consequences.</S>
      <S N="FixText">If SQL Server Browser is needed, document the justification and obtain the appropriate approvals._x000A__x000A_Where SQL Server Browser is judged unnecessary, in the Services tool, double-click on "SQL Server Browser" to open its "Properties" dialog._x000A__x000A_Set Startup Type to "Disabled"._x000A__x000A_If Service Status is "Running", click on "Stop"._x000A__x000A_Click on "OK".</S>
      <S N="Check">If the need for the SQL Server Browser service is documented, with appropriate approval, this is not a finding._x000A__x000A_Open the Services tool._x000A__x000A_Either navigate, via the Windows Start Menu and/or Control Panel, to "Administrative Tools", and select "Services"; or at a command prompt, type "services.msc" and press the "Enter" key._x000A__x000A_Scroll to "SQL Server Browser"._x000A__x000A_If its Startup Type is not shown as "Disabled", this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="135">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Database</S>
      <S N="SqlVersion">2005</S>
      <S N="VulnID">V-2451</S>
      <S N="RuleID">SV-23779r2_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">DM1709-SQLServer9</S>
      <S N="Title">The guest user account should be disabled.</S>
      <S N="Description">The guest user ID in a database allows access by all Windows login IDs without requiring an individual database account. This allows unauthorized access to the database.trueDatabase AdministratorIAAC-1</S>
      <S N="FixText">Revoke connect permission from all databases except master and tempdb._x000A__x000A_From the query prompt:_x000A__x000A_SELECT name_x000A_FROM [master].sys.databases_x000A_WHERE name NOT IN ('master', 'tempdb')_x000A_AND state = 0_x000A__x000A_Repeat for each database:_x000A__x000A_From the query prompt:_x000A__x000A_USE [database name]_x000A_REVOKE CONNECT FROM 'guest'</S>
      <S N="Check">From the query prompt:_x000A__x000A_SELECT name_x000A_FROM [master].sys.databases_x000A_WHERE name NOT IN ('master', 'tempdb')_x000A_AND state = 0_x000A__x000A_Repeat for each database:_x000A__x000A_From the query prompt:_x000A__x000A_USE [database name]_x000A_SELECT COUNT(grantee_principal_id)_x000A_FROM sys.database_permissions_x000A_WHERE grantee_principal_id = 2_x000A_AND state = 'G'_x000A_AND permission_name = 'CONNECT'_x000A__x000A_If any value other than a 0 is returned, this is a Finding.</S>
    </MS>
  </Obj>
  <Obj RefId="136">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Database</S>
      <S N="SqlVersion">2005</S>
      <S N="VulnID">V-2457</S>
      <S N="RuleID">SV-23785r2_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">DM1715-SQLServer9</S>
      <S N="Title">Object permission assignments should be authorized.</S>
      <S N="Description">Securely designed applications require only that database application user accounts have permissions to access and manipulate only the application data assigned to them in accordance with the their job function. Restrictions may be further restricted by granting data access to users only through execution of database procedures. Excess privileges can lead to unauthorized data access and can compromise data integrity.trueDatabase AdministratorECLP-1</S>
      <S N="FixText">Revoke unauthorized permissions assigned to application user roles where supported by the DBMS vendor._x000A__x000A_From the query prompt:_x000A__x000A_USE [database name]_x000A_REVOKE [permission] ON [object] FROM [group name]_x000A__x000A_Document assigned role permissions in the System Security Plan and authorize with the IAO.</S>
      <S N="Check">From the query prompt:_x000A__x000A_SELECT name AS [Database Name]_x000A_FROM [master].sys.databases_x000A_WHERE name NOT IN ('tempdb', 'ReportServerTempDB')_x000A_AND state = 0_x000A__x000A_Repeat for each database:_x000A__x000A_From the query prompt:_x000A__x000A_USE [Database Name]_x000A_SELECT u.name AS [Principal]', o.name AS [Object], p.permission_name AS [Type]_x000A_FROM sys.all_objects o, sys.database_principals u, sys.database_permissions p_x000A_WHERE o.object_id = p.major_id_x000A_AND p.grantee_principal_id = u.principal_id_x000A_AND p.state IN ('G', 'W')_x000A_AND (p.type NOT IN ('DL', 'EX', 'IN', 'SL', 'UP')_x000A_ OR u.name IN ('public', 'guest'))_x000A_ORDER BY u.name, o.name, p.permission_name_x000A__x000A_Review results listed._x000A__x000A_If any results listed are not documented in the System Security Plan and authorized by the IAO, this is a Finding._x000A__x000A_Note: Some permissions assigned to PUBLIC within the master database may require the 'Allow modifications to be made directly to the system catalogs' database setting be_x000A_temporarily enabled.</S>
    </MS>
  </Obj>
  <Obj RefId="137">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Database</S>
      <S N="SqlVersion">2005</S>
      <S N="VulnID">V-2458</S>
      <S N="RuleID">SV-23790r2_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">DM1749-SQLServer9</S>
      <S N="Title">Permissions on system tables should be restricted to authorized accounts.</S>
      <S N="Description">Microsoft SQL Server defaults to allow all users to view the majority of the system tables. The system tables contain information such as login IDs, permissions, objects and even the text of all stored procedures. In a secure environment, any direct access granted to these tables by users bypasses security controls defined within the associated system procedures and views. The bypass of these controls can lead to unauthorized viewing of sensitive data.trueDatabase AdministratorECLP-1</S>
      <S N="FixText">Revoke permissions granted to system tables where supported by the DBMS vendor._x000A__x000A_From the query prompt:_x000A__x000A_ USE [database name]_x000A_ REVOKE [permission] ON [object name] FROM [user name]_x000A__x000A_Document permission grants in the System Security Plan and authorize with the IAO.</S>
      <S N="Check">From the query prompt:_x000A__x000A_SELECT name AS [Database Name]_x000A_FROM [master].sys.databases_x000A_WHERE state = 0_x000A__x000A_Repeat for each database:_x000A__x000A_From the query prompt:_x000A__x000A_USE [Database Name]_x000A_SELECT u.name AS [Principal], t.name AS [Table], p.permission_name AS [Permission], p.state_desc AS [State]_x000A_FROM sys.database_principals u_x000A_ JOIN sys.database_permissions p ON u.principal_id = p.grantee_principal_id_x000A_ JOIN sys.tables t ON p.major_id = t.object_id_x000A_WHERE p.state_desc &lt;&gt; 'DENY'_x000A_AND t.is_ms_shipped = 1_x000A_ORDER BY u.name, t.name_x000A__x000A_Review the list of permissions assigned to system tables._x000A__x000A_If any results listed are not documented in the System Security Plan and authorized by the IAO, this is a Finding._x000A__x000A_Note: By default, SELECT permission is granted to the PUBLIC role for system tables in all databases. Even though permission is set by default, it is still a Finding.</S>
    </MS>
  </Obj>
  <Obj RefId="138">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Database</S>
      <S N="SqlVersion">2005</S>
      <S N="VulnID">V-2463</S>
      <S N="RuleID">SV-23804r2_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">DM1760-SQLServer9</S>
      <S N="Title">DDL permissions should be granted only to authorized accounts.</S>
      <S N="Description">Data Definition Language (DDL) commands include CREATE, ALTER, and DROP object actions. These actions cause changes to the structure, definition and configuration of the DBMS as well as to the objects themselves that can affect any or all operations of the database. Such privileged actions, when not restricted to authorized persons and activities, can lead to a compromise of data and DBMS availability.trueDatabase AdministratorECLP-1</S>
      <S N="FixText">Revoke DDL permissions from unauthorized accounts with the REVOKE command:_x000A__x000A_From the query prompt:_x000A__x000A_USE [database name]_x000A_REVOKE [permission] FROM [user name]_x000A__x000A_Document required DDL permission grants in the System Security Plan and authorize with the IAO.</S>
      <S N="Check">From the query prompt:_x000A__x000A_SELECT name AS [Database Name]_x000A_FROM [master].sys.databases_x000A_WHERE state = 0_x000A__x000A_Repeat for each database:_x000A__x000A_From the query prompt:_x000A__x000A_USE [Database Name]_x000A_SELECT u.name AS [Principal], o.name AS [Object], p.permission_name AS [Permission], p.state_desc AS [State]_x000A_FROM sys.database_principals u_x000A_ JOIN sys.database_permissions p ON u.principal_id = p.grantee_principal_id_x000A_ LEFT JOIN sys.all_objects o ON p.major_id = o.object_id AND p.class IN (1, 8)_x000A_ LEFT JOIN sys.schemas s ON p.major_id = s.schema_id AND p.class = 3_x000A_WHERE p.state_desc &lt;&gt; 'DENY'_x000A_AND p.state IN ('G', 'W')_x000A_AND (p.type LIKE 'CR%' OR p.type LIKE 'AL%')_x000A_ORDER BY u.name, o.name, p.permission_name_x000A__x000A_Compare the results listed to those documented in the System Security Plan. If any accounts listed are:_x000A__x000A_1. Application users_x000A_2. Application user roles_x000A_3. Application administrator roles_x000A_4. PUBLIC role_x000A_5. GUEST user_x000A__x000A_this is a Finding._x000A__x000A_If any application developer accounts are listed with DDL privileges to production databases, this is a Finding._x000A__x000A_If results are not documented in the System Security Plan or authorized by the IAO, this is a Finding.</S>
    </MS>
  </Obj>
  <Obj RefId="139">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Database</S>
      <S N="SqlVersion">2005</S>
      <S N="VulnID">V-2498</S>
      <S N="RuleID">SV-23833r2_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">DM5144-SQLServer9</S>
      <S N="Title">Permissions using the WITH GRANT OPTION should be granted only to DBA or application administrator accounts.</S>
      <S N="Description">The WITH GRANT option assigned with privileges, allows the grantee of the privilege to re-grant the privilege to other accounts. Unauthorized or unmanaged assignment of privileges may result in a compromise of data confidentiality and database operation. Privilege assignment should be restricted to DBA, application object owner accounts and application administration accounts.trueDatabase AdministratorECLP-1</S>
      <S N="FixText">Revoke unauthorized permissions granted with the WITH GRANT option._x000A__x000A_From the query prompt:_x000A__x000A_USE [Database Name]_x000A_REVOKE GRANT OPTION FOR [object] FROM [Principal]_x000A__x000A_You may re-grant the object permissions to the Principal as shown below._x000A__x000A_From the query prompt:_x000A__x000A_USE [Database Name]_x000A_GRANT [permission] ON [object] TO [Principal]_x000A__x000A_Document required object permission grants with Grant Option in the System Security Plan and authorize with the IAO.</S>
      <S N="Check">From the query prompt:_x000A__x000A_SELECT name AS [Database Name]_x000A_FROM [master].sys.databases_x000A_WHERE state = 0_x000A__x000A_Repeat for each database:_x000A__x000A_From the query prompt:_x000A__x000A_USE [Database Name]_x000A_SELECT u.name AS [Principal], o.name AS [Object], p.permission_name AS [Permission], p.state_desc AS [State]_x000A_FROM sys.database_principals u_x000A_ JOIN sys.database_permissions p ON u.principal_id = p.grantee_principal_id_x000A_ LEFT JOIN sys.all_objects o ON p.major_id = o.object_id AND p.class IN (1, 8)_x000A_ LEFT JOIN sys.schemas s ON p.major_id = s.schema_id AND p.class = 3_x000A_WHERE p.state_desc &lt;&gt; 'DENY'_x000A_AND p.state IN ('W')_x000A_ORDER BY u.name, o.name, p.permission_name_x000A__x000A_Review listed object grants. Compare with the list documented in the System Security Plan and authorized by the IAO._x000A__x000A_If any object grants listed are not documented in the System Security Plan and authorized by the IAO, this is a Finding.</S>
    </MS>
  </Obj>
  <Obj RefId="140">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Database</S>
      <S N="SqlVersion">2005</S>
      <S N="VulnID">V-3727</S>
      <S N="RuleID">SV-24072r2_rule</S>
      <S N="Severity">low</S>
      <S N="Weight">10.0</S>
      <S N="Version">DG0015-SQLServer9</S>
      <S N="Title">Database applications should be restricted from using static DDL statements to modify the application schema.</S>
      <S N="Description">Application users by definition and job function require only the permissions to manipulate data within database objects and execute procedures within the database. The statements used to define objects in the database are referred to as Data Definition Language (DDL) statements and include the CREATE, DROP, and ALTER object statements (DDL statements do not include CREATE USER, DROP USER, or ALTER USER actions). This requirement is included here as a production system would by definition not support changes to the data definitions. Where object creation is an indirect result of DBMS operation or dynamic object structures are required by the application function as is found in some object-oriented DBMS applications, this restriction does not apply. Re-use of static data structures to recreate temporary data objects are not exempted.trueInformation Assurance OfficerECSD-1, ECSD-2</S>
      <S N="FixText">Coordinate with the application designer to modify the application to use static objects with temporary data rather than creating and using temporary objects._x000A__x000A_Document in the System Security Plan all known object creation that supports dynamic object usage.</S>
      <S N="Check">From the query prompt:_x000A__x000A_SELECT name AS [Database Name]_x000A_FROM [master].sys.databases_x000A_WHERE name NOT IN ('tempdb', 'ReportServerTempDB')_x000A_AND state = 0_x000A__x000A_Repeat for each database:_x000A__x000A_From the query prompt:_x000A__x000A_USE [Database Name]_x000A_SELECT s.name AS [Schema], o.name AS [Object], u.type_desc AS [TYPE], o.create_date AS [Create Date]_x000A_FROM sys.schemas s_x000A_ JOIN sys.database_principals u ON s.principal_id = u.principal_id_x000A_ JOIN sys.all_objects o ON s.schema_id = o.schema_id_x000A_WHERE u.name NOT IN ('dbo', 'INFORMATION_SCHEMA', 'sys')_x000A_AND o.is_ms_shipped = 0_x000A_ORDER BY s.name, o.name, o.create_date_x000A__x000A_View the list of objects listed by the queries above. If any object creation dates do not coincide with the software maintenance and upgrade logs or are not objects documented as supporting dynamic object creation functions, investigate the circumstances under which the object was created. If the object is created using static definitions to store temporary data or indicates that the application uses unauthorized DDL statements, this is a Finding._x000A__x000A_The results of these queries will just give an indication of what objects were created since the database installation or its most recent upgrade. It should not be used as a complete result. For example, using the queries listed above, application objects created with the database installation will not be reported as well as objects owned by default application owner accounts._x000A__x000A_If the creation dates are more recent than the installation or latest upgrade of the application, the application may be using DDL statements._x000A__x000A_If the listed objects are not documented in the System Security Plan, this is a Finding.</S>
    </MS>
  </Obj>
  <Obj RefId="141">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Database</S>
      <S N="SqlVersion">2005</S>
      <S N="VulnID">V-3817</S>
      <S N="RuleID">SV-25285r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">DG0073-SQLServer9</S>
      <S N="Title">Database accounts should not specify account lock times less than the site-approved minimum.</S>
      <S N="Description">Unauthorized access to database accounts may be thwarted by instituting a lock on the target account after the specified number of unsuccessful logins. If allowed to continue an attack unimpeded, the attempt could eventually become successful and compromise the database and data integrity.falseDatabase AdministratorECLO-1, ECLO-2</S>
      <S N="FixText">Set the failed login attempt count to 3 to trigger an account lockout or to the number specified in the System Security Plan where supported by the DBMS._x000A__x000A_Where this requirement is not compatible with the operation of a front-end application, the unsuccessful logon count and time will be specified and the operational need documented in the System Security Plan.</S>
      <S N="Check">If no DBMS accounts authenticate using passwords, this check is Not a Finding._x000A__x000A_If DBMS uses Host Authentication only, this check is Not a Finding._x000A__x000A_If the DBMS does not natively support this functionality, this check is Not a Finding._x000A__x000A_If the DBMS is not configured to lock database accounts after three or an IAO-specified number of consecutive unsuccessful connection attempts within a 60 minute period, this is a Finding._x000A__x000A_Note: The counter may be reset to 0 if a third failed logon attempt does not occur before reset. Ensure password policy enforcement is enabled for SQL Server accounts per Check DG0079.</S>
    </MS>
  </Obj>
  <Obj RefId="142">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Database</S>
      <S N="SqlVersion">2005</S>
      <S N="VulnID">V-3823</S>
      <S N="RuleID">SV-24094r2_rule</S>
      <S N="Severity">low</S>
      <S N="Weight">10.0</S>
      <S N="Version">DG0091-SQLServer9</S>
      <S N="Title">Custom and GOTS application source code stored in the database should be protected with encryption or encoding.</S>
      <S N="Description">Source code may include information on data relationships, locations of sensitive data that are otherwise obscured, or other processing information that could aid a malicious user. Encoding or encryption of the custom source code objects within the database helps protect against this type of disclosure.trueDatabase AdministratorDCSL-1</S>
      <S N="FixText">Recreate stored procedures and specify encryption using the ALTER PROCEDURE command._x000A__x000A_Example:_x000A_ALTER PROCEDURE [MyProc] WITH ENCRYPTION_x000A_AS_x000A_SELECT [mycol1], [mycol2] FROM [mytable]..._x000A__x000A_Replace objects specified between the "[]" characters with custom/GOTS procedure references._x000A__x000A_Document all exceptions to this requirement in the System Security Plan and authorize with the IAO.</S>
      <S N="Check">If this is not a production database, this check is Not a Finding._x000A__x000A_From the query prompt:_x000A__x000A_SELECT name AS [Database Name]_x000A_FROM [master].sys.databases_x000A_WHERE name NOT IN ('tempdb', 'reportserver', 'reportservertempdb')_x000A_AND state = 0_x000A__x000A_Repeat for each database:_x000A__x000A_From the query prompt:_x000A__x000A_USE [Database Name]_x000A_SELECT USER_NAME(o.schema_id) AS [Schema], o.name AS [Object], o.type_desc AS [Type], o.create_date AS [Create Date]_x000A_FROM sys.all_objects o, sys.sql_modules s_x000A_WHERE o.object_id = s.object_id_x000A_AND s.definition IS NOT NULL_x000A_AND o.is_ms_shipped = 0_x000A_ORDER BY USER_NAME(o.schema_id), o.name_x000A__x000A_Review the listed results._x000A__x000A_If any results listed are not documented in the System Security Plan and authorized by the IAO, this is a Finding.</S>
    </MS>
  </Obj>
  <Obj RefId="143">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Database</S>
      <S N="SqlVersion">2005</S>
      <S N="VulnID">V-5683</S>
      <S N="RuleID">SV-24066r2_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">DG0004-SQLServer9</S>
      <S N="Title">Application object owner accounts should be disabled when not performing installation or maintenance actions.</S>
      <S N="Description">Object ownership provides all database object permissions to the owned object. Access to the application object owner accounts requires special protection to prevent unauthorized access and use of the object ownership privileges. In addition to the high privileges to application objects assigned to this account, it is also an account that, by definition, is not accessed interactively except for application installation and maintenance. This reduced access to the account means that unauthorized access to the account could go undetected. To help protect the account, it should be enabled only when access is required.trueDatabase AdministratorECLP-1</S>
      <S N="FixText">Disable logins for all application object owner accounts or members of database roles that own objects:_x000A__x000A_ALTER LOGIN [name] DISABLE_x000A__x000A_Document application object owner accounts that are not disabled in the System Security Plan and authorize with the IAO.</S>
      <S N="Check">Review list of non-default, non-DBA and non-developer object owners:_x000A__x000A_From the query prompt:_x000A__x000A_SELECT name AS [Database Name]_x000A_FROM [master].sys.databases_x000A_WHERE state = 0_x000A__x000A_Repeat for each database:_x000A__x000A_From the query prompt:_x000A__x000A_USE [Database Name]_x000A_SELECT DISTINCT s.name AS [Schema], l.name AS [User]_x000A_FROM sys.all_objects o_x000A_ JOIN sys.schemas s ON o.schema_id = s.schema_id_x000A_ JOIN sys.database_principals u ON s.principal_id = u.principal_id_x000A_ JOIN master.sys.sql_logins l ON u.sid = l.sid_x000A_WHERE o.is_ms_shipped = 0_x000A_AND l.is_disabled = 0_x000A__x000A_If any login names are returned (not disabled) from the last part of the query, this is a Finding._x000A__x000A_Note: The 'sa' account is not exempt from this requirement and should be disabled. DBA and developer accounts authorized to own objects in the database may be permitted, but must be documented.</S>
    </MS>
  </Obj>
  <Obj RefId="144">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Database</S>
      <S N="SqlVersion">2005</S>
      <S N="VulnID">V-15128</S>
      <S N="RuleID">SV-24098r2_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">DG0105-SQLServer9</S>
      <S N="Title">DBMS application user roles should not be assigned unauthorized privileges.</S>
      <S N="Description">Unauthorized access to the data can lead to loss of confidentiality and integrity of the data.trueDatabase AdministratorDCFA-1</S>
      <S N="FixText">Use the grant and revoke commands to assign the authorized privileges as listed in the System Security Plan to custom database application or application user roles.</S>
      <S N="Check">Compare privileges assigned to database application user roles to those defined in the System Security Plan._x000A__x000A_From the query prompt:_x000A__x000A_SELECT name_x000A_FROM [master].sys.databases_x000A_WHERE name NOT IN ('tempdb', 'ReportServerTempDB')_x000A_AND state = 0_x000A__x000A_Repeat for each database:_x000A__x000A_USE [database name]_x000A_SELECT r.name, o.name, p.permission_name_x000A_FROM sys.database_principals r, sys.database_permissions p, sys.all_objects o_x000A_WHERE p.grantee_principal_id = r.principal_id_x000A_AND p.major_id = o.object_id_x000A_AND r.principal_id NOT IN (0, 2)_x000A_AND r.type IN ('A', 'R')_x000A_AND r.is_fixed_role = 0_x000A_ORDER BY r.name, o.name, p.permission_name_x000A__x000A_If the assigned privileges do not match the authorized list of privileges, this is a Finding._x000A__x000A_Note: Default privileges assigned to fixed data roles are considered authorized by default.</S>
    </MS>
  </Obj>
  <Obj RefId="145">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Database</S>
      <S N="SqlVersion">2005</S>
      <S N="VulnID">V-15142</S>
      <S N="RuleID">SV-19465r2_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">DG0166-SQLServer9</S>
      <S N="Title">Asymmetric keys used by the DBMS for encryption of sensitive data should use DoD PKI Certificates. Private keys used by the DBMS should be protected in accordance with NIST (unclassified data) or NSA (classified data) approved key management and processes.</S>
      <S N="Description">Encryption is only effective if the encryption method is robust and the keys used to provide the encryption are not easily discovered. Without effective encryption, sensitive data is vulnerable to unauthorized access.trueDatabase AdministratorIAKM-1, IAKM-2, IAKM-3</S>
      <S N="FixText">Use DOD code-signing certificates to create asymmetric keys stored in the database and used to encrypt sensitive data stored in the database._x000A__x000A_Assign the application object owner account as the owner of the asymmetric key._x000A__x000A_Create audit events for access to the key by other than the application owner account or approved application objects._x000A__x000A_Revoke any privileges assigned to the asymmetric key to other than the application object owner account and authorized users._x000A__x000A_Protect the private key by encrypting it with the database or service master key.</S>
      <S N="Check">If no data is identified as being sensitive or classified by the Information Owner, in the System Security Plan or in the AIS Functional Architecture documentation, this check is Not a Finding._x000A__x000A_If no identified sensitive or classified data requires encryption by the Information Owner in the System Security Plan and/or AIS Functional Architecture documentation, this check is Not a Finding._x000A__x000A_Note: Protection of DBMS system data is reviewed in other checks._x000A__x000A_From the query prompt:_x000A__x000A_SELECT name_x000A_FROM [master].sys.databases_x000A_WHERE state = 0_x000A__x000A_Repeat for each database:_x000A__x000A_From the query prompt:_x000A__x000A_USE [database name]_x000A_SELECT k.name, SUSER_SNAME(u.sid), k.pvt_key_encryption_type_x000A_FROM sys.asymmetric_keys k, sys.database_principals u_x000A_WHERE k.principal_id = u.principal_id_x000A_ORDER BY k.name, SUSER_SNAME(u.sid), k.pvt_key_encryption_type_x000A__x000A_If the total number of records returned for all databases is 0, this is Not a Finding._x000A__x000A_Note: Compliance will be measured as part of the security review of the application._x000A__x000A_For each asymmetric key identified as being used to encrypt sensitive date, verify the key owner is not a SYSADMIN:_x000A__x000A_From the query prompt:_x000A__x000A_USE [database name]_x000A_SELECT o.name, USER_NAME(p.grantee_principal_id), p.permission_name_x000A_FROM sys.database_permissions p, sys.objects o_x000A_WHERE p.major_id = o.object_id_x000A_AND p.class_desc = 'ASYMMETRIC KEY'_x000A_ORDER BY o.name, USER_NAME(p.grantee_principal_id), p.permission_name_x000A__x000A_If the key owner listed from the previous query is listed as a sysadmin member, this is a Finding._x000A__x000A_If any key owner of a key listed above is not the application object owner account or an account specific to the application as documented in the System Security Plan, this is a Finding._x000A_  _x000A_Review any asymmetric keys whose private key is not encrypted:_x000A__x000A_From the query prompt:_x000A__x000A_SELECT name_x000A_FROM [master].sys.asymmetric_keys_x000A_WHERE pvt_key_encryption_type = 'NA'_x000A_ORDER BY name_x000A__x000A_If any records are returned, this is a Finding._x000A__x000A_Examine evidence that an audit record is created whenever the asymmetric key is accessed by other than authorized users. In particular, view evidence that access by a SYSADMIN or other system privileged account results in the generation of an audit record. This is required because system privileges allow access to encryption keys and can use them to access sensitive data where they do not have a need to know._x000A__x000A_If an audit record is not generated for unauthorized access to the asymmetric key, this is a Finding._x000A__x000A_Note: SQL Server does not provide use of encryption keys stored outside of the instance except to create keys stored within the instance. Therefore, protection of externally stored keys is not addressed for SQL Server in this check.</S>
    </MS>
  </Obj>
  <Obj RefId="146">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Database</S>
      <S N="SqlVersion">2005</S>
      <S N="VulnID">V-15151</S>
      <S N="RuleID">SV-23769r2_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">DM0531-SQLServer9</S>
      <S N="Title">Fixed Database roles should have only authorized users or groups as members.</S>
      <S N="Description">Fixed database roles provide a mechanism to grant groups of privileges to users. These privilege groupings are defined by the installation or upgrade of the SQL Server software at the discretion of Microsoft. Memberships in these roles granted to users should be strictly controlled and monitored. Privileges assigned to these roles should be reviewed for change after software upgrade or maintenance to ensure that the privileges continue to be appropriate to the assigned members.trueDatabase AdministratorECLP-1</S>
      <S N="FixText">Grant fixed database roles only to authorized accounts. _x000A__x000A_Revoke unauthorized accounts from fixed database roles._x000A__x000A_From the SQL Server Management Studio GUI:_x000A__x000A_To deassign roles:_x000A_  1. Expand [instance name]_x000A_  2. Expand Databases_x000A_  3. Expand [database type]_x000A_  4. Expand [database name]_x000A_  5. Expand Security_x000A_  6. Expand Roles_x000A_  7. Expand Database Roles_x000A_  8. Double-click the role to be removed from the assigned user_x000A_  9. Select the user's account under Role Members_x000A_  10. Click on the Remove button_x000A__x000A_Document fixed database role grants in the System Security Plan and authorize with the IAO.</S>
      <S N="Check">From the query prompt:_x000A__x000A_SELECT name AS [Database Name]_x000A_FROM [master].sys.databases_x000A_WHERE state = 0_x000A__x000A_Repeat for each database:_x000A__x000A_From the query prompt:_x000A__x000A_USE [Database Name]_x000A_SELECT u.name AS [Principal], g.name AS [Role]_x000A_FROM sys.database_role_members r, sys.database_principals u, sys.database_principals g_x000A_WHERE r.role_principal_id = g.principal_id_x000A_AND r.member_principal_id = u.principal_id_x000A_AND g.is_fixed_role = 1_x000A_ORDER BY u.name, g.name_x000A__x000A_The DBO membership in the db_owner fixed database role does not require explicit authorization and is Not a Finding._x000A__x000A_Verify fixed database role assignments for each Principal listed in the System Security Plan. If any Principals are not authorized, this is a Finding._x000A__x000A_Any fixed database role assignments to the Guest Principal is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="147">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Database</S>
      <S N="SqlVersion">2005</S>
      <S N="VulnID">V-15159</S>
      <S N="RuleID">SV-23860r2_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">DM6175-SQLServer9</S>
      <S N="Title">The Database Master key encryption password should meet DoD password complexity requirements.</S>
      <S N="Description">Weak passwords may be easily guessed. When passwords used to encrypt keys used for encryption of sensitive data, then the confidentiality of all data encrypted using that key is at risk.trueDatabase AdministratorIAKM-1, IAKM-2, IAKM-3</S>
      <S N="FixText">Assign an encryption password to the Database Master Key that is a minimum of 15 characters, contains at least 2 uppercase characters, 2 lowercase characters, 2 special characters, 2 numeric characters and has no repeating characters._x000A__x000A_To change the Database Master Key encryption password:_x000A__x000A_USE [database name]_x000A_ALTER MASTER KEY REGENERATE WITH ENCRYPTION BY PASSWORD = '[new password]'_x000A__x000A_Note: The database master key encryption method should not be changed until the effects are thoroughly reviewed. Changing the master key encryption causes all encryption using the database master key to be decrypted and re-encrypted. This action should not be taken during a high-demand time. Please see the MS SQL Server documentation prior to re-encrypting the database master key for detailed information.</S>
      <S N="Check">From the query prompt:_x000A__x000A_SELECT name_x000A_FROM [master].sys.databases_x000A_WHERE state = 0_x000A__x000A_Repeat for each database:_x000A__x000A_From the query prompt:_x000A__x000A_USE [database name]_x000A_SELECT COUNT(name)_x000A_FROM sys.symmetric_keys s, sys.key_encryptions k_x000A_WHERE s.name = '##MS_DatabaseMasterKey##'_x000A_AND s.symmetric_key_id = k.key_id_x000A_AND k.crypt_type = 'ESKP'_x000A__x000A_If the value returned is greater than 0, a Database Master key exists and is encrypted with a password._x000A__x000A_Review procedures and evidence of password requirements used to encrypt Database Master Keys. If the passwords are not required to meet DOD password standards, currently 15 characters, 2 uppercase characters, 2 lowercase characters, 2 special characters, and 2 numeric characters and no repeating characters, this is a Finding._x000A__x000A_Interview the IAO or DBA to determine the method to retrieve the password to use the Database Master Key. If storage of the password occurs unencrypted in application code or other database tables or files, this is a Finding.</S>
    </MS>
  </Obj>
  <Obj RefId="148">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Database</S>
      <S N="SqlVersion">2005</S>
      <S N="VulnID">V-15161</S>
      <S N="RuleID">SV-23861r2_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">DM6179-SQLServer9</S>
      <S N="Title">The Database Master Key should be encrypted by the Service Master Key where required.</S>
      <S N="Description">Protection of the Database Master Key is necessary to protect the confidentiality of sensitive data. When encrypted by the Service Master Key, SYSADMINs may access and use the key to view sensitive data that they are not authorized to view. Where alternate encryption means are not feasible, encryption by the Service Master Key may be necessary. To help protect sensitive data from unauthorized access by DBA's, mitigations may be in order. Mitigations may include automatic alerts or other audit events when the database master key is accessed outside of the application or by a DBA account.trueDatabase AdministratorIAKM-1, IAKM-2, IAKM-3</S>
      <S N="FixText">Where possible, encrypt the Database Master Key with a password known only to the application administrator._x000A__x000A_Where not possible, configure additional audit events or alerts to detect unauthorized access to the database master key by users not authorized to view sensitive data.</S>
      <S N="Check">From the query prompt:_x000A__x000A_SELECT name_x000A_FROM [master].sys.databases_x000A_WHERE is_master_key_encrypted_by_server = 1_x000A_AND owner_sid &lt;&gt; 1_x000A_AND state = 0_x000A__x000A_If no databases are returned, this is Not a Finding._x000A__x000A_For any databases returned, verify in the System Security Plan that encryption of the Database Master Key using the Service Master Key is acceptable and approved by the Information Owner and the encrypted data does not require additional protections to deter or detect DBA access. If not approved, this is a Finding._x000A__x000A_If approved and additional protections are required, then verify that the additional requirements are in place in accordance with the System Security Plan. These may include additional auditing on access of the Database Master Key with alerts or other automated monitoring._x000A__x000A_If the additional requirements are not in place, this is a Finding.</S>
    </MS>
  </Obj>
  <Obj RefId="149">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Database</S>
      <S N="SqlVersion">2005</S>
      <S N="VulnID">V-15162</S>
      <S N="RuleID">SV-25497r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">DM6180-SQLServer9</S>
      <S N="Title">Database Master Key passwords shoud not be stored in credentials within the database.</S>
      <S N="Description">Storage of the database master key password in a database credential allows decryption of sensitive data by privileged users who may not have a need-to-know requirement to access the data.falseDatabase AdministratorIAKM-1, IAKM-2, IAKM-3</S>
      <S N="FixText">Use the stored procedure sp_control_dbmasterkey_password to remove any credentials that store database master key passwords._x000A__x000A_From the query prompt:_x000A__x000A_EXEC SP_CONTROL_DBMASTERKEY_PASSWORD @db_name = '[database name]', @action = N'drop'</S>
      <S N="Check">From the query prompt:_x000A__x000A_SELECT COUNT(credential_id)_x000A_FROM [master].sys.master_key_passwords_x000A__x000A_If count is not 0, this is a Finding.</S>
    </MS>
  </Obj>
  <Obj RefId="150">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Database</S>
      <S N="SqlVersion">2005</S>
      <S N="VulnID">V-15164</S>
      <S N="RuleID">SV-23863r2_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">DM6184-SQLServer9</S>
      <S N="Title">Asymmetric keys should be derived from DoD PKI certificates.</S>
      <S N="Description">Asymmetric keys derived from self-signed certificates or self-generated by other means do not meet the security requirements of DOD that require validation by DOD trusted certificate authorities.trueDatabase AdministratorIAKM-1, IAKM-2, IAKM-3</S>
      <S N="FixText">Where asymmetric key use is required, the asymmetric should be generated using a code-signing certificate or using the database master key to encrypt the private key. Use of the asymmetric key is expected in DOD installations to be used to support symmetric keys that are in turn used to encrypt sensitive data._x000A__x000A_In a DOD environment, asymmetric keys generated and stored within the SQL Server database are not expected to be used for storage of DOD PKI certificates associated with DOD personnel and used to authenticate them for any database access._x000A__x000A_CREATE ASYMMETRIC KEY [key name]_x000A__x000A_OR_x000A__x000A_CREATE ASYMMETRIC KEY [key name] FROM [asymmetric key source]_x000A__x000A_[asymmetric key source] may be FILE = [strong file name] or EXECUTABLE FILE = 'executable file' or ASSEMBLY [assembly name]_x000A__x000A_Each of the asymmetric key sources is expected in a DOD environment to files signed with code-signing certificates issued by the DOD PKMO. Use of the database master key to encrypt is acceptable, especially where the key is generated using the service master key which in turn is generated from the server certificate. In cases where the DBAs are not trusted, use of external key sources is required.</S>
      <S N="Check">From the query prompt:_x000A__x000A_SELECT name_x000A_FROM [master].sys.databases_x000A_WHERE state = 0_x000A__x000A_Repeat for each database:_x000A__x000A_From the query prompt:_x000A__x000A_USE [database name]_x000A_SELECT name, SUSER_SNAME(sid)_x000A_FROM sys.asymmetric_keys_x000A_ORDER BY name, SUSER_SNAME(sid)_x000A__x000A_If no keys are defined for any database, this check is Not a Finding._x000A__x000A_If keys are returned, verify the key is associated with a DOD PKI Certificate._x000A__x000A_Evidence may include review of the certificate of a signed file used to read the key into the database._x000A__x000A_If the key is not from a DOD PKI certificate or evidence cannot be determined or presented, this is a Finding.</S>
    </MS>
  </Obj>
  <Obj RefId="151">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Database</S>
      <S N="SqlVersion">2005</S>
      <S N="VulnID">V-15168</S>
      <S N="RuleID">SV-23862r2_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">DM6183-SQLServer9</S>
      <S N="Title">Symmetric keys should use a master key, certificate, or asymmetric key to encrypt the key.</S>
      <S N="Description">Symmetric keys are vulnerable if the symmetric key encryption is not protected from disclosure. Symmetric keys are well protected by use of either the database or the service master key. Where access by DBA's is not acceptable, use of the application code-signing certificate can be used to provide protection.trueDatabase AdministratorIAKM-1, IAKM-2, IAKM-3</S>
      <S N="FixText">Configure or alter symmetric keys to encrypt keys with certificates or authorized asymmetric keys:_x000A__x000A_From the query prompt:_x000A__x000A_ALTER SYMMETRIC KEY [key name] ADD ENCRYPTION BY CERTIFICATE [certificate name]_x000A_ALTER SYMMETRIC KEY [key name] DROP ENCRYPTION BY [password, symmetric key or asymmetric key]_x000A__x000A_The symmetric key must specify a certificate or asymmetric key for encryption._x000A__x000A_The certificate may be the code-signing certificate used by the application.</S>
      <S N="Check">From the query prompt:_x000A__x000A_SELECT name_x000A_FROM [master].sys.databases_x000A_WHERE state = 0_x000A__x000A_Repeat for each database:_x000A__x000A_From the query prompt:_x000A__x000A_USE [database name]_x000A_SELECT s.name, k.crypt_type_desc_x000A_FROM sys.symmetric_keys s, sys.key_encryptions k_x000A_WHERE s.symmetric_key_id = k.key_id_x000A_AND k.crypt_type IN ('KSKP', 'ESKS')_x000A_AND s.principal_id &lt;&gt; 1_x000A_ORDER BY s.name, k.crypt_type_desc_x000A__x000A_Review any symmetric keys that have been defined against the System Security Plan._x000A__x000A_If any keys are defined that are not documented in the System Security Plan, this is a Finding._x000A__x000A_Review the System Security Plan to review the encryption mechanism specified for each symmetric key. If the method does not indicate use of certificates, this is a Finding._x000A__x000A_If the certificate specified is not a DOD PKI certificate, this is a Finding.</S>
    </MS>
  </Obj>
  <Obj RefId="152">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Database</S>
      <S N="SqlVersion">2005</S>
      <S N="VulnID">V-15172</S>
      <S N="RuleID">SV-23871r2_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">DM6196-SQLServer9</S>
      <S N="Title">Object permissions should not be assigned to PUBLIC or GUEST.</S>
      <S N="Description">The guest account is available to users that do not have authorized accounts on the database. The PUBLIC role is granted to all users of the database regardless of assigned job function. Assignment of object privileges to unauthorized users can compromise data integrity and/or confidentiality.trueDatabase AdministratorECLP-1</S>
      <S N="FixText">Revoke any unauthorized object privileges assigned to PUBLIC or GUEST where supported by the DBMS vendor._x000A__x000A_Document all remaining object privileges assigned to PUBLIC in the System Security Plan and authorize with the IAO._x000A__x000A_From the query prompt:_x000A__x000A_SELECT name_x000A_FROM [master].sys.databases_x000A_WHERE state = 0_x000A__x000A_Repeat for each database:_x000A__x000A_From the query prompt:_x000A__x000A_USE [database name]_x000A_REVOKE [privilege] ON [object name] FROM '[public or guest]'_x000A__x000A_Repeat for each object privilege assigned to public or guest:_x000A__x000A_From the query prompt:_x000A__x000A_USE [database name]_x000A_REVOKE [permission] ON [schema name].[object name] TO PUBLIC_x000A__x000A_To determine correct schema name for the object, use:_x000A__x000A_SELECT SCHEMA_NAME(schema_id)_x000A_FROM [master].sys.all_objects_x000A_WHERE name = '[object name]'</S>
      <S N="Check">From the query prompt:_x000A__x000A_SELECT name AS [Database Name]_x000A_FROM [master].sys.databases_x000A_WHERE state = 0_x000A__x000A_Repeat for each database:_x000A__x000A_From the query prompt:_x000A__x000A_USE [Database Name]_x000A_SELECT u.name AS [Principal], o.name AS [Object], p.permission_name AS [Permission], p.state_desc AS [State]_x000A_FROM sys.database_principals u_x000A_ JOIN sys.database_permissions p ON u.principal_id = p.grantee_principal_id_x000A_ JOIN sys.all_objects o ON p.major_id = o.object_id_x000A_WHERE p.state_desc &lt;&gt; 'DENY' _x000A_AND u.name IN ('guest', 'public')_x000A_ORDER BY u.name, o.name, p.permission_name_x000A__x000A_If any results listed are unauthorized, this is a Finding._x000A__x000A_If any results listed are not documented in the System Security Plan and authorized by the IAO, this is a Finding._x000A__x000A_Note: Some permissions assigned to PUBLIC within the master database may require the 'Allow modifications to be made directly to the system catalogs' database setting be_x000A_temporarily be enabled.</S>
    </MS>
  </Obj>
  <Obj RefId="153">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Database</S>
      <S N="SqlVersion">2005</S>
      <S N="VulnID">V-15177</S>
      <S N="RuleID">SV-25498r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">DM6188-SQLServer9</S>
      <S N="Title">The Service Master Key should be backed up, stored offline and off site.</S>
      <S N="Description">Backup and recovery of the Service Master Key may be critical to the complete recovery of the database.falseDatabase AdministratorIAKM-1, IAKM-2, IAKM-3</S>
      <S N="FixText">Document and implement procedures to safely backup and store the service master key._x000A__x000A_Include in the procedures methods to establish evidence of backup and storage and careful, restricted access and restoration of the service master key._x000A__x000A_Also, include provisions to store the key offsite._x000A__x000A_BACKUP SERVICE MASTER KEY TO FILE = 'path_to_file' _x000A_ ENCRYPTION BY PASSWORD = 'password'</S>
      <S N="Check">Review procedures for and evidence of backup of the SQL Server Service Master Key in the System Security Plan. _x000A__x000A_If the procedures or evidence does not exist, this is a Finding._x000A__x000A_If the procedures do not indicate offline and off-site storage of the Service Master Key, this is a Finding._x000A__x000A_If procedures do not indicate access restrictions to the Service Master Key backup, this is a Finding.</S>
    </MS>
  </Obj>
  <Obj RefId="154">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Database</S>
      <S N="SqlVersion">2005</S>
      <S N="VulnID">V-15185</S>
      <S N="RuleID">SV-23864r2_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">DM6185-SQLServer9</S>
      <S N="Title">Asymmetric private key encryption should use an authorized encryption type.</S>
      <S N="Description">Asymmetric keys stored in the database that also include storage of the private key require protection from any unauthorized user. To protect unauthorized access and use of any asymmetric key by DBA's or users with SYSADMIN privileges, a password must be used to encrypt the private key. Use of the Database Master Key or Service Master Key allows access by the DBA. Consider the protection requirements for asymmetric key usage and document this in the System Security Plan. Avoid storage of static asymmetric private keys that is keys not generated and maintained for temporary session or other temporary usage, in the database.trueDatabase AdministratorIAKM-1, IAKM-2, IAKM-3</S>
      <S N="FixText">If stored with a private key, the private key is always encrypted either by a specified password, or by the database or service master key._x000A__x000A_Create or alter the asymmetric key with the approved encryption type specified in the System Security Plan._x000A__x000A_Document the approved encryption method after considering whether the DBA should be trusted to access the asymmetric key.</S>
      <S N="Check">From the query prompt:_x000A__x000A_SELECT name_x000A_FROM [master].sys.databases_x000A_WHERE state = 0_x000A__x000A_Repeat for each database:_x000A__x000A_From the query prompt:_x000A__x000A_USE [database name]_x000A_SELECT name, pvt_key_encryption_type_desc_x000A_FROM sys.asymmetric_keys_x000A_WHERE pvt_key_encryption_type = 'PW'_x000A_ORDER BY name, pvt_key_encryption_type_desc_x000A__x000A_If no records are returned, this is Not a Finding._x000A__x000A_Review any records returned and the encryption type listed. If any do not match the documented approved encryption method as specified in the System Security Plan, this is a Finding.</S>
    </MS>
  </Obj>
  <Obj RefId="155">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Database</S>
      <S N="SqlVersion">2005</S>
      <S N="VulnID">V-15607</S>
      <S N="RuleID">SV-24068r2_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">DG0008-SQLServer9</S>
      <S N="Title">Application objects should be owned by accounts authorized for ownership.</S>
      <S N="Description">Database object ownership implies full privileges to the owned object including the privilege to assign access to the owned objects to other subjects. Unmanaged or uncontrolled ownership of objects can lead to unauthorized object grants and alterations.trueDatabase AdministratorECLP-1</S>
      <S N="FixText">Create database accounts dedicated for application object ownership._x000A__x000A_To simplify access authorizations, use a single account for each application to avoid cross chaining of ownership, which makes security configuration more complex and degrades system performance._x000A__x000A_Document all application object ownership in the System Security Plan and authorize with the IAO.</S>
      <S N="Check">From the query prompt:_x000A__x000A_SELECT name AS [Database Name]_x000A_FROM [master].sys.databases_x000A_WHERE state = 0_x000A__x000A_Repeat for each database:_x000A__x000A_From the query prompt:_x000A__x000A_USE [Database Name]_x000A_SELECT DISTINCT s.name AS [Schema Name], u.name AS [Principal], u.type_desc AS [Type]_x000A_FROM sys.schemas s_x000A_ JOIN sys.database_principals u ON s.principal_id = u.principal_id_x000A_ JOIN sys.all_objects o ON s.schema_id = o.schema_id_x000A_WHERE u.name NOT IN ('dbo', 'INFORMATION_SCHEMA', 'sys')_x000A_ORDER BY s.name, u.name_x000A__x000A_Review the object ownerships listed.  Verify any listed accounts are authorized application installation accounts and documented in the System Security Plan._x000A__x000A_If any accounts are not authorized, this is a Finding._x000A__x000A_If any authorized accounts listed are not documented in the System Security Plan, this is a Finding.</S>
    </MS>
  </Obj>
  <Obj RefId="156">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Database</S>
      <S N="SqlVersion">2005</S>
      <S N="VulnID">V-15629</S>
      <S N="RuleID">SV-24106r2_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">DG0121-SQLServer9</S>
      <S N="Title">Application users privileges should be restricted to assignment using application user roles.</S>
      <S N="Description">Privileges granted outside the role of the application user job function are more likely to go unmanaged or without oversight for authorization. Maintenance of privileges using roles defined for discrete job functions offers improved oversight of application user privilege assignments and helps to protect against unauthorized privilege assignment.trueDatabase AdministratorECLP-1</S>
      <S N="FixText">Revoke permissions assigned directly to user accounts and grant them instead to the appropriate group account._x000A__x000A_From the query prompt:_x000A__x000A_REVOKE [permission] ON [object] FROM [user name]_x000A_GRANT [permission] ON [object] TO [group name]_x000A__x000A_Document any exceptions to privileges that cannot be assigned via database roles in the System Security Plan.</S>
      <S N="Check">From the query prompt:_x000A__x000A_SELECT name_x000A_FROM [master].sys.databases_x000A_WHERE state = 0_x000A__x000A_Repeat for each database:_x000A__x000A_From the query prompt:_x000A__x000A_USE [database name]_x000A_SELECT u.name, o.name, p.permission_name_x000A_FROM sys.all_objects o, sys.database_principals u, sys.database_permissions p_x000A_WHERE o.object_id = p.major_id_x000A_AND p.grantee_principal_id = u.principal_id_x000A_AND p.state IN ('G', 'W')_x000A_AND u.type IN ('S', 'U')_x000A_ORDER BY u.name, o.name, p.permission_name_x000A__x000A_If any names are listed, this is a Finding.</S>
    </MS>
  </Obj>
  <Obj RefId="157">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Database</S>
      <S N="SqlVersion">2005</S>
      <S N="VulnID">V-15630</S>
      <S N="RuleID">SV-24307r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">DG0122-SQLServer9</S>
      <S N="Title">Access to sensitive data should be restricted to authorized users identified by the Information Owner.</S>
      <S N="Description">Unauthorized access to sensitive data can lead to unauthorized disclosure, modification or accountability. Access to sensitive data that is granted that is not restricted at all levels based on job function may be exploited regardless of attempts to control. An example of this is a web application that serves general users, but that access sensitive data in a backend database using an account with elevated privileges. This provides a means for the web application user to exploit the application to gain unauthorized access to data in the database. Where the user never has access to a path with excess privileges, unauthorized access is more difficult to gain.falseDatabase AdministratorECAN-1</S>
      <S N="FixText">Have the Information Owner identify all sensitive data stored in the database specified in the System Security Plan._x000A__x000A_Define job functions and sensitive data access requirements for the job functions and included them in the System Security Plan._x000A__x000A_Assign only authorized users for job functions.</S>
      <S N="Check">If no data is identified as being sensitive or classified by the Information Owner, in the System Security Plan or in the AIS Functional Architecture documentation, this check is Not a Finding._x000A__x000A_If no identified sensitive or classified data requires encryption by the Information Owner in the System Security Plan and/or AIS Functional Architecture documentation, this check is Not a Finding._x000A__x000A_Review privilege assignments to sensitive data stored in the database._x000A__x000A_Compare assigned privileges to those that are authorized in the System Security Plan._x000A__x000A_If unauthorized access is granted or sensitive data access requirements are not documented, this is a Finding.</S>
    </MS>
  </Obj>
  <Obj RefId="158">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Database</S>
      <S N="SqlVersion">2005</S>
      <S N="VulnID">V-15642</S>
      <S N="RuleID">SV-25369r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">DG0138-SQLServer9</S>
      <S N="Title">Access grants to sensitive data should be restricted to authorized user roles.</S>
      <S N="Description">Unauthorized access to sensitive data may compromise the confidentiality of personnel privacy, threaten national security or compromise a variety of other sensitive operations. Access controls are best managed by defining requirements based on distinct job functions and assigning access based on the job function assigned to the individual user.falseDatabase AdministratorECAN-1</S>
      <S N="FixText">Define, document and implement all sensitive data access controls based on job function in the System Security Plan.</S>
      <S N="Check">If no data is identified as being sensitive or classified by the Information Owner, in the System Security Plan or in the AIS Functional Architecture documentation, this check is Not a Finding._x000A__x000A_If no identified sensitive or classified data requires encryption by the Information Owner in the System Security Plan and/or AIS Functional Architecture documentation, this check is Not a Finding._x000A__x000A_Review data access requirements for sensitive data as identified and assigned by the Information Owner in the System Security Plan._x000A__x000A_Review the access controls for sensitive data configured in the database._x000A__x000A_If the configured access controls do not match those defined in the System Security Plan, this is a Finding.</S>
    </MS>
  </Obj>
  <Obj RefId="159">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Database</S>
      <S N="SqlVersion">2005</S>
      <S N="VulnID">V-15654</S>
      <S N="RuleID">SV-21488r2_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">DG0165-SQLServer9</S>
      <S N="Title">DBMS symmetric keys should be protected in accordance with NSA or NIST-approved key management technology or processes.</S>
      <S N="Description">Symmetric keys used for encryption protect data from unauthorized access. However, if not protected in accordance with acceptable standards, the keys themselves may be compromised and used for unauthorized data access.trueDatabase AdministratorIAKM-1, IAKM-2, IAKM-3</S>
      <S N="FixText">Document all users authorized to access the database master key in the System Security Plan._x000A__x000A_Restrict authorized users to the application, database owner and SYSADMINs._x000A__x000A_For each unauthorized user:_x000A__x000A_From the query prompt:_x000A__x000A_REVOKE CONTROL FROM [user name]_x000A_</S>
      <S N="Check">From the query prompt:_x000A__x000A_SELECT name_x000A_FROM [master].sys.databases_x000A_WHERE state = 0_x000A__x000A_Repeat for each database:_x000A__x000A_From the query prompt:_x000A__x000A_USE [database name]_x000A_SELECT USER_NAME(grantee_principal_id)_x000A_FROM sys.database_permissions_x000A_WHERE class = 0_x000A_AND state IN ('G', 'W')_x000A_AND type = 'CL'_x000A_ORDER BY USER_NAME(grantee_principal_id)_x000A__x000A_If no records are returned, this is Not a Finding._x000A__x000A_If any records are returned, verify they are authorized to have access to manage the Database Master Key. If any do not, this is a Finding.</S>
    </MS>
  </Obj>
  <Obj RefId="160">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Database</S>
      <S N="SqlVersion">2005</S>
      <S N="VulnID">V-15657</S>
      <S N="RuleID">SV-21490r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">DG0172-SQLServer9</S>
      <S N="Title">Changes to DBMS security labels should be audited.</S>
      <S N="Description">Some DBMS systems provide the feature to assign security labels to data elements. The confidentiality and integrity of the data depends upon the security label assignment where this feature is in use. Changes to security label assignment may indicate suspicious activity.falseDatabase AdministratorECLC-1</S>
      <S N="FixText">Define the policy for auditing changes to security labels defined for the data. Document the audit requirements in the System Security Plan and configure database auditing in accordance with the policy.</S>
      <S N="Check">If no data is identified as being sensitive or classified by the Information Owner, in the System Security Plan or in the AIS Functional Architecture documentation, this check is Not a Finding._x000A__x000A_If no identified sensitive or classified data requires encryption by the Information Owner in the System Security Plan and/or AIS Functional Architecture documentation, this check is Not a Finding._x000A__x000A_If the DBMS does not provide the capability to display sensitivity marking of data, this check is Not a Finding._x000A__x000A_For SQL Server 2005:_x000A__x000A_  Review the DBMS configuration for marking and labeling of sensitive data._x000A_   http://www.microsoft.com/technet/prodtechnol/sql/2005/multisec.mspx_x000A__x000A_If security label assignment is not audited for changes, this is a Finding._x000A_</S>
    </MS>
  </Obj>
  <Obj RefId="161">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2005</S>
      <S N="VulnID">V-2420</S>
      <S N="RuleID">SV-24121r1_rule</S>
      <S N="Severity">low</S>
      <S N="Weight">10.0</S>
      <S N="Version">DG0010-SQLServer9</S>
      <S N="Title">Database executable and configuration files should be monitored for unauthorized modifications.</S>
      <S N="Description">Changes to files in the DBMS software directory including executable, configuration, script, or batch files can indicate malicious compromise of the software files. Changes to non-executable files, such as log files and data files, do not usually reflect unauthorized changes, but are modified by the DBMS as part of normal operation. These modifications can be ignored.falseInformation Assurance OfficerDCSL-1</S>
      <S N="FixText">Establish and implement procedures to monitor any changes made to the database software. Identify all database files and directories to be included in the host system or database backups and provide these to the person responsible for backups._x000A__x000A_For Windows systems, use the dir /s &gt; filename.txt run weekly to store and compare file modification/creation dates and file sizes using the DOS fc command. This is not as comprehensive as some tools available, but may be enhanced by also checking checksum or file hashes.</S>
      <S N="Check">Ask the DBA to describe/demonstrate any software modification detection procedures in place and request documents of these procedures to review. If procedures exist that include review of the database software directories and database application directories, this is Not a Finding. Verify by reviewing reports for inclusion of the DBMS executable and configuration files:_x000A__x000A_Sample Questions: What procedures/software do you have in place to detect unauthorized modification to application files? Are the database application software files including both the SQL Server and third party files scanned for modification? Do you scan for modifications to the configuration files?</S>
    </MS>
  </Obj>
  <Obj RefId="162">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2005</S>
      <S N="VulnID">V-2422</S>
      <S N="RuleID">SV-24155r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">DG0040-SQLServer9</S>
      <S N="Title">The DBMS software installation account should be restricted to authorized users.</S>
      <S N="Description">DBA and other privileged administrative or application owner accounts are granted privileges that allow actions that can have a greater impact on database security and operation. It is especially important to grant access to privileged accounts to only those persons who are qualified and authorized to use them.falseInformation Assurance OfficerECLP-1, ECPA-1</S>
      <S N="FixText">Develop and implement procedures to restrict use and require logging of use of the DBMS software installation account._x000A__x000A_Document authorized personnel and assignments in the System Security Plan.</S>
      <S N="Check">Review procedures for controlling and granting access to use of the DBMS software installation account.   _x000A__x000A_If access or use of this account is not restricted to the minimum number of personnel required or unauthorized access to the account has been granted, this is a Finding.</S>
    </MS>
  </Obj>
  <Obj RefId="163">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2005</S>
      <S N="VulnID">V-2423</S>
      <S N="RuleID">SV-24079r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">DG0050-SQLServer9</S>
      <S N="Title">Database software, applications and configuration files should be monitored to discover unauthorized changes.</S>
      <S N="Description">Unmanaged changes that occur to the database software libraries or configuration can lead to unauthorized or compromised installations.falseDatabase AdministratorDCSL-1, DCSW-1</S>
      <S N="FixText">Develop, document and implement procedures to monitor for unauthorized changes to DBMS software libraries, related software application libraries and configuration files._x000A__x000A_If a third-party automated tool is not employed, an automated job that reports file information on the directories and files of interest and compares them to the baseline report for the same will meet this requirement._x000A__x000A_File hashes or checksums should be used for comparisons as file dates may be manipulated by malicious users.</S>
      <S N="Check">Review monitoring procedures and implementation evidence to verify that monitoring of changes to database software libraries, related applications and configuration files is done._x000A__x000A_Verify that the list of files and directories being monitored is complete._x000A__x000A_If monitoring does not occur or is not complete, this is a Finding.</S>
    </MS>
  </Obj>
  <Obj RefId="164">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2005</S>
      <S N="VulnID">V-2424</S>
      <S N="RuleID">SV-7382r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">DG0060-SQLServer9</S>
      <S N="Title">All database non-interactive, n-tier connection, and shared accounts that exist should be documented and approved by the IAO.</S>
      <S N="Description">Group authentication does not provide individual accountability for actions taken on the DBMS or data.  Whenever a single database account is used to connect to the database, a secondary authentication method that provides individual account ability is required. This scenario most frequently occurs when an externally hosted application authenticates individual users to the application and the application uses a single account to retrieve or update database information on behalf of the individual users.trueDatabase AdministratorInformation Assurance OfficerIAGA-1</S>
      <S N="FixText">Use accounts assigned to individual users where feasible. Design applications to provide individual accountability (audit logs) for actions performed under a single database account. Implement other DBMS automated procedures that provide individual accountability. Where appropriate, implement manual procedures to use manual logs and monitor entries against account usage to ensure procedures are followed.</S>
      <Nil N="Check" />
    </MS>
  </Obj>
  <Obj RefId="165">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2005</S>
      <S N="VulnID">V-2426</S>
      <S N="RuleID">SV-25417r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">DM0510-SQLServer9</S>
      <S N="Title">C2 Audit mode should be enabled or custom audit traces defined.</S>
      <S N="Description">The C2 audit mode uses a system-defined trace to collect audit information for MS SQL Server 2000 and higher. It utilizes all security event categories defined within SQL Server, not all of which are required by the Database STIG. Without required auditing, accountability and investigative support is limited.falseDatabase AdministratorECAT-1, ECAT-2</S>
      <S N="FixText">Configure and enable C2 auditing or confirm valid audit traces are set per checks DG0029, DG0145 and DM5267._x000A__x000A_Note: Setting the C2 audit mode enables auditing of more events than required by the STIG and may generate too many records to manage effectively. _x000A__x000A_From the query prompt:_x000A__x000A_EXEC SP_CONFIGURE 'c2 audit mode', 1_x000A_RECONFIGURE_x000A__x000A_To create a custom audit, see instructions in check DG0145.</S>
      <S N="Check">From the query prompt:_x000A__x000A_SELECT CAST(value AS INT) 'Config_Value'_x000A_FROM [master].sys.configurations_x000A_WHERE name = 'c2 audit mode'_x000A__x000A_If 1 is returned as the value for Config_Value, this is Not a Finding_x000A__x000A_If the value 0 is returned for Config_Value, confirm that a valid audit trace is configured and implemented. See checks DG0029, DG0145 and DM5267. If there is not a valid audit trace, this is a Finding.</S>
    </MS>
  </Obj>
  <Obj RefId="166">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2005</S>
      <S N="VulnID">V-2427</S>
      <S N="RuleID">SV-23758r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">DM0530-SQLServer9</S>
      <S N="Title">Fixed Server roles should have only authorized users or groups assigned as members.</S>
      <S N="Description">Fixed server roles provide a mechanism to grant groups of privileges to users. These privilege groupings are defined by the installation or upgrade of the SQL Server software at the discretion of Microsoft. Memberships in these roles granted to users should be strictly controlled and monitored. Privileges assigned to these roles should be reviewed for change after software upgrade or maintenance to ensure that the privileges continue to be appropriate to the assigned members.trueDatabase AdministratorECLP-1</S>
      <S N="FixText">Remove fixed server role assignments from unauthorized users. Grant fixed roles to authorized personnel only. Remove unauthorized accounts from assigned roles._x000A__x000A_From the query prompt:_x000A__x000A_EXEC SP_DROPSRVROLEMEMBER '[account name]', '[fixed server role name]'_x000A__x000A_Replace [account name] with the name of the account and [fixed server role name] with the name of the fixed server role.</S>
      <Nil N="Check" />
    </MS>
  </Obj>
  <Obj RefId="167">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2005</S>
      <S N="VulnID">V-2436</S>
      <S N="RuleID">SV-23762r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">DM0660-SQLServer9</S>
      <S N="Title">MS SQL Server Instance name should not incude a SQL Server or other software version number.</S>
      <S N="Description">The use of version numbers within the database instance name restricts the use of the instance name from meaningful use in subsequent upgrades. Changing the database instance names on a production database causes unnecessary administrative overhead and compromise existing secure network configurations.trueDatabase AdministratorECAN-1</S>
      <S N="FixText">Do not use version number references in instance names._x000A__x000A_The instance name cannot be changed on an existing instance._x000A__x000A_A new instance can be created with a compliant name and the databases moved.</S>
      <Nil N="Check" />
    </MS>
  </Obj>
  <Obj RefId="168">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2005</S>
      <S N="VulnID">V-2461</S>
      <S N="RuleID">SV-23794r1_rule</S>
      <S N="Severity">high</S>
      <S N="Weight">10.0</S>
      <S N="Version">DM1758-SQLServer9</S>
      <S N="Title">Extended stored procedure xp_cmdshell should be restricted to authorized accounts.</S>
      <S N="Description">The xp_cmdshell extended stored procedure allows execution of host executables outside the controls of database access permissions. This access may be exploited by malicious users who have compromised the integrity of the SQL Server database process to control the host operating system to perpetrate additional malicious activity.trueDatabase AdministratorECLP-1</S>
      <S N="FixText">Authorize and document requirements for use of the xp_cmdshell option in the System Security Plan and AIS Functional Architecture documentation. Where not authorized, disable or restrict its use._x000A__x000A_From the query prompt:_x000A__x000A_USE master_x000A_REVOKE EXECUTE ON xp_cmdshell FROM [user]_x000A__x000A_Replace 'user' with the user account name._x000A__x000A_From the query prompt:_x000A__x000A_EXEC SP_CONFIGURE 'show advanced options', 1_x000A_EXEC SP_CONFIGURE 'xp_cmdshell', 0_x000A_RECONFIGURE</S>
      <Nil N="Check" />
    </MS>
  </Obj>
  <Obj RefId="169">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2005</S>
      <S N="VulnID">V-2464</S>
      <S N="RuleID">SV-23884r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">DM1761-SQLServer9</S>
      <S N="Title">Execute stored procedures at startup, if enabled, should have a custom audit trace defined.</S>
      <S N="Description">The DBMS startup process may be vulnerable to introduction of malicious or unauthorized actions. Any use of automated execution of custom procedures provides an opportunity to deploy unauthorized code. For some versions of SQL Server, audit requirements may only be met by audit procedures that are set to start automatically at system startup.falseDatabase AdministratorDCSS-1, DCSS-2</S>
      <S N="FixText">Enable the â€˜scan for startup procsâ€™ configuration option if a custom audit trace is in use (see Check DG0145: DBMS audit record content) or if operationally required and documented in the System Security Plan:_x000A__x000A_EXEC SP_CONFIGURE 'show advanced options', 1_x000A_EXEC SP_CONFIGURE 'scan for startup procs', 1_x000A_RECONFIGURE_x000A__x000A_Otherwise, disable its use:_x000A__x000A_EXEC SP_CONFIGURE 'show advanced options', 1_x000A_EXEC SP_CONFIGURE 'scan for startup procs', 0_x000A_RECONFIGURE</S>
      <S N="Check">From the query prompt:_x000A__x000A_SELECT CAST(value AS INT) 'Config_Value'_x000A_FROM [master].sys.configurations_x000A_WHERE name = 'scan for startup procs'_x000A__x000A_If a value of 1 is returned for Config_Value and a custom audit trace is NOT in use (see Check DG0145: DBMS audit record content), this is a Finding._x000A__x000A_NOTE: Use of the sp_procoption to mark or unmark automatically run stored procedures will enable this option automatically. If operationally required, document this option as required in the System Security Plan.</S>
    </MS>
  </Obj>
  <Obj RefId="170">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2005</S>
      <S N="VulnID">V-2472</S>
      <S N="RuleID">SV-23814r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">DM2095-SQLServer9</S>
      <S N="Title">OLE Automation extended stored procedures should be restricted to sysadmin access.</S>
      <S N="Description">Extended stored procedures allow SQL Server users to execute functions external to SQL Server. An extended stored procedure is a function within a Windows DLL that can be referenced as a stored procedure. While this feature is a powerful extension of SQL Server, it also increases the risk of SQL Server users gaining unauthorized access to the operating system. The Windows account used by SQL Server to log on determines the security context used by extended stored procedures. Certain sensitive extended stored procedures should be closely monitored. These sensitive stored procedures include the OLE Automation stored procedures. OLE Automation stored procedures can be used to reconfigure the security of other services including IIS (Internet Information Server).trueDatabase AdministratorDCFA-1</S>
      <S N="FixText">Disable OLE extended stored procedures where no needed or restrict access to SYSADMINs and authorized roles._x000A__x000A_Disable OLE extended stored procedures:_x000A__x000A_From the query prompt:_x000A__x000A_EXEC SP_CONFIGURE 'show advanced options', 1_x000A_EXEC SP_CONFIGURE 'OLE Automation Procedures', 0_x000A_RECONFIGURE_x000A__x000A_Note: SQL Server 2005 does not drop system extended stored procedures. Microsoft recommends denying EXEC permissions instead.</S>
      <Nil N="Check" />
    </MS>
  </Obj>
  <Obj RefId="171">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2005</S>
      <S N="VulnID">V-2473</S>
      <S N="RuleID">SV-23825r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">DM2119-SQLServer9</S>
      <S N="Title">Registry extended stored procedures should be restricted to sysadmin access.</S>
      <S N="Description">Extended stored procedures allow SQL Server users to execute functions external to SQL Server. An extended stored procedure is a function within a Windows NT DLL that can be referenced as a stored procedure. While this feature is a powerful extension of SQL Server, it also increases the risk of SQL Server users gaining unauthorized access to the operating system. The Windows NT account used by SQL Server to log on determines the security context used by extended stored procedures. Certain sensitive extended stored procedures should be closely monitored. These sensitive stored procedures include the registry editing stored procedures. Registry extended stored procedures can be used to read or change security information, including the NT password database, from the registry.trueDatabase AdministratorDCFA-1</S>
      <S N="FixText">Restrict access of Registry extended stored procedures to SYSADMINs and authorized roles as documented in the System Security Plan and authorized by the IAO._x000A__x000A_Note: SQL Server 2005 and later does not drop system extended stored procedures. Microsoft recommends denying EXEC permissions instead._x000A__x000A_Restrict and/or remove access to Registry extended stored procedures where not authorized:_x000A__x000A_From the SQL Server Management Studio GUI:_x000A__x000A_1. Connect/expand SQL Server_x000A_2. Expand Databases_x000A_3. Expand System databases_x000A_4. Expand Master_x000A_5. Expand Programmability_x000A_6. Expand Extended Stored Procedures_x000A_7. Expand System Extended Stored Procedures_x000A_8. Locate and select each of the Registry extended stored procedures listed in the Check section_x000A_9. Right click on the extended stored procedure_x000A_10. Select Properties_x000A_11. Click on the Permissions page_x000A_12. Select each user or role and deselect the Grant (and With Grant if checked) permissions from all users, database roles and public except from SYSADMINs and authorized roles when permitted_x000A_13. Click OK_x000A__x000A_Document access grants and restrictions in the System Security Plan and authorize with the IAO.</S>
      <Nil N="Check" />
    </MS>
  </Obj>
  <Obj RefId="172">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2005</S>
      <S N="VulnID">V-2485</S>
      <S N="RuleID">SV-25445r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">DM2142-SQLServer9</S>
      <S N="Title">Remote access should be disabled if not authorized.</S>
      <S N="Description">The remote access option determines if connections to and from other Microsoft SQL Servers are allowed. Remote connections are used to support distributed queries and other data access and command executions across and between remote database hosts. The list of remote servers determines the servers that have defined for remote connections to and from the SQL Server instance. The list of remote logins determines which users on remote servers can connect to and from other SQL Servers. Remote servers and logins that are not properly secured can be used to compromise the server.falseDatabase AdministratorDCFA-1</S>
      <S N="FixText">Document remote access in the System Security Plan and AIS Functional Architecture documentation._x000A__x000A_If required and authorized, document the requirement and authorization in the System Security Plan and AIS Functional Architecture documentation._x000A__x000A_To enable remote access:_x000A__x000A_From the query prompt:_x000A__x000A_EXEC SP_CONFIGURE 'remote access', 1_x000A_RECONFIGURE_x000A__x000A_If not required, disable remote access and document the requirement and authorization in the System Security Plan and AIS Functional Architecture documentation._x000A__x000A_To disable remote access:_x000A__x000A_From the query prompt:_x000A__x000A_EXEC SP_CONFIGURE 'remote access', 0_x000A_RECONFIGURE_x000A__x000A_Follow procedures documented on Microsoft's website on how to configure a remote server setup._x000A__x000A_http://support.microsoft.com/kb/914277</S>
      <S N="Check">From the query prompt:_x000A__x000A_SELECT CAST(value AS INT) 'Config_Value'_x000A_FROM [master].sys.configurations_x000A_WHERE name = 'remote access'_x000A__x000A_If a value of 1 is returned for Config_Value, remote access is enabled._x000A__x000A_If the use of linked servers is not documented and authorized in the System Security Plan and AIS Functional Architecture documentation, this is a Finding._x000A__x000A_If the use of linked servers is not approved by the IAO, this is a Finding._x000A__x000A_Note: See check DG0190 for authorized linked servers._x000A__x000A_If remote access is not documented in the System Security Plan and AIS Functional Architecture documentation regardless of authorization or use, this is a Finding. </S>
    </MS>
  </Obj>
  <Obj RefId="173">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2005</S>
      <S N="VulnID">V-2487</S>
      <S N="RuleID">SV-25448r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">DM3566-SQLServer9</S>
      <S N="Title">SQL Server authentication mode should be set to Windows authentication mode or Mixed mode.</S>
      <S N="Description">SQL Server authentication does not provide a sufficiently robust password complexity and management capability to meet stringent security requirements. SQL Server allows use of Windows authentication, a more robust and security authentication service, to control access to the database.falseDatabase AdministratorIAIA-1, IAIA-2</S>
      <S N="FixText">Configure the instance to accept Windows authentication._x000A__x000A_From the query prompt:_x000A__x000A_EXEC XP_LOGINCONFIG 'login mode', 1_x000A__x000A_If SQL Server authentication is required and authorized, document the requirement with a justification in the System Security Plan. Configure the instance to accept SQL Server authentication._x000A__x000A_From the query prompt:_x000A__x000A_EXEC XP_LOGINCONFIG 'login mode', 2</S>
      <S N="Check">From the query prompt:_x000A__x000A_  EXEC XP_LOGINCONFIG 'login mode'_x000A__x000A_If a value of 'Windows Authentication' is returned for config_value, this is Not a Finding._x000A__x000A_If a value of 'Mixed' is returned for config_value, confirm in the System Security Plan that SQL Server authentication is required and authorized. If it is not, this is a Finding._x000A__x000A_Note: SQL Server authentication and the use of passwords are dependent on password management configured on the host platform. Sufficient password management is available only in SQL Server 2005 on Windows 2003 or later. Password authentication is discouraged and only authorized where Windows authentication is not possible. Ensure password policy enforcement is enabled for SQL Server accounts per Check DG0079.</S>
    </MS>
  </Obj>
  <Obj RefId="174">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2005</S>
      <S N="VulnID">V-2488</S>
      <S N="RuleID">SV-25451r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">DM3763-SQLServer9</S>
      <S N="Title">SQL Server Agent CmdExec or ActiveScripting jobs should be restricted to sysadmins.</S>
      <S N="Description">SQL Server Agent CmdExec and ActiveScripting subsystems allow the execution of code by the host operating system under the security context. Allow use of these features only to SYSADMINs and use only where necessary to limit risk of database exploit to the host operating system. Members of the SYSADMIN group have access to all proxies and subsystems by default. Additional assignments are not necessary and would be considered suspect.falseDatabase AdministratorDCFA-1, ECLP-1</S>
      <S N="FixText">Members of the SYSADMIN role have access to all proxies by default. For any proxies defined for Active Scripting or CmdExec subsystems, remove all additional access privileges._x000A__x000A_Select based on returns from the SP_ENUM_PROXY_SUBSYSTEM results:_x000A__x000A_From the query prompt:_x000A__x000A_EXEC SP_REVOKE_LOGIN_FROM_PROXY '[login name]' @proxy_name = 'ActiveScripting'_x000A_EXEC SP_REVOKE_LOGIN_FROM_PROXY '[login name]' @proxy_name = 'CmdExec'_x000A__x000A_Replace [login name] with the name returned in the SP_ENUM_PROXY_FOR_SUBSYSTEM procedure.</S>
      <S N="Check">From the query prompt:_x000A__x000A_USE msdb_x000A_EXEC SP_ENUM_PROXY_FOR_SUBSYSTEM @subsystem_name = 'ActiveScripting'_x000A_EXEC SP_ENUM_PROXY_FOR_SUBSYSTEM @subsystem_name = 'CmdExec'_x000A__x000A_If no records are returned, this is Not a Finding._x000A__x000A_For each proxy listed:_x000A__x000A_EXEC SP_ENUM_LOGIN_FOR_PROXY @proxy_name = '[proxy name]'_x000A__x000A_Replace [proxy name] with the proxy names returned above._x000A__x000A_Review the names listed in the return. If any names include users that are not SYSADMINs or list groups that contain members other than SYSADMIN, this is a Finding.</S>
    </MS>
  </Obj>
  <Obj RefId="175">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2005</S>
      <S N="VulnID">V-2500</S>
      <S N="RuleID">SV-23886r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">DM5267-SQLServer9</S>
      <S N="Title">Trace Rollover should be enabled for audit traces that have a maximum trace file size.</S>
      <S N="Description">The majority of Microsoft SQL Server security auditing is provided by the trace facility. Traces may be created using system stored procedures or with Microsoft SQL Profiler. The trace must be running in order for security event data to be collected for analysis. Traces can specify a maximum size for the trace file. An action may also be specified when a maximum file size is reached. The trace file rollover option for a defined trace causes the current trace file to close and a new one to be opened with no loss of data. If a maximum file size has been set and the rollover option is not set, the trace stops writing when the maximum file size is reached. If the trace file writes function stops, then auditing is disabled.falseDatabase AdministratorECRR-1</S>
      <S N="FixText">Re-create the trace and specify TRACE_FILE_ROLLOVER (option = 2) added to SHUTDOWN_ON_ERROR (option &gt; 4)._x000A__x000A_From the query prompt:_x000A__x000A_EXEC SP_TRACE_CREATE [ @traceid = ] trace_id OUTPUT _x000A_, [ @options = ] option_value _x000A_, [ @tracefile = ] 'trace_file' _x000A_[ , [ @maxfilesize = ] max_file_size ]_x000A_[ , [ @stoptime = ] 'stop_time' ]_x000A_[ , [ @filecount = ] 'max_rollover_files' ]</S>
      <Nil N="Check" />
    </MS>
  </Obj>
  <Obj RefId="176">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2005</S>
      <S N="VulnID">V-2507</S>
      <S N="RuleID">SV-24149r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">DG0030-SQLServer9</S>
      <S N="Title">Audit trail data should be retained for one year.</S>
      <S N="Description">Without preservation, a complete discovery of an attack or suspicious activity may not be determined. DBMS audit data also contributes to the complete investigation of unauthorized activity and needs to be included in audit retention plans and procedures.falseDatabase AdministratorECRR-1</S>
      <S N="FixText">Develop, document and implement an audit retention policy and procedures._x000A__x000A_It is recommended that the most recent thirty days of audit logs remain available online._x000A__x000A_After thirty days, the audit logs may be maintained offline._x000A__x000A_Online maintenance provides for a more timely capability and inclination to investigate suspicious activity.</S>
      <S N="Check">Review and verify the implementation of an audit trail retention policy._x000A__x000A_Verify that audit data is maintained for a minimum of one year._x000A__x000A_If audit data is not maintained for a minimum of one year, this is a Finding.</S>
    </MS>
  </Obj>
  <Obj RefId="177">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2005</S>
      <S N="VulnID">V-2508</S>
      <S N="RuleID">SV-24088r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">DG0070-SQLServer9</S>
      <S N="Title">Unauthorized user accounts should not exist.</S>
      <S N="Description">Unauthorized user accounts provide unauthorized access to the database and may allow access to database objects. Only authorized users should be granted database accounts.trueDatabase AdministratorIAAC-1</S>
      <S N="FixText">Develop, document and implement procedures for authorizing creation and changes to user accounts. Monitor user accounts to verify that they remain authorized. Drop user accounts that are no longer authorized.</S>
      <Nil N="Check" />
    </MS>
  </Obj>
  <Obj RefId="178">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2005</S>
      <S N="VulnID">V-3335</S>
      <S N="RuleID">SV-23880r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">DM0900-SQLServer9</S>
      <S N="Title">SQL Mail, SQL Mail Extended Stored Procedures (XPs) and Database Mail XPs are required and enabled.</S>
      <S N="Description">The SQL Mail, SQL Mail Extended Stored Procedures (XPs) and Database Mail XPs are used by database applications to provide email messages to and from the database. This capability may easily be abused to send malicious messages to remote users or systems. Disabling its use helps to protect the database from generating or receiving malicious email notifications.falseDatabase AdministratorDCFA-1</S>
      <S N="FixText">Ensure you properly document SQL Mail, SQL Mail XPs and Database Mail XPs configurations regardless of authorization or use in the System Security Plan._x000A__x000A_If not approved by the IAO and authorized for use, disable SQL Mail, SQL Mail XPs and Database Mail XPs._x000A__x000A_From the query prompt:_x000A__x000A_EXEC SP_CONFIGURE 'show advanced options', 1_x000A_EXEC SP_CONFIGURE 'SQL Mail XPs', 0_x000A_RECONFIGURE_x000A__x000A_From the query prompt:_x000A__x000A_EXEC SP_CONFIGURE 'show advanced options', 1_x000A_EXEC SP_CONFIGURE 'Database Mail XPs', 0_x000A_RECONFIGURE</S>
      <S N="Check">Determine the SQL Server Edition:_x000A__x000A_From the query prompt:_x000A__x000A_SELECT CONVERT(INT, SERVERPROPERTY('EngineEdition'))_x000A__x000A_If value returned is 1 (Personal or Desktop Edition) or 4 (Express Edition), this check is Not Applicable._x000A__x000A_From the query prompt:_x000A__x000A_SELECT CAST(value AS INT) 'Config_Value'_x000A_FROM [master].sys.configurations_x000A_WHERE name = 'sql mail xps'_x000A__x000A_If the value of Config_Value is 0, this is Not a Finding._x000A__x000A_If the value of Config_Value is 1, then confirm in the System Security Plan that email message traffic is required by the database applications. If it is not documented, and required this is a Finding._x000A__x000A_From the query prompt:_x000A__x000A_SELECT CAST(value AS INT) 'Config_Value'_x000A_FROM [master].sys.configurations_x000A_WHERE name = 'database mail xps'_x000A__x000A_If the value of Config_Value is 0, this is Not a Finding._x000A__x000A_If the value of Config_Value is 1, then confirm in the System Security Plan that email message traffic is required by the database applications. If it is not documented, and required this is a Finding.</S>
    </MS>
  </Obj>
  <Obj RefId="179">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2005</S>
      <S N="VulnID">V-3336</S>
      <S N="RuleID">SV-23958r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">DM0901-SQLServer9</S>
      <S N="Title">SQL Server Agent email notification usage if enabled should be documented and approved by the IAO.</S>
      <S N="Description">SQL Mail accepts incoming database commands via email. This can introduce malicious codes or viruses into the SQL server environment.falseDatabase AdministratorDCBP-1</S>
      <S N="FixText">Ensure you properly document Agent Email Alert configurations regardless of authorization or use in the System Security Plan._x000A__x000A_Where not required and authorized for use, disable Email notification for SQL Server Agent.</S>
      <S N="Check">Determine the SQL Server Edition:_x000A__x000A_From the query prompt:_x000A__x000A_SELECT CONVERT(INT, SERVERPROPERTY('EngineEdition'))_x000A__x000A_If value returned is 1 (Personal or Desktop Edition) or 4 (Express Edition), this check is Not Applicable._x000A__x000A_From the SQL Server Management Studio GUI:_x000A__x000A_1. Right click on SQL Server Agent_x000A_2. Select Properties_x000A_3. Select Alert System_x000A__x000A_If the box next to "Enable mail profile" is checked, documentation for this function should exist with the IAO in the System Security Plan and AIS Functional Architecture documentation._x000A__x000A_If this function is not documented, this is a Finding.</S>
    </MS>
  </Obj>
  <Obj RefId="180">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2005</S>
      <S N="VulnID">V-3726</S>
      <S N="RuleID">SV-24123r1_rule</S>
      <S N="Severity">low</S>
      <S N="Weight">10.0</S>
      <S N="Version">DG0011-SQLServer9</S>
      <S N="Title">Configuration management procedures should be defined and implemented for database software modifications.</S>
      <S N="Description">Uncontrolled, untested, or unmanaged changes result in an unreliable security posture. All changes to software libraries related to the database and its use need to be reviewed, considered, and the responsibility for CM assigned. CM responsibilities may appear to cross boundaries. It is important, however, for the boundaries of CM responsibility to be clearly defined and assigned to ensure no libraries or configurations are left unaddressed. Related database application libraries may include third-party DBMS management tools, DBMS stored procedures, or other end-user applications.falseInformation Assurance OfficerDCPR-1</S>
      <S N="FixText">Develop, document and implement configuration management procedures or processes._x000A__x000A_Ensure the 4 major requirements listed in the check are documented at a minimum._x000A__x000A_Assign responsibilities for oversight and approval for any and all changes made to DBMS software and configuration.</S>
      <S N="Check">Interview the IAO and review documentation to determine if a configuration management (CM) process is implemented for the DBMS system that includes requirements for:_x000A_  (1) Formally documented CM roles, responsibilities, and procedures to include the management of IA information and documentation;_x000A_  (2) A configuration control board that implements procedures to ensure a security review and approval of all proposed DoD information system changes, to include interconnections to other DoD information systems;_x000A_  (3) A testing process to verify proposed configuration changes prior to implementation in the operational environment; and_x000A_  (4) A verification process to provide additional assurance that the CM process is working effectively and that changes outside the CM process are technically or procedurally not permitted._x000A__x000A_If documented evidence for procedures or processes outlined above are not present or are incomplete, this is a Finding.</S>
    </MS>
  </Obj>
  <Obj RefId="181">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2005</S>
      <S N="VulnID">V-3728</S>
      <S N="RuleID">SV-24131r1_rule</S>
      <S N="Severity">low</S>
      <S N="Weight">10.0</S>
      <S N="Version">DG0016-SQLServer9</S>
      <S N="Title">Unused database components, database application software and database objects should be removed from the DBMS system.</S>
      <S N="Description">Unused, unnecessary DBMS components increase the attack vector for the DBMS by introducing additional targets for attack. By minimizing the services and applications installed on the system, the number of potential vulnerabilities is reduced.falseDatabase AdministratorDCFA-1</S>
      <S N="FixText">Review the list of optional features or components available for the DBMS product._x000A__x000A_If any are required for operation of applications that will be accessing the DBMS, then include them in the application design specification and list them in the System Security Plan._x000A__x000A_If any are not, but have been installed, then uninstall them and remove any database objects and applications that are installed to support them.</S>
      <S N="Check">Review the list of components or optional features installed with the database._x000A__x000A_This may be most clearly displayed using the DBMS product installation tool, but may require review of the product installation documentation._x000A__x000A_If no optional features or components are installed, this is Not a Finding._x000A__x000A_If optional components or features are installed, then review the System Security Plan to verify that they are documented and authorized._x000A__x000A_If any are not documented and authorized, this is a Finding.</S>
    </MS>
  </Obj>
  <Obj RefId="182">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2005</S>
      <S N="VulnID">V-3803</S>
      <S N="RuleID">SV-24133r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">DG0017-SQLServer9</S>
      <S N="Title">A production DBMS installation should not coexist on the same DBMS host with other, non-production DBMS installations.</S>
      <S N="Description">Production, development and other non-production DBMS installations have different access and security requirements.  Shared production/non-production DBMS installations secured at a production-level can impede development efforts whereas production/non-production DBMS installations secured at a development-level can lead to exploitation of production-level installations. Production DBMS installations should be kept separate from development, QA, TEST and other non-production DBMS systems.falseDatabase AdministratorInformation Assurance OfficerECSD-1, ECSD-2</S>
      <S N="FixText">Recommend establishing a dedicated DBMS host for production DBMS installations (See Checks DG0109 and DG0110)._x000A__x000A_A dedicated host system in this case refers to an instance of the operating system at a minimum._x000A__x000A_The operating system may reside on a virtual host machine where supported by the DBMS vendor.</S>
      <S N="Check">Review the System Security Plan and interview the DBA and IAO to determine if the DBMS host contains production and non-production DBMS installations._x000A__x000A_If the DBMS host contains both production and non-production DBMS installations or the production DBMS installation is being used for non-production efforts, determine if this allowance is documented in the System Security Plan and authorized by the IAO._x000A__x000A_If not documented and authorized, this is a Finding._x000A__x000A_NOTE: Though shared production/non-production DBMS installations was allowed under previous database STIG guidance, doing so may place it in violation of OS, Application, Network or Enclave STIG guidance. Ensure that any shared production/non-production DBMS installations meets STIG guidance requirements at all levels or mitigate any conflicts in STIG guidance with your DAA.</S>
    </MS>
  </Obj>
  <Obj RefId="183">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2005</S>
      <S N="VulnID">V-3805</S>
      <S N="RuleID">SV-24135r1_rule</S>
      <S N="Severity">low</S>
      <S N="Weight">10.0</S>
      <S N="Version">DG0019-SQLServer9</S>
      <S N="Title">Application software should be owned by a Software Application account.</S>
      <S N="Description">File and directory ownership imparts full privileges to the owner. These privileges should be restricted to a single, dedicated account to preserve proper chains of ownership and privilege assignment management.falseDatabase AdministratorDCSL-1, ECSD-1, ECSD-2</S>
      <S N="FixText">Assign DBMS file and directory ownership to the software installation and maintenance account._x000A__x000A_Use the software owner account to install and maintain the DBMS software libraries and configuration files.</S>
      <S N="Check">Review the ownership of all DBMS and dependent application software and configuration files. If the owner is other than the software installation account or the designated owner account for the file, this is a Finding._x000A__x000A_Some configuration and log files may be owned by a service or process account. Ownership of these files should be recorded and verified accordingly.</S>
    </MS>
  </Obj>
  <Obj RefId="184">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2005</S>
      <S N="VulnID">V-3806</S>
      <S N="RuleID">SV-24142r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">DG0021-SQLServer9</S>
      <S N="Title">A baseline of database application software should be documented and maintained.</S>
      <S N="Description">Without maintenance of a baseline of current DBMS application software, monitoring for changes cannot be complete and unauthorized changes to the software can go undetected. Changes to the DBMS executables could be the result of intentional or unintentional actions.falseDatabase AdministratorInformation Assurance OfficerDCSW-1</S>
      <S N="FixText">Develop, document and implement baseline procedures that include all DBMS software files and directories._x000A__x000A_Update the baseline after new installations, upgrades or maintenance activities that include changes to the software baseline.</S>
      <S N="Check">Have the DBA and/or IAO provide the DBMS software baseline procedures, implementation evidence, and a list of files and directories included in the baseline procedure for completeness._x000A__x000A_If baseline procedures do not exist, not implemented reliably or not complete, this is a Finding._x000A__x000A_Software and configuration directories are under:_x000A__x000A_[drive] \Program Files\Microsoft SQL Server_x000A__x000A_The exact directory is specified in the registry key:_x000A__x000A_HKEY_LOCAL_MACHINE \ Software \ Microsoft \ Microsoft SQL Server \ 90 \ VerSpecificRootDir_x000A__x000A_For each instance, the directory and all contents specified under the registry key below where [#] is the assigned instance number:_x000A__x000A_HKEY_LOCAL_MACHINE \ Software \ Microsoft \ Microsoft SQL Server \ MSSQL.[#] \ Setup \ SQLProgramDir_x000A_</S>
    </MS>
  </Obj>
  <Obj RefId="185">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2005</S>
      <S N="VulnID">V-3807</S>
      <S N="RuleID">SV-24174r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">DG0052-SQLServer9</S>
      <S N="Title">All applications that access the database should be logged in the audit trail.</S>
      <S N="Description">Protections and privileges are designed within the database to correspond to access via authorized software. Use of unauthorized software to access the database could indicate an attempt to bypass established permissions. Reviewing the use of application software to the database can lead to discovery of unauthorized access attempts.falseDatabase AdministratorECAT-1, ECAT-2</S>
      <S N="FixText">Modify auditing to ensure audit records include identification of applications used to access the DBMS._x000A__x000A_Ensure auditing captures the name [or unique identifier] of applications accessing the DBMS at a minimum._x000A__x000A_Develop or procure a 3rd-party solution where native DBMS logging is not employed or does not capture required information.</S>
      <S N="Check">Review the DBMS audit trail to determine if the names [or unique identifiers] of applications used to connect to the database are included._x000A__x000A_If an alternate method other than DBMS logging is authorized and implemented, review the audit trail to determine if the names [or unique identifiers] of applications used to connect to the database are included._x000A__x000A_If application access to the DBMS is not being audited, this is a Finding._x000A__x000A_If auditing does not capture the name [or unique identifier] of applications accessing the DBMS at a minimum, this is a Finding.</S>
    </MS>
  </Obj>
  <Obj RefId="186">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2005</S>
      <S N="VulnID">V-3808</S>
      <S N="RuleID">SV-24081r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">DG0051-SQLServer9</S>
      <S N="Title">Database job/batch queues should be reviewed regularly to detect unauthorized database job submissions.</S>
      <S N="Description">Unauthorized users may bypass security mechanisms by submitting jobs to job queues managed by the database to be run under a more privileged security context of the database or host system. These queues should be monitored regularly to detect any such unauthorized job submissions.trueDatabase AdministratorECLP-1</S>
      <S N="FixText">Establish and implement procedures to monitor the database job queue and job history for unauthorized job submissions. Include or note documented policy and procedures in the System Security Plan.</S>
      <Nil N="Check" />
    </MS>
  </Obj>
  <Obj RefId="187">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2005</S>
      <S N="VulnID">V-3810</S>
      <S N="RuleID">SV-24086r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">DG0065-SQLServer9</S>
      <S N="Title">DBMS authentication should require use of a DoD PKI certificate.</S>
      <S N="Description">In a properly configured DBMS, access controls defined for data access and DBMS management actions are assigned based on the user identity and  job function. Unauthenticated or falsely authenticated access leads directly to the potential unauthorized access, misuse, and lost accountability of data and activities within the DMBS. Use of PKI certificates for authentication to the DBMS provides a robust mechanism to ensure identity to authorize access to the DBMS.falseInformation Assurance OfficerIATS-1, IATS-2</S>
      <S N="FixText">Implement PKI authentication for all accounts defined within the database where applicable._x000A__x000A_Applications may use host system (server) certificates to authenticate._x000A__x000A_For MAC 3 systems, use of the DoD PKI Class 3 certificate and hardware security token (when available) at minimum is required._x000A__x000A_For MAC 1 and 2 systems, use of the DoD PKI Class 3 or 4 certificate and hardware security token (when available) or an NSA-certified product at minimum is required.</S>
      <S N="Check">If user access to the DBMS is via a portal or mid-tier system or product and PKI-authentication occurs at the portal/mid-tier, this check is Not a Finding._x000A__x000A_Review the list of all DBMS accounts and their authentication methods._x000A__x000A_This list is usually available from a system view or table and is easily gained from a simple SQL query._x000A__x000A_If any accounts are listed with an authentication method other than a PKI certificate, this is a Finding._x000A__x000A_For MAC 3 systems, if identification and authentication is not accomplished using the DoD PKI Class 3 certificate and hardware security token (when available) at minimum, this is a Finding._x000A__x000A_For MAC 1 and 2 systems, if identification and authentication is not accomplished using the DoD PKI Class 3 or 4 certificate and hardware security token (when available) or an NSA-certified product at minimum, this is a Finding.</S>
    </MS>
  </Obj>
  <Obj RefId="188">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2005</S>
      <S N="VulnID">V-3811</S>
      <S N="RuleID">SV-24193r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">DG0066-SQLServer9</S>
      <S N="Title">Procedures for establishing temporary passwords that meet DoD password requirements for new accounts should be defined, documented and implemented.</S>
      <S N="Description">New accounts authenticated by passwords that are created without a password or with an easily guessed password are vulnerable to unauthorized access. Procedures for creating new accounts with passwords should include the required assignment of a temporary password to be modified by the user upon first use.falseDatabase AdministratorIAIA-1, IAIA-2</S>
      <S N="FixText">Develop, document and implement procedures for assigning temporary passwords to user accounts._x000A__x000A_Procedures should include instruction to meet current DoD password length and complexity requirements and provide a secure method to relay the temporary password to the user._x000A__x000A_Temporary passwords should also be short-lived and require immediate update by the user upon first login.</S>
      <S N="Check">If all DBMS accounts are configured to authenticate using certificates or other credential besides passwords, this check is Not a Finding._x000A__x000A_Where accounts are authenticated using passwords, review procedures and implementation evidence for creation of temporary passwords._x000A__x000A_If the procedures or evidence do not exist or do not enforce passwords to meet DoD password requirements, this is a Finding.</S>
    </MS>
  </Obj>
  <Obj RefId="189">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2005</S>
      <S N="VulnID">V-3812</S>
      <S N="RuleID">SV-24197r1_rule</S>
      <S N="Severity">high</S>
      <S N="Weight">10.0</S>
      <S N="Version">DG0067-SQLServer9</S>
      <S N="Title">Database account passwords should be stored in encoded or encrypted format whether stored in database objects, external host files, environment variables or any other storage locations.</S>
      <S N="Description">Database passwords stored in clear text are vulnerable to unauthorized disclosure. Database passwords should always be encoded or encrypted when stored internally or externally to the DBMS.falseDatabase AdministratorIAIA-1, IAIA-2</S>
      <S N="FixText">Develop, document and maintain a list of DBMS database objects, database configuration files, associated scripts and applications defined within or external to the DBMS that access the database, and DBMS / user environment files/settings in the System Security Plan._x000A__x000A_Record whether they do or do not contain DBMS passwords._x000A__x000A_If passwords are present, ensure they are encoded or encrypted and protected by host system security._x000A__x000A_Consider using vendor or 3rd party tools to support external authentication.</S>
      <S N="Check">This check applies specifically to the Oracle DBMS installation and its associated files, scripts and environments._x000A__x000A_This check does not apply to compiled, encoded or encrypted application source code and batch job code covered in Check DG0130. _x000A__x000A_Ask the DBA to review the list of DBMS database objects, database configuration files, associated scripts and applications defined within and external to the DBMS that access the database._x000A__x000A_The list should also include files or settings used to configure the operational environment for the DBMS and for interactive DBMS user accounts._x000A__x000A_Ask the DBA and/or IAO to determine if any DBMS database objects, database configuration files, associated scripts and applications defined within or external to the DBMS that access the database, and DBMS / user environment files/settings contain database passwords._x000A__x000A_If any do, confirm that DBMS passwords stored internally or externally to the DBMS are encoded or encrypted._x000A__x000A_If any passwords are stored in clear text, this is a Finding._x000A__x000A_If a list of DBMS database objects, database configuration files, associated scripts and applications defined within or external to the DBMS that access the database, and DBMS / user environment files/settings is not maintained in the System Security Plan, this is a Finding.</S>
    </MS>
  </Obj>
  <Obj RefId="190">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2005</S>
      <S N="VulnID">V-3813</S>
      <S N="RuleID">SV-24215r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">DG0068-SQLServer9</S>
      <S N="Title">DBMS tools or applications that echo or require a password entry in clear text should be protected from password display.</S>
      <S N="Description">Database applications may allow for entry of the account name and password as a visible parameter of the application execution command. This practice should be prohibited and disabled, if possible, by the application. If it cannot be disabled, users should be strictly instructed not to use this feature. Typically, the application will prompt for this information and accept it without echoing it on the users computer screen.falseDatabase AdministratorIAIA-1, IAIA-2</S>
      <S N="FixText">Configure or modify applications to prohibit display of passwords in clear text on the command line if possible._x000A__x000A_Implement policy and train users to prohibit entry of passwords on the command line for applications that cannot be modified or configured to deny this. Remove any applications that can access the database if they are not being used or cannot be monitored.</S>
      <S N="Check">Interview the DBA to determine if any applications that access the database (such as sqlcmd, etc.) allow for entry of the account name and password on the command line._x000A__x000A_If any applications exist and are in use, ask the DBA if users have been instructed not to include passwords on the command line and if these applications are monitored for compliance._x000A__x000A_If documentation of instruction and monitoring are not being performed, this is a Finding.</S>
    </MS>
  </Obj>
  <Obj RefId="191">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2005</S>
      <S N="VulnID">V-3815</S>
      <S N="RuleID">SV-24220r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">DG0071-SQLServer9</S>
      <S N="Title">New passwords should be required to differ from old passwords by more than four characters.</S>
      <S N="Description">Changing passwords frequently can thwart password-guessing attempts or re-establish protection of a compromised DBMS account. Minor changes to passwords may not accomplish this as password guessing may be able to continue to build on previous guesses or the new password may be easily guessed using the old password.falseDatabase AdministratorIAIA-1, IAIA-2</S>
      <S N="FixText">Define, configure and test a password verify feature or function that authenticates passwords on change to ensure that new password differs from old password by more than four characters.</S>
      <S N="Check">If no DBMS accounts authenticate using passwords, this check is Not a Finding._x000A__x000A_If DBMS uses Windows Authentication only, this check is Not a Finding._x000A__x000A_If the DBMS supports this functionality, review the settings and function logic or have the DBA demonstrate a password change to ensure that the function requires new passwords to differ from old passwords by more than four characters._x000A__x000A_If the review or the demonstration reveals that passwords are not checked for a difference of more than four characters, this is a Finding._x000A__x000A_NOTE: Ensure password policy enforcement is enabled for SQL Server accounts per Check DG0079.</S>
    </MS>
  </Obj>
  <Obj RefId="192">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2005</S>
      <S N="VulnID">V-3818</S>
      <S N="RuleID">SV-24090r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">DG0075-SQLServer9</S>
      <S N="Title">Unauthorized database links should not be defined and active.</S>
      <S N="Description">DBMS links provide a communication and data transfer path definition between two databases that may be used by malicious users to discover and obtain unauthorized access to remote systems. Database links between production and development DBMSs provide a means for developers to access production data not authorized for their access or to introduce untested or unauthorized applications to the production database. Only protected, controlled, and authorized downloads of any production data to use for development should be allowed. Only applications that have completed the configuration management process should be introduced by the application object owner account to the production system.trueDatabase AdministratorDCFA-1</S>
      <S N="FixText">Document all remote or external interfaces used by the DBMS to connect to or allow connections from remote or external sources in the System Security Plan and AIS Functional Architecture documentation._x000A__x000A_Include with the documentation as appropriate, any network ports or protocols, security accounts, and the sensitivity of any data exchanged._x000A__x000A_Do not define or configure database links between production databases and test or development databases._x000A__x000A_Delete any links or remote server definitions between production and test or development databases.</S>
      <Nil N="Check" />
    </MS>
  </Obj>
  <Obj RefId="193">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2005</S>
      <S N="VulnID">V-3819</S>
      <S N="RuleID">SV-24226r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">DG0076-SQLServer9</S>
      <S N="Title">Sensitive information from production database exports should be modified after import to a development database.</S>
      <S N="Description">Data export from production databases may include sensitive data. Application developers do not have a need to know to sensitive data. Any access they may have to production data would be considered unauthorized access and subject the sensitive data to unlawful or unauthorized disclosure. See DODD 8500.1 section E2.1.41 for a definition of Sensitive Information.falseDatabase AdministratorECAN-1</S>
      <S N="FixText">Document procedures and restrictions for production data export. Require any users assigned privileges that allow the export of production data from the database to acknowledge understanding of the export restrictions. Restrict permissions allowing use or access to database export procedures or functions to authorized users.</S>
      <S N="Check">If the database is not a production database, this check is Not Applicable._x000A__x000A_Review procedures or restrictions for data exports from the production database. If data exports are allowed, then review procedures for protecting any sensitive data included in the exports. If sensitive data is included in the exports and no protections are taken to remove or modify the data to render it not sensitive when provided to unauthorized users, this is a Finding.</S>
    </MS>
  </Obj>
  <Obj RefId="194">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2005</S>
      <S N="VulnID">V-3820</S>
      <S N="RuleID">SV-24228r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">DG0077-SQLServer9</S>
      <S N="Title">Production databases should be protected from unauthorized access by developers on shared production/development host systems.</S>
      <S N="Description">Developers granted elevated database and operating system privileges on systems that support both development and production databases can affect the operation and/or security of the production database system. Operating system and database privileges assigned to developers on shared development and production systems should be restricted.falseDatabase AdministratorECLP-1</S>
      <S N="FixText">Develop, document and implement procedures to review and maintain privileges granted to developers on shared production and development host systems and databases._x000A__x000A_Recommend establishing a dedicated DBMS host for production DBMS installations (See Checks DG0109 and DG0110)._x000A__x000A_A dedicated host system in this case refers to an instance of the operating system at a minimum._x000A__x000A_The operating system may reside on a virtual host machine where supported by the DBMS vendor.</S>
      <S N="Check">Review the list of instances and databases installed on the host system with the DBA._x000A__x000A_Ask which databases are production databases and which are for development._x000A__x000A_If only development or only production databases exist on this host, this is Not a Finding._x000A__x000A_Otherwise, ask the DBA to confirm that policy and procedures are in place for the IAO to review database and operating system privileges on the system._x000A__x000A_If none are in place, this is a Finding._x000A__x000A_Ask the DBA/SA if developer host accounts have been granted privileges to production database directories, files or resources._x000A__x000A_If they have been, this is a Finding._x000A__x000A_NOTE: Though shared production/non-production DBMS installations was allowed under previous database STIG guidance, doing so may place it in violation of OS, Application, Network or Enclave STIG guidance. Ensure that any shared production/non-production DBMS installations meets STIG guidance requirements at all levels or mitigate any conflicts in STIG guidance with your DAA.</S>
    </MS>
  </Obj>
  <Obj RefId="195">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2005</S>
      <S N="VulnID">V-3821</S>
      <S N="RuleID">SV-24232r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">DG0080-SQLServer9</S>
      <S N="Title">Application user privilege assignment should be reviewed monthly or more frequently to ensure compliance with least privilege and documented policy.</S>
      <S N="Description">Users granted privileges not required to perform their assigned functions are able to make unauthorized modifications to the production data or database. Monthly or more frequent periodic review of privilege assignments assures that organizational and/or functional changes are reflected appropriately.falseDatabase AdministratorECLP-1</S>
      <S N="FixText">Develop, document and implement procedures for periodic review of application user database privilege assignments. Include methods to provide evidence of review in the procedures to verify reviews occur in accordance with the procedures.</S>
      <S N="Check">Review procedures and implementation evidence to determine if procedures are in place for periodic review of user privileges by the IAO. Evidence may consist of email or other correspondence that acknowledges receipt of periodic reports and notification of review between the DBA and IAO or other auditors as assigned._x000A__x000A_If the procedures are incomplete or no evidence of implementation exists, this is a Finding.</S>
    </MS>
  </Obj>
  <Obj RefId="196">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2005</S>
      <S N="VulnID">V-3825</S>
      <S N="RuleID">SV-24248r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">DG0093-SQLServer9</S>
      <S N="Title">Remote adminstrative connections to the database should be encrypted.</S>
      <S N="Description">Communications between a client and database service across the network may contain sensitive information including passwords. Encryption of remote administrative connections to the database ensures confidentiality.falseDatabase AdministratorECCT-1, ECCT-2</S>
      <S N="FixText">Do not administer DBMS systems remotely if possible._x000A__x000A_If this is not possible, ensure that all connections to the DBMS for administrative purposes utilize encryption at all possible levels [i.e. Network (VPN), Host (SSH/RDP), and Database (Client/ODBC/listener)]._x000A__x000A_Ensure unclassified, sensitive data transmitted through a commercial or wireless network are encrypted using NIST-certified cryptography.</S>
      <S N="Check">If no administration accounts are accessed remotely, this check is Not a Finding._x000A__x000A_Ask the DBA if access to the administration accounts is:_x000A__x000A_ 1. Made using remote access through a local host account_x000A_ 2. Made directly to the database from a remote database client_x000A__x000A_If access is via a local host account, review procedures, policy, and/or evidence that remote administrative account access is performed only via an encrypted connection protocol such as SSH, Remote Desktop Connection (properly configured, of course), etc., to connect to the host._x000A__x000A_If it is not, this is a Finding._x000A__x000A_If access is via direct connection to the DBMS from a DBMS client, confirm that a dedicated database listener exists on the DBMS server and configured to encrypt communications for remote administrative connections._x000A__x000A_If it is not, this is a Finding._x000A__x000A_If there are any listeners on the DBMS host that are configured to accept unencrypted traffic, determine through review of policy and training evidence that DBAs know to use the encrypted listener for remote access to administrative accounts._x000A__x000A_If no such policy exists, the DBAs have not been instructed to use or do not use an encrypted connection, this is a Finding._x000A__x000A_Interview DBAs to confirm they use the encrypted listener for remote DBA access._x000A__x000A_If any DBAs do not, this is a Finding._x000A__x000A_Ensure unclassified, sensitive data transmitted through a commercial or wireless network are encrypted using NIST-certified cryptography.</S>
    </MS>
  </Obj>
  <Obj RefId="197">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2005</S>
      <S N="VulnID">V-3827</S>
      <S N="RuleID">SV-24250r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">DG0095-SQLServer9</S>
      <S N="Title">Audit trail data should be reviewed daily or more frequently.</S>
      <S N="Description">Review of audit trail data provides a means for detection of unauthorized access or attempted access. Frequent and regularly scheduled reviews ensures that such access is discovered in a timely manner.falseInformation Assurance OfficerECAT-1</S>
      <S N="FixText">Develop, document and implement policy and procedures to monitor audit trail data daily.</S>
      <S N="Check">Review policy, procedures and implementation evidence for daily audit trail monitoring._x000A__x000A_For SQL Server, the audit trail data is found in audit traces, the system error logs (ERRORLOG.*) files, and the system and application event logs._x000A__x000A_If the policy, procedures and evidence are not present or complete, this is a Finding.</S>
    </MS>
  </Obj>
  <Obj RefId="198">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2005</S>
      <S N="VulnID">V-3832</S>
      <S N="RuleID">SV-25423r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">DM0920-SQLServer9</S>
      <S N="Title">A Windows OS DBA group should exist.</S>
      <S N="Description">The DBA job function differs from the host system administrator job function.  Without a separate host OS group to assign necessary privileges on the operating system, separation of duties is not achieved and excess privileges for the job function are assigned.falseInformation Assurance OfficerECPA-1</S>
      <S N="FixText">Follow the steps outlined in the Check procedure above. Create a Windows OS group to use for SQL Server DBA privilege and permission assignment as documented in the System Security Plan.</S>
      <S N="Check">For Windows 2000:_x000A__x000A_1. Right click on My Computer_x000A_2. Select Manage_x000A_3. Expand Local Users_x000A_4. Expand Groups_x000A__x000A_For Windows 2003:_x000A__x000A_1. Click Start_x000A_2. Select All Programs_x000A_3. Select Administrative Tools_x000A_4. Click Computer Management_x000A_5. Expand System Tools_x000A_6. Expand Local Users and Groups_x000A_7. Select Groups_x000A__x000A_View the list of groups defined. Verify the OS DBA group as specified in the System Security Plan exists._x000A__x000A_If the OS DBA windows group specified in the System Security Plan does not exist, this is a Finding.</S>
    </MS>
  </Obj>
  <Obj RefId="199">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2005</S>
      <S N="VulnID">V-3833</S>
      <S N="RuleID">SV-25426r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">DM0921-SQLServer9</S>
      <S N="Title">Windows OS DBA group should contain only authorized users.</S>
      <S N="Description">The host DBA group is assigned permissions to the DBMS system libraries and may also be used to assign DBA privileges within the database.  Unauthorized DBA privilege assignment leaves the DBMS data and operations vulnerable to complete compromise.falseInformation Assurance OfficerECPA-1</S>
      <S N="FixText">Remove any OS DBA group membership assignments and assignments to the SYSADMIN role from accounts not authorized and documented in the System Security Plan by the IAO._x000A_ _x000A_Authorize and document in the System Security Plan all DBA accounts and assignments to the SYSADMIN role prior to assigning DBA group membership and privileges.</S>
      <S N="Check">For Windows 2000:_x000A__x000A_1. Right click on My Computer_x000A_2. Select Manage_x000A_3. Expand Local Users_x000A_4. Expand Groups_x000A_5. Select the OS DBA Group_x000A_6. Right click on the OS DBA Group_x000A_7. Select Properties_x000A__x000A_For Windows 2003:_x000A__x000A_1. Click Start_x000A_2. Select All Programs_x000A_3. Select Administrative Tools_x000A_4. Click Computer Management_x000A_5. Expand System Tools_x000A_6. Expand Local Users and Groups_x000A_7. Select Groups_x000A_8. Select the OS DBA Group_x000A_9. Right click on the OS DBA Group_x000A_10. Select Properties_x000A__x000A_Review the list of accounts assigned to the OS DBA group._x000A__x000A_Review the list of accounts assigned to the SYSADMIN role:_x000A__x000A_For SQL Server:_x000A__x000A_From the query prompt:_x000A__x000A_  exec sp_helpsrvrolemember 'sysadmin'_x000A__x000A_If any accounts assigned OS DBA group membership or SYSADMIN privileges that are not DBAs as authorized and documented in the System Security Plan, this is a Finding._x000A__x000A_If the OS DBA group is not defined, this is a Finding.</S>
    </MS>
  </Obj>
  <Obj RefId="200">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2005</S>
      <S N="VulnID">V-3835</S>
      <S N="RuleID">SV-25429r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">DM0924-SQLServer9</S>
      <S N="Title">The SQL Server service should use a least-privileged local or domain user account.</S>
      <S N="Description">The Windows builtin Administrators group and LocalSystem account are assigned full privileges to the Windows operating system. These privileges are not required by the SQL Server service accounts for operation and, if assigned, could allow a successful attack of the SQL Server service to lead to a full compromise of the host system.falseSystem AdministratorDatabase AdministratorDCFA-1</S>
      <S N="FixText">Create a local custom account for the SQL Server service accounts. A domain account may be used where network resources are required. _x000A__x000A_Please see SQL Server Books Online for information that is more detailed._x000A__x000A_Assign the service accounts to the SQL Server groups created at installation (SQL Server 2005) if available._x000A__x000A_Assign the SQL Server accounts to the appropriate OS SQL Service group. Do not assign the SQL Server accounts to the OS DBA group._x000A__x000A_Note: Each service identified with an ([Instance Name]) should have its own, separate local user/domain user account. Do not add the SQL Server Agent user/domain account to the local or domain Administrators groups.</S>
      <S N="Check">Check for Service Account used:_x000A__x000A_For Windows 2003 (Windows 2000 is similar):_x000A_1. Click Start_x000A_2. Right click on My Computer_x000A_3. Click on Manage,_x000A_4. Expand Services and Applications_x000A_5. Select Services_x000A_6. Locate the SQL Server ([instance name]) services_x000A_7. Examine the account listed in the â€˜Log On Asâ€™ column_x000A__x000A_If the account listed is a builtin account (LocalSystem, Local Service, Network Service, etc.), this is a Finding._x000A__x000A_Exceptions are:_x000A__x000A_1. SQL Server Active Directory Helper (Network Service)_x000A_2. SQL Server Integration Services (Network Service)_x000A_3. SQL Server VSS Writer (Local System)_x000A__x000A_If the account listed is a domain user account (does not begin with ".\" or the host computer name), then confirm that the service requires access to remote systems including for the provision of email services as documented in the System Security Plan._x000A__x000A_If network resource access is not required, use of domain account is a Finding._x000A__x000A_If the account listed is a local or domain user account, then review group membership privileges. See below for Administrator group privilege check. Note any other group membership assignments for future check analysis._x000A_ _x000A_For Windows 2000:_x000A__x000A_1. Right click on My Computer_x000A_2. Select Manage_x000A_3. Expand Local Users_x000A_4. Expand Groups_x000A_5. Select the Administrators Group_x000A_6. Right click on the Administrators Group_x000A_7. Select Properties_x000A__x000A_For Windows 2003:_x000A__x000A_1. Click Start_x000A_2. Select All Programs_x000A_3. Select Administrative Tools_x000A_4. Click Computer Management_x000A_5. Expand System Tools_x000A_6. Expand Local Users and Groups_x000A_7. Select Groups_x000A_8. Select the Administrators Group_x000A_9. Right click on the Administrators Group_x000A_10. Select Properties_x000A__x000A_If the service account is listed as a member of the Administrators group, this is a Finding._x000A__x000A_Note: SQL Server Agent cannot be configured for autorestart without assignment to the Administrator Group. SQL Server Agent must be manually restarted after the service has been interrupted._x000A__x000A_If clustering is being used, assignment of "Debug Programs" user right to the account either directly or through an assigned group may be required and is authorized.  Ensure this is documented in the System Security Plan.</S>
    </MS>
  </Obj>
  <Obj RefId="201">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2005</S>
      <S N="VulnID">V-3838</S>
      <S N="RuleID">SV-25432r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">DM0927-SQLServer9</S>
      <S N="Title">SQL Server registry keys should be properly secured.</S>
      <S N="Description">Registry keys contain configuration data for the SQL Server services and applications. Unrestricted access or access unnecessary for operation can lead to a compromise of the application or disclosure of information that may lead to a successful attack or compromise of data.falseDatabase AdministratorECAN-1</S>
      <S N="FixText">Review permissions assigned to the SQL Server registry keys and Subkeys._x000A__x000A_Revoke Full Control permissions to accounts or groups other than DBAs, Administrators, System and Creator Owner except for keys and Subkeys listed in the check procedures. _x000A__x000A_Revoke all Read permissions from any custom SQL Server users group and specific other groups as listed in the check procedures.</S>
      <S N="Check">Use regedit.exe (Windows 2003) or regedt32.exe (Windows XP, Windows 2000) to review registry permissions_x000A__x000A_To review registry permissions using regedit.exe, navigate to the registry key indicated, right-click on the key, and select Permissions. Select the users and groups permissions and view the assigned Permissions in the Permissions box._x000A__x000A_To view Special Permissions (From the Permissions window for the key):_x000A__x000A_1. Click on the Advanced button_x000A_2. Select the Effective Permissions tab_x000A_3. Click the Select button_x000A_4. Select the User or Group name to review_x000A_5. To see the list of users or groups:_x000A_  a. Click on the Advanced button_x000A_  b. Click on the Find Now button_x000A_  c. Select a user or group account_x000A_  d. Click OK_x000A__x000A_View registry permissions for the following registry keys and sub-keys under:_x000A__x000A_HKEY_LOCAL_MACHINE \ SOFTWARE \ Microsoft \ Microsoft SQL Server_x000A__x000A_If Full Control permissions are granted to other than Administrators, the DBA group, Creator Owner, System or the SQL Server service group with the following exceptions, this is a Finding._x000A__x000A_1. HKEY_LOCAL_MACHINE \ SOFTWARE \ Microsoft \ Microsoft SQL Server \ Instance Names \ RS \  = Full Control to key to local group account  SQLServer2005ReportServerUser$[instance name]_x000A_2. HKEY_LOCAL_MACHINE \ SOFTWARE \ Microsoft \ Microsoft SQL Server \ MSSQL.1 \ MSSearch \ = Full Control to keys and Subkeys to local group account SQLServer2005MSFTEUser$[instance name]_x000A_3. HKEY_LOCAL_MACHINE \ SOFTWARE \ Microsoft \ Microsoft SQL Server \ MSSQL.1 \ SQLServerAgent \ = Full Control to key to local group account SQLServer2005SQLAgentUser$[instance name]_x000A_4. HKEY_LOCAL_MACHINE \ SOFTWARE \ Microsoft \ Microsoft SQL Server \ MSSQL.1 \ SQLServerAgent \ = Full Control to key to local group account SQLServer2005SQLServerADHelperUser$[instance name]_x000A_5. HKEY_LOCAL_MACHINE \ SOFTWARE \ Microsoft \ Microsoft SQL Server \ Instance Names \ RS \  = Read to keys and Subkeys to local group account Remote Desktop Users_x000A_   _x000A_If other than Read permissions are granted to the custom SQL Server Users group or members of that group, this is a Finding._x000A__x000A_Note: During SQL Server 2005 installation, service group memberships are granted Read access to specific registry keys. If this Read access duplicates the custom SQL Server Users group access, this would not be a Finding._x000A__x000A_The DBA, Creator Owner, System, Administrators and SQL Server service groups should be granted Full Control.</S>
    </MS>
  </Obj>
  <Obj RefId="202">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2005</S>
      <S N="VulnID">V-4754</S>
      <S N="RuleID">SV-24125r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">DG0012-SQLServer9</S>
      <S N="Title">Database software directories including DBMS configuration files are stored in dedicated directories separate from the host OS and other applications.</S>
      <S N="Description">Multiple applications can provide a cumulative negative effect. A vulnerability and subsequent exploit to one application can lead to an exploit of other applications sharing the same security context. For example, an exploit to a web server process that leads to unauthorized administrative access to host system directories can most likely lead to a compromise of all applications hosted by the same system. Database software not installed using dedicated directoriies both threatens and is threatened by other hosted applications. Access controls defined for one application may by default provide access to the other applicationâ€™s database objects or directories. Any method that provides any level of separation of security context assists in the protection between applications.falseDatabase AdministratorDCPA-1</S>
      <S N="FixText">Install SQL Server DBMS software using directories separate from the OS and other application software library directories._x000A__x000A_Re-locate any directories or re-install other application software that currently shares the DBMS software library directory to separate directories._x000A__x000A_Recommend dedicating a separate partition for the DBMS software libraries where supported by the DBMS.</S>
      <S N="Check">Review the SQL Server software library directory. The SQL Server software library is defined in the registry key:_x000A__x000A_HKEY_LOCAL_MACHINE \ SOFTWARE \ Microsoft \ Microsoft SQL Server \ MSSQL.[ #] \ Setup \ SQLProgramDir_x000A__x000A_Note any custom subdirectories within the SQL Server software library directory. _x000A__x000A_If any directories or files not installed with the SQL Server software exist with the SQL Server software directory, this is a Finding.  _x000A__x000A_Only applications that are required for the functioning and administration, not use, of the DBMS should be located on the same disk directory as the DBMS software libraries.</S>
    </MS>
  </Obj>
  <Obj RefId="203">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2005</S>
      <S N="VulnID">V-4758</S>
      <S N="RuleID">SV-24115r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">DG0002-SQLServer9</S>
      <S N="Title">An upgrade/migration plan should be developed to address an unsupported DBMS software version.</S>
      <S N="Description">Unsupported software versions are not patched by vendors to address newly discovered security versions. An unpatched version is vulnerable to attack.  Developing and implementing an upgrade plan prior to a lapse in support helps to protect against published vulnerabilities.falseInformation Assurance OfficerVIVM-1</S>
      <S N="FixText">Apply the latest service pack (after testing) for the supported DBMS version._x000A__x000A_Create an upgrade plan for obsolete or expiring vendor products._x000A__x000A_As soon as an expiration date is published for the product, prepare to upgrade it._x000A__x000A_The cost of the upgrade should be budgeted including any additional testing and development required supporting the upgrade._x000A__x000A_A plan for testing the upgrade should also be scheduled._x000A__x000A_Any other steps for upgrade should be included in the plan and the plan for upgrade should be scheduled for completion prior to expiration of the current product or product support contract.</S>
      <S N="Check">If the check for unsupported version (DG0001) returns an unsupported version or the installed version is within 6 mos. of a desupport notice, ask if migration plans are in progress to upgrade to a supported version. If plans are not in progress, this is a Finding._x000A__x000A_To check version for SQL Server:_x000A__x000A_From the query prompt:_x000A__x000A_SELECT CONVERT(CHAR(13), SERVERPROPERTY('ProductVersion'))_x000A__x000A_Where format is in major.minor.build and we only concern ourselves with the major version:_x000A__x000A_9 = SQL Server 2005_x000A__x000A_From the query prompt:_x000A__x000A_SELECT CONVERT(CHAR(3), SERVERPROPERTY('ProductLevel'))_x000A__x000A_Where value:_x000A__x000A_RTM = Original release version (no service packs installed)_x000A_SPn = Service Pack Level_x000A__x000A_View version and service pack level. If the DBMS is not at the service pack level listed for the version below and no update plan exists, this is a Finding._x000A__x000A_Product Release (as of 1 May 2009)_x0009_Mainstream Support Retired_x0009_Extended Support Retired_x0009_Service Pack_x000A_SQL Server 9 (2005)_x0009_04/12/2011_x0009_04/12/2016_x0009_SP3</S>
    </MS>
  </Obj>
  <Obj RefId="204">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2005</S>
      <S N="VulnID">V-5658</S>
      <S N="RuleID">SV-24113r1_rule</S>
      <S N="Severity">high</S>
      <S N="Weight">10.0</S>
      <S N="Version">DG0001-SQLServer9</S>
      <S N="Title">Vendor supported software is evaluated and patched against newly found vulnerabilities.</S>
      <S N="Description">The version of MS SQL Server must be listed by Microsoft as a supported version. Microsoft discontinues fixes for unsupported versions on reported dates. In order to maintain a secure environment, the installed version must continue to receive fixes for reported vulnerabilities.falseInformation Assurance OfficerVIVM-1</S>
      <S N="FixText">Protect the SQL Server installation from published vulnerabilities by upgrading to a supported version and installing all service packs and HOTFIXes as they become available (after testing).</S>
      <Nil N="Check" />
    </MS>
  </Obj>
  <Obj RefId="205">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2005</S>
      <S N="VulnID">V-5659</S>
      <S N="RuleID">SV-24117r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">DG0003-SQLServer9</S>
      <S N="Title">The latest security patches should be installed.</S>
      <S N="Description">Maintaining the currency of the software version protects the database from known vulnerabilities.falseIf any update has been released that is deemed by Microsoft to be a critical update, this check should be assigned a Severity Category of I.Database AdministratorVIVM-1</S>
      <S N="FixText">Upgrade to the latest SQL Server Service Pack. Apply all applicable Microsoft SQL Server critical updates and HOTFIXes.</S>
      <Nil N="Check" />
    </MS>
  </Obj>
  <Obj RefId="206">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2005</S>
      <S N="VulnID">V-5685</S>
      <S N="RuleID">SV-24075r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">DG0029-SQLServer9</S>
      <S N="Title">Required auditing parameters for database auditing should be set.</S>
      <S N="Description">Auditing provides accountability for changes made to the DBMS configuration or its objects and data. It provides a means to discover suspicious activity and unauthorized changes. Without auditing, a compromise may go undetected and without a means to determine accountability.falseDatabase AdministratorECAR-1, ECAR-2, ECAR-3</S>
      <S N="FixText">Enable the trace created in Check DG0145._x000A__x000A_From the query prompt:_x000A__x000A_EXEC SP_TRACE_SETSTATUS [TraceID], 1_x000A__x000A_Replace [TraceID] with the ID of the trace created for the DG0145 audit trace requirement.</S>
      <S N="Check">If C2 Auditing is enabled (See Check DM0510: C2 audit mode), this check is Not a Finding._x000A__x000A_Determine the SQL Server Edition:_x000A__x000A_From the query prompt:_x000A__x000A_SELECT CONVERT(INT, SERVERPROPERTY('EngineEdition'))_x000A__x000A_If value returned is 1 (Personal or Desktop Edition) or 4 (Express Edition), if auditing is not enabled or not configured completely to requirements, review the System Security Plan. If this is properly explained in the System Security Plan, this is Not a Finding. If this is not documented or documented poorly in the System Security Plan, this is a Finding._x000A__x000A_If value returned is 2 (Standard Edition) or 3 (Enterprise/Developer Edition), these findings apply._x000A__x000A_Determine if trace is enabled._x000A__x000A_From the query prompt:_x000A__x000A_SELECT traceid 'TraceID'_x000A_FROM ::FN_TRACE_GETINFO('0')_x000A_WHERE traceid &lt;&gt; 1 â€“ Do not count default trace in SQL Server 2005_x000A_AND property = 5_x000A_AND value = 1_x000A__x000A_If no trace is returned, this is a Finding._x000A__x000A_If the trace returned for Check DG0145 is not returned above, this is a Finding._x000A_</S>
    </MS>
  </Obj>
  <Obj RefId="207">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2005</S>
      <S N="VulnID">V-5686</S>
      <S N="RuleID">SV-24077r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">DG0032-SQLServer9</S>
      <S N="Title">Audit records should be restricted to authorized individuals.</S>
      <S N="Description">Audit data is frequently targeted by malicious users as it can provide a means to detect their activity. The protection of the audit trail data is of special concern and requires restrictions to allow only the auditor and DBMS backup, recovery, and maintenance users access to it.trueDatabase AdministratorECTP-1</S>
      <S N="FixText">Grant audit file and database audit object access to authorized DBAs and auditors._x000A__x000A_Revoke audit file and database audit object access from unauthorized database and OS accounts._x000A_</S>
      <Nil N="Check" />
    </MS>
  </Obj>
  <Obj RefId="208">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2005</S>
      <S N="VulnID">V-6756</S>
      <S N="RuleID">SV-24119r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">DG0005-SQLServer9</S>
      <S N="Title">Only necessary privileges to the host system should be granted to DBA OS accounts.</S>
      <S N="Description">Database administration accounts are frequently granted more permissions to the local host system than are necessary. This allows inadvertent or malicious changes to the host operating system.falseSystem AdministratorDatabase AdministratorECLP-1</S>
      <S N="FixText">Revoke any host system privileges from DBA accounts not required DBMS administration._x000A__x000A_Revoke any OS group memberships that assign excess privileges to DBA accounts._x000A__x000A_Remove any directly applied permissions or user rights from the DBA account.</S>
      <S N="Check">Review host system privileges assigned to the DBA accounts. If any are granted host system administrator privileges or other system privileges not required for DBMS administration, this is a Finding._x000A_ _x000A_The DBA should have only the OS Users group, custom SQLServer DBA group, SQL Server service groups and custom SQL Server Users groups assigned. The custom SQL Server groups should have only the Log on Locally user right assigned.</S>
    </MS>
  </Obj>
  <Obj RefId="209">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2014</S>
      <S N="VulnID">V-6767</S>
      <Obj N="RuleID" RefId="210">
        <TN RefId="1">
          <T>System.Object[]</T>
          <T>System.Array</T>
          <T>System.Object</T>
        </TN>
        <LST>
          <S>SV-25089r1_rule</S>
          <S>SV-30746r1_rule</S>
        </LST>
      </Obj>
      <Obj N="Severity" RefId="211">
        <TNRef RefId="1" />
        <LST>
          <S>medium</S>
          <S>medium</S>
        </LST>
      </Obj>
      <Obj N="Weight" RefId="212">
        <TNRef RefId="1" />
        <LST>
          <S>10.0</S>
          <S>10.0</S>
        </LST>
      </Obj>
      <Obj N="Version" RefId="213">
        <TNRef RefId="1" />
        <LST>
          <S>DG0007-SQLServer9</S>
          <S>DG0007-SQLServer9</S>
        </LST>
      </Obj>
      <Obj N="Title" RefId="214">
        <TNRef RefId="1" />
        <LST>
          <S>The database should be secured in accordance with DoD guidance where applicable.</S>
          <S>The database should be secured in accordance with DoD, vendor and/or commercially accepted practices where applicable.</S>
        </LST>
      </Obj>
      <Obj N="Description" RefId="215">
        <TNRef RefId="1" />
        <LST>
          <S>DBMS systems that do not follow DoD security guidance are vulnerable to related published vulnerabilities. A DoD reference document such as a security technical implementation guide or security recommendation guide constitutes the primary source for security configuration or implementation guidance for the deployment of newly acquired IA- and IA-enabled IT products that require use of the product's IA capabilities. falseInformation Assurance OfficerDCCS-1, DCCS-2</S>
          <S>DBMS systems that do not follow DoD, vendor and/or public best security practices are vulnerable to related published vulnerabilities. A DoD reference document such as a security technical implementation guide or security recommendation guide constitutes the primary source for security configuration or implementation guidance for the deployment of newly acquired IA- and IA-enabled IT products that require use of the product's IA capabilities.falseInformation Assurance OfficerDCCS-1, DCCS-2</S>
        </LST>
      </Obj>
      <Obj N="FixText" RefId="216">
        <TNRef RefId="1" />
        <LST>
          <S>Apply available DoD security guidance to the DBMS system._x000A__x000A_If DoD security guidance is not available, the system owner works with DISA or NSA to draft configuration guidance for inclusion in a departmental reference guide.</S>
          <S>Apply available security guidance to the DBMS system._x000A__x000A_If DoD security guidance is not available, the following are acceptable in descending order as available:_x000A_  (1) Commercially accepted practices (e.g., SANS);_x000A_  (2) Independent testing results (e.g., ICSA); or_x000A_  (3) Vendor literature</S>
        </LST>
      </Obj>
      <Obj N="Check" RefId="217">
        <TNRef RefId="1" />
        <LST>
          <S>Review security and administration documentation maintained for the DBMS system for indications that DoD security guidance has been applied to the DBMS system._x000A__x000A_If the DBMS system has not been secured using available DoD security guidance, this is a Finding.</S>
          <S>Review security and administration documentation maintained for the DBMS system for indications that security guidance has been applied to the DBMS system._x000A__x000A_If DoD security guidance is not available, the following are acceptable in descending order as available:_x000A_  (1) Commercially accepted practices (e.g., SANS);_x000A_  (2) Independent testing results (e.g., ICSA); or_x000A_  (3) Vendor literature_x000A__x000A_If the DBMS system has not been secured using available security guidance as listed above, this is a Finding.</S>
        </LST>
      </Obj>
    </MS>
  </Obj>
  <Obj RefId="218">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2005</S>
      <S N="VulnID">V-15102</S>
      <S N="RuleID">SV-24234r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">DG0083-SQLServer9</S>
      <S N="Title">Automated notification of suspicious activity detected in the audit trail should be implemented.</S>
      <S N="Description">Audit record collection may quickly overwhelm storage resources and an auditor's ability to review it in a productive manner. Automated tools can provide the means to manage the audit data collected as well as present it to an auditor in an efficient way.falseInformation Assurance OfficerECRG-1</S>
      <S N="FixText">Develop, document and implement database or host system procedures to report audit trail data in a form usable to detect unauthorized access to or usage of DBMS privileges, procedures or data.</S>
      <S N="Check">Review automated tool usage for reporting of audit trail data._x000A__x000A_If automated tools are not used, this is a Finding._x000A__x000A_Automated DBMS jobs and/or procedures may be used to produce the periodic reports where supported by the DBMS.</S>
    </MS>
  </Obj>
  <Obj RefId="219">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2005</S>
      <S N="VulnID">V-15103</S>
      <S N="RuleID">SV-25393r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">DG0161-SQLServer9</S>
      <S N="Title">An automated tool that monitors audit data and immediately reports suspicious activity should be employed for the DBMS.</S>
      <S N="Description">Audit logs only capture information on suspicious events. Without an automated monitoring and alerting tool, malicious activity may go undetected and without response until compromise of the database or data is severe.falseInformation Assurance OfficerECAT-2</S>
      <S N="FixText">Develop or procure, document and implement an automated, continuous on-line monitoring and audit trail creation capability for the DBMS is deployed with the capability to immediately alert personnel of any unusual or inappropriate activity with potential IA implications, and with a user-configurable capability to automatically disable the system if serious IA violations are detected.</S>
      <S N="Check">Review evidence or operation of an automated, continuous on-line monitoring and audit trail creation capability for the DBMS is deployed with the capability to immediately alert personnel of any unusual or inappropriate activity with potential IA implications, and with a user-configurable capability to automatically disable the system if serious IA violations are detected._x000A__x000A_If the requirements listed above are not fully met, this is a Finding.</S>
    </MS>
  </Obj>
  <Obj RefId="220">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2005</S>
      <S N="VulnID">V-15104</S>
      <S N="RuleID">SV-25395r1_rule</S>
      <S N="Severity">high</S>
      <S N="Weight">10.0</S>
      <S N="Version">DG0167-SQLServer9</S>
      <S N="Title">Sensitive data served by the DBMS should be protected by encryption when transmitted across the network.</S>
      <S N="Description">Sensitive data served by the DBMS and transmitted across the network in clear text is vulnerable to unauthorized capture and review.falseDatabase AdministratorECCT-1, ECCT-2</S>
      <S N="FixText">Configure encryption of sensitive data served by the DBMS in accordance with the specifications provided in the System Security Plan._x000A__x000A_Document acceptance of risk by the Information Owner where sensitive or classified data is not encrypted. Have the IAO document assurance that the unencrypted sensitive or classified information is otherwise inaccessible to those who do not have Need-to-Know access to the data._x000A__x000A_For SQL Server 2005:_x000A__x000A_Also, see Microsoft KB article for information on using SQL Server in FIPS 140-2 compliant mode:_x000A__x000A_http://support.microsoft.com/kb/920995/_x000A__x000A_To configure encryption using SQL Server features:_x000A__x000A_From the SQL Server Configuration Manager GUI:_x000A__x000A_1. Expand SQL Server 2005 Network Configuration_x000A_2. Right-click on Protocols for [instance name]_x000A_3. Select Properties_x000A_4. Select the Flags tab_x000A_5. Select Yes for ForceEncryption from the pull-down options</S>
      <S N="Check">If no data is identified as being sensitive or classified by the Information Owner, in the System Security Plan or in the AIS Functional Architecture documentation, this check is Not a Finding._x000A__x000A_If no identified sensitive or classified data requires encryption by the Information Owner in the System Security Plan and/or AIS Functional Architecture documentation, this check is Not a Finding._x000A__x000A_If encryption requirements are listed and specify configuration at the host system or network device level, review evidence that the configuration meets the specification with the DBA. It may be necessary to review network device configuration evidence or host communications configuration evidence with a Network and/or System Administrator._x000A__x000A_If the evidence review does not meet the requirement or specification as listed in the System Security Plan, this is a Finding._x000A__x000A_For SQL Server 2005:_x000A__x000A_If encryption for sensitive data in transit is required by SQL Server configuration, then review the setting for the instance parameter ForceEncryption:_x000A__x000A_From the SQL Server Configuration Manager GUI:_x000A__x000A_1. Expand SQL Server 2005 Network Configuration_x000A_2. Right-click on Protocols for [instance name]_x000A_3. Select Properties_x000A_4. Select the Flags tab_x000A_5. View the value for ForceEncryption_x000A__x000A_OR_x000A__x000A_From the Registry Editor:_x000A__x000A_HKEY_LOCAL_MACHINE \ SOFTWARE \ Microsoft \ Microsoft SQL Server \ MSSQL.1 \ MSSQLServer \ SuperSocketNetLib \ ForceEncryption_x000A__x000A_If the value of ForceEncryption does not equal yes or 1, this is a Finding.</S>
    </MS>
  </Obj>
  <Obj RefId="221">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2005</S>
      <S N="VulnID">V-15105</S>
      <S N="RuleID">SV-24104r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">DG0120-SQLServer9</S>
      <S N="Title">Unauthorized access to external database objects should be removed from application user roles.</S>
      <S N="Description">Access to objects stored and/or executed outside of the DBMS security context may provide an avenue of attack to host system resources not controlled by the DBMS. Any access to external resources from the DBMS can lead to a compromise of the host system or its resources.trueDatabase AdministratorECLP-1</S>
      <S N="FixText">Evaluate the associated risk in allowing access to external objects._x000A__x000A_Consider the security context under which the object is accessed or whether the privileges required to access the object are available for assignment based on job function._x000A__x000A_Where feasible, modify the application to use only objects stored internally to the database. Where not feasible, note the risk assessment and acceptance in the System Security Plan for access to external objects._x000A__x000A_Document required access permissions in the System Security Plan and authorize with the IAO.</S>
      <Nil N="Check" />
    </MS>
  </Obj>
  <Obj RefId="222">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2005</S>
      <S N="VulnID">V-15106</S>
      <S N="RuleID">SV-24238r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">DG0086-SQLServer9</S>
      <S N="Title">DBA roles should be periodically monitored to detect assignment of unauthorized or excess privileges.</S>
      <S N="Description">Excess privilege assignment can lead to intentional or unintentional unauthorized actions. Such actions may compromise the operation or integrity of the DBMS and its data.falseInformation Assurance OfficerECLP-1</S>
      <S N="FixText">Design, document and implement procedures for monitoring DBA role privilege assignments.</S>
      <S N="Check">Review procedures and implementation evidence of DBA role privilege monitoring._x000A__x000A_If procedures are incomplete or not implemented, this is a Finding._x000A__x000A_If monitoring does not occur every 30 days or more often, this is a Finding.</S>
    </MS>
  </Obj>
  <Obj RefId="223">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2005</S>
      <S N="VulnID">V-15107</S>
      <S N="RuleID">SV-24084r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">DG0063-SQLServer9</S>
      <S N="Title">DBMS privileges to restore database data or other DBMS configurations, features or objects should be restricted to authorized DBMS accounts.</S>
      <S N="Description">Unauthorized restoration of database data, objects, or other configuration or features can result in a loss of data integrity, unauthorized configuration, or other DBMS interruption or compromise.trueDatabase AdministratorECLP-1</S>
      <S N="FixText">Define DBMS roles that are authorized for database restore functions, restrict assignment of restore privileges to those roles, and assign those roles only to authorized DBMS accounts.</S>
      <Nil N="Check" />
    </MS>
  </Obj>
  <Obj RefId="224">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2005</S>
      <S N="VulnID">V-15108</S>
      <S N="RuleID">SV-25411r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">DG0194-SQLServer9</S>
      <S N="Title">Privileges assigned to developers on shared production and development DBMS hosts and the DBMS should be monitored every three months or more frequently for unauthorized changes.</S>
      <S N="Description">The developer role does not require Need-to-Know or administrative privileges to production databases. Assigning excess privileges can lead to unauthorized access to sensitive data or compromise of database operations.falseInformation Assurance OfficerECPC-1, ECPC-2</S>
      <S N="FixText">Develop, document and implement policy and procedures to monitor DBMS and DBMS host privileges assigned to developers on shared production and development systems to detect unauthorized assignments every three months or more often._x000A__x000A_Recommend establishing a dedicated DBMS host for production DBMS installations (See Checks DG0109 and DG0110). A dedicated host system in this case refers to an instance of the operating system at a minimum. The operating system may reside on a virtual host machine where supported by the DBMS vendor.</S>
      <S N="Check">If the DBMS or DBMS host is not shared by production and development activities, this check is Not a Finding._x000A__x000A_Review policy, monitoring procedures and evidence of developer privileges on shared development and production DBMS and DBMS host systems with the IAO._x000A__x000A_If developer privileges are not monitored every three months or more frequently, this is a Finding._x000A__x000A_NOTE: Though shared production/non-production DBMS installations was allowed under previous database STIG guidance, doing so may place it in violation of OS, Application, Network or Enclave STIG guidance. Ensure that any shared production/non-production DBMS installations meets STIG guidance requirements at all levels or mitigate any conflicts in STIG guidance with your DAA.</S>
    </MS>
  </Obj>
  <Obj RefId="225">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2005</S>
      <S N="VulnID">V-15109</S>
      <S N="RuleID">SV-25413r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">DG0195-SQLServer9</S>
      <S N="Title">DBMS production application and data directories should be protected from developers on shared production/development DBMS host systems.</S>
      <S N="Description">Developer roles should not be assigned DBMS administrative privileges to production DBMS application and data directories. The separation of production and development DBA and developer roles help protect the production system from unauthorized, malicious or unintentional interruption due to development activities.falseSystem AdministratorDatabase AdministratorECPC-1, ECPC-2</S>
      <S N="FixText">Create separate DBMS host OS groups for developer and production DBAs._x000A__x000A_Do not assign production DBA accounts to development OS groups. Do not assign development DBA accounts to production OS groups._x000A__x000A_Remove any unauthorized accounts from both production and development OS groups._x000A__x000A_Document in the System Security Plan._x000A__x000A_Recommend establishing a dedicated DBMS host for production DBMS installations (See Checks DG0109 and DG0110). A dedicated host system in this case refers to an instance of the operating system at a minimum. The operating system may reside on a virtual host machine where supported by the DBMS vendor.</S>
      <S N="Check">If the DBMS host does not support both production and development operations, this check is Not a Finding._x000A__x000A_Review the list of OS DBA group membership with the SA and DBA. Compare to the list in the System Security Plan._x000A__x000A_If any accounts not identified in the System Security Plan for the production DBMS have been assigned DBA privileges (to include developer accounts), this is a Finding._x000A__x000A_If OS DBA group membership is not included in the System Security Plan, this is a Finding._x000A__x000A_NOTE: Though shared production/non-production DBMS installations was allowed under previous database STIG guidance, doing so may place it in violation of OS, Application, Network or Enclave STIG guidance. Ensure that any shared production/non-production DBMS installations meets STIG guidance requirements at all levels or mitigate any conflicts in STIG guidance with your DAA.</S>
    </MS>
  </Obj>
  <Obj RefId="226">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2005</S>
      <S N="VulnID">V-15110</S>
      <S N="RuleID">SV-24157r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">DG0041-SQLServer9</S>
      <S N="Title">Use of the DBMS installation account should be logged.</S>
      <S N="Description">The DBMS installation account may be used by any authorized user to perform DBMS installation or maintenance. Without logging, accountability for actions attributed to the account is lost.falseInformation Assurance OfficerECLP-1</S>
      <S N="FixText">Develop and implement a logging procedure for use of the DBMS software installation account that provides accountability to individuals for any actions taken by the account.</S>
      <S N="Check">Review and verify implementation of logging procedures defined for use of the DBMS software installation account._x000A__x000A_If procedures for logging access to the DBMS are not present or are not being followed, this is a Finding._x000A__x000A_Host system audit logs should be echoed or matched in the DBMS installation account usage log along with an indication of the person who accessed the account and an explanation for the access.</S>
    </MS>
  </Obj>
  <Obj RefId="227">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2005</S>
      <S N="VulnID">V-15111</S>
      <S N="RuleID">SV-24167r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">DG0042-SQLServer9</S>
      <S N="Title">Use of the DBMS software installation account should be restricted to DBMS software installation, upgrade and maintenance actions.</S>
      <S N="Description">The DBMS software installation account is granted privileges not required for DBA or other functions. Use of accounts configured with excess privileges may result in unauthorized or unintentional compromise of the DBMS.falseInformation Assurance OfficerECLP-1</S>
      <S N="FixText">Develop, document and implement policy and procedures and train authorized users to restrict usage of the DBMS software installation account for DBMS software installation, upgrade and maintenance actions only.</S>
      <S N="Check">Review the logs for usage of the DBMS software installation account. Interview personnel authorized to access the DBMS software installation account to ask how the account is used._x000A__x000A_If any usage of the account is to support daily operations or DBA responsibilities, this is a Finding.</S>
    </MS>
  </Obj>
  <Obj RefId="228">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2005</S>
      <S N="VulnID">V-15112</S>
      <S N="RuleID">SV-24240r1_rule</S>
      <S N="Severity">low</S>
      <S N="Weight">10.0</S>
      <S N="Version">DG0088-SQLServer9</S>
      <S N="Title">The DBMS should be periodically tested for vulnerability management and IA compliance.</S>
      <S N="Description">The DBMS security configuration may be altered either intentionally or unintentionally over time. The DBMS may also be the subject of published vulnerabilities that require the installation of a security patch or a reconfiguration to mitigate the vulnerability. If the DBMS is not monitored for required or unintentional changes that render it not compliant with requirements, it can be vulnerable to attack or compromise.falseInformation Assurance OfficerECMT-1, ECMT-2</S>
      <S N="FixText">Develop, document and implement procedures for periodic testing of the DBMS for current vulnerability management and security configuration compliance as stated in the check._x000A__x000A_Coordinate 3rd-party validation testing for Classified systems.</S>
      <S N="Check">Review procedures and evidence of implementation for DBMS IA and vulnerability management compliance._x000A__x000A_This should include periodic, unannounced, in-depth monitoring and provide for specific penetration testing to ensure compliance with all vulnerability mitigation procedures such as the DoD IAVA or other DoD IA practices is planned, scheduled and conducted._x000A__x000A_Testing is intended to ensure that the system's IA capabilities continue to provide adequate assurance against constantly evolving threats and vulnerabilities._x000A__x000A_The results for Classified systems are required to be independently validated._x000A__x000A_If the requirments listed above are not being met, this is a Finding.</S>
    </MS>
  </Obj>
  <Obj RefId="229">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2005</S>
      <S N="VulnID">V-15113</S>
      <S N="RuleID">SV-23852r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">DM6065-SQLServer9</S>
      <S N="Title">SQL Server replications agents should be run under separate and dedicated OS accounts.</S>
      <S N="Description">Use of shared accounts used by replication agents require that all permissions required to support each of the separate replication agent roles (snapshot publication, distribution, log reading, merge publication, queue reading, and replication maintenance) be assigned to the shared account. This translates to excess privilege assignment to the account to perform a specific job task and an exploit to the single account means a compromise to all replication elements accessed by the shared account. Separation of duties by use of separate and dedicated accounts reduces the risk to the entire replication implementation.trueDatabase AdministratorDCFA-1</S>
      <S N="FixText">Create individual Windows accounts for each replication agent._x000A__x000A_Specify the Windows account created for the replication agent, in the Replication Agent Security settings in SQL Server._x000A__x000A_From the SQL Server Management Studio GUI:_x000A__x000A_1. Expand instance_x000A_2. Expand Replication_x000A_3. Expand Local Publications_x000A_4. For each Local Publication:_x000A_  a. Right-click on the publication_x000A_  b. Select Properties_x000A_  c. Select Agent Security page_x000A_  d. Click on Security Settings button_x000A_  e. Enter the dedicated Windows account for the Snapshot Agent_x000A_  f. Select Connect to the Publisher - By impersonating the process account_x000A_  g. Click OK_x000A_  h. Click OK</S>
      <Nil N="Check" />
    </MS>
  </Obj>
  <Obj RefId="230">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2005</S>
      <S N="VulnID">V-15114</S>
      <S N="RuleID">SV-24242r1_rule</S>
      <S N="Severity">low</S>
      <S N="Weight">10.0</S>
      <S N="Version">DG0089-SQLServer9</S>
      <S N="Title">Developers should not be assigned excessive privileges on production databases.</S>
      <S N="Description">Developers play a unique role and represent a specific type of threat to the security of the DBMS.  Where restricted resources prevent the required separation of production and development DBMS installations, developers granted elevated privileges to create and manage new database objects must also be prevented from actions that can threaten the production operation.falseDatabase AdministratorECPC-1, ECPC-2</S>
      <S N="FixText">Revoke DBA privileges assigned to developers on production DBMS unless required and authorized._x000A__x000A_Revoke database or other production object administrative privileges from developers unless required and authorized._x000A__x000A_Restrict developer privileges to production objects to those granted to application users only where such privileges are required and authorized.</S>
      <S N="Check">If the database is not a production database, this check is Not Applicable._x000A__x000A_Review privileges assigned to developers:_x000A__x000A_1. Identify login name of developer DBMS accounts from the System Security Plan and/or DBA._x000A_2. For each developer account, display the username SID and the databases where the user is defined:_x000A__x000A_  EXEC SP_HELPLOGINS '[login name]'_x000A__x000A_3. Display all fixed server role membership assignments:_x000A__x000A_  EXEC SP_HELPSRVROLEMEMBER_x000A__x000A_If developers are assigned privileges that allow change or alteration of database objects in any production databases, this is a Finding._x000A__x000A_If developers are assigned membership to any DBMS server roles, this is a Finding.</S>
    </MS>
  </Obj>
  <Obj RefId="231">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2005</S>
      <S N="VulnID">V-15116</S>
      <S N="RuleID">SV-25400r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">DG0175-SQLServer9</S>
      <S N="Title">The DBMS host platform and other dependent applications should be configured in compliance with applicable STIG requirements.</S>
      <S N="Description">The security of the data stored in the DBMS is also vulnerable to attacks against the host platform, calling applications, and other application or optional components.falseInformation Assurance OfficerECSC-1</S>
      <S N="FixText">Configure all related application components and the DBMS host platform in accordance with the applicable DOD STIG. Regularly audit the security configuration of related applications and the host platform to confirm continued compliance with security requirements.</S>
      <S N="Check">Review evidence of security hardening and auditing of the DBMS host platform with the IAO. If the DBMS host platform has not been hardened and received a security audit, this is a Finding._x000A__x000A_Review evidence of security hardening and auditing for all application(s) that store data in the database and all other separately configured components that access the database including web servers, application servers, report servers, etc. If any have not been hardened and received a security audit, this is a Finding._x000A__x000A_Review evidence of security hardening and auditing for all application(s) installed on the local DBMS host where security hardening and auditing guidance exists. If any have not been hardened and received a security audit, this is a Finding.</S>
    </MS>
  </Obj>
  <Obj RefId="232">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2005</S>
      <S N="VulnID">V-15117</S>
      <S N="RuleID">SV-25402r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">DG0176-SQLServer9</S>
      <S N="Title">The DBMS audit logs should be included in backup operations.</S>
      <S N="Description">DBMS audit logs are essential to the investigation and prosecution of unauthorized access to the DBMS data. Unless audit logs are available for review, the extent of data compromise may not be determined and the vulnerability exploited may not be discovered. Undiscovered vulnerabilities could lead to additional or prolonged compromise of the data.falseDatabase AdministratorECTB-1</S>
      <S N="FixText">Configure and ensure SQL Server audit trace files, instance and other error log files are included in regular backups.</S>
      <S N="Check">Audit events are logged by SQL Server to error logs, Windows event logs, and to SQL Profiler trace files._x000A__x000A_Review evidence of backups that include the default directory for SQL Server error logs and trace files._x000A__x000A_The default directory for SQL Server error logs and trace files is stored in the Windows registry under:_x000A__x000A_HKEY_LOCAL_MACHINE \ SOFTWARE \ Microsoft \ Microsoft SQL Server \ MSSQL.[#] \ MSSQLServer \ DefaultLog_x000A__x000A_Where [#] is the sequential number assigned to each instance._x000A__x000A_This directory is referred to below as [instance logpath]:_x000A__x000A_SQL Server error logs:_x000A__x000A_[instance logpath]ERRORLOG.[#]_x000A__x000A_Audit trace (*.trc) files:_x000A__x000A_Default is [instance logpath], but may be directed to any accessible directory._x000A__x000A_Log files of other components, e.g. SQLAGENT.[#]:_x000A__x000A_[instance logpath]_x000A__x000A_Audit trace results may also be directed to SQL Server tables. SQL Server data backups are addressed in a separate check; therefore, do not include audit results stored in database tables._x000A__x000A_If evidence of inclusion of audit log files in regular DBMS or host backups does not exist, this is a Finding.</S>
    </MS>
  </Obj>
  <Obj RefId="233">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2005</S>
      <S N="VulnID">V-15118</S>
      <S N="RuleID">SV-25391r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">DG0159-SQLServer9</S>
      <S N="Title">Remote administrative access to the database should be monitored by the IAO or IAM.</S>
      <S N="Description">Remote administrative access to systems provides a path for access to and exploit of DBA privileges. Where the risk has been accepted to allow remote administrative access, it is imperative to instate increased monitoring of this access to detect any abuse or compromise.falseInformation Assurance OfficerInformation Assurance ManagerEBRP-1</S>
      <S N="FixText">Develop, document and implement policy and procedures to monitor remote DBA access to the DBMS._x000A__x000A_The automated generation of a log report with automatic dissemination to the IAO and/or IAM may be used. Require and store an acknowledgement of receipt and confirmation of review for the log report.</S>
      <S N="Check">If remote administrative access to the database is disabled, this check is Not a Finding._x000A__x000A_Review policy, procedures and implementation evidence of monitoring of remote administrative access to the database with the IAO or IAM._x000A__x000A_If policy and procedures for monitoring remote administrative access do not exist or not implemented, this is a Finding.</S>
    </MS>
  </Obj>
  <Obj RefId="234">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2005</S>
      <S N="VulnID">V-15119</S>
      <S N="RuleID">SV-24100r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">DG0114-SQLServer9</S>
      <S N="Title">DBMS files critical for DBMS recovery should be stored on RAID or other high-availability storage devices.</S>
      <S N="Description">DBMS recovery can be adversely affected by hardware storage failure. Impediments to DBMS recovery can have a significant impact on operations.trueSystem AdministratorDatabase AdministratorCOBR-1</S>
      <S N="FixText">Place SQL Server critical files including data, transaction and audit log files on fault-tolerant storage devices or employ SQL Server DBMS or OS clustering where supported by the DBMS. </S>
      <Nil N="Check" />
    </MS>
  </Obj>
  <Obj RefId="235">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2005</S>
      <S N="VulnID">V-15120</S>
      <S N="RuleID">SV-24189r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">DG0064-SQLServer9</S>
      <S N="Title">DBMS backup and restoration files should be protected from unauthorized access.</S>
      <S N="Description">Lost or compromised DBMS backup and restoration files may lead to not only the loss of data, but also the unauthorized access to sensitive data. Backup files need the same protections against unauthorized access when stored on backup media as when online and actively in use by the database system. In addition, the backup media needs to be protected against physical loss. Most DBMSs maintain online copies of critical control files to provide transparent or easy recovery from hard disk loss or other interruptions to database operation.falseDatabase AdministratorCOBR-1</S>
      <S N="FixText">Develop, document and implement protection for backup and restoration files._x000A__x000A_Document personnel and the level of access authorized for each to the backup and restoration files in the System Security Plan.</S>
      <S N="Check">Review file protections assigned to online backup and restoration files._x000A__x000A_Review access protections and procedures for offline backup and restoration files._x000A__x000A_If backup or restoration files are subject to unauthorized access, this is a Finding._x000A__x000A_It may be necessary to review backup and restoration procedures to determine ownership and access during all phases of backup and recovery. In addition to physical and host system protections, consider other methods including password protection to the files.</S>
    </MS>
  </Obj>
  <Obj RefId="236">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2005</S>
      <S N="VulnID">V-15121</S>
      <S N="RuleID">SV-25409r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">DG0187-SQLServer9</S>
      <S N="Title">DBMS software libraries should be periodically backed up.</S>
      <S N="Description">The DBMS application depends upon the availability and integrity of its software libraries. Without backups, compromise or loss of the software libraries can prevent a successful recovery of DBMS operations.falseDatabase AdministratorCOSW-1</S>
      <S N="FixText">Configure backups to include all DBMS application and third-party database application software libraries.</S>
      <S N="Check">Review evidence of SQL Server and dependent application files and directories._x000A__x000A_The SQL Server software directory is specified in the registry value:_x000A__x000A_HKEY_LOCAL_MACHINE \ SOFTWARE \ Microsoft \ Microsoft SQL Server \ MSSQL.[#] \ Setup \ SqlBinRoot_x000A__x000A_Other SQL Server software including, but not limited to SQL Server tools and utilities, are found in the directory and subdirectories under:_x000A__x000A_[drive] \ Program Files \ Microsoft SQL Server_x000A__x000A_This directory is specified in the registry under:_x000A__x000A_HKEY_LOCAL_MACHINE \ SOFTWARE \ Microsoft \ Microsoft SQL Server \ 90 \ Tools \ Setup \ SQLPath_x000A__x000A_Other executables may be installed under the same Microsoft SQL Server path._x000A__x000A_Third-party applications may be located in other directory structures.  _x000A__x000A_Review the System Security Plan for a list of all DBMS application software libraries to be included in software library backups._x000A__x000A_If any software library files are not included in regular backups, this is a Finding.</S>
    </MS>
  </Obj>
  <Obj RefId="237">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2005</S>
      <S N="VulnID">V-15122</S>
      <S N="RuleID">SV-25407r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">DG0186-SQLServer9</S>
      <S N="Title">The database should not be directly accessible from public or unauthorized networks.</S>
      <S N="Description">Databases often store critical and/or sensitive information used by the organization. For this reason, databases are targeted for attacks by malicious users. Additional protections provided by network defenses that limit accessibility help protect the database and its data from unnecessary exposure and risk.falseInformation Assurance OfficerEBBD-1, EBBD-2, EBBD-3</S>
      <S N="FixText">Do not allow direct connections from users originating from the Internet or other public network to the DBMS._x000A__x000A_Include in the System Security Plan for the system whether the DBMS serves public-facing applications or applications serving users from other untrusted networks._x000A__x000A_Do not store sensitive or classified data on a DBMS server that serves public-facing applications.</S>
      <S N="Check">Review the System Security Plan to determine if the DBMS serves data to users or applications outside the local enclave._x000A__x000A_If the DBMS is not accessed outside of the local enclave, this check is Not a Finding._x000A__x000A_If the DBMS serves applications available from a public network (e.g. the Internet), then confirm that the application servers are located in a DMZ._x000A__x000A_If the DBMS is located inside the local enclave and is directly accessible to public users, this is a Finding._x000A__x000A_If the DBMS serves public-facing applications and is not protected from direct client connections and unauthorized networks, this is a Finding._x000A__x000A_If the DBMS serves public-facing applications and contains sensitive or classified information, this is a Finding.</S>
    </MS>
  </Obj>
  <Obj RefId="238">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2005</S>
      <S N="VulnID">V-15124</S>
      <S N="RuleID">SV-25457r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">DM6015-SQLServer9</S>
      <S N="Title">The Named Pipes network protocol should be documented and approved if enabled.</S>
      <S N="Description">The named pipes network protocol requires more ports to be opened on firewalls than TCP/IP. Managing and administering multiple network protocols may unnecessarily complicate network controls.falseDatabase AdministratorDCFA-1</S>
      <S N="FixText">If Named Pipes is required, document its use in the System Security Plan. Disable Named Pipes if not required and documented in the System Security Plan._x000A__x000A_From the SQL Server Configuration Manager GUI:_x000A__x000A_1. Expand SQL Server 2005 Network Configuration_x000A_2. Repeat for each instance:_x000A_  a. Select Protocols for [instance name]_x000A_  b. Double-click Named Pipes._x000A_  c. Select No as the value for Enabled._x000A_  d. Click OK_x000A_3. Click OK (acknowledge change won't take place until next restart)_x000A_4. Exit the SQL Server Configuration Manager GUI</S>
      <S N="Check">From the SQL Server Configuration Manager GUI:_x000A__x000A_1. Expand SQL Server 2005 Network Configuration_x000A_2. Repeat for each instance:_x000A_  a. Select Protocols for [instance name]._x000A_  b. View in the right pane, the status for Named Pipes_x000A__x000A_If Named Pipes is enabled, this is a Finding.</S>
    </MS>
  </Obj>
  <Obj RefId="239">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2005</S>
      <S N="VulnID">V-15125</S>
      <S N="RuleID">SV-23851r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">DM6045-SQLServer9</S>
      <S N="Title">Only authorized users should be assigned permissions to SQL Server Agent proxies.</S>
      <S N="Description">Database accounts granted access to SQL Server Agent proxies are granted permissions to create and submit specific function job steps to be executed by SQL Server Agent. Unauthorized users may use access to proxies to execute unauthorized functions against the SQL Server instance or host operating system.trueDatabase AdministratorECAN-1</S>
      <S N="FixText">Note: SYSADMINs have access to all proxies by default._x000A__x000A_For each user or group granted unauthorized access to a proxy (select based on returns from the SP_ENUM_PROXY_FOR_SUBSYSTEM results):_x000A__x000A_From the query prompt:_x000A__x000A_EXEC SP_REVOKE_LOGIN_FROM_PROXY '[login name]' @proxy_name = '[proxy name]'_x000A__x000A_Replace [proxy name] with the name of the proxy and replace [login name] with the name returned in the SP_ENUM_PROXY_FOR_SUBSYSTEM procedure.</S>
      <Nil N="Check" />
    </MS>
  </Obj>
  <Obj RefId="240">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2014</S>
      <S N="VulnID">V-15126</S>
      <Obj N="RuleID" RefId="241">
        <TNRef RefId="1" />
        <LST>
          <S>SV-24127r1_rule</S>
          <S>SV-30770r1_rule</S>
          <S>SV-30771r1_rule</S>
        </LST>
      </Obj>
      <Obj N="Severity" RefId="242">
        <TNRef RefId="1" />
        <LST>
          <S>medium</S>
          <S>medium</S>
          <S>medium</S>
        </LST>
      </Obj>
      <Obj N="Weight" RefId="243">
        <TNRef RefId="1" />
        <LST>
          <S>10.0</S>
          <S>10.0</S>
          <S>10.0</S>
        </LST>
      </Obj>
      <Obj N="Version" RefId="244">
        <TNRef RefId="1" />
        <LST>
          <S>DG0013-SQLServer9</S>
          <S>DG0013-SQLServer9</S>
          <S>DG0013-SQLServer9</S>
        </LST>
      </Obj>
      <Obj N="Title" RefId="245">
        <TNRef RefId="1" />
        <LST>
          <S>Database backup procedures should be defined, documented and implemented.</S>
          <S>Database backup procedures should be defined, documented and implemented.</S>
          <S>Database backup procedures should be defined, documented and implemented.</S>
        </LST>
      </Obj>
      <Obj N="Description" RefId="246">
        <TNRef RefId="1" />
        <LST>
          <S>Database backups provide the required means to restore databases after compromise or loss. Backups help reduce the vulnerability to unauthorized access or hardware loss.falseSystem AdministratorDatabase AdministratorCODB-1, CODB-2, CODB-3</S>
          <S>Database backups provide the required means to restore databases after compromise or loss. Backups help reduce the vulnerability to unauthorized access or hardware loss.falseSystem AdministratorDatabase AdministratorCODB-1, CODB-2, CODB-3</S>
          <S>Database backups provide the required means to restore databases after compromise or loss. Backups help reduce the vulnerability to unauthorized access or hardware loss.falseSystem AdministratorDatabase AdministratorCODB-1, CODB-2, CODB-3</S>
        </LST>
      </Obj>
      <Obj N="FixText" RefId="247">
        <TNRef RefId="1" />
        <LST>
          <S>Develop, document and implement database backup procedures._x000A__x000A_Include a secondary server installed at a separate location (IAW COOP guidelines) that can be brought online to prevent any disruption to availability or loss of data.</S>
          <S>Develop, document and implement database backup procedures._x000A__x000A_Include daily backup procedures and offline backup data storage at an alternate site.</S>
          <S>Develop, document and implement database backup procedures._x000A__x000A_Include weekly backup procedures and offline backup data storage.</S>
        </LST>
      </Obj>
      <Obj N="Check" RefId="248">
        <TNRef RefId="1" />
        <LST>
          <S>Review the database backup procedures and implementation evidence._x000A__x000A_Evidence of implementation includes records of backup events and physical review of backup media._x000A__x000A_Evidence should match the backup plan as recorded in the System Security Plan._x000A__x000A_If backup procedures do not exist or not implemented in accordance with the procedures, this is a Finding._x000A__x000A_If backups do not include a redundant secondary system maintained at a separate physical site that can be activated without interruption or loss of data if the primary system fails, this is a Finding.</S>
          <S>Review the database backup procedures and implementation evidence._x000A__x000A_Evidence of implementation includes records of backup events and physical review of backup media._x000A__x000A_Evidence should match the backup plan as recorded in the System Security Plan._x000A__x000A_If backup procedures do not exist or not implemented in accordance with the procedures, this is a Finding._x000A__x000A_If backups are not performed daily or more often, this is a Finding._x000A__x000A_If backup data is not secured and stored offline at an alternate site, this is a Finding.</S>
          <S>Review the database backup procedures and implementation evidence._x000A__x000A_Evidence of implementation includes records of backup events and physical review of backup media._x000A__x000A_Evidence should match the backup plan as recorded in the System Security Plan._x000A__x000A_If backup procedures do not exist or not implemented in accordance with the procedures, this is a Finding._x000A__x000A_If backups are not performed weekly or more often, this is a Finding.</S>
        </LST>
      </Obj>
    </MS>
  </Obj>
  <Obj RefId="249">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2005</S>
      <S N="VulnID">V-15127</S>
      <S N="RuleID">SV-24302r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">DG0118-SQLServer9</S>
      <S N="Title">The IAM should review changes to DBA role assignments.</S>
      <S N="Description">Unauthorized assignment of DBA privileges can lead to a compromise of DBMS integrity. Providing oversight to the authorization and assignment of privileges provides the separation of duty to support sufficient oversight.falseInformation Assurance ManagerECPA-1</S>
      <S N="FixText">Develop, document and implement policy and procedures to monitor changes to DBA role assignments._x000A__x000A_Develop, document and implement policy and procedures to notify the IAM of changes to DBA role assignments._x000A__x000A_Include methods in the procedures that provide evidence of monitoring and notification.</S>
      <S N="Check">Review the policy, procedures and implementation evidence for monitoring changes to DBA role assignments and procedures for notifying the IAM of the changes for review._x000A__x000A_If policy, procedures and implementation evidence do not exist, this is a Finding.</S>
    </MS>
  </Obj>
  <Obj RefId="250">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2005</S>
      <S N="VulnID">V-15129</S>
      <S N="RuleID">SV-24139r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">DG0020-SQLServer9</S>
      <S N="Title">Backup and recovery procedures should be developed, documented, implemented and periodically tested.</S>
      <S N="Description">Problems with backup procedures or backup media may not be discovered until after a recovery is needed. Testing and verification of procedures provides the opportunity to discover oversights, conflicts, or other issues in the backup procedures or use of media designed to be used.falseDatabase AdministratorCODP-1, CODP-2, CODP-3</S>
      <S N="FixText">Develop, document and implement testing and verification procedures for database backup and recovery. Include requirements for documenting database backup and recovery testing and verification activities in the procedures.</S>
      <S N="Check">Review the testing and verification procedures documented in the System Security Plan._x000A__x000A_Review evidence of implementation of testing and verification procedures by reviewing logs from backup and recovery implementation. Logs may be in electronic or hardcopy and may include email or other notification._x000A__x000A_If testing and verification of backup and recovery procedures are not documented in the System Security Plan, this is a Finding._x000A__x000A_If evidence of testing and verification of backup and recovery procedures does not exist, this is a Finding.</S>
    </MS>
  </Obj>
  <Obj RefId="251">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2005</S>
      <S N="VulnID">V-15130</S>
      <S N="RuleID">SV-24224r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">DG0074-SQLServer9</S>
      <S N="Title">Unapproved inactive or expired database accounts should not be found on the database.</S>
      <S N="Description">Unused or expired DBMS accounts provide a means for undetected, unauthorized access to the database.trueDatabase AdministratorIAAC-1</S>
      <S N="FixText">Develop, document and implement procedures to monitor database accounts for inactivity and expiration._x000A__x000A_Investigate, document and authorize if appropriate any accounts that are expired or locked or have been inactive for more than 30 days._x000A__x000A_Where appropriate, protect authorized expired or inactive accounts by disabling them or applying some other similar protection:_x000A__x000A_  ALTER LOGIN [NAME] DISABLE_x000A__x000A_Note: DBMS accounts using Windows Authentication or linked to certificates can be monitored or managed by the host or through Active Directory for domain accounts. Ensure DBA and SA coordinate host/domain account management and host/domain account management meets host/domain-level STIG requirements.</S>
      <Nil N="Check" />
    </MS>
  </Obj>
  <Obj RefId="252">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2005</S>
      <S N="VulnID">V-15131</S>
      <S N="RuleID">SV-24244r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">DG0090-SQLServer9</S>
      <S N="Title">Sensitive information stored in the database should be protected by encryption.</S>
      <S N="Description">Sensitive data stored in unencrypted format within the database is vulnerable to unauthorized viewing.falseDatabase AdministratorInformation Assurance OfficerECCR-1, ECCR-2, ECCR-3</S>
      <S N="FixText">Use third-party tools or native DBMS features to encrypt sensitive or classified data stored in the database._x000A__x000A_Use only NIST-certified or NSA-approved cryptography to provide encryption._x000A__x000A_Document acceptance of risk by the Information Owner where sensitive or classified data is not encrypted. Have the IAO document assurance that the unencrypted sensitive or classified information is otherwise inaccessible to those who do not have Need-to-Know access to the data._x000A__x000A_Developers should consider using a record-specific encryption method to protect individual records. For example, by employing the session username or other individualized element as part of the encryption key, then decryption of a data element is only possible by that user or other data accessible only by that user.  _x000A__x000A_Consider applying additional auditing of access to any unencrypted sensitive or classified data when accessed by users (with and/or without Need-to-Know).</S>
      <S N="Check">If no data is identified as being sensitive or classified by the Information Owner, in the System Security Plan or in the AIS Functional Architecture documentation, this check is Not a Finding._x000A__x000A_If no identified sensitive or classified data requires encryption by the Information Owner in the System Security Plan and/or AIS Functional Architecture documentation, this check is Not a Finding._x000A__x000A_Have your DBA use select statements in the database to review sensitive data stored in tables as identified in the System Security Plan and/or AIS Functional Architecture documentation._x000A__x000A_If any sensitive data is human readable by unauthorized users, this is a Finding._x000A__x000A_If encryption is required by the information owner, NIST-certified cryptography is used to encrypt stored sensitive information. _x000A__x000A_If encryption is required by the information owner, NIST-certified cryptography is used to encrypt stored classified non-sources and methods intelligence information._x000A__x000A_If a classified enclave contains sources and methods intelligence data and is accessed by individuals lacking an appropriate clearance for sources and methods intelligence, then NSA-approved cryptography is used to encrypt all sources and methods intelligence stored within the enclave._x000A__x000A_Note: The result for this check may be marked as Not a Finding and the requirement of encryption in the database waived where the database has only database administrative accounts and application accounts that have a need-to-know to the data. This waiver does not preclude any requirement for encryption of the associated database data file (see DG0092).</S>
    </MS>
  </Obj>
  <Obj RefId="253">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2005</S>
      <S N="VulnID">V-15132</S>
      <S N="RuleID">SV-24246r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">DG0092-SQLServer9</S>
      <S N="Title">Database data files containing sensitive information should be encrypted.</S>
      <S N="Description">Where access controls do not provide complete protection of sensitive or classified data, encryption can help to close the gap. Encryption of sensitive data helps protect disclosure to privileged users who do not have a need-to-know requirement to view the data that is stored in files outside of the database. Data encryption also provides a level of protection where database controls cannot restrict access to single rows and columns of data.falseDatabase AdministratorECCR-1, ECCR-2, ECCR-3</S>
      <S N="FixText">Use third-party tools or native DBMS features to encrypt sensitive or classified data stored in the database._x000A__x000A_Use only NIST-certified or NSA-approved cryptography to provide encryption._x000A__x000A_Document acceptance of risk by the Information Owner where sensitive or classified data is not encrypted._x000A__x000A_Have the IAO document assurance that the unencrypted sensitive or classified information is otherwise inaccessible to those who do not have Need-to-Know access to the data._x000A__x000A_To lessen the impact on system performance, separate sensitive data where file encryption is required into dedicated DBMS data files._x000A__x000A_Consider applying additional auditing of access to any unencrypted sensitive or classified data when accessed by users (with and/or without Need-to-Know).</S>
      <S N="Check">Review the System Security Plan and/or the AIS Functional Architecture documentation to discover sensitive or classified data identified by the Information Owner that requires encryption._x000A_ _x000A_If no sensitive or classified data is identified as requiring encryption by the Information Owner, this check is Not a Finding._x000A__x000A_Have the DBA use select statements in the database to review sensitive data stored in tables as identified in the System Security Plan and/or AIS Functional Architecture documentation._x000A__x000A_If all sensitive data as identified is encrypted within the database objects, encryption of the DBMS data files is optional and Not a Finding._x000A__x000A_If all sensitive data is not encrypted within database objects, review encryption applied to the DBMS host data files._x000A__x000A_If no encryption is applied, this is a Finding._x000A__x000A_If encryption is required by the information owner, NIST-certified cryptography is used to encrypt stored sensitive information. _x000A__x000A_If encryption is required by the information owner, NIST-certified cryptography is used to encrypt stored classified non-sources and methods intelligence information._x000A__x000A_If a classified enclave contains sources and methods intelligence data and is accessed by individuals lacking an appropriate clearance for sources and methods intelligence, then NSA-approved cryptography is used to encrypt all sources and methods intelligence stored within the enclave._x000A__x000A_Determine which DBMS data files contain sensitive data. Not all DBMS data files will require encryption.</S>
    </MS>
  </Obj>
  <Obj RefId="254">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2014</S>
      <S N="VulnID">V-15133</S>
      <Obj N="RuleID" RefId="255">
        <TNRef RefId="1" />
        <LST>
          <S>SV-24151r1_rule</S>
          <S>SV-28974r1_rule</S>
        </LST>
      </Obj>
      <Obj N="Severity" RefId="256">
        <TNRef RefId="1" />
        <LST>
          <S>medium</S>
          <S>medium</S>
        </LST>
      </Obj>
      <Obj N="Weight" RefId="257">
        <TNRef RefId="1" />
        <LST>
          <S>10.0</S>
          <S>10.0</S>
        </LST>
      </Obj>
      <Obj N="Version" RefId="258">
        <TNRef RefId="1" />
        <LST>
          <S>DG0031-SQLServer9</S>
          <S>DG0031-SQLServer9</S>
        </LST>
      </Obj>
      <Obj N="Title" RefId="259">
        <TNRef RefId="1" />
        <LST>
          <S>Transaction logs should be periodically reviewed for unauthorized modification of data. Users_x000A_should be notified of time and date of the last change in data content.</S>
          <S>Transaction logs should be periodically reviewed for unauthorized modification of data.</S>
        </LST>
      </Obj>
      <Obj N="Description" RefId="260">
        <TNRef RefId="1" />
        <LST>
          <S>Unauthorized or malicious changes to data compromise the integrity and usefulness of the data. Auditing changes to data supports accountability and non-repudiation. Auditing changes to data may be provided by the application accessing the DBMS or may depend upon the DBMS auditing functions. When DBMS auditing is used, the DBA is responsible for ensuring the auditing configuration meets the application design requirements.falseDatabase AdministratorECCD-1, ECCD-2</S>
          <S>Unauthorized or malicious changes to data compromise the integrity and usefulness of the data. Auditing changes to data supports accountability and non-repudiation. Auditing changes to data may be provided by the application accessing the DBMS or may depend upon the DBMS auditing functions. When DBMS auditing is used, the DBA is responsible for ensuring the auditing configuration meets the application design requirements.falseDatabase AdministratorECCD-1, ECCD-2</S>
        </LST>
      </Obj>
      <Obj N="FixText" RefId="261">
        <TNRef RefId="1" />
        <LST>
          <S>Configure database data auditing to comply with the requirements of the application._x000A__x000A_Document auditing requirements in the System Security Plan._x000A__x000A_Develop, document and implement policy and procedures for reviewing access and changes to data periodically or immediately upon system security events._x000A__x000A_Develop, document and implement mechanisms to notify users of time and date of the last change in data content.</S>
          <S>Configure database data auditing to comply with the requirements of the application._x000A__x000A_Document auditing requirements in the System Security Plan.</S>
        </LST>
      </Obj>
      <Obj N="Check" RefId="262">
        <TNRef RefId="1" />
        <LST>
          <S>If the application does not require auditing using DBMS features, this check is Not Applicable._x000A__x000A_Review the application System Security Plan for requirements for database configuration for auditing changes to application data._x000A__x000A_If the application requires DBMS auditing for changes to data, review the database audit configuration against the application requirement. If the auditing does not comply with the requirement, this is a Finding._x000A__x000A_Review policy and procedures for reviewing access and changes to data._x000A__x000A_If policy and procedures are not in place, this is a Finding. _x000A__x000A_If access and changes to data are not periodically reviewed or immediately reviewed on system security events, this is a Finding._x000A__x000A_If mechanisms are not in place to notify users of time and date of the last change in data content, this is a Finding.</S>
          <S>If the application does not require auditing using DBMS features, this check is Not Applicable._x000A__x000A_Review the application System Security Plan for requirements for database configuration for auditing changes to application data._x000A__x000A_If the application requires DBMS auditing for changes to data, review the database audit configuration against the application requirement. If the auditing does not comply with the requirement, this is a Finding.</S>
        </LST>
      </Obj>
    </MS>
  </Obj>
  <Obj RefId="263">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2005</S>
      <S N="VulnID">V-15134</S>
      <S N="RuleID">SV-25436r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">DM0929-SQLServer9</S>
      <S N="Title">The Integration Services service account should not be assigned excess host system privileges.</S>
      <S N="Description">Excess privileges can unnecessarily increase the vulnerabilities to a successful attack. If the Integration Service is compromised, the attack can lead to use of the privileges assigned to the service account. Administrative and other unnecessary privileges assigned to the service account can be used for an attack on the host system and/or SQL Server database.falseSystem AdministratorDatabase AdministratorDCFA-1</S>
      <S N="FixText">Assign the Network Services Account the privileges as listed in the Check procedures where authorized by the System Administrator.  Confirm that removal of any user rights from the Network Services Account do not conflict with OS or Application STIG requirements or affect operation of the DBMS server._x000A__x000A_Document any changes made in the System Security Plan.</S>
      <S N="Check">Check User Rights (may be assigned using group privileges):_x000A__x000A_1. Click Start_x000A_2. Select Control Panel \ Administrative Tools (Win2K) or Select Administrative Tools (Win2K3)_x000A_3. Click Local Security Policy_x000A_4. Expand Local Policies_x000A_5. Select User Rights Assignment_x000A__x000A_View the Security Settings to see user rights assigned to the service account or group._x000A__x000A_For SQL Server Integration Services service account:_x000A__x000A_If any user rights are assigned to the service account other than the following, this is a Finding:_x000A__x000A_1. Log on as a service (SeServiceLogonRight)_x000A_2. Permission to write to application event log_x000A_3. Bypass traverse checking (SeChangeNotifyPrivilege)_x000A_4. Create global objects (SeCreateGlobalPrivilege)_x000A_5. Impersonate a client after authentication (SeImpersonatePrivilege)_x000A__x000A_If clustering is being used, assignment of "Debug Programs" user right to the account either directly or through an assigned group may be required and is authorized.  Ensure this is documented in the System Security Plan.</S>
    </MS>
  </Obj>
  <Obj RefId="264">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2005</S>
      <S N="VulnID">V-15137</S>
      <S N="RuleID">SV-25454r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">DM3930-SQLServer9</S>
      <S N="Title">Error log retention shoud be set to meet log retention policy.</S>
      <S N="Description">For SQL Server, error logs are used to store system event and system error information. In addition to assisting in correcting system failures or issues that could affect system availability and operation, log information may also be useful in discovering evidence of malicious intent. Management of the error logs requires consideration and planning to prevent loss of security data and maintaining system operation.falseDatabase AdministratorECCR-1, ECCR-2, ECCR-3</S>
      <S N="FixText">Review the SQL Server error log usage and determine a strategy for maintenance._x000A__x000A_The strategy should provide for the longest online retention that is considered meaningful and useful. This is determined over a period for operation and depends upon the amount of log data generated._x000A__x000A_Error logs must be maintained for a minimum of one year (DG0030). Error logs should be moved offline to satisfy this retention requirement. Design the provision for evidence of retention and allow restoration (for review) of the error logs in the System Security Plan._x000A__x000A_For SQL Server 2005:_x000A__x000A_From the SQL Server Management Studio GUI:_x000A__x000A_1. Connect to and expand the SQL Server instance_x000A_2. Expand Management_x000A_3. Right-click on SQL Server Logs_x000A_4. Select Configure_x000A_5. Under the General Page, select or deselect Limit the number of error logs before they are recycled_x000A_6. Enter the number of error log files determined for the SQL Server instance_x000A_7. Click OK</S>
      <S N="Check">Review the registry key value:_x000A__x000A_HKEY_LOCAL_MACHINE \ Software \ Microsoft \ Microsoft SQL Server \ MSSQL.# \ MSSQLServer \ NumErrorLogs _x000A__x000A_where [#] indicates the sequence number assigned to the SQL Server instance._x000A__x000A_Sequence number assignments to instances may be viewed at:_x000A__x000A_HKEY_LOCAL_MACHINE \ Software \ Microsoft \ Microsoft SQL Server \ Instance Names \ SQL \[instance name] _x000A__x000A_Review the number assigned for the maximum number of error logs. Confirm this is the number documented in the System Security Plan._x000A__x000A_If the number is not documented in the System Security Plan or the assigned value does not match the System Security Plan specification, this is a Finding._x000A__x000A_Review evidence that error log retention is maintained for a minimum of one year. Error logs should be moved offline after 30 days or less depending on system storage capacity.</S>
    </MS>
  </Obj>
  <Obj RefId="265">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2005</S>
      <S N="VulnID">V-15138</S>
      <S N="RuleID">SV-24252r1_rule</S>
      <S N="Severity">low</S>
      <S N="Weight">10.0</S>
      <S N="Version">DG0096-SQLServer9</S>
      <S N="Title">The DBMS IA policies and procedures should be reviewed annually or more frequently.</S>
      <S N="Description">A regular review of current database security policies and procedures is necessary to maintain the desired security posture of the DBMS. Policies and procedures should be measured against current DOD policy, STIG guidance, vendor-specific guidance and recommendations, and site-specific or other security policy.falseInformation Assurance OfficerDCAR-1</S>
      <S N="FixText">Develop, document and implement policy and procedures to monitor audit trail data daily.</S>
      <S N="Check">Review policy, procedures and implementation evidence of annual reviews of DBMS IA policy and procedures._x000A__x000A_If policy and procedures do not exist, are incomplete, or are not implemented and followed annually or more frequently, this is a Finding.</S>
    </MS>
  </Obj>
  <Obj RefId="266">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2005</S>
      <S N="VulnID">V-15139</S>
      <S N="RuleID">SV-24254r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">DG0097-SQLServer9</S>
      <S N="Title">Plans and procedures for testing DBMS installations, upgrades and patches should be defined and followed prior to production implementation.</S>
      <S N="Description">Updates and patches to existing software have the intention of improving the security or enhancing or adding features to the product. However, it is unfortunately common that updates or patches can render production systems inoperable or even introduce serious vulnerabilities. Some updates also set security configurations back to unacceptable settings that do not meet security requirements. For these reasons, it is a good practice to test updates and patches offline before introducing them in a production environment.falseInformation Assurance OfficerDCCT-1</S>
      <S N="FixText">Develop, document and implement policy and procedures for testing DBMS installations, upgrades and patches prior to deployment on production systems.</S>
      <S N="Check">Review policy, procedures and implementation evidence for testing DBMS installations, upgrades and patches prior to production deployment._x000A__x000A_If policy and procedures do not exist, are incomplete or evidence of implementation does not exist, this is a Finding.</S>
    </MS>
  </Obj>
  <Obj RefId="267">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2005</S>
      <S N="VulnID">V-15140</S>
      <S N="RuleID">SV-24218r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">DG0069-SQLServer9</S>
      <S N="Title">Procedures and restrictions for import of production data to development databases should be documented, implemented and followed.</S>
      <S N="Description">Data export from production databases may include sensitive data. Application developers do not have a need to know to sensitive data. Any access they may have to production data would be considered unauthorized access and subject the sensitive data to unlawful or unauthorized disclosure.falseDatabase AdministratorECAN-1</S>
      <S N="FixText">Document procedures and restrictions for production data export._x000A__x000A_Require any users assigned privileges that allow the export of production data from the database to acknowledge understanding of the export restrictions._x000A__x000A_Restrict permissions allowing use or access to database export procedures or functions to authorized users.</S>
      <S N="Check">If the database being reviewed is not a production database, this check is Not Applicable._x000A_ _x000A_Review procedures or restrictions for data exports from the production database._x000A__x000A_If data exports are not allowed, then review methods for preventing and monitoring of any production data export._x000A__x000A_If procedures and methods are not complete or implemented, this is a Finding._x000A__x000A_Acknowledgement of data export restrictions and procedures by individuals granted privileges that enable data export is considered sufficient protection, however, record of such acknowledgement must be filed._x000A__x000A_Privileges required for database copy and/or export commands include sysadmin, dbcreator or database owner of the source database._x000A__x000A_If DBMS export utilities are not restricted to users authorized by the IAO, this is a Finding.</S>
    </MS>
  </Obj>
  <Obj RefId="268">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2005</S>
      <S N="VulnID">V-15141</S>
      <S N="RuleID">SV-24263r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">DG0102-SQLServer9</S>
      <S N="Title">DBMS processes or services should run under custom, dedicated OS accounts.</S>
      <S N="Description">Shared accounts do not provide separation of duties nor allow for assignment of least privileges for use by database processes and services. Without separation and least privilege, the exploit of one service or process is more likely to be able to compromise another or all other services.falseDatabase AdministratorDCFA-1</S>
      <S N="FixText">Create and assign custom local or domain user accounts to the SQL Server service accounts._x000A__x000A_Disable any services and service accounts not required for operation._x000A__x000A_Assign only required user rights to the custom service accounts._x000A__x000A_Document in the System Security Plan.</S>
      <S N="Check">Note: The SQL Server Service is covered in Check DG0101._x000A__x000A_View the service account properties for the SQL Server services._x000A__x000A_1. Select Start / Administrative Tools / Services_x000A_2. View Properties / Log On for the following services:_x000A_  a. SQL Server Agent ([Instance Name])_x000A_  b. SQL Server Analysis Services ([Instance Name])_x000A_  c. SQL Server Browser ([Instance Name])_x000A_  d. SQL Server FullText Search ([Instance Name])_x000A_  e. SQL Server Reporting Services ([Instance Name])_x000A_3. View Properties / Log on for the following services:_x000A_  a. SQL Server Active Directory Helper (Log On As Network Service)_x000A_  b. SQL Server Integration Services (Log On As Network Service)_x000A_  c. SQL Server VSS Writer (Log On As Local System)_x000A__x000A_Not all of these services may exist. If some services do not exist, checks for these services are Not a Finding._x000A__x000A_If the listed services do not use a custom account (with exception to 3a â€“ 3c above), this is a Finding._x000A__x000A_If any of the services uses a domain user account, then review the requirement for the domain user account. If the service does not require interaction with network or domain resources, this is a Finding._x000A__x000A_Note: Use of a local user account is recommended unless domain or network resources are accessed by the service._x000A__x000A_Review user rights assigned to the SQL Server service accounts. User rights may also be assigned to the service accounts via Windows groups and group policies:_x000A__x000A_1. Select Start / Run_x000A_2. Type: gpedit.msc (enter)_x000A_3. Under Group Policy Editor:_x000A_  a. Expand  Local Computer Policy_x000A_  b. Expand Computer Configuration_x000A_  c. Expand Windows Settings_x000A_  d. Expand Security Settings_x000A_  e. Expand Local Properties_x000A_  f. Select User Rights Assignment_x000A_  g. Locate the Policies under each listed service_x000A_  h. Confirm the Security Setting for each policy contains the custom account assigned to the service_x000A_    i. Log on as a service_x000A_      1. SQL Server Agent_x000A_      2. SQL Server Analysis Services_x000A_      3. SQL Server Browser_x000A_      4. SQL Server FullText Search_x000A_      5. SQL Server Reporting Services_x000A_      6. SQL Server Active Directory Helper_x000A_      7. SQL Server Integration Services_x000A_      8. SQL Server VSS Writer_x000A_    ii. Act as part of the Operating System_x000A_      1. SQL Server Agent_x000A_    iii. Log on as a batch job_x000A_      1. SQL Server Agent_x000A_    iv. Bypass traverse checking_x000A_      1. SQL Server Agent_x000A_      2. SQL Server Integration Services_x000A_    v. Replace a process-level token_x000A_      1. SQL Server Agent_x000A_    vi. Adjust memory quotas for a process_x000A_      1. SQL Server Agent_x000A_    vii. Create global objects_x000A_      1. SQL Server Integration Services_x000A_    viii. Impersonate a client after authentication_x000A_      1. SQL Server Integration Services_x000A_  i. Exit Group Policy Editor_x000A__x000A_If any user rights other than those listed above are assigned to the service accounts, this is a Finding.</S>
    </MS>
  </Obj>
  <Obj RefId="269">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2005</S>
      <S N="VulnID">V-15143</S>
      <S N="RuleID">SV-24269r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">DG0106-SQLServer9</S>
      <S N="Title">Database data encryption controls should be configured in accordance with application requirements.</S>
      <S N="Description">Authorizations may not sufficiently protect access to sensitive data and may require encryption. In some cases, the required encryption may be provided by the application accessing the database. In others, the DBMS may be configured to provide the data encryption. When the DBMS provides the encryption, the requirement must be implemented as identified by the Information Owner to prevent unauthorized disclosure or access.falseDatabase AdministratorDCFA-1</S>
      <S N="FixText">Configure DBMS encryption features and functions as required by the System Security Plan and AIS Functional Architecture documentation. Discrepancies between what features are and are not available should be resolved with the Information Owner, Application Developer and DBA as overseen by the IAO.</S>
      <S N="Check">Review the System Security Plan and AIS Functional Architecture documentation and note sensitive data identified by the Information Owner as requiring encryption using DBMS features administered by the DBA._x000A__x000A_If no data is identified as being sensitive or classified by the Information Owner, in the System Security Plan or in the AIS Functional Architecture documentation, this check is Not a Finding._x000A__x000A_Review the encryption configuration against the System Security Plan and AIS Functional Architecture documentation specification._x000A__x000A_If the specified encryption is not configured, this is a Finding.</S>
    </MS>
  </Obj>
  <Obj RefId="270">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2005</S>
      <S N="VulnID">V-15144</S>
      <S N="RuleID">SV-24271r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">DG0107-SQLServer9</S>
      <S N="Title">Sensitive data is stored in the database and should be identified in the System Security Plan and AIS Functional Architecture documentation.</S>
      <S N="Description">A DBMS that does not have the correct confidentiality level identified or any confidentiality level assigned stands the chance of not being secured at a level appropriate to the risk it poses.falseInformation Assurance OfficerDCFA-1</S>
      <S N="FixText">Include identification of any sensitive data in the System Security Plan and AIS Functional Architecture. Include discussions of data that appear to be sensitive and annotate why it is not marked as such.</S>
      <S N="Check">Review the System Security Plan and AIS Functional Architecture documentation for the DBMS and note any sensitive data that is identified._x000A__x000A_Review database table column data or descriptions that indicate sensitive data. For example, a data column labeled "SSN" could indicate social security numbers are stored in the column. Question the IAO or DBA where any questions arise._x000A__x000A_General categories of sensitive data requiring identification include any personal identifiable information (PII) involving health, financial and security proprietary or sensitive business data or data that might be classified._x000A__x000A_If any columns in the database contain data considered sensitive and is not referenced in the System Security Plan and AIS Functional Architecture documentation, this is a Finding.</S>
    </MS>
  </Obj>
  <Obj RefId="271">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2005</S>
      <S N="VulnID">V-15145</S>
      <S N="RuleID">SV-24275r1_rule</S>
      <S N="Severity">low</S>
      <S N="Weight">10.0</S>
      <S N="Version">DG0108-SQLServer9</S>
      <S N="Title">The DBMS restoration priority should be assigned.</S>
      <S N="Description">When DBMS service is disrupted, the impact it has on the overall mission of the organization can be severe. Without the proper assignment of the priority to be placed on restoration of the DBMS and its subsystems, restoration of DBMS services may not meet mission requirements.falseInformation Assurance OfficerDCFA-1</S>
      <S N="FixText">Review the mission criticality of the DBMS in relation to the overall mission of the organization and assign it a restoration priority.</S>
      <S N="Check">Review the System Security Plan to discover the restoration priority assigned to the DBMS._x000A__x000A_If it is not assigned, this is a Finding.</S>
    </MS>
  </Obj>
  <Obj RefId="272">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2005</S>
      <S N="VulnID">V-15146</S>
      <S N="RuleID">SV-24278r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">DG0109-SQLServer9</S>
      <S N="Title">The DBMS should not be operated without authorization on a host system supporting other application services.</S>
      <S N="Description">In the same way that added security layers can provide a cumulative positive effect on security posture, multiple applications can provide a cumulative negative effect. A vulnerability and subsequent exploit to one application can lead to an exploit of other applications sharing the same security context. For example, an exploit to a web server process that leads to unauthorized administrative access to the host system can most likely lead to a compromise of all applications hosted by the same system. A DBMS not installed on a dedicated host may pose a threat to and be threatened by other hosted applications. Applications that share a single DBMS may also create risk to one another. Access controls defined for one application by default may provide access to the other application's database objects or directories. Any method that provides any level of separation of security context assists in the protection between applications.falseInformation Assurance OfficerDCPA-1</S>
      <S N="FixText">A dedicated host system in this case refers to an instance of the operating system at a minimum._x000A__x000A_The operating system may reside on a virtual host machine if supported by the DBMS vendor._x000A__x000A_Remove any unauthorized processes or services and install on a separate host system._x000A__x000A_Where separation is not supported, update the System Security Plan and provide the technical requirement for having the application share a host with the DBMS.</S>
      <S N="Check">Review the list of processes/services running on the DBMS host system._x000A__x000A_For Windows, review the Services snap-in. Investigate with the DBA/SA any unknown services._x000A__x000A_If any of the services or processes are identified as supporting applications or functions not authorized in the System Security Plan, this is a Finding._x000A__x000A_Note: Only applications that are operationally required to share the same host system may be authorized to do so. Applications that share the same host for administrative, financial or other non-operational reasons may not be authorized and are a Finding.</S>
    </MS>
  </Obj>
  <Obj RefId="273">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2005</S>
      <S N="VulnID">V-15147</S>
      <S N="RuleID">SV-24289r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">DG0111-SQLServer9</S>
      <S N="Title">The DBMS data files, transaction logs and audit files should be stored in dedicated directories or disk partitions separate from software or other application files.</S>
      <S N="Description">Protection of DBMS data, transaction and audit data files stored by the host operating system is dependent on OS controls. When different applications share the same database process, resource contention and differing security controls may be required to isolate and protect one application's data and audit logs from another. DBMS software libraries and configuration files also require differing access control lists.falseDatabase AdministratorDCPA-1</S>
      <S N="FixText">Configure the DBMS to specify dedicated host system disk directories to store database and log files for each application sharing the database. Do not share the application's data disk directory with application software libraries.</S>
      <S N="Check">If separation of data, transaction and audit data is not supported by the DBMS, this check is Not a Finding._x000A__x000A_In the references below, replace SQL5Root with the registry path:_x000A__x000A_  "HKEY_LOCAL_MACHINE \ SOFTWARE \ Microsoft \ Microsoft SQL Server"_x000A__x000A_Replace [#] with the SQL Server instance number as listed under:_x000A__x000A_  SQL5Root \ Instance Names \ SQL \ [instance name]_x000A__x000A_Review the disk/directory specification where database data, transaction log and audit files are stored:_x000A__x000A_  SQL5Root \ MSSQL.[#] \ Setup \ SQLProgramDir_x000A__x000A_Review the default data and log directory specifications in the registry:_x000A__x000A_  SQL5Root \ MSSQL.[#] \ MSSQLServer \ DefaultData_x000A_  SQL5Root \ MSSQL.[#] \ MSSQLServer \ DefaultLog_x000A__x000A_If the program file directory and disk partition is the same as either the DefaultData or the DefaultLog directories, this is a Finding._x000A__x000A_If stored separately and access permissions for each directory is the same, this is a Finding.</S>
    </MS>
  </Obj>
  <Obj RefId="274">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2005</S>
      <S N="VulnID">V-15148</S>
      <S N="RuleID">SV-25376r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">DG0152-SQLServer9</S>
      <S N="Title">DBMS network communications should comply with PPS usage restrictions.</S>
      <S N="Description">Non-standard network ports, protocol or services configuration or usage could lead to bypass of network perimeter security controls and protections.falseDatabase AdministratorDCPP-1</S>
      <S N="FixText">From the SQL Server Configuration Manager GUI:_x000A__x000A_1. Expand SQL Server 2005 Network Configuration_x000A_2. Select Protocols for [instance name]_x000A_3. Right-click on TCP/IP_x000A_4. Select  Properties_x000A_5. Select  IP Addresses tab_x000A_6. Clear any value listed in TCP Dynamic Ports for all IP addresses_x000A_7. Set all TCP Port values for ports accessed across a network boundary to TCP Port 1433_x000A__x000A_Ensure port is registered in the PPS CAL for use outside the enclave:_x000A__x000A_http://iase.disa.mil/ports/index.html</S>
      <S N="Check">From the SQL Server Configuration Manager GUI:_x000A__x000A_1. Expand SQL Server 2005 Network Configuration_x000A_2. Select Protocols for [instance name]_x000A_3. Right-click on TCP/IP_x000A_4. Select  Properties_x000A_5. Select  IP Addresses tab_x000A__x000A_View all TCP Dynamic Ports and TCP Port values for all IP addresses._x000A__x000A_OR_x000A__x000A_View the registry values:_x000A__x000A_HKEY_LOCAL_MACHINE \ Software \ Microsoft \ Microsoft SQL Server \ MSSQL.[#] \ MSSQLServer \ SuperSocketNetLib \ Tcp\IP[#]  \ TCPDynamicPorts_x000A__x000A_HKEY_LOCAL_MACHINE \ Software \ Microsoft \ Microsoft SQL Server \ MSSQL.[#] \ MSSQLServer \ SuperSocketNetLib \ Tcp\IP[#]  \ TcpPort_x000A__x000A_HKEY_LOCAL_MACHINE \ Software \ Microsoft \ Microsoft SQL Server \ MSSQL.[#] \ MSSQLServer \ SuperSocketNetLib \ IPAll \ TCPDynamicPorts_x000A__x000A_HKEY_LOCAL_MACHINE \ Software \ Microsoft \ Microsoft SQL Server \ MSSQL.[#] \ MSSQLServer \ SuperSocketNetLib \ IPAll \ TcpPort_x000A__x000A_If any value (including 0) is entered for TCP Dynamic Ports, this is a Finding._x000A__x000A_A blank value indicates dynamic ports are not enabled and is Not a Finding._x000A__x000A_For SQL Server 2005 default instance, if the TCP Port value is set to 1433, this is Not a Finding._x000A__x000A_NOTE: For SQL Server 2005 named instance (via SQL Server Browser service), UDP Port 1434 is used._x000A__x000A_If any TCP Port value is set to a different port number, verify network traffic for the DBMS does not cross network or enclave boundaries as defined in the PPS CAL or registered with the PPS:_x000A__x000A_http://iase.disa.mil/ports/index.html_x000A__x000A_If any do and are not registered or allowed per the PPS, this is a Finding.</S>
    </MS>
  </Obj>
  <Obj RefId="275">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2005</S>
      <S N="VulnID">V-15149</S>
      <S N="RuleID">SV-25378r1_rule</S>
      <S N="Severity">low</S>
      <S N="Weight">10.0</S>
      <S N="Version">DG0153-SQLServer9</S>
      <S N="Title">DBA roles assignments should be assigned and authorized by the IAO.</S>
      <S N="Description">The DBA role and associated privileges provide complete control over the DBMS operation and integrity. DBA role assignment without authorization could lead to the assignment of these privileges to untrusted and untrustworthy persons and complete compromise of DBMS integrity.falseInformation Assurance OfficerDCSD-1</S>
      <S N="FixText">Develop, document and implement procedures to ensure all DBA role assignments are authorized and assigned by the IAO._x000A__x000A_Include methods that provide evidence of approval in the procedures.</S>
      <S N="Check">Review the documented procedures for approval and granting of DBA privileges._x000A__x000A_Review implementation evidence for the procedures._x000A__x000A_If procedures do not exist or evidence that they are followed does not exist, this is a Finding.</S>
    </MS>
  </Obj>
  <Obj RefId="276">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2005</S>
      <S N="VulnID">V-15150</S>
      <S N="RuleID">SV-25380r1_rule</S>
      <S N="Severity">low</S>
      <S N="Weight">10.0</S>
      <S N="Version">DG0154-SQLServer9</S>
      <S N="Title">The DBMS requires a System Security Plan containing all required information.</S>
      <S N="Description">A System Security Plan identifies security control applicability and configuration for the DBMS. It also contains security control documentation requirements. Security controls applicable to the DBMS may not be documented, tracked or followed if not identified in the System Security Plan. Any omission of security control consideration could lead to an exploit of DBMS vulnerabilities.falseInformation Assurance OfficerDCSD-1</S>
      <S N="FixText">Develop, document and implement a System Security Plan for the DBMS or include IA documentation related to the DBMS in the System Security Plan of the system that the DBMS supports._x000A__x000A_Refer to Section 3.4 in the Microsoft SQL Server Database Security Checklist for information on how to develop a System Security Plan._x000A__x000A_Include or note additional information in the System Security Plan where required in other DBMS checks.</S>
      <S N="Check">Review the System Security Plan for the DBMS with the IAO._x000A__x000A_Review coverage of the following in the System Security Plan:_x000A_1. Technical, administrative and procedural IA program and policies that govern the DBMS_x000A_2. Identification of all IA personnel (IAM, IAO, DBA, SA) assigned responsibility to the DBMS_x000A_3. Specific IA requirements and objectives (e.g., requirements for data handling or dissemination (to include identification of sensitive data stored in the database,  database application user job functions/roles and privileges), system redundancy and backup, or emergency response)_x000A__x000A_If the System Security Plan does not exist, this is a Finding._x000A__x000A_If the System Security Plan does not include the information listed above at a minimum, this is a Finding.</S>
    </MS>
  </Obj>
  <Obj RefId="277">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2005</S>
      <S N="VulnID">V-15152</S>
      <S N="RuleID">SV-24092r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">DG0079-SQLServer9</S>
      <S N="Title">DBMS login accounts require passwords to meet complexity requirements.</S>
      <S N="Description">Weak passwords are a primary target for attack to gain unauthorized access to databases and other systems. Where username/password is used for identification and authentication to the database, requiring the use of strong passwords can help prevent simple and more sophisticated methods for guessing at passwords.trueDatabase AdministratorIAIA-1, IAIA-2</S>
      <S N="FixText">For all DBMS accounts using SQL Server logins, set the accounts for password complexity checking:_x000A__x000A_From the query prompt:_x000A__x000A_ALTER LOGIN [login name] CHECK_POLICY = ON_x000A__x000A_Note: This setting depends upon host system password complexity settings. The host system must be configured to comply with Windows STIG requirements._x000A_</S>
      <Nil N="Check" />
    </MS>
  </Obj>
  <Obj RefId="278">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2005</S>
      <S N="VulnID">V-15153</S>
      <S N="RuleID">SV-19452r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">DG0125-SQLServer9</S>
      <S N="Title">DBMS account passwords should be set to expire every 60 days or more frequently.</S>
      <S N="Description">Unchanged passwords provide a means for compromised passwords to be used for unauthorized access to DBMS accounts over a long time.trueDatabase AdministratorIAIA-1, IAIA-2</S>
      <S N="FixText">Set SQL Server logins to check password expiration._x000A__x000A_ALTER LOGIN [user name] WITH CHECK_EXPIRATION = ON_x000A_</S>
      <Nil N="Check" />
    </MS>
  </Obj>
  <Obj RefId="279">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2005</S>
      <S N="VulnID">V-15154</S>
      <S N="RuleID">SV-24111r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">DG0190-SQLServer9</S>
      <S N="Title">Credentials stored and used by the DBMS to access remote databases or applications should be authorized and restricted to authorized users.</S>
      <S N="Description">Credentials defined for access to remote databases or applications may provide unauthorized access to additional databases and applications to unauthorized or malicious users.trueDatabase AdministratorDCFA-1</S>
      <S N="FixText">Grant access to linked servers to authorized accounts or applications only._x000A__x000A_Document all linked server access authorizations in the System Security Plan and authorize with the IAO.</S>
      <Nil N="Check" />
    </MS>
  </Obj>
  <Obj RefId="280">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2005</S>
      <S N="VulnID">V-15155</S>
      <S N="RuleID">SV-25439r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">DM0933-SQLServer9</S>
      <S N="Title">The SQL Server Agent service account should not be assigned excess user rights.</S>
      <S N="Description">Excess privileges can unnecessarily increase the vulnerabilities to a successful attack. If the SQL Server Agent service is compromised, the attack can lead to use of the privileges assigned to the service account. Administrative and other unnecessary privileges assigned to the service account can be used for an attack on the host system and/or SQL Server database.falseSystem AdministratorDatabase AdministratorDCFA-1</S>
      <S N="FixText">Create a local custom account for the SQL Server Agent service account. A domain account may be used where network resources are required. Please see SQL Server Books Online for information that is more detailed._x000A__x000A_Assign the account to the SQL Server Agent (group created at installation for SQL Server 2005) if available._x000A__x000A_Assign the SQL Server Agent account or group the user privileges as listed in the Check procedures.</S>
      <S N="Check">Check User Rights (may be assigned using group privileges):_x000A__x000A_1. Click Start_x000A_2. Select Control Panel \ Administrative Tools (Win2K) or Select Administrative Tools (Win2K3)_x000A_3. Click Local Security Policy_x000A_4. Expand Local Policies_x000A_5. Select User Rights Assignment_x000A__x000A_View the Security Settings to see user rights assigned to the service account or group._x000A__x000A_For SQL Server Agent service account:_x000A__x000A_If any user rights are assigned to the service account other than the following, this is a Finding:_x000A__x000A_1. Log on as a service (SeServiceLogonRight)_x000A_2. Act as part of the operating system (SeTcbPrivilege) (Win2K only)_x000A_3. Log on as a batch job (SeBatchLogonRight)_x000A_4. Replace a process-level token (SeAssignPrimaryTokenPrivilege)_x000A_5. Bypass traverse checking (SeChangeNotifyPrivilege)_x000A_6. Adjust memory quotas for a process (SeIncreaseQuotaPrivilege)_x000A__x000A_If clustering is being used, assignment of "Debug Programs" user right to the account either directly or through an assigned group may be required and is authorized.  Ensure this is documented in the System Security Plan.</S>
    </MS>
  </Obj>
  <Obj RefId="281">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2005</S>
      <S N="VulnID">V-15165</S>
      <S N="RuleID">SV-23857r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">DM6128-SQLServer9</S>
      <S N="Title">Only authorized service broker endpoints should be configured on the server.</S>
      <S N="Description">Service Broker endpoints expose the database to SQL Server messaging communication access. Where not carefully designed and implemented, messaging communication can unnecessarily expose the database to additional exploit that compromises data confidentiality and integrity. Removing messaging communication endpoints helps to protect the database from unauthorized messaging communication access.trueDatabase AdministratorDCFA-1</S>
      <S N="FixText">Authorize and document Service Broker endpoints in the System Security Plan. Where not authorized, drop Service Broker service endpoints._x000A__x000A_From the query prompt:_x000A__x000A_DROP ENDPOINT [endpoint name]</S>
      <Nil N="Check" />
    </MS>
  </Obj>
  <Obj RefId="282">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2005</S>
      <S N="VulnID">V-15166</S>
      <S N="RuleID">SV-25496r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">DM6160-SQLServer9</S>
      <S N="Title">Database Engine Ad Hoc distributed queries should be disabled.</S>
      <S N="Description">Adhoc queries allow undefined access to remote database sources. Access to untrusted databases could result in execution of malicious applications and/or a compromise of local data confidentiality and integrity.falseDatabase AdministratorDCFA-1</S>
      <S N="FixText">Authorize and document requirements for use of Ad hoc distributed queries in the System_x000A_Security Plan and AIS Functional Architecture documentation. Where not authorized, disable its use._x000A__x000A_From the query prompt:_x000A_EXEC SP_CONFIGURE 'show advanced options', 1_x000A_EXEC SP_CONFIGURE 'ad hoc distributed queries', 0_x000A_RECONFIGURE</S>
      <S N="Check">From the query prompt:_x000A__x000A_SELECT CAST(value AS INT) 'Config_Value'_x000A_FROM [master].sys.configurations_x000A_WHERE name = 'ad hoc distributed queries'_x000A__x000A_If the value of Config_Value is 0, this is Not a Finding._x000A__x000A_If the value of Config_Value is 1, confirm in the System Security Plan that this option is documented, required and approved by the IAO. If it is not documented, required and approved, this is a Finding.</S>
    </MS>
  </Obj>
  <Obj RefId="283">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2005</S>
      <S N="VulnID">V-15167</S>
      <S N="RuleID">SV-23867r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">DM6189-SQLServer9</S>
      <S N="Title">The data directory should specify a dedicated disk partition and restricted access.</S>
      <S N="Description">Data directories require different access controls than software file directories. Locating data directories in separate directories on a dedicated disk partition allows assign of access controls to only those users that require access and helps protect the data from unauthorized access.falseDatabase AdministratorDCPA-1</S>
      <S N="FixText">Create at least one dedicated disk partition to store database data and log files._x000A__x000A_Create dedicated directories to store database data files for each individual application that uses the database._x000A__x000A_Specify the dedicated database data file disk partition for the default data directory._x000A__x000A_Include this information in the System Security Plan and AIS Functional Architecture documentation.</S>
      <S N="Check">Review the default data and log directory specifications:_x000A__x000A_For SQL Server 2005 Default Instance:_x000A_ _x000A_  HKEY_LOCAL_MACHINE \ SOFTWARE \ Microsoft \ MSSQLServer \ MSSQLServer \ DefaultData_x000A_  HKEY_LOCAL_MACHINE \ SOFTWARE \ Microsoft \ MSSQLServer \ MSSQLServer \ DefaultLog_x000A__x000A_For SQL Server 2005 Named Instance:_x000A__x000A_  HKEY_LOCAL_MACHINE \ SOFTWARE \ Microsoft \ Microsoft SQL Server \ MSSQL.[#] \ MSSQLServer \ DefaultData_x000A_  HKEY_LOCAL_MACHINE \ SOFTWARE \ Microsoft \ Microsoft SQL Server \ MSSQL.[#] \ MSSQLServer \ DefaultLog_x000A__x000A_If the DefaultData directory lists the same directory as the DefaultLog directory, this is a Finding._x000A__x000A_Review the master database file locations:_x000A__x000A_From the query prompt:_x000A__x000A_SELECT physical_name, type_desc_x000A_FROM [master].sys.master_files_x000A_ORDER BY physical_name_x000A__x000A_Review each database file locations:_x000A__x000A_From the query prompt:_x000A__x000A_SELECT name_x000A_FROM [master].sys.databases_x000A_WHERE state = 0_x000A__x000A_Repeat for each database:_x000A__x000A_USE [database name]_x000A_SELECT physical_name, type_desc_x000A_FROM sys.database_files_x000A_ORDER BY physical_name_x000A__x000A_If any results show more than one database using the same physical filename, this is a Finding._x000A__x000A_If any files from either the master_files or database_files show log files (*_log.ldf files) in the same directory as data files, this is a Finding._x000A__x000A_Note: Transactional log files (*.LDF) files can coexist with data files (*.MDF). A transactional log files will have a similar name or a variant name of its matching data file (ex: master.mdf vs. mastlog.ldf). Not all data files will have a corresponding transactional log file._x000A__x000A_If any databases share the same directory, verify in the System Security Plan that the databases are shared by the same application. If they are not, this is a Finding.</S>
    </MS>
  </Obj>
  <Obj RefId="284">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2005</S>
      <S N="VulnID">V-15169</S>
      <S N="RuleID">SV-25435r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">DM0928-SQLServer9</S>
      <S N="Title">The SQL Server services should not be assigned excessive user rights.</S>
      <S N="Description">Excessive or unneeded privileges allow for unauthorized actions. When application vulnerabilities are exploited, excessive privileges assigned to the application can lead to unnecessary risk to the host system and other services.falseSystem AdministratorDatabase AdministratorDCFA-1</S>
      <S N="FixText">Create local custom accounts for the SQL Server Analysis, Reporting, Full Text Search, and Browser service accounts. A domain account may be used where network resources are required. Please see SQL Server Books Online for information that is more detailed._x000A__x000A_Assign the service account to the SQL Server service group (created at installation for the service accounts for SQL Server 2005/2008) if available._x000A__x000A_Assign the service account or group the user privileges as listed in the Check procedures.</S>
      <S N="Check">Check User Rights (may be assigned using group privileges):_x000A__x000A_1. Click Start_x000A_2. Select Control Panel \ Administrative Tools (Win2K) or Select Administrative Tools (Win2K3)_x000A_3. Click Local Security Policy_x000A_4. Expand Local Policies_x000A_5. Select User Rights Assignment_x000A__x000A_View the Security Settings to see user rights assigned to the service account or group._x000A__x000A_If any user rights are assigned to the service account other than the following, this is a Finding._x000A__x000A_If any services listed below do not exist, then do not include them in the review:_x000A__x000A_1. Analysis Server: Log on as a service_x000A_2. Report Server: Log on as a service_x000A_3. Integration Services:_x000A_  a. Log on as a service_x000A_  b. Permission to write to application event log_x000A_  c. Bypass traverse checking_x000A_  d. Create global objects_x000A_  e. Impersonate a client after authentication_x000A_4. Full-Text Search:  Log on as a Service_x000A_5. SQL Server Browser:  Log on as a Service_x000A__x000A_If clustering is being used, assignment of "Debug Programs" user right to the account either directly or through an assigned group may be required and is authorized.  Ensure this is documented in the System Security Plan.</S>
    </MS>
  </Obj>
  <Obj RefId="285">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2005</S>
      <S N="VulnID">V-15170</S>
      <S N="RuleID">SV-25420r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">DM0919-SQLServer9</S>
      <S N="Title">SQL Server services should be assigned least privileges on the SQL Server Windows host.</S>
      <S N="Description">Exploits to SQL Server services may provide access to the host system resources within the security context of the service. Excess privileges assigned to the SQL Services can increase the threat to the host system.falseInformation Assurance OfficerECPA-1</S>
      <S N="FixText">Remove unnecessary group membership from SQL Server service accounts. Review any group membership assignments other than the:_x000A__x000A_1. SQL Server service group_x000A_2. SQL Server service users group_x000A_3. Windows Users group_x000A__x000A_For SQL Server Database service, Performance Monitor group membership if replication and monitoring are operationally required.</S>
      <S N="Check">View the Windows group memberships assigned to the SQL Server service accounts:_x000A__x000A_List of services:_x000A__x000A_1. SQL Server Database_x000A_2. SQL Server Agent_x000A_3. Analysis Services_x000A_4. Integration Services_x000A_5. Reporting Services_x000A_6. Notification Services_x000A_7. Full Text Search_x000A_8. SQL Server Browser_x000A_9. SQL Server Active Directory Helper_x000A_10.  SQL Writer_x000A__x000A_Group Membership:_x000A__x000A_The service account and groups should be local unless the services access other domain or remote services._x000A__x000A_1. Service-specific groups (e.g. SQLServer2005MSSQLUser$[host name]$[instance name])_x000A_2. SQL Server services Users Groups - custom name, used to replace Users group permissions to SQL Server directories and files_x000A_3. Performance Monitor - for SQL Server Database service if Replication is in use and performance is monitored_x000A_4. Windows Users group_x000A_  _x000A_If any services are assigned group membership to any groups other than:_x000A__x000A_1. A custom SQL Server service group_x000A_2. A custom SQL Server service users group,_x000A_3. Windows Users group_x000A__x000A_this is a Finding._x000A__x000A_User rights and file permissions are reviewed under separate checks.</S>
    </MS>
  </Obj>
  <Obj RefId="286">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2005</S>
      <S N="VulnID">V-15173</S>
      <S N="RuleID">SV-23868r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">DM6195-SQLServer9</S>
      <S N="Title">Database TRUSTWORTHY status should be authorized and documented or set to off.</S>
      <S N="Description">The TRUSTWORTHY database setting restricts access to database resources by databases that contain assemblies with the EXTERNAL_ACCESS or UNSAFE permission settings and modules that use impersonation of accounts assigned elevated privileges. Unless all assemblies and code for the database have been reviewed, especially in the case where databases have been detached and attached between server instances, leaving the TRUSTWORTHY status to off can help reduce threats from malicious assemblies or modules.trueDatabase AdministratorECLP-1</S>
      <S N="FixText">Disable TRUSTWORTHY status on all databases (except the msdb database) if enabled and not authorized_x000A__x000A_From the query prompt:_x000A__x000A_ALTER DATABASE [database name] SET TRUSTWORTHY OFF_x000A__x000A_Include in the System Security Plan all relevant settings for each database.</S>
      <Nil N="Check" />
    </MS>
  </Obj>
  <Obj RefId="287">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2005</S>
      <S N="VulnID">V-15176</S>
      <S N="RuleID">SV-25463r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">DM6030-SQLServer9</S>
      <S N="Title">SQL Server event forwarding, if enabled, should be operational.</S>
      <S N="Description">If SQL Server is configured to forward events to an Alerts Management Server that is not available,  then no alerts are issued for the server.falseDatabase AdministratorDCFA-1</S>
      <S N="FixText">Enable use of event forwarding only as part of a SQL Server automated management system design where careful consideration and the requirements for its use are carefully considered. The plan should include consideration for network or alert management server failure and subsequent loss of alert data._x000A__x000A_Include the alert management plan or a reference to it in the System Security Plan that includes the instance of SQL Server under review._x000A__x000A_Disable event forwarding where not required._x000A__x000A_From the SQL Server Management Studio GUI:_x000A__x000A_1. Expand instance_x000A_2. Right-click on SQL Server Agent_x000A_3. Select Properties_x000A_4. Select the Advanced page_x000A_5. Click on Forward events to a different server to remove the check from the check box_x000A_6. Click the OK button to save and close</S>
      <S N="Check">From RegEdit, view values:_x000A__x000A_HKEY_LOCAL_MACHINE \ SOFTWARE \ Microsoft \ Microsoft SQL Sever \ MSSQL.[#] \ SQLServerAgent \ AlertForwardingServer_x000A__x000A_If the value is empty or NULL, this is Not a Finding._x000A__x000A_If the value is not NULL, verify that the use of alert forwarding is authorized in the System Security Plan._x000A__x000A_If alert forwarding is in use and not authorized and documented, this is a Finding.</S>
    </MS>
  </Obj>
  <Obj RefId="288">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2005</S>
      <S N="VulnID">V-15178</S>
      <S N="RuleID">SV-23855r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">DM6070-SQLServer9</S>
      <S N="Title">Replication databases should have authorized db_owner role members. The replication monitor role should have authorized members.</S>
      <S N="Description">Role privileges required by replication include full privileges to the databases with replicated objects. Restrict replication database db_owner role memberships and the system distribution database replmonitor database role membership to authorized replication agent accounts that require access to the database. Unauthorized access can provide unintentional or malicious users greater opportunity to exploit replication access.trueDatabase AdministratorECLP-1</S>
      <S N="FixText">Revoke role membership for unauthorized accounts granted replication role memberships:_x000A__x000A_USE [database name]_x000A_EXEC SP_DROPROLEMEMBER '[replmonitor or db_owner]' FROM '[account name]'</S>
      <Nil N="Check" />
    </MS>
  </Obj>
  <Obj RefId="289">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2005</S>
      <S N="VulnID">V-15179</S>
      <S N="RuleID">SV-24283r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">DG0110-SQLServer9</S>
      <S N="Title">The DBMS should not share a host supporting an independent security service.</S>
      <S N="Description">The Security Support Structure is a security control function or service provided by an external system or application. An example of this would be a Windows domain controller that provides identification and authentication that can be used by other systems to control access. The vulnerabilities and, therefore, associated risk of a DBMS installed on a system that provides a security support structure is significantly higher than when installed with other functions that do not provide security support. In cases where the DBMS is dedicated to local support of a security support function (e.g. a directory service), separation may not be possible.falseInformation Assurance OfficerDCSP-1</S>
      <S N="FixText">Either move the DBMS installation to a dedicated host system or move the directory or security services to another host system._x000A__x000A_A dedicated host system in this case refers to an instance of the operating system at a minimum. The operating system may reside on a virtual host machine if supported by the DBMS vendor.</S>
      <S N="Check">Review the services and processes active on the DBMS host system._x000A__x000A_If the host system is acting as a Windows domain controller, this is a finding._x000A__x000A_If the host system is supporting any other directory or security service that does not use the DBMS to store the directory information, this is a Finding._x000A__x000A_Note: A local installation of Anti-virus or Firewall does not constitute a security service in this context.</S>
    </MS>
  </Obj>
  <Obj RefId="290">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2005</S>
      <S N="VulnID">V-15180</S>
      <S N="RuleID">SV-25499r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">DM6193-SQLServer9</S>
      <S N="Title">Only authorized users should be granted access to Analysis Services data sources.</S>
      <S N="Description">Access control applied to data sources controls user access to remotely defined systems using the authentication and authorizations defined for the data source. Unauthorized access to the data source in turn provides unauthorized access to remote systems.falseDatabase AdministratorECAN-1</S>
      <S N="FixText">Document all roles authorized to access data sources in the System Security Plan. Remove any unauthorized data sources from roles.</S>
      <S N="Check">From the SQL Server Management Studio GUI:_x000A__x000A_1. Connect to the Analysis Services instance_x000A_2. For each Analysis Services database:_x000A_  a. Expand the database_x000A_  b. Expand Roles_x000A_  c. For each role listed:_x000A_    i. Right-click on the role_x000A_    ii. Select Properties_x000A_    iii. Select the Data Sources page_x000A__x000A_Review the list of data sources listed for the role against authorized roles in the System Security Plan._x000A__x000A_If access to any unauthorized data sources is assigned to the role, this is a Finding._x000A__x000A_If documentation does not exist or is insufficient to determine authorized access, this is a Finding.</S>
    </MS>
  </Obj>
  <Obj RefId="291">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2005</S>
      <S N="VulnID">V-15181</S>
      <S N="RuleID">SV-25470r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">DM6099-SQLServer9</S>
      <S N="Title">Analysis Services user-defined COM functions should be disabled if not required.</S>
      <S N="Description">Allowing user-defined COM functions can allow unauthorized code access to the Analysis Services instance. Where not required as part of the operational design, allowing user-defined COM functions can expose the instance to unnecessary risk.falseDatabase AdministratorDCFA-1</S>
      <S N="FixText">If not documented as required and authorized by the IAO, set value for ComUdfEnabled to 'false'._x000A__x000A_From the SQL Server Management Studio GUI:_x000A__x000A_1. Connect to the Analysis Services instance_x000A_2. Right click on the Analysis Services instance_x000A_3. Select Properties_x000A_4. View the value listed for Feature \ ComUdfEnabled_x000A_5. Select value = 'false'_x000A_6. Click OK</S>
      <S N="Check">If Analysis Services is not deployed on the local host, this check is Not a Finding._x000A__x000A_Note: To detect deployment, view Windows Services. If SQL Server Analysis Services ([instance name]) is not listed, then Analysis Services is not installed on this host. _x000A__x000A_If the System Security Plan indicates User-Defined COM Functions is required for operation, this check is Not a Finding._x000A__x000A_From the SQL Server Management Studio GUI:_x000A__x000A_1. Connect to the Analysis Services instance_x000A_2. Right click on the Analysis Services instance_x000A_3. Select Properties_x000A_4. View the value listed for Feature \ ComUdfEnabled_x000A__x000A_If the value = 'true', this is a Finding._x000A__x000A_The User-Defined COM Functions value may also be viewed in the Analysis Services configuration file, msmdsrv.ini under XML tag:_x000A__x000A_[ComUdfEnabled]_x000A__x000A_The configuration file may be found in the [install dir] \ MSSQL.[#] \ OLAP \ Config directory.</S>
    </MS>
  </Obj>
  <Obj RefId="292">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2005</S>
      <S N="VulnID">V-15182</S>
      <S N="RuleID">SV-25465r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">DM6075-SQLServer9</S>
      <S N="Title">Replication snapshot folders should be protected from unauthorized access.</S>
      <S N="Description">Replication snapshot folders contain database data to which only authorized replication accounts require access. Unauthorized access to these folders could compromise data confidentiality and integrity, and could compromise database availability.falseDatabase AdministratorECAN-1</S>
      <S N="FixText">Restrict access to the replication snapshot folders:_x000A__x000A_From Windows Explorer:_x000A__x000A_1. Administrators/DBAs:  Full Control_x000A_2. Snapshot Agents: Write access_x000A_3. Merge, Subscription, and Distribution agents:  Read access</S>
      <S N="Check">View the list of databases participating in replication:_x000A__x000A_EXEC SP_HELPREPLICATIONDBOPTION_x000A__x000A_For each replication database:_x000A__x000A_EXEC SP_HELPPUBLICATION_x000A__x000A_If snapshot_in_defaultfolder is 1 for any records returned, the snapshot folder name is:_x000A__x000A_[install dir]\[instance dir]\MSSQL\ReplData_x000A__x000A_If the snapshot_in_defaultfolder is 0, then the snapshot folder name is listed in alt_snapshot_folder._x000A__x000A_View OS permissions to the snapshot folder:_x000A__x000A_Review operating system permissions assigned to the snapshot folder using Windows Explorer._x000A__x000A_The following are required/authorized permissions by role:_x000A__x000A_1. Administrators/DBAs:  Full Control_x000A_2. Snapshot Agents: Write access_x000A_3. Merge and Distribution agents:  Read access_x000A__x000A_If any permission other than those listed is assigned or are assigned to unauthorized accounts, this is a Finding._x000A__x000A_View database permissions to the snapshot folder:_x000A__x000A_For each replication database:_x000A__x000A_EXEC SP_HELPPUBLICATION_SNAPSHOT '[publication name]' _x000A__x000A_If any permission is granted to accounts other than Administrators, DBAs, CREATOR OWNER, SYSTEM, or the snapshot agent account, merge, or distribution agents, this is a Finding._x000A__x000A_If merge and distribution agents have more than Read access to the snapshot folder, this is a Finding.</S>
    </MS>
  </Obj>
  <Obj RefId="293">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2005</S>
      <S N="VulnID">V-15183</S>
      <S N="RuleID">SV-25466r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">DM6085-SQLServer9</S>
      <S N="Title">The Analysis Services ad hoc data mining queries configuration option should be disabled if not required.</S>
      <S N="Description">SQL Server Ad Hoc distributed queries allow specific functions (OPENROWSET and OPENDATASOURCE) to connect to remote systems without those remote systems being defined within database. Access to unauthorized systems could lead to unauthorized activity in remote systems that could compromise the local database.falseDatabase AdministratorDCFA-1</S>
      <S N="FixText">Set value for AllowAdHocOpenRowsetQueries to 'false'_x000A__x000A_From the SQL Server Management Studio GUI:_x000A__x000A_ 1. Connect to the Analysis Services instance_x000A_ 2. Right click on the Analysis Services instance_x000A_ 3. Select Properties_x000A_ 4. View the value listed for DataMining \ AllowAdHocOpenRowsetQueries_x000A_ 5. Select value = 'false'_x000A_ 6. Click OK</S>
      <S N="Check">If Analysis Services is not deployed on the local host, this check is Not a Finding._x000A__x000A_Note: To detect deployment, view Windows Services. If SQL Server Analysis Services ([instance name]) is not listed, then Analysis Services is not installed on this host._x000A__x000A_From the SQL Server Management Studio GUI:_x000A__x000A_1. Connect to the Analysis Services instance_x000A_2. Right click on the Analysis Services instance_x000A_3. Select Properties_x000A_4. View the value listed for DataMining \ AllowAdHocOpenRowsetQueries_x000A__x000A_If value = 'true', this is a Finding._x000A__x000A_The AllowAdHocOpenRowsetQueries value may also be viewed in the Analysis Services configuration file, msmdsrv.ini under XML tag: _x000A__x000A_[AllowAdHocOpenRowsetQueries]_x000A__x000A_The configuration file may be found in the [install dir] \ MSSQL.[#] \ OLAP \ Config directory.</S>
    </MS>
  </Obj>
  <Obj RefId="294">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2005</S>
      <S N="VulnID">V-15184</S>
      <S N="RuleID">SV-25467r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">DM6086-SQLServer9</S>
      <S N="Title">Analysis Services Anonymous Connections should be disabled.</S>
      <S N="Description">Anonymous connections allow unauthenticated access to the database. Although the database may not store sensitive application data, operation and data compromise may occur without accountability where unauthenticated access is allowed.falseDatabase AdministratorIAIA-1, IAIA-2</S>
      <S N="FixText">Set value for RequireClientAuthentication to 'true'_x000A__x000A_From the SQL Server Management Studio GUI:_x000A__x000A_1. Connect to the Analysis Services instance_x000A_2. Right click on the Analysis Services instance_x000A_3. Select Properties_x000A_4. View the value listed for Security \ RequireClientAuthentication_x000A_5. Select value = 'true'_x000A_6. Click OK_x000A_</S>
      <S N="Check">If Analysis Services is not deployed on the local host, this check is Not a Finding._x000A__x000A_Note: To detect deployment, view Windows Services. If SQL Server Analysis Services ([instance name]) is not listed, then Analysis Services is not installed on this host._x000A__x000A_From the SQL Server Management Studio GUI:_x000A__x000A_1. Connect to the Analysis Services instance_x000A_2. Right click on the Analysis Services instance_x000A_3. Select Properties_x000A_4. View the value listed for Security \ RequireClientAuthentication_x000A__x000A_If value = 'false', this is a Finding._x000A__x000A_The RequireClientAuthentication value may also be viewed in the Analysis Services configuration file, msmdsrv.ini under XML tag:_x000A__x000A_[RequireClientAuthentication]_x000A__x000A_The configuration file may be found in the [install dir] \ MSSQL.[#] \ OLAP \ Config directory.</S>
    </MS>
  </Obj>
  <Obj RefId="295">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2005</S>
      <S N="VulnID">V-15186</S>
      <S N="RuleID">SV-25469r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">DM6088-SQLServer9</S>
      <S N="Title">Analysis Services Links From Objects should be disabled if not required.</S>
      <S N="Description">Analysis Services allows other server instances to link to local analysis services objects. Where not required, enabling of this allowance can unnecessarily expose the database objects to unauthorized access or compromise.falseDatabase AdministratorDCFA-1</S>
      <S N="FixText">Set value for LinkFromOtherInstanceEnabled to 'false'._x000A__x000A_From the SQL Server Management Studio GUI:_x000A__x000A_1. Connect to the Analysis Services instance_x000A_2. Right click on the Analysis Services instance_x000A_3. Select Properties_x000A_4. View the value listed for Feature \ LinkFromOtherInstanceEnabled_x000A_5. Select value = 'false'_x000A_6. Click OK</S>
      <S N="Check">If Analysis Services is not deployed on the local host, this check is Not a Finding._x000A__x000A_Note: To detect deployment, view Windows Services. If SQL Server Analysis Services ([instance name]) is not listed, then Analysis Services is not installed on this host. _x000A__x000A_If the System Security Plan indicates Links from Other instances is required for operation, this check is Not a Finding._x000A__x000A_From the SQL Server Management Studio GUI:_x000A__x000A_1. Connect to the Analysis Services instance_x000A_2. Right click on the Analysis Services instance_x000A_3. Select Properties_x000A_4. View the value listed for Feature \ LinkFromOtherInstanceEnabled_x000A__x000A_If the value = 'true', this is a Finding._x000A__x000A_The LinkFromOtherInstanceEnabled value may also be viewed in the Analysis Services configuration file, msmdsrv.ini under XML tag:_x000A__x000A_[LinkFromOtherInstanceEnabled]_x000A__x000A_The configuration file may be found in the [install dir] \ MSSQL.[#] \ OLAP \ Config directory.</S>
    </MS>
  </Obj>
  <Obj RefId="296">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2005</S>
      <S N="VulnID">V-15187</S>
      <S N="RuleID">SV-25494r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">DM6155-SQLServer9</S>
      <S N="Title">Linked server providers should not allow ad hoc access.</S>
      <S N="Description">Ad hoc access allows undefined access to remote systems. Access to remote systems should be controlled to prevent untrusted data to be executed or uploaded to the local server.falseDatabase AdministratorDCFA-1</S>
      <S N="FixText">Enable Disallow adhoc access for all linked servers._x000A__x000A_From the SQL Server Management Studio GUI:_x000A__x000A_1. Expand Database_x000A_2. Expand Server Objects_x000A_3. Expand Linked Servers_x000A_4. Expand Providers_x000A_5. For each Provider listed:_x000A_  a. Right click on Provider name_x000A_  b. Select Properties_x000A_  c. Click on the Enable check box for Name = Disallow adhoc access_x000A_  d. Click OK button_x000A__x000A_Note:  The procedure described above will disallow adhoc access for all linked servers that use the providers..</S>
      <S N="Check">From the SQL Server Management Studio GUI:_x000A__x000A_1. Expand Database_x000A_2. Expand Server Objects_x000A_3. Expand Linked Servers_x000A_4. Expand Providers_x000A_5. For each Provider listed:_x000A_  a. Right click on Provider name_x000A_  b. Click Properties_x000A_  c. View Provider options_x000A__x000A_If "Disallow adhoc access" is not enabled (checked) for all Providers, this is a Finding.</S>
    </MS>
  </Obj>
  <Obj RefId="297">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2005</S>
      <S N="VulnID">V-15188</S>
      <S N="RuleID">SV-25471r1_rule</S>
      <S N="Severity">high</S>
      <S N="Weight">10.0</S>
      <S N="Version">DM6101-SQLServer9</S>
      <S N="Title">Analysis Services Required Protection Levels should be set to 1.</S>
      <S N="Description">Sensitive data is vulnerable to unauthorized access when traversing untrusted network segments. Encryption of the data in transit helps protect the confidentiality of the data.falseDatabase AdministratorECCT-1, ECCT-2</S>
      <S N="FixText">Modify the msmdsrv.ini to set Required Protection Levels to use encryption._x000A__x000A_Make a backup copy of the msmdsrv.ini file._x000A__x000A_Edit the msmdsrv.ini file_x000A__x000A_Under the DataProtection tag, set the value for RequiredProtectionLevel to 1 OR under the DataProtection tag, create the tag RequiredProtectionLevel and set the value to 1._x000A__x000A_Under the DataProtection tag, set the value for RequiredWebProtectionLevel to 1 OR under the DataProtection tag, create the tag RequiredWebProtectionLevel and set the value to 1._x000A__x000A_Under the AdministrativeDataProtection tag, set the value for RequiredProtectionLevel to 1 OR under the AdministrativeDataProtection tag, create the tag RequiredProtectionLevel and set the value to 1._x000A__x000A_Under the AdministrativeDataProtection tag, set the value for RequiredWebProtectionLevel to 1 OR under the AdministrativeDataProtection tag, create the tag RequiredWebProtectionLevel and set the value to 1._x000A__x000A_Save and exit._x000A__x000A_Restart the SQL Server Analysis Services service for the changes to take effect._x000A__x000A_NOTE: Check DM6101 now combines fixes from DM6101, DM6102, DM6106 and DM6107 into this single fix._x000A__x000A_Checks DM6102, DM6106 and DM6107 have been inactivated.</S>
      <S N="Check">Determine if SQL Server Analysis Services is installed._x000A__x000A_View the Windows Services Snap-In._x000A__x000A_If SQL Server Analysis Services ([instance name]) is not listed, Analysis Services is not installed on this host. _x000A__x000A_If SQL Server Analysis Services is not installed on the DBMS host, this check is Not a Finding._x000A__x000A_If SQL Server Analysis Services in installed on the DBMS host (regardless of whether it is actively running or not), review the msmdsrv.ini file for the SQL Server Analysis service._x000A__x000A_The value for [install dir] can be found in the Windows Registry under the parameter:_x000A__x000A_  HKLM\SOFTWARE\Microsoft\Microsoft SQL Server\MSSQL.1\Setup\SqlProgramDir_x000A__x000A_The msmdsrv.ini configuration file may be found in the directory:_x000A__x000A_[install dir]\MSSQL.2\OLAP\Config_x000A__x000A_View the contens of the msmdsrv.ini file._x000A__x000A_1. Locate the RequiredProtectionLevel XML tag under the DataProtection tag._x000A__x000A_   If the RequiredProtectionLevel tag is not listed, this is a Finding._x000A__x000A_   If the RequiredProtectionLevel tag is listed and set to a value of 0 or 2, this is a Finding._x000A__x000A_   If the RequiredProtectionLevel tag is listed and set to a value of 1, this part of the check is Not a Finding._x000A__x000A_2. Locate the RequiredProtectionLevel XML tag under the AdministrativeDataProtection tag._x000A__x000A_   If the RequiredProtectionLevel tag is not listed, this is a Finding._x000A__x000A_   If the RequiredProtectionLevel tag is listed and set to a value of 0 or 2, this is a Finding._x000A__x000A_   If the RequiredProtectionLevel tag is listed and set to a value of 1, this part of the check is Not a Finding._x000A__x000A_3. Locate the RequiredWebProtectionLevel XML tag under the DataProtection tag._x000A__x000A_   If the RequiredWebProtectionLevel tag is not listed, this is a Finding._x000A__x000A_   If the RequiredWebProtectionLevel tag is listed and set to a value of 0 or 2, this is a Finding._x000A__x000A_   If the RequiredWebProtectionLevel tag is listed and set to a value of 1, this part of the check is Not a Finding._x000A__x000A_4. Locate the RequiredWebProtectionLevel XML tag under the AdministrativeDataProtection tag._x000A__x000A_   If the RequiredWebProtectionLevel tag is not listed, this is a Finding._x000A__x000A_   If the RequiredWebProtectionLevel tag is listed and set to a value of 0 or 2, this is a Finding._x000A__x000A_   If the RequiredWebProtectionLevel tag is listed and set to a value of 1, this part of the check is Not a Finding._x000A__x000A_If any parts of this check are a Finding, this check is a Finding._x000A__x000A_NOTE: Check DM6101 now combines checks from DM6101, DM6102, DM6106 and DM6107 into this single check._x000A__x000A_Checks DM6102, DM6106 and DM6107 have been inactivated.</S>
    </MS>
  </Obj>
  <Obj RefId="298">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2005</S>
      <S N="VulnID">V-15190</S>
      <S N="RuleID">SV-25473r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">DM6103-SQLServer9</S>
      <S N="Title">Analysis Services Security Package List should be disabled if not required.</S>
      <S N="Description">Analysis Services Security Packages are security applications provided outside of the default Analysis Services installation. The packages may be provided by custom development or commercial third-party products used for client authentication. Use of untested or unverified security applications may introduce unknown vulnerabilities to the instance. Restrict use of non-default security packages to tested and trusted applications that meet DOD authentication requirements.falseInformation Assurance OfficerDCFA-1</S>
      <S N="FixText">From the SQL Server Management Studio GUI:_x000A__x000A_1. Connect to the Analysis Services instance_x000A_2. Right click on the Analysis Services instance_x000A_3. Select Properties_x000A_4. View the value listed for Security \ SecurityPackageList_x000A_5. Select value and delete all unauthorized packages from the list_x000A_6. Click OK_x000A_</S>
      <S N="Check">If Analysis Services is not installed on the local host, this check is Not a Finding._x000A__x000A_Note: To detect installation, view the Windows Services snap-in. If SQL Server Analysis Services ([instance name]) is not listed, then Analysis Services is not installed on this host. _x000A__x000A_From the SQL Server Management Studio GUI:_x000A__x000A_1. Connect to the Analysis Services instance_x000A_2. Right click on the Analysis Services instance_x000A_3. Select Properties_x000A_4. View the value listed for Security \ SecurityPackageList_x000A__x000A_If the value is not NULL and lists packages other than those documented in the System Security Plan, this is a Finding._x000A__x000A_The SecurityPackageList value may also be viewed in the Analysis Services configuration file, msmdsrv.ini under XML tag:_x000A__x000A_[SecurityPackageList]_x000A__x000A_The configuration file may be found in the [install dir] \ MSSQL.[#] \ OLAP \ Config directory.</S>
    </MS>
  </Obj>
  <Obj RefId="299">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2005</S>
      <S N="VulnID">V-15193</S>
      <S N="RuleID">SV-25476r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">DM6108-SQLServer9</S>
      <S N="Title">The Analysis Services server role should be restricted to authorized users.</S>
      <S N="Description">The Analysis Services server role grants server-wide security privileges to the assigned user. An unauthorized user could compromise database and analysis server data and operational integrity or availability.falseInformation Assurance OfficerECLP-1</S>
      <S N="FixText">Remove unauthorized members from the Analysis Service instance._x000A__x000A_From the SQL Server Management Studio GUI:_x000A__x000A_1. Connect to the Analysis Services instance_x000A_2. Right click on the Analysis Services instance_x000A_3. Select Properties_x000A_4. Select the Security page_x000A_5. Select any unauthorized user to remove_x000A_6. Click the Remove button_x000A_7. Click OK</S>
      <S N="Check">If Analysis Services is not deployed on the local host, this check is Not a Finding._x000A__x000A_Note: To detect deployment, view Windows Services. If SQL Server Analysis Services ([instance name]) is not listed, then Analysis Services is not installed on this host. _x000A__x000A_From the SQL Server Management Studio GUI:_x000A__x000A_1. Connect to the Analysis Services instance_x000A_2. Right click on the Analysis Services instance_x000A_3. Select Properties_x000A_4. Select the Security page_x000A_5. View member names assigned to the server role_x000A__x000A_If any assigned members are not included as authorized in the System Security Plan, this is a Finding.</S>
    </MS>
  </Obj>
  <Obj RefId="300">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2005</S>
      <S N="VulnID">V-15194</S>
      <S N="RuleID">SV-25477r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">DM6109-SQLServer9</S>
      <S N="Title">Only authorized accounts should be assigned to one or more Analysis Services database roles.</S>
      <S N="Description">Unauthorized group membership assignment grants unauthorized privileges to database accounts. Unauthorized may lead to a compromise of data confidentiality or integrity.falseDatabase AdministratorECAN-1</S>
      <S N="FixText">Authorize and document all Analysis Services database role assignments in the System Security Plan._x000A__x000A_From the SQL Server Management Studio GUI:_x000A__x000A_1. Connect to the Analysis Services instance_x000A_2. Expand the Analysis Services instance_x000A_3. Expand Databases_x000A_4. Repeat for each database:_x000A_  a. Click on each database role_x000A_  b. Open the member list_x000A_  c. Select any unauthorized users_x000A_  d. Click the Remove button_x000A_  e. Click OK</S>
      <S N="Check">If Analysis Services is not deployed on the local host, this check is Not a Finding._x000A__x000A_Note: To detect deployment, view Windows Services. If SQL Server Analysis Services ([instance name]) is not listed, then Analysis Services is not installed on this host. _x000A__x000A_From the SQL Server Management Studio GUI:_x000A__x000A_1. Connect to the Analysis Services instance_x000A_2. Right click on the Analysis Services instance_x000A_3. Expand Databases_x000A_4. Repeat for each database:_x000A_  a. Click on each database role_x000A_  b. View the member list_x000A__x000A_If any members are assigned database roles that are not documented in the System Security Plan, this is a Finding.</S>
    </MS>
  </Obj>
  <Obj RefId="301">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2005</S>
      <S N="VulnID">V-15196</S>
      <S N="RuleID">SV-23859r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">DM6145-SQLServer9</S>
      <S N="Title">Only authorized SQL Server proxies should be assigned access to subsystems.</S>
      <S N="Description">SQL Server subsystems define a set of functionality available for assignment to a SQL Server Agent proxy. These act as privileges to perform certain job tasks. Excess privilege assignment or subsystem assignment can lead to unauthorized access to the SQL Server instance or host operating system.trueDatabase AdministratorECAN-1</S>
      <S N="FixText">Define and document in the System Security Plan the minimum subsystem assignments required by individual proxies._x000A__x000A_Assign to each proxy only those subsystems required to complete the SQL Server Agent job.</S>
      <Nil N="Check" />
    </MS>
  </Obj>
  <Obj RefId="302">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2005</S>
      <S N="VulnID">V-15197</S>
      <S N="RuleID">SV-23858r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">DM6140-SQLServer9</S>
      <S N="Title">Dedicated accounts should be designated for SQL Server Agent proxies.</S>
      <S N="Description">SQL Server proxies use to execute specific job functions defined for SQL Server Agent. If proxies share a single account for multiple job functions, least privileges cannot be assigned based on the particular job function. This can compromise the security of the shared functions should a compromise of the SQL Server Agent job occur.trueDatabase AdministratorECAN-1</S>
      <S N="FixText">Create Windows accounts for each proxy defined._x000A__x000A_Assign only the file permissions, subsystem access and other privileges required to run the SQL Server Agent job._x000A__x000A_Document proxy accounts in the System Security Plan and authorize with the IAO.</S>
      <Nil N="Check" />
    </MS>
  </Obj>
  <Obj RefId="303">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2005</S>
      <S N="VulnID">V-15198</S>
      <S N="RuleID">SV-25488r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">DM6130-SQLServer9</S>
      <S N="Title">The Web Assistant procedures configuration option should be disabled if not required.</S>
      <S N="Description">The Web Assistant procedures are used by database applications to create web pages. This capability may easily be abused to send malicious messages to remote users or systems. Disabling its use helps to protect the database from generating or receiving malicious email notifications.falseDatabase AdministratorDCFA-1</S>
      <S N="FixText">Authorize and document requirements for use of Web Assistant Procedures in the System Security Plan and AIS Functional Architecture documentation. Where not authorized, disable use of Web Assistant Procedures._x000A__x000A_From the query prompt:_x000A__x000A_EXEC SP_CONFIGURE 'show advanced options', 1_x000A_EXEC SP_CONFIGURE 'Web Assistant procedures', 0_x000A_RECONFIGURE</S>
      <S N="Check">From the query prompt:_x000A__x000A_SELECT CAST(value AS INT) 'Config_Value'_x000A_FROM [master].sys.configurations_x000A_WHERE name = 'web assistant procedures'_x000A__x000A_If the value of Config_Value is 1, confirm in the System Security Plan and AIS Functional Architecture documentation that Web Assistant procedures are required and approved by the IAO. If it is not documented, required and approved, this is a Finding.</S>
    </MS>
  </Obj>
  <Obj RefId="304">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2005</S>
      <S N="VulnID">V-15199</S>
      <S N="RuleID">SV-25481r1_rule</S>
      <S N="Severity">low</S>
      <S N="Weight">10.0</S>
      <S N="Version">DM6120-SQLServer9</S>
      <S N="Title">Reporting Services Web service requests and HTTP access should be disabled if not required.</S>
      <S N="Description">Where not required, SOAP and URL access to the web service unnecessarily exposes the report server to attack via the SOAP and HTTP protocols.falseDatabase AdministratorDCFA-1</S>
      <S N="FixText">Document requirements for enabling Report Services access via web services and HTTP. If not required, disable Web Service Requests and HTTP access._x000A__x000A_From Surface Area Configuration for Features:_x000A_1. Connect to the Report Services instance_x000A_2. Expand the instance_x000A_3. Expand Report Services_x000A_4. Select Web Service Requests and HTTP Access_x000A_5. Click on Enable Web Service Requests and HTTP access to clear the check box_x000A_6. Click OK</S>
      <S N="Check">If Reporting Services is not installed, this check is Not a Finding._x000A__x000A_Note: To detect installation, view Windows Services. If SQL Server Reporting Services ([instance name]) is not listed, then Reporting Services is not installed on this host._x000A__x000A_From Surface Area Configuration for Features:_x000A_1. Connect to the Report Services instance_x000A_2. Expand the instance_x000A_3. Expand Report Services_x000A_4. Select Web Service Requests and HTTP Access_x000A__x000A_If checked, verify that Web Service requests are HTTP access are required and the requirement is documented in the System Security Plan. If it is not, this is a Finding.</S>
    </MS>
  </Obj>
  <Obj RefId="305">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2005</S>
      <S N="VulnID">V-15201</S>
      <S N="RuleID">SV-23959r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">DM6150-SQLServer9</S>
      <S N="Title">Cross database ownership chaining, if required, should be documented and authorized by the IAO.</S>
      <S N="Description">Cross database ownership chaining allows permissions to objects to be assigned by users other than the Information Owner. This allows access to objects that are not authorized directly by the Information Owner based on job functions defined by the owner. Unauthorized access may lead to a compromise of data integrity or confidentiality.falseDatabase AdministratorECLP-1</S>
      <S N="FixText">Document requirements for use of cross db ownership chaining in the System Security Plan and AIS Functional Architecture documentation and authorize with the IAO._x000A__x000A_Where not authorized, disable its use._x000A__x000A_From the query prompt:_x000A__x000A_EXEC SP_CONFIGURE 'cross db ownership chaining', 0_x000A_RECONFIGURE_x000A__x000A_NOTE: If you have databases that require cross-database ownership chaining, the recommended practice is to turn off the cross db ownership chaining option for the instance using sp_configure; then turn on cross-database ownership chaining for individual databases that require it using the ALTER DATABASE statement.</S>
      <S N="Check">From the query prompt:_x000A__x000A_SELECT CAST(value AS INT) AS [Config Value]_x000A_FROM [master].sys.configurations_x000A_WHERE name = 'cross db ownership chaining'_x000A__x000A_If the value of Config Value is 0, this is Not a Finding._x000A__x000A_If the value of Config Value is 1, confirm in the System Security Plan that this option is documented, required and approved by the IAO. If it is not documented, required and approved, this is a Finding._x000A__x000A_To check assignment per individual database._x000A__x000A_From the query prompt:_x000A_SELECT name AS [Database Name]_x000A_FROM [master].sys.databases_x000A_WHERE is_db_chaining_on = 1_x000A_AND name NOT IN ('master', 'tempdb', 'msdb')_x000A_AND state = 0_x000A__x000A_If any database names are listed, are not documented in the System Security Plan and not authorized by the IAO, this is a Finding.</S>
    </MS>
  </Obj>
  <Obj RefId="306">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2005</S>
      <S N="VulnID">V-15202</S>
      <S N="RuleID">SV-25487r1_rule</S>
      <S N="Severity">low</S>
      <S N="Weight">10.0</S>
      <S N="Version">DM6123-SQLServer9</S>
      <S N="Title">Use of Command Language Runtime objects should be disabled if not required.</S>
      <S N="Description">The clr_enabled parameter configures SQL Server to allow or disallow use of Command Language Runtime objects. CLR objects is managed code that integrates with the .NET Framework. This is a more secure method than external stored procedures, although it still contains some risk. Where no external application execution requirements are required, disallowing use of any improves the overall security posture of the database.falseDatabase AdministratorDCFA-1</S>
      <S N="FixText">Where CLR object use is part of the designed and approved use of the SQL Server database, document the requirement in the System Security Plan._x000A__x000A_Where CLR object use is not required, disable its use._x000A__x000A_From the query prompt:_x000A__x000A_EXEC SP_CONFIGURE 'clr_enabled', 0_x000A_RECONFIGURE</S>
      <S N="Check">From the query prompt:_x000A__x000A_SELECT CAST(value AS INT) 'Config_Value'_x000A_FROM [master].sys.configurations_x000A_WHERE name = 'clr enabled'_x000A__x000A_If the value of Config_Value is 0, this is Not a Finding._x000A__x000A_If the value of Config_Value is 1, confirm in the System Security Plan that access to CLR applications is required. If it is not, this is a Finding.</S>
    </MS>
  </Obj>
  <Obj RefId="307">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2005</S>
      <S N="VulnID">V-15203</S>
      <S N="RuleID">SV-25486r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">DM6122-SQLServer9</S>
      <S N="Title">Reporting Services Windows Integrated Security should be disabled.</S>
      <S N="Description">Use of Windows integrated security may allow access via Report Services bypasses security controls assessed at the database level. This may be restricted by requiring that all report data source connections use specific credentials to access report data sources.falseDatabase AdministratorIAIA-1, IAIA-2</S>
      <S N="FixText">Disable Windows Integrated Security._x000A__x000A_From Surface Area Configuration for Features:_x000A_1. Connect to the Report Services instance_x000A_2. Expand the instance_x000A_3. Expand Report Services_x000A_4. Select Windows Integrated Security_x000A_5. Click on Windows Integrated Security to clear the check box_x000A_6. Click OK</S>
      <S N="Check">If Reporting Services is not installed, this check is Not a Finding._x000A__x000A_Note: To detect installation, view Windows Services. If SQL Server Reporting Services ([instance name]) is not listed, then Reporting Services is not installed on this host._x000A__x000A_From Surface Area Configuration for Features:_x000A_1. Connect to the Report Services instance_x000A_2. Expand the instance_x000A_3. Expand Report Services_x000A_4. Select Windows Integrated Security_x000A__x000A_If checked, this is a Finding.</S>
    </MS>
  </Obj>
  <Obj RefId="308">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2005</S>
      <S N="VulnID">V-15204</S>
      <S N="RuleID">SV-25468r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">DM6087-SQLServer9</S>
      <S N="Title">Analysis Services Links to Objects should be disabled if not required.</S>
      <S N="Description">Analysis Services may make connections to external SQL Server instances. In some cases this may be required for the intended operation, however, where not required, this may introduce unnecessary risk where unauthorized external links may be made.falseDatabase AdministratorDCFA-1</S>
      <S N="FixText">Set value for LinkToOtherInstanceEnabled to 'false'._x000A__x000A_From the SQL Server Management Studio GUI:_x000A__x000A_1. Connect to the Analysis Services instance_x000A_2. Right click on the Analysis Services instance_x000A_3. Select Properties_x000A_4. View the value listed for Feature \ LinkToOtherInstanceEnabled_x000A_5. Select value = 'false'_x000A_6. Click OK</S>
      <S N="Check">If Analysis Services is not deployed on the local host, this check is Not a Finding._x000A__x000A_Note: To detect deployment, view Windows Services. If SQL Server Analysis Services ([instance name]) is not listed, then Analysis Services is not installed on this host. _x000A__x000A_If the System Security Plan indicates Links to Other instances is required for operation, this check is Not a Finding._x000A__x000A_From the SQL Server Management Studio GUI:_x000A__x000A_1. Connect to the Analysis Services instance_x000A_2. Right click on the Analysis Services instance_x000A_3. Select Properties_x000A_4. View the value listed for Feature \ LinkToOtherInstanceEnabled_x000A__x000A_If the value = 'true', this is a Finding._x000A__x000A_The LinkToOtherInstanceEnabled value may also be viewed in the Analysis Services configuration file, msmdsrv.ini under XML tag:_x000A__x000A_[LinkToOtherInstanceEnabled]_x000A__x000A_The configuration file may be found in the [install dir] \ MSSQL.[#] \ OLAP \ Config directory.</S>
    </MS>
  </Obj>
  <Obj RefId="309">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2005</S>
      <S N="VulnID">V-15205</S>
      <S N="RuleID">SV-25485r1_rule</S>
      <S N="Severity">low</S>
      <S N="Weight">10.0</S>
      <S N="Version">DM6121-SQLServer9</S>
      <S N="Title">Reporting Services scheduled events and report delivery should be disabled if not required.</S>
      <S N="Description">Where not required, Scheduled events and report delivery unnecessarily exposes the report server to attack via Report Service event handling and report delivery.falseDatabase AdministratorDCFA-1</S>
      <S N="FixText">Document requirements for enabling 'Report Services Scheduled events and report delivery'. If not required, disable Scheduled events and report delivery._x000A__x000A_From Surface Area Configuration for Features:_x000A_1. Connect to the Report Services instance_x000A_2. Expand the instance_x000A_3. Expand Report Services_x000A_4. Select Scheduled events and report delivery _x000A_5. Click on the Scheduled events and report delivery to clear the check box_x000A_6. Click OK</S>
      <S N="Check">If Reporting Services is not installed, this check is Not a Finding._x000A__x000A_Note: To detect installation, view Windows Services. If SQL Server Reporting Services ([instance name]) is not listed, then Reporting Services is not installed on this host._x000A__x000A_From Surface Area Configuration for Features:_x000A_1. Connect to the Report Services instance_x000A_2. Expand the instance_x000A_3. Expand Report Services_x000A_4. Select Scheduled events and report delivery_x000A__x000A_If checked, verify that Scheduled events and report delivery is required and the requirement is documented in the System Security Plan. If it is not, this is a Finding.</S>
    </MS>
  </Obj>
  <Obj RefId="310">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2005</S>
      <S N="VulnID">V-15206</S>
      <S N="RuleID">SV-23856r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">DM6126-SQLServer9</S>
      <S N="Title">Only authorized XML Web Service endpoints should be configured on the server.</S>
      <S N="Description">XML Web Service endpoints expose the database its data to web service access. Where not carefully designed and implemented, web services can unnecessarily expose the database to additional exploit that compromises data confidentiality and integrity. Removing web service endpoints helps to protect the database from unauthorized web service access.trueDatabase AdministratorDCFA-1</S>
      <S N="FixText">Authorized and document XML web service endpoints in the System Security Plan and AIS Functional Architecture documentation. Where not authorized, drop XML web service endpoints._x000A__x000A_From the query prompt:_x000A__x000A_DROP ENDPOINT [endpoint name]_x000A__x000A_Where documented and authorized, set each endpoint to use the appropriate authentication protocol, SSL if required and disable anonymous access if not authorized. If a clear port is also required and authorized, ensure the value for clear_port is set to a known value (i.e. HTTP port 80 or other IAO authorized port value).</S>
      <Nil N="Check" />
    </MS>
  </Obj>
  <Obj RefId="311">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2005</S>
      <S N="VulnID">V-15210</S>
      <S N="RuleID">SV-25500r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">DM6198-SQLServer9</S>
      <S N="Title">The Agent XPs option should be set to disabled if not required.</S>
      <S N="Description">The Agent XPs are extended stored procedures used by the SQL Server Agent that provide privileged actions that run externally to the DBMS under the security context of the SQL Server Agent service account. If these procedures are available from a database session, an exploit to the SQL Server instance could result in a compromise of the host system and external SQL Server resources. Access to these procedures should be disabled unless use of SQL Server Agent is required and authorized.falseDatabase AdministratorDCFA-1</S>
      <S N="FixText">Authorize and document requirements for use of the Agent XPs option in the System Security Plan and AIS Functional Architecture documentation. Where not required and authorized, disable its use._x000A__x000A_From the query prompt:_x000A__x000A_EXEC SP_CONFIGURE 'show advanced options', 1_x000A_EXEC SP_CONFIGURE 'Agent XPs', 0_x000A_RECONFIGURE</S>
      <S N="Check">From the query prompt:_x000A__x000A_SELECT CAST(value AS INT) 'Config_Value'_x000A_FROM [master].sys.configurations_x000A_WHERE name = 'agent xps'_x000A__x000A_If the value of Config_Value is 1, confirm in the System Security Plan that this option is documented, required and approved by the IAO. If it is not documented, required and approved, this is a Finding._x000A__x000A_Note: If you are using SQL Server Management Studio to administer the SQL Server DBMS, document, approve and enable this option in the System Security Plan.</S>
    </MS>
  </Obj>
  <Obj RefId="312">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2005</S>
      <S N="VulnID">V-15211</S>
      <S N="RuleID">SV-25501r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">DM6199-SQLServer9</S>
      <S N="Title">The SMO and DMO SPs option should be set to disabled if not required.</S>
      <S N="Description">The SMO and DMO XPs are management object extended stored procedures that provide highly privileged actions that run externally to the DBMS under the security context of the SQL Server service account. If these procedures are available from a database session, an exploit to the SQL Server instance could result in a compromise of the host system and external SQL Server resources including the SQL Server software, audit, log and data files. Access to these procedures should be disabled unless a clear requirement for their use is indicated and authorized.falseDatabase AdministratorDCFA-1</S>
      <S N="FixText">Authorize and document requirements for use of the SMO and DMO XPs option in the System Security Plan and AIS Functional Architecture documentation. Where not required and authorized, disable its use._x000A__x000A_From the query prompt:_x000A__x000A_EXEC SP_CONFIGURE 'show advanced options', 1_x000A_EXEC SP_CONFIGURE 'SMO and DMO XPs', 0_x000A_RECONFIGURE</S>
      <S N="Check">From the query prompt:_x000A__x000A_SELECT CAST(value AS INT) 'Config_Value'_x000A_FROM [master].sys.configurations_x000A_WHERE name = 'smo and dmo xps'_x000A__x000A_If the value of Config_Value is 1, confirm in the System Security Plan and AIS Functional Architecture documentation that this option is documented and is required and approved by the IAO. If it is not documented, required and approved, this is a Finding._x000A__x000A_Note: If you are using SQL Server Management Studio to administer the SQL Server DBMS, document, approve and enable this option in the System Security Plan.</S>
    </MS>
  </Obj>
  <Obj RefId="313">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2005</S>
      <S N="VulnID">V-15608</S>
      <S N="RuleID">SV-24070r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">DG0009-SQLServer9</S>
      <S N="Title">Access to DBMS software files and directories should not be granted to unauthorized users.</S>
      <S N="Description">The DBMS software libraries contain the executables used by the DBMS to operate. Unauthorized access to the libraries can result in malicious alteration or planting of operational executables. This may in turn jeopardize data stored in the DBMS and/or operation of the host system.falseDatabase AdministratorDCSL-1</S>
      <S N="FixText">Restrict access to SQL Server files and directories as directed in the check.</S>
      <S N="Check">SQL Server program files are installed in two places:_x000A__x000A_1. A subdirectory of Program Files directory named Microsoft SQL Server ( specified here as [PFdir]) _x000A_2. The directory created for the specific instance (specified here as [InstDir])._x000A__x000A_This directory is specified in the registry for database engine instances under:_x000A__x000A_HKEY_LOCAL_MACHINE \ SOFTWARE \ Microsoft \ Microsoft SQL Server \ Instance Names \ SQL_x000A__x000A_Instances for Reporting Services and Analysis Services are listed under the registry keys:_x000A__x000A_HKEY_LOCAL_MACHINE \ SOFTWARE \ Microsoft \ Microsoft SQL Server \ Instance Names \ RS_x000A__x000A_HKEY_LOCAL_MACHINE \ SOFTWARE \ Microsoft \ Microsoft SQL Server \ Instance Names \ OLAP_x000A__x000A_File permissions may be reviewed individually using Windows explorer by navigating to the directory specified and viewing the Security properties. There are also tools available that are designed to streamline review of file permissions._x000A__x000A_Verify that the permissions are equal to or more restrictive than listed below:_x000A__x000A_The following groups may have Full Control assigned to any or all directories or files:_x000A__x000A_1. Administrators (builtin group)_x000A_2. DBAs  (custom group)_x000A_3. CREATOR OWNER (builtin)_x000A_4. SYSTEM (builtin)_x000A_5. SQL Server Service Account_x000A__x000A_If permission assignments are less restrictive than listed, this is a Finding._x000A__x000A_If permission assignments are granted to the Builtin USERS group, this is a Finding._x000A__x000A_Retain the SQL Server specific groups installed by Microsoft, any file permissions assigned to them and document in the System Security Plan.</S>
    </MS>
  </Obj>
  <Obj RefId="314">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2005</S>
      <S N="VulnID">V-15609</S>
      <S N="RuleID">SV-24129r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">DG0014-SQLServer9</S>
      <S N="Title">Default demonstration and sample database objects and applications should be removed.</S>
      <S N="Description">Demonstration and sample database objects and applications present publicly known attack points for malicious users. These demonstration and sample objects are meant to provide simple examples of coding specific functions and are not developed to prevent vulnerabilities from being introduced to the DBMS and host system.falseDatabase AdministratorDCFA-1</S>
      <S N="FixText">Drop sample or demonstration databases from production instances._x000A__x000A_Verify that no production objects have been stored in demonstration or sample databases prior to dropping._x000A__x000A_DROP DATABASE [database name]</S>
      <Nil N="Check" />
    </MS>
  </Obj>
  <Obj RefId="315">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2005</S>
      <S N="VulnID">V-15610</S>
      <S N="RuleID">SV-24074r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">DG0025-SQLServer9</S>
      <S N="Title">DBMS should use NIST FIPS 140-2 validated cryptography.</S>
      <S N="Description">Use of cryptography to provide confidentiality and non-repudiation is not effective unless strong methods are employed with its use. Many earlier encryption methods and modules have been broken and/or overtaken by increasing computing power. The NIST FIPS 140-2 cryptographic standards provide proven methods and strengths to employ cryptography effectively.trueDatabase AdministratorInformation Assurance OfficerDCNR-1</S>
      <S N="FixText">Upgrade to a FIPS 140-2 certified SQL Server version if encryption is required by the Information Owner._x000A__x000A_Configure cryptographic functions to use FIPS 140-2 compliant algorithms and hashing functions. If the DBMS does not employ validated cryptographic modules, consider obtaining and using a third-party FIPS 140-2 validated solution._x000A__x000A_Note: FIPS 140-2 compliance or non-compliance for the host and network is outside the purview of the Database STIG/Checklist. FIPS 140-2 non-compliance at the host/network level does not negate this requirement._x000A__x000A_Configure symmetric keys to use approved encryption algorithms. Existing keys are not re-configurable to use different algorithms._x000A__x000A_This may only be specified at key creation time:_x000A__x000A_CREATE SYMMETRIC KEY [key name] WITH ALGORITHM = AES_256 ENCRYPTION BY [certificate or asymmetric key]_x000A__x000A_Other approved algorithms that may be specified are TRIPLE_DES, AES_128 and AES_192._x000A__x000A_The symmetric key must specify a certificate or asymmetric for encryption. The certificate may be the code-signing certificate used by the application.</S>
      <Nil N="Check" />
    </MS>
  </Obj>
  <Obj RefId="316">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2005</S>
      <S N="VulnID">V-15611</S>
      <S N="RuleID">SV-24183r1_rule</S>
      <S N="Severity">low</S>
      <S N="Weight">10.0</S>
      <S N="Version">DG0054-SQLServer9</S>
      <S N="Title">The audit logs should be periodically monitored to discover DBMS access using unauthorized applications.</S>
      <S N="Description">Regular and timely reviews of audit records increases the likelihood of early discovery of suspicious activity. Discovery of suspicious behavior can in turn trigger protection responses to minimize or eliminate a negative impact from malicious activity. Use of unauthorized application to access the DBMS may indicate an attempt to bypass security controls including authentication and data access or manipulation implemented by authorized applications.falseInformation Assurance OfficerECAT-1, ECAT-2</S>
      <S N="FixText">Develop, document and implement procedures for monitoring application access to the database to detect access meant to bypass security controls._x000A__x000A_Where alerts are not implemented or available, establish weekly or more frequent review of queue activity.</S>
      <S N="Check">Review procedures for and evidence of monitoring the audit log to detect access by unauthorized applications in the System Security Plan._x000A__x000A_If procedures or implementation evidence do not exist, this is a Finding._x000A__x000A_If alerts are not generated automatically, manual reviews should occur weekly or more frequently. If manual reviews are required and implementation evidence does not exist, this is a Finding.</S>
    </MS>
  </Obj>
  <Obj RefId="317">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2005</S>
      <S N="VulnID">V-15612</S>
      <S N="RuleID">SV-24222r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">DG0072-SQLServer9</S>
      <S N="Title">Database password changes by users should be limited to one change within 24 hours where supported by the DBMS.</S>
      <S N="Description">Frequent password changes may indicate suspicious activity or attempts to bypass password controls based on password histories. Limiting the frequency of password changes helps to enforce password change rules and can lead to the discovery of compromised accounts.falseDatabase AdministratorIAIA-1, IAIA-2</S>
      <S N="FixText">Develop, configure and test a password verify feature or function that authenticates passwords on change to ensure that changes to database passwords do not occur more than once within a 24-hour period where supported by the DBMS.</S>
      <S N="Check">If no DBMS accounts authenticate using passwords, this check is Not a Finding._x000A__x000A_If DBMS uses Windows Authentication only, this check is Not a Finding._x000A__x000A_If the DBMS supports this functionality, review the settings and function logic or have the DBA demonstrate a password change to ensure that the function does not allow user changes to database passwords to occur more than once within a 24-hour period._x000A__x000A_If the review or demonstration reveals that database passwords can be changed by users more than once within a 24-hour period, this is a Finding._x000A__x000A_NOTE: Ensure password policy enforcement is enabled for SQL Server accounts per Check DG0079.</S>
    </MS>
  </Obj>
  <Obj RefId="318">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2005</S>
      <S N="VulnID">V-15613</S>
      <S N="RuleID">SV-24230r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">DG0078-SQLServer9</S>
      <S N="Title">Each database user, application or process should have an individually assigned account.</S>
      <S N="Description">Use of accounts shared by multiple users, applications, or processes limit the accountability for actions taken in or on the data or database. Individual accounts provide an opportunity to limit database authorizations to those required for the job function assigned to each individual account.falseDatabase AdministratorIAIA-1, IAIA-2</S>
      <S N="FixText">Create individual accounts for each user, application, or other process that requires a database connection._x000A__x000A_Document any accounts that are shared where separation is not supported by the application or for maintenance support._x000A__x000A_Design, develop and implement a method to log use of any account to which more than one person has access.  Restrict interactive access to shared  accounts to the fewest persons possible.</S>
      <S N="Check">Review DBMS account names against the list of authorized DBMS accounts in the System Security Plan.  If any accounts indicate use by mulitiple persons that are not mapped to a specific person, this is a Finding._x000A__x000A_If any applications or processes share an account that could be assigned an individual account or are not specified as requiring a shared account, this is a Finding._x000A__x000A_Note:  Privileged installation accounts may be required to be accessed by DBA or other administrators for system maintenance.  In these cases, each use of the account must be logged in some manner to assign accountability for any actions taken during the use of the account.</S>
    </MS>
  </Obj>
  <Obj RefId="319">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2005</S>
      <S N="VulnID">V-15614</S>
      <S N="RuleID">SV-20971r1_rule</S>
      <S N="Severity">low</S>
      <S N="Weight">10.0</S>
      <S N="Version">DG0084-SQLServer9</S>
      <S N="Title">The DBMS should be configured to clear residual data from memory, data objects or files, or other storage locations.</S>
      <S N="Description">Database storage locations may be reassigned to different objects during normal operations.  If not cleared of residual data, sensitive data may be exposed to unauthorized access.falseDatabase AdministratorECRC-1</S>
      <S N="FixText">Authorize and document requirements for use of the common criteria compliance option in the System Security Plan and AIS Functional Architecture documentation. Where authorized, enable its use._x000A__x000A_From the query prompt:_x000A__x000A_EXEC SP_CONFIGURE 'show advanced options', 1_x000A_EXEC SP_CONFIGURE 'common criteria compliance enabled', 1_x000A_RECONFIGURE</S>
      <S N="Check">Determine the SQL Server Edition:_x000A__x000A_From the query prompt:_x000A__x000A_SELECT CONVERT(INT, SERVERPROPERTY('EngineEdition'))_x000A__x000A_If value returned is 1 (Personal or Desktop Edition), 2 (Standard Edition) or 4 (Express Edition), this check is Not Applicable._x000A__x000A_From the query prompt:_x000A__x000A_SELECT CAST(value AS INT)_x000A_FROM [master].sys.configurations_x000A_WHERE name = 'common criteria compliance enabled'_x000A__x000A_If the value = 0, confirm in the System Security Plan that common criteria compliance is documented as not required by the IAO. If it is not documented or is required and approved, this is a Finding.</S>
    </MS>
  </Obj>
  <Obj RefId="320">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2005</S>
      <S N="VulnID">V-15615</S>
      <S N="RuleID">SV-24236r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">DG0085-SQLServer9</S>
      <S N="Title">DBA accounts should not be assigned excessive or unauthorized role privileges.</S>
      <S N="Description">The default DBA privileges typically include all privileges defined for a DBMS. These privileges are required to configure the DBMS and to provide other users access to DBMS objects. However, DBAs may not require access to application data or other privileges to administer the DBMS. Where not required or desired, DBAs may be prevented from accessing protected data for which they have no need-to-know or from utilizing unauthorized privileges for other actions. Although DBAs may assign themselves privileges to override any restrictions, the assignment of privileges is an audit requirement and this auditable event may assist discovery of a misuse of privileges.falseDatabase AdministratorInformation Assurance OfficerECLP-1</S>
      <S N="FixText">Document DBA job functions and minimum role privileges required to perform the DBA job function in the System Security Plan._x000A__x000A_Assign DBA accounts role privileges as documented and authorized in the System Security Plan._x000A__x000A_Revoke role privileges from DBA accounts where not documented and approved in the System Security Plan.</S>
      <S N="Check">Review DBA account role assignments and compare them to those listed in the System Security Plan with the IAO._x000A__x000A_If system/database roles assigned to DBAs are not listed as required assignments in the System Security Plan, this is a Finding.</S>
    </MS>
  </Obj>
  <Obj RefId="321">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2005</S>
      <S N="VulnID">V-15616</S>
      <S N="RuleID">SV-21481r1_rule</S>
      <S N="Severity">low</S>
      <S N="Weight">10.0</S>
      <S N="Version">DG0087-SQLServer9</S>
      <S N="Title">Sensitive data should be labeled.</S>
      <S N="Description">The sensitivity marking or labeling of data items promotes the correct handling and protection of the data.  Without such notification, the user may unwittingly disclose sensitive data to unauthorized users.falseDatabase AdministratorECML-1</S>
      <S N="FixText">Employ DBMS capabilities to mark or label sensitive data stored within the DBMS where supported. Document the appropriate markings of sensitive data in the System Security Plan.</S>
      <S N="Check">If no data is identified as being sensitive or classified by the Information Owner, in the System Security Plan or in the AIS Functional Architecture documentation, this check is Not a Finding._x000A__x000A_If the DBMS does not provide the capability to mark or label sensitive data within the DBMS, this check is Not a Finding._x000A__x000A_Review the DBMS configuration for marking and labeling of sensitive data. If sensitive data is not marked and labeled in accordance with the System Security Plan, this is a Finding._x000A_  http://www.microsoft.com/technet/prodtechnol/sql/2005/multisec.mspx</S>
    </MS>
  </Obj>
  <Obj RefId="322">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2005</S>
      <S N="VulnID">V-15617</S>
      <S N="RuleID">SV-24256r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">DG0098-SQLServer9</S>
      <S N="Title">Access to external objects should be disabled if not required and authorized.</S>
      <S N="Description">Objects defined within the database, but stored externally to the database are accessible based on authorizations defined by the local operating system or other remote system that may be under separate security authority. Access to external objects may thus be uncontrolled or not based on least privileges defined for each user job function. This in turn may provide unauthorized access to the external objects.falseDatabase AdministratorDCFA-1</S>
      <S N="FixText">Include any external application data objects defined in the database that is required for authorized application use in the AIS functional architecture documentation._x000A__x000A_Disable use of or remove any external application data object definitions that are not authorized.</S>
      <S N="Check">Review the database for definitions of application objects stored externally to the database._x000A__x000A_Determine if there are methods to disable use or access or to remove definitions for external data objects._x000A__x000A_If there are ways to prevent access to the external application data objects or the requirement for their access is not documented in the AIS functional architecture, this is a Finding.</S>
    </MS>
  </Obj>
  <Obj RefId="323">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2005</S>
      <S N="VulnID">V-15618</S>
      <S N="RuleID">SV-24096r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">DG0099-SQLServer9</S>
      <S N="Title">Access to external DBMS executables should be disabled or restricted.</S>
      <S N="Description">DBMSâ€™s may spawn additional external processes to execute procedures that are defined in the DBMS, but stored in external host files (external procedures). The spawned process used to execute the external procedure may operate within a different OS security context than the DBMS and provide unauthorized access to the host system.trueDatabase AdministratorDCFA-1</S>
      <S N="FixText">Document extended stored procedures in the System Security Plan and authorize with the IAO._x000A__x000A_Restrict access of extended stored procedures to SYSADMINs and application owner accounts where authorized for use._x000A__x000A_Note: Use of some extended stored procedures is required for common use and removal may affect SQL Server operations. The requirement differs based on SQL Server usage. To determine required extended stored procedures for a specific SQL Server installation, enable auditing on execute of the procedures. Review the audit data after a sufficient period to capture all operational usage, and then restrict access to unused extended stored procedures. If no operational issues arise after a sufficient time (you should double the period used before), remove the unused extended stored procedures where supported by the DBMS vendor._x000A__x000A_By default, the public role is granted execute access to many system-supplied extended stored procedures. It is recommended these execute privileges to extended stored procedures (the ones being retained for system use) be transferred from the public role and re-assigned to a custom all-user group._x000A__x000A_Redesign applications to use CLR integration.</S>
      <Nil N="Check" />
    </MS>
  </Obj>
  <Obj RefId="324">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2005</S>
      <S N="VulnID">V-15619</S>
      <S N="RuleID">SV-24258r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">DG0100-SQLServer9</S>
      <S N="Title">Replication accounts should not be granted DBA privileges.</S>
      <S N="Description">Replication accounts may be used to access databases defined for the replication architecture. An exploit of a replication on one database could lead to the compromise of any database participating in the replication that uses the same account name and credentials. If the replication account is compromised and it has DBA privileges, the database is at additional risk to unauthorized or malicious action.falseDatabase AdministratorDCFA-1</S>
      <S N="FixText">Disable replication if replication is not required._x000A__x000A_From the SQL Server Management Studio GUI:_x000A__x000A_1. Expand SQL Server_x000A_2. Right-click on Replication_x000A_3. Click Disable Publishing and Distribution_x000A_4. Complete the steps presented_x000A__x000A_Secure replication if required, authorized and documented._x000A__x000A_1. Create and use dedicated Windows-authenticated database accounts for Replication Agent use_x000A_2. Assign minimum database and file permissions to the Replication Agent accounts_x000A_3. Add only authorized Replication Merge and Distribution Agent accounts (and SYSADMIN accounts) to the PAL_x000A_4. Use network shared for snapshot folders access by pull subscriptions_x000A__x000A_Document replication in the System Security Plan, AIS Functional Architecture documentation and authorize with the IAO regardless of requirement.</S>
      <S N="Check">From the query prompt:_x000A__x000A_USE master_x000A_EXEC SP_GET_DISTRIBUTOR_x000A__x000A_If the value of installed is 0, and a review of the System Security Plan confirms the use of replication is not required and not allowed, this check is Not a Finding._x000A__x000A_If the value of installed is 1, and a review of the System Security Plan confirms the use of replication is required and allowed, this is Not a Finding. If it is not required or not allowed, this is a Finding._x000A__x000A_The following steps determine if the security of the configured Replication follows best practices:_x000A__x000A_From the query prompt:_x000A__x000A_EXEC SP_HELPREPLICATIONDBOPTION_x000A__x000A_1. Ensure replication data is encrypted in transit_x000A__x000A_Review documentation and evidence of configuration for encrypted connections between remote databases participating in replication where transmissions cross untrusted (support connections that do not have a need-to-know access requirement to the data being replicated) networks._x000A__x000A_2. Confirm replication agents use dedicated accounts_x000A__x000A_This is covered individually under check DM6065 and is not included in Finding status here. To view replication agent accounts:_x000A__x000A_USE msdb_x000A_SELECT p.name 'Proxy Name', c.credential_identity_x000A_FROM sys.credentials c, sysproxies p, sysproxysubsystem s_x000A_WHERE c.credential_id = p.proxy_id_x000A_AND s.proxy_id = p.proxy_id_x000A_AND s.subsysstem_id &gt; 3_x000A_AND s.subsystem_id &lt; 9_x000A__x000A_3. Confirm Replication Agent accounts are assigned minimum privileges_x000A__x000A_For each database, review assigned roles/permissions for each agent account:_x000A__x000A_USE [database name]_x000A__x000A_For each agent account listed under #2 above:_x000A__x000A_EXEC SP_HELPUSER '[user name]'_x000A__x000A_If any GroupName other than db_owner is listed in any database, this is a Finding._x000A__x000A_If any GroupName is listed in any database other than replication databases, this is a Finding_x000A__x000A_EXEC SP_HELPROTECT '[user name]'_x000A__x000A_If any permission is listed, this is a Finding. _x000A__x000A_Perform once:_x000A__x000A_EXEC SP_HELPSRVROLEMEMBER_x000A__x000A_If any replication agent accounts are listed, this is a Finding._x000A__x000A_4. Confirm only authorized Merge and Distribution Agent accounts are listed in the Publication Access List (PAL)_x000A__x000A_For each replication database:_x000A__x000A_EXEC SP_HELPPUBLICATION_x000A__x000A_For each publication listed:_x000A__x000A_EXEC SP_HELP_PUBLICATION_ACCESS '[publication name]'_x000A__x000A_If any accounts are listed under publications that are not SYSADMINs, replication merge (category REPL-Merge) or replication distributor (category REPL-Distribution) agent accounts, this is a Finding._x000A__x000A_5. Confirm minimum permissions are assigned to any local snapshot folders_x000A_Results for this security check are recorded individually under DM6075._x000A__x000A_6. (cont from 5) Confirm snapshot Agent accounts are granted only write permissions to the snapshot folder_x000A__x000A_If the snapshot agent account has more than write access to the snapshot folder, this is a Finding._x000A__x000A_7. Verify network shares are used for snapshot folders accessed by pull subscriptions_x000A__x000A_If the server does not have a Publisher database, this check is Not a Finding._x000A__x000A_For each publisher database:_x000A__x000A_USE [database name]_x000A_EXEC SP_HELPSUBSCRIPTION_x000A__x000A_If any subscribers listed indicate a remote database (a database on a different server), then confirm the snapshot folder is defined as a network share. If it is not, this is a Finding._x000A__x000A_Note: See folder information for the publication listed for the subscriber under the SP_HELPPUBLICATION results. Windows shares are indicated with a share icon and are indicated as shared in the directory properties \ share tab._x000A__x000A_8. Verify Agent accounts use Windows authentication_x000A__x000A_See Agent accounts returned from #2 above_x000A__x000A_If any accounts listed are not Windows accounts (display [domain or computername]\[account name]), this is a Finding.</S>
    </MS>
  </Obj>
  <Obj RefId="325">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2005</S>
      <S N="VulnID">V-15620</S>
      <S N="RuleID">SV-24260r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">DG0101-SQLServer9</S>
      <S N="Title">OS accounts used to execute external procedures should be assigned minimum privileges.</S>
      <S N="Description">External applications spawned by the DBMS process may be executed under OS accounts assigned unnecessary privileges that can lead to unauthorized access to OS resources. Unauthorized access to OS resources can lead to the compromise of the OS, the DBMS, and any other service provided by the host platform.falseDatabase AdministratorDCFA-1</S>
      <S N="FixText">Create a local custom account for the SQL Server service accounts._x000A__x000A_A domain account may be used where network resources are required._x000A__x000A_Please see SQL Server Books Online for detailed information._x000A__x000A_Assign the account to the SQL Server group (created at installation for SQL Server 2005) if available._x000A__x000A_Assign the SQL Server account or group the user privileges as listed in the Check procedures.</S>
      <S N="Check">View the Security Settings of the SQL Server service account to see user rights assigned to the service account or group._x000A__x000A_To view assigned user rights (may be assigned using group privileges):_x000A__x000A_1. Click Start_x000A_2. Select Control Panel \ Administrative Tools (Win2K) or Select Administrative Tools (Win2K3)_x000A_3. Click Local Security Policy_x000A_4. Expand Local Policies_x000A_5. Select User Rights Assignment_x000A__x000A_For SQL Server Service account:_x000A__x000A_If any user rights are assigned to the service account other than the following, this is a Finding:_x000A__x000A_1. Log on as a service (SeServiceLogonRight)_x000A_2. Act as part of the operating system (SeTcbPrivilege) (Win2K only)_x000A_3. Log on as a batch job (SeBatchLogonRight)_x000A_4. Replace a process-level token (SeAssignPrimaryTokenPrivilege)_x000A_5. Bypass traverse checking (SeChangeNotifyPrivilege)_x000A_6. Adjust memory quotas for a process (SeIncreaseQuotaPrivilege)_x000A__x000A_The following user rights are applicable for SQL Server 2005 only:_x000A_1. Permission to start SQL Server Active Directory Helper_x000A_2. Permission to Start SQL Write</S>
    </MS>
  </Obj>
  <Obj RefId="326">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2005</S>
      <S N="VulnID">V-15622</S>
      <S N="RuleID">SV-24267r1_rule</S>
      <S N="Severity">low</S>
      <S N="Weight">10.0</S>
      <S N="Version">DG0104-SQLServer9</S>
      <S N="Title">DBMS service identification should be unique and clearly identifies the service.</S>
      <S N="Description">Local or network services that do not employ unique or clearly identifiable targets can lead to inadvertent or unauthorized connections.falseDatabase AdministratorDCFA-1</S>
      <S N="FixText">Follow instructions for renaming a database instance:_x000A__x000A_  Review the sp_dropserver and sp_addserver procedures_x000A__x000A_Set the value so that it does not identify the SQL Server version and clearly identifies its purpose.</S>
      <S N="Check">Review the SQL Server database names on the DBMS host:_x000A__x000A_Go to Start / Administrative Tools / Services_x000A__x000A_View service names that begin with "SQL Server". The database name is in parenthesis (NAME). _x000A__x000A_If database names as listed do not clearly identify the use of the database or clearly differentiate individual databases, this is a Finding._x000A__x000A_An example of database naming that meets the requirement:_x000A__x000A_prdinv01 (Production Inventory Database #1)_x000A_dvsales02 (Development Sales Database #2)_x000A_msfindb1 (Microsoft Financials Database #1)_x000A__x000A_Examples of instance naming that do not meet the requirement:_x000A__x000A_database1, MyDatabase, SQL7_x000A__x000A_Interview the DBA to get an understanding of the naming scheme used to determine if the names are clear differentiations.</S>
    </MS>
  </Obj>
  <Obj RefId="327">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2005</S>
      <S N="VulnID">V-15625</S>
      <S N="RuleID">SV-24294r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">DG0115-SQLServer9</S>
      <S N="Title">Recovery procedures and technical system features exist to ensure that recovery is done_x000A_in a secure and verifiable manner.</S>
      <S N="Description">A DBMS may be vulnerable to use of compromised data or other critical files during recovery. Use of compromised files could introduce maliciously altered application code, relaxed security settings or loss of data integrity. Where available, DBMS mechanisms to ensure use of only trusted files can help protect the database from this type of compromise during DBMS recovery.falseDatabase AdministratorCOTR-1</S>
      <S N="FixText">Develop, document and implement DBMS recovery procedures and employ technical system features where supported by the DBMS to specify trusted files during DBMS recovery._x000A__x000A_Ensure circumstances that can inhibit a trusted recovery are documented and appropriate mitigating procedures have been put in place.</S>
      <S N="Check">Review DBMS recovery procedures or technical system features to determine if mechanisms exist and are in place to specify use of trusted files during DBMS recovery._x000A__x000A_If recovery procedures do not exist or are not sufficient to ensure recovery is done in a secure and verifiable manner, this is a Finding._x000A__x000A_If system features exist and are not employed or not employed sufficiently, this is a Finding._x000A__x000A_If circumstances that can inhibit a trusted recovery are not documented and appropriate mitigating procedures have not been put in place, this is a Finding.</S>
    </MS>
  </Obj>
  <Obj RefId="328">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2005</S>
      <S N="VulnID">V-15626</S>
      <S N="RuleID">SV-24102r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">DG0116-SQLServer9</S>
      <S N="Title">Database privileged role assignments should be restricted to IAO-authorized DBMS accounts.</S>
      <S N="Description">Roles assigned privileges to perform DDL and/or system configuration actions in the database can lead to compromise of any data in the database as well as operation of the DBMS itself. Restrict assignment of privileged roles to authorized personnel and database accounts to help prevent unauthorized activity.trueInformation Assurance OfficerECLP-1</S>
      <S N="FixText">Document IAO-authorized privileged role assignments in the System Security Plan. Remove assignments where not authorized._x000A__x000A_If BUILTIN\Administrators is part of the SYSADMIN fixed server role, create a custom group for SYSADMIN functions, add authorized users to the custom group, add the group to the SYSADMIN fixed server role, remove BUILTIN\Administrators from the role. If other unauthorized users exist, remove them from the role._x000A__x000A_To remove BUILTIN\Administrators from the SYSADMIN fixed server role:_x000A__x000A_1. Create a custom group for SYSADMIN functions_x000A_2. Add authorized users to the custom group_x000A_3. Add the group to the SYSADMIN fixed server role_x000A_4. Remove BUILTIN\Administrators from the role</S>
      <Nil N="Check" />
    </MS>
  </Obj>
  <Obj RefId="329">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2005</S>
      <S N="VulnID">V-15627</S>
      <S N="RuleID">SV-24298r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">DG0117-SQLServer9</S>
      <S N="Title">Administrative privileges should be assigned to database accounts via database roles.</S>
      <S N="Description">Privileges granted outside the role of the administrative user job function are more likely to go unmanaged or without oversight for authorization. Maintenance of privileges using roles defined for discrete job functions offers improved oversight of administrative user privilege assignments and helps to protect against unauthorized privilege assignment.falseInformation Assurance OfficerECPA-1</S>
      <S N="FixText">Create roles for administrative function assignments. Assign the necessary privileges for the administrative function to a role._x000A__x000A_Assign administrative roles to authorized administrative users._x000A__x000A_Document administrative job functions, roles, and required permissions in the System Security Plan._x000A__x000A_Maintain evidence of administrative role authorizations.</S>
      <S N="Check">Review administrative accounts for direct privilege assignment._x000A__x000A_If any administrative privileges have been assigned directly to a database account, this is a Finding.</S>
    </MS>
  </Obj>
  <Obj RefId="330">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2014</S>
      <S N="VulnID">V-15628</S>
      <Obj N="RuleID" RefId="331">
        <TNRef RefId="1" />
        <LST>
          <S>SV-24305r1_rule</S>
          <S>SV-55936r1_rule</S>
        </LST>
      </Obj>
      <Obj N="Severity" RefId="332">
        <TNRef RefId="1" />
        <LST>
          <S>medium</S>
          <S>medium</S>
        </LST>
      </Obj>
      <Obj N="Weight" RefId="333">
        <TNRef RefId="1" />
        <LST>
          <S>10.0</S>
          <S>10.0</S>
        </LST>
      </Obj>
      <Obj N="Version" RefId="334">
        <TNRef RefId="1" />
        <LST>
          <S>DG0119-SQLServer9</S>
          <S>DG0119-SQLServer9</S>
        </LST>
      </Obj>
      <Obj N="Title" RefId="335">
        <TNRef RefId="1" />
        <LST>
          <S>DBMS application users should not be granted administrative privileges to the DBMS.</S>
          <S>DBMS application users should not be granted administrative privileges to the DBMS.</S>
        </LST>
      </Obj>
      <Obj N="Description" RefId="336">
        <TNRef RefId="1" />
        <LST>
          <S>DBMS privileges to issue other than Database Manipulation Language (DML) commands provide means to affect database object configuration and use of resources.  Application users do not require these privileges to complete non-administrative job functions.  Where applications require administrative privileges to execute non-administrative functions, exploits of the application can lead to unauthorized administrative access to the DBMS.falseDatabase AdministratorECLP-1</S>
          <S>DBMS privileges to issue other than Database Manipulation Language (DML) commands provide means to affect database object configuration and use of resources.  Application users do not require these privileges to complete non-administrative job functions.  Where applications require administrative privileges to execute non-administrative functions, exploits of the application can lead to unauthorized administrative access to the DBMS.falseDatabase AdministratorECLP-1</S>
        </LST>
      </Obj>
      <Obj N="FixText" RefId="337">
        <TNRef RefId="1" />
        <LST>
          <S>Revoke administrative privileges from application roles. _x000A__x000A_Do not allow Database Definition Language (DDL) or other administrative privileges for operation of the application, for example, do not create and drop database objects for temporary storage of data._x000A__x000A_Consider, instead, the storage of temporary data in static database tables.</S>
          <S>Revoke administrative privileges from application roles. _x000A__x000A_Do not allow Database Definition Language (DDL) or other administrative privileges for operation of the application, for example, do not create and drop database objects for temporary storage of data._x000A__x000A_Consider, instead, the storage of temporary data in static database tables.</S>
        </LST>
      </Obj>
      <Obj N="Check" RefId="338">
        <TNRef RefId="1" />
        <LST>
          <S>Review privileges assigned to application roles in the database._x000A__x000A_If any privileges other than SELECT, INSERT, UPDATE, DELETE or EXECUTE are assigned to application roles, this is a Finding.</S>
          <S>Review privileges assigned to application roles in the database._x000A__x000A_If any privileges other than SELECT, INSERT, UPDATE, DELETE or EXECUTE are assigned to application roles, this is a Finding.</S>
        </LST>
      </Obj>
    </MS>
  </Obj>
  <Obj RefId="339">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2005</S>
      <S N="VulnID">V-15631</S>
      <S N="RuleID">SV-24309r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">DG0123-SQLServer9</S>
      <S N="Title">Access to DBMS system tables and other configuration or metadata should be restricted to DBAs.</S>
      <S N="Description">Administrative data includes DBMS metadata and other configuration and management data. Unauthorized access to this data could result in unauthorized changes to database objects, access controls, or DBMS configuration.falseDatabase AdministratorECAN-1</S>
      <S N="FixText">Revoke access to system tables to non-DBA users._x000A__x000A_Where use of system data is required by non-DBA users, provide controlled access for authorized functions via views, procedures, or other use of controlled objects.</S>
      <S N="Check">Review access controls on system tables._x000A__x000A_Review access to configuration data stored in the database._x000A__x000A_If any users not assigned DBA privileges are assigned access to the underlying tables, this is a Finding.</S>
    </MS>
  </Obj>
  <Obj RefId="340">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2005</S>
      <S N="VulnID">V-15632</S>
      <S N="RuleID">SV-24312r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">DG0124-SQLServer9</S>
      <S N="Title">Use of DBA accounts should be restricted to administrative activities.</S>
      <S N="Description">Use of privileged accounts for non-administrative purposes puts data at risk of unintended or unauthorized loss, modification or exposure. In particular, DBA accounts if used for non-administration application development or application maintenance can lead to miss-assignment of privileges where privileges are inherited by object owners. It may also lead to loss or compromise of application data where the elevated privileges bypass controls designed in and provided by applications.falseInformation Assurance OfficerECLP-1</S>
      <S N="FixText">Create separate accounts for administration activities._x000A__x000A_Develop, document and implement policy and procedures that require separate, unprivileged or less-privileged accounts for development, testing and application users.</S>
      <S N="Check">Review accounts assigned fixed server roles and fixed database roles with the DBA/IAO and as documented in the System Security Plan._x000A__x000A_Review other database or application roles assigned to the accounts assigned fixed roles as documented in the System Security Plan._x000A__x000A_If any accounts assigned fixed roles are also assigned application roles or other application object privilege roles or own application objects used for other than DBA functions, this is a Finding.</S>
    </MS>
  </Obj>
  <Obj RefId="341">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2005</S>
      <S N="VulnID">V-15634</S>
      <S N="RuleID">SV-24314r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">DG0127-SQLServer9</S>
      <S N="Title">DBMS account passwords should not be set to easily guessed words or values.</S>
      <S N="Description">DBMS account passwords set to common dictionary words or values render accounts vulnerable to password guessing attacks and unauthorized access.falseDatabase AdministratorIAIA-1, IAIA-2</S>
      <S N="FixText">Employ preventative means, user training and/or password cracking routines to discover and prevent easily guessed passwords in the database.</S>
      <S N="Check">If no DBMS accounts authenticate using passwords, this check is Not a Finding._x000A__x000A_If DBMS uses Windows Authentication only, this check is Not a Finding._x000A__x000A_Review methods for protecting accounts from assignment of easily guessed passwords. If methods do not include at least one of the following or a viable alternate means to prevent use of easily guessed passwords, this is a Finding._x000A__x000A_1. Password cracker run frequently to report easily guessed passwords_x000A_2. Automated routine to check passwords against password dictionaries at password assignment time_x000A_3. User training and understanding of the risk of easily guessed passwords_x000A_4. Using Windows Authentication for database accounts_x000A__x000A_NOTE: Ensure password policy enforcement is enabled for SQL Server accounts per Check DG0079.</S>
    </MS>
  </Obj>
  <Obj RefId="342">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2005</S>
      <S N="VulnID">V-15635</S>
      <S N="RuleID">SV-24108r1_rule</S>
      <S N="Severity">high</S>
      <S N="Weight">10.0</S>
      <S N="Version">DG0128-SQLServer9</S>
      <S N="Title">DBMS default accounts should be assigned custom passwords.</S>
      <S N="Description">DBMS default passwords provide a commonly known and exploited means for unauthorized access to database installations.falseIf identified accounts show an account status of LOCKED and password is set to EXPIRED this is a Finding, but downgrade the severity Category Code to II.Database AdministratorIAIA-1, IAIA-2</S>
      <S N="FixText">Assign a password to accounts that meet DoD complexity requirements._x000A__x000A_From the query prompt:_x000A__x000A_USE master_x000A_ALTER LOGIN [name] WITH PASSWORD = '[new password]'_x000A__x000A_Replace [new password] with a password and [name] with the account name._x000A__x000A_Use the SQL Server Enterprise Manager GUI to change the assigned password of any SQL Serverâ€“related service. _x000A__x000A_Each service must be changed individually. </S>
      <Nil N="Check" />
    </MS>
  </Obj>
  <Obj RefId="343">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2005</S>
      <S N="VulnID">V-15636</S>
      <S N="RuleID">SV-29118r1_rule</S>
      <S N="Severity">high</S>
      <S N="Weight">10.0</S>
      <S N="Version">DG0129-SQLServer9</S>
      <S N="Title">Passwords should be encrypted when transmitted across the network.</S>
      <S N="Description">DBMS passwords sent in clear text format across the network are vulnerable to discovery by unauthorized users. Disclosure of passwords may easily lead to unauthorized access to the database.falseDatabase AdministratorIAIA-1, IAIA-2</S>
      <S N="FixText">Utilize SQL Server connection protocols and products (i.e. SQL Server Client) where possible._x000A__x000A_Where other connection products and protocols are used, ensure configuration options for encrypting passwords during login events across the network are used._x000A__x000A_If the database does not provide encryption for login events natively, employ encryption at the OS or network level._x000A__x000A_Ensure passwords remain encrypted from source to destination.</S>
      <S N="Check">SQL Server natively encrypts passwords in transit when using SQL Server connection protocols and products (i.e. SQL Server Client)._x000A__x000A_Where other connection products and protocols are used, review configuration options for encrypting passwords during login events across the network._x000A__x000A_If passwords are not encrypted, this is a Finding._x000A__x000A_Where only SQL Server connection protocols and products are used and password encryption is not purposely disabled and enabled where applicable, this is Not a Finding._x000A__x000A_If determined that passwords are passed unencrypted at any point along the transmission path between the source and destination, this is a Finding.</S>
    </MS>
  </Obj>
  <Obj RefId="344">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2005</S>
      <S N="VulnID">V-15637</S>
      <S N="RuleID">SV-24320r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">DG0130-SQLServer9</S>
      <S N="Title">DBMS passwords should not be stored in compiled, encoded or encrypted batch jobs or compiled, encoded or encrypted application source code.</S>
      <S N="Description">The storage of passwords in application source or batch job code that is compiled, encoded or encrypted prevents compliance with password expiration and other management requirements as well as provides another means for potential discovery.falseDatabase AdministratorInformation Assurance OfficerIAIA-1, IAIA-2</S>
      <S N="FixText">Design DBMS application code and batch job code that is compiled, encoded or encrypted to NOT contain passwords._x000A__x000A_Consider alternatives to using password authentication for compiled, encoded or encrypted batch jobs and DBMS application code.</S>
      <S N="Check">Ask the DBA to review application source code that is required by Check DG0091 to be encoded or encrypted for database accounts used by applications or batch jobs to access the database._x000A__x000A_Ask the DBA to review source batch job code prior to compiling, encoding or encrypting for database accounts used by applications or the batch jobs themselves to access the database._x000A__x000A_Ask the DBA and/or IAO to determine if the compiled, encoded or encrypted application source code or batch jobs contain passwords used for authentication to the database._x000A__x000A_If none of the identified compiled, encoded or encrypted application source code or batch job code contain passwords used for authentication, this check is Not a Finding._x000A__x000A_If any of the identified compiled, encoded or encrypted application source code or batch job code do contain passwords used for authentication to the database, this is a Finding._x000A__x000A_NOTE: This check only applies to application source code or batch job code that is compiled, encoded or encrypted in a production environment. Application source code or batch job code that is not compiled, encoded or encrypted would fall under Check DG0067 for determination of compliance.</S>
    </MS>
  </Obj>
  <Obj RefId="345">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2005</S>
      <S N="VulnID">V-15638</S>
      <S N="RuleID">SV-21454r1_rule</S>
      <S N="Severity">low</S>
      <S N="Weight">10.0</S>
      <S N="Version">DG0131-SQLServer9</S>
      <S N="Title">DBMS default account names should be changed.</S>
      <S N="Description">Well-known DBMS account names are targeted most frequently by attackers and are thus more prone to providing unauthorized access to the database.falseDatabase AdministratorIAIA-1, IAIA-2</S>
      <S N="FixText">From the query prompt:_x000A__x000A_ALTER LOGIN sa WITH NAME = '[new sa name]'_x000A__x000A_Replace [new sa name] with a custom-supplied name.</S>
      <Nil N="Check" />
    </MS>
  </Obj>
  <Obj RefId="346">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2005</S>
      <S N="VulnID">V-15639</S>
      <S N="RuleID">SV-24322r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">DG0133-SQLServer9</S>
      <S N="Title">Unlimited account lock times should be specified for locked accounts.</S>
      <S N="Description">When no limit is imposed on failed logon attempts and accounts are not disabled after a set number of failed access attempts, then the DBMS account is vulnerable to sustained attack.  When access attempts may continue unrestricted, the likelihood of success is increased.  A successful attempt results in unauthorized access to the database.falseDatabase AdministratorECLO-1, ECLO-2</S>
      <S N="FixText">Configure the database to maintain an account lock time until the account is manually unlocked by an authorized account administrator._x000A__x000A_For DBMS accounts using Windows Authentication:_x000A__x000A_1. Launch the Group Policy Editor on the DBMS Server_x000A_2. Under Computer Configuration:_x000A_  a. Expand Windows Settings_x000A_  b. Expand Security Settings_x000A_  c. Expand Account Policies_x000A_  d. Select Account Lockout Policy_x000A_3. Set "Account Lockout Threshold" = 3_x000A_4. Set or Reset "Account Lockout Duration" = 0_x000A_5. Set or Reset "Reset Account Lockout Counter After" = 99999 (about 69 days, which is max for this policy setting)_x000A_6. Close Group Policy Editor_x000A__x000A_Document these settings in the System Security Plan.</S>
      <S N="Check">If the DBMS does not provide a method or means for configuration of account lock times, this check is Not a Finding._x000A__x000A_Review the account lock time configuration setting. If the lock time is not set to unlimited or is set to allow the DBMS to unlock the account after a pre-determined amount of time, this is a Finding._x000A__x000A_For DBMS accounts using Windows Authentication:_x000A__x000A_1. Launch the Group Policy Editor on the DBMS Server_x000A_2. Under Computer Configuration:_x000A_  a. Expand Windows Settings_x000A_  b. Expand Security Settings_x000A_  c. Expand Account Policies_x000A_  d. Select Account Lockout Policy_x000A_3. Review Account Lockout Duration, Account Lockout Threshold and Reset Account Lockout Counter After policies_x000A__x000A_If Account Lockout Duration is not set or set to a value greater than 0, this is a Finding._x000A__x000A_If Account Lockout Threshold is not set or set to a value greater than 3, this is a Finding._x000A__x000A_If Reset Account Lockout Counter After is not set to its maximum value (For Windows 2003, this is 99999), this is a Finding._x000A__x000A_NOTE: Ensure password policy enforcement is enabled for SQL Server accounts per Check DG0079.</S>
    </MS>
  </Obj>
  <Obj RefId="347">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2005</S>
      <S N="VulnID">V-15643</S>
      <S N="RuleID">SV-25371r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">DG0140-SQLServer9</S>
      <S N="Title">Access to DBMS security should be audited.</S>
      <S N="Description">DBMS security data is useful to malicious users to perpetrate activities that compromise DBMS operations or data integrity. Auditing of access to this data supports forensic and accountability investigations.falseDatabase AdministratorECAR-1, ECAR-2, ECAR-3</S>
      <S N="FixText">Enable auditing for access to any security data where supported by the OS._x000A__x000A_If audit for access results in an unacceptable adverse impact on application operation, scale back the audit to a reasonable and acceptable level._x000A__x000A_Document any incomplete audit with acceptance of the risk of incomplete audit in the System Security Plan._x000A__x000A_Auditing for Access via OS should include, at a minimum, the User ID, date and time of the event and the event type per Check DG0145.</S>
      <S N="Check">Note: Checks DG0029, DG0145, DM0510 and DM5267 cover auditing of data within SQL Server and should not be included in this check._x000A__x000A_Determine locations of DBMS audit, configuration, credential and other security data using the registry keys provided below:_x000A__x000A_Audit Trace = HKLM\SOFTWARE\Microsoft\Microsoft SQL Server\MSSQL.1\MSSQLServer\DefaultData_x000A_              _x000A_Log = C:\Program Files\Microsoft SQL Server\MSSQL.3\Reporting Services\LogFiles_x000A_      HKLM\SOFTWARE\Microsoft\Microsoft SQL Server\MSSQL.1\CPE\ErrorDumpDir_x000A_      HKLM\SOFTWARE\Microsoft\Microsoft SQL Server\MSSQL.2\CPE\ErrorDumpDir_x000A_      HKLM\SOFTWARE\Microsoft\Microsoft SQL Server\MSSQL.3\CPE\ErrorDumpDir_x000A_      HKLM\SOFTWARE\Microsoft\Microsoft SQL Server\MSSQL.1\MSSQLServer\DefaultLog_x000A_      HKLM\SOFTWARE\Microsoft\Microsoft SQL Server\MSSQL.1\SQLServerAgent\ErrorLogFile_x000A__x000A_Config = C:\Program Files\Microsoft SQL Server\90\Shared\ASConfig_x000A_         HKLM\SOFTWARE\Microsoft\Microsoft SQL Server\{INSTANCE NAME}\Setup\SQLPath_x000A_         HKLM\SOFTWARE\Microsoft\Microsoft SQL Server\MSSQL.1\MSSQLServer\BackupDirectory_x000A_         HKLM\SOFTWARE\Microsoft\Microsoft SQL Server\MSSQL.1\MSSQLServer\FullTextDefaultPath_x000A_         HKLM\SOFTWARE\Microsoft\Microsoft SQL Server\MSSQL.1\Replication\WorkingDirectory_x000A_         HKLM\SOFTWARE\Microsoft\Microsoft SQL Server\MSSQL.1\Setup\SQLBinRoot_x000A_         HKLM\SOFTWARE\Microsoft\Microsoft SQL Server\MSSQL.1\Setup\SQLDataRoot_x000A_         HKLM\SOFTWARE\Microsoft\Microsoft SQL Server\MSSQL.1\Setup\SQLPath_x000A_         HKLM\SOFTWARE\Microsoft\Microsoft SQL Server\MSSQL.1\Setup\SQLProgramDir_x000A_         HKLM\SOFTWARE\Microsoft\Microsoft SQL Server\MSSQL.1\SQLServerAgent\WorkingDirectory_x000A_         HKLM\SOFTWARE\Microsoft\Microsoft SQL Server\MSSQL.2\Setup\DataDir_x000A_         HKLM\SOFTWARE\Microsoft\Microsoft SQL Server\MSSQL.2\Setup\SQLBinRoot_x000A_         HKLM\SOFTWARE\Microsoft\Microsoft SQL Server\MSSQL.2\Setup\SQLPath_x000A_         HKLM\SOFTWARE\Microsoft\Microsoft SQL Server\MSSQL.2\Setup\SQLProgramDir_x000A__x000A_Review audit settings for these directories, files or data objects. If the security data is not audited for access, consider the operational impact and appropriateness for access that is not audited._x000A__x000A_If the risk for incomplete auditing of the security files is reasonable and documented in the System Security Plan, do not include this as a Finding.</S>
    </MS>
  </Obj>
  <Obj RefId="348">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2005</S>
      <S N="VulnID">V-15644</S>
      <S N="RuleID">SV-25374r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">DG0141-SQLServer9</S>
      <S N="Title">Attempts to bypass access controls should be audited.</S>
      <S N="Description">Detection of suspicious activity including access attempts and successful access from unexpected places, during unexpected times, or other unusual indicators can support decisions to apply countermeasures to deter an attack. Without detection, malicious activity may proceed without impedance.falseDatabase AdministratorECAR-2, ECAR-3</S>
      <S N="FixText">Enable Auditing level. _x000A__x000A_From the SQL Server Management Studio GUI:_x000A__x000A_1. Navigate to the SQL Server instance name_x000A_2. Right-click on it_x000A_3. Select Properties_x000A_4. Select Security tab or page_x000A_5. Review Login Auditing selection_x000A_6. Select "Failed logins only" or "Both failed and successful logins" from the Login Auditing section_x000A_7. Apply changes_x000A_8. Exit the SQL Server Management Studio GUI_x000A_</S>
      <Nil N="Check" />
    </MS>
  </Obj>
  <Obj RefId="349">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2005</S>
      <S N="VulnID">V-15645</S>
      <S N="RuleID">SV-21458r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">DG0142-SQLServer9</S>
      <S N="Title">Changes to configuration options should be audited.</S>
      <S N="Description">The default audit trace provides a log of activity and changes primarily related to DBMS configuration options. The default audit trace option does not provide adequate auditing and should be disabled.falseDatabase AdministratorECAR-3</S>
      <S N="FixText">Authorize and document requirements for use of the default trace option in the System Security Plan and AIS Functional Architecture documentation. Where not authorized, disable its use._x000A__x000A_From the query prompt:_x000A__x000A_EXEC SP_CONFIGURE 'show advanced options', 1_x000A_EXEC SP_CONFIGURE 'default trace enabled', 0_x000A_RECONFIGURE</S>
      <S N="Check">From the query prompt:_x000A__x000A_SELECT CAST(value AS INT) 'Config_Value'_x000A_FROM [master].sys.configurations_x000A_WHERE name = 'default trace enabled'_x000A__x000A_If the value of Config_Value is 0, this is Not a Finding._x000A__x000A_If the value of Config_Value is 1, confirm in the System Security Plan and AIS Functional Architecture documentation that this option is documented as required and approved by the IAO. If it is not documented and is required and approved, this is a Finding.</S>
    </MS>
  </Obj>
  <Obj RefId="350">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2005</S>
      <S N="VulnID">V-15646</S>
      <S N="RuleID">SV-24109r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">DG0145-SQLServer9</S>
      <S N="Title">Audit records should contain required information.</S>
      <S N="Description">Complete forensically valuable data may be unavailable or accountability may be jeopardized when audit records do not contain sufficient information.falseDatabase AdministratorECAR-1, ECAR-2, ECAR-3</S>
      <S N="FixText">Create and start an audit trace that audits required events._x000A__x000A_CREATE PROCEDURE fso_audit AS_x000A__x000A_-- Create a Queue_x000A__x000A_DECLARE @rc INT_x000A_DECLARE @TraceID INT_x000A_DECLARE @maxfilesize BIGINT_x000A_DECLARE @fso_audit_log NVARCHAR(128)_x000A__x000A_SET @maxfilesize = 5_x000A__x000A_-- Define custom @fso_audit_log to path\filename_x000A__x000A_SET @fso_audit_log = 'd:\sqlserver\audit\fsoauditlog.log'_x000A__x000A_EXEC @rc = SP_TRACE_CREATE @TraceID output, 6, @fso_audit_log, @maxfilesize, NULL_x000A__x000A_IF (@rc != 0) GOTO Error_x000A__x000A_-- Client side File and Table cannot be scripted._x000A_-- Set the events:_x000A__x000A_DECLARE @on BIT_x000A__x000A_SET @on = 1_x000A__x000A_-- Logins are audited based on SQL Server instance_x000A_-- setting Audit Level stored in registry_x000A_-- HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Microsoft SQL Server\MSSQL.[#]\MSSQLServer\AuditLevel_x000A__x000A_-- Audit Login_x000A_-- Occurs when a user successfully logs in to SQL Server._x000A__x000A_EXEC SP_TRACE_SETEVENT @TraceID, 14, 1,  @on -- TextData_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 14, 6,  @on -- NTUserName_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 14, 7,  @on -- NTDomainName_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 14, 8,  @on -- HostName_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 14, 10, @on -- ApplicationName_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 14, 11, @on -- LoginName_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 14, 12, @on -- SPID_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 14, 14, @on -- StartTime_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 14, 23, @on -- Success_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 14, 26, @on -- ServerName_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 14, 35, @on -- DatabaseName_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 14, 41, @on -- LoginSid_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 14, 60, @on -- IsSystem_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 14, 64, @on -- SessionLoginName_x000A__x000A_-- Audit Logout_x000A_-- Occurs when a user logs out of SQL Server._x000A__x000A_EXEC SP_TRACE_SETEVENT @TraceID, 15, 6,  @on -- NTUserName_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 15, 7,  @on -- NTDomainName_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 15, 8,  @on -- HostName_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 15, 10, @on -- ApplicationName_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 15, 11, @on -- LoginName_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 15, 12, @on -- SPID_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 15, 13, @on -- Duration_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 15, 14, @on -- StartTime_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 15, 15, @on -- EndTime_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 15, 23, @on -- Success_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 15, 26, @on -- ServerName_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 15, 35, @on -- DatabaseName_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 15, 41, @on -- LoginSid_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 15, 60, @on -- IsSystem_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 15, 64, @on -- SessionLoginName_x000A__x000A__x000A_-- Audit Server Starts and Stops_x000A_-- Occurs when the SQL Server service state is modified._x000A__x000A_EXEC SP_TRACE_SETEVENT @TraceID, 18, 6,  @on -- NTUserName_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 18, 7,  @on -- NTDomainName_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 18, 8,  @on -- HostName_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 18, 10, @on -- ApplicationName_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 18, 11, @on -- LoginName_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 18, 12, @on -- SPID_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 18, 14, @on -- StartTime_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 18, 23, @on -- Success_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 18, 26, @on -- ServerName_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 18, 41, @on -- LoginSid_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 18, 60, @on -- IsSystem_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 18, 64, @on -- SessionLoginName_x000A__x000A_-- Audit Login Failed_x000A_-- Indicates that a login attempt to SQL Server from a client failed._x000A__x000A_EXEC SP_TRACE_SETEVENT @TraceID, 20, 1,  @on -- TextData_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 20, 6,  @on -- NTUserName_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 20, 7,  @on -- NTDomainName_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 20, 8,  @on -- HostName_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 20, 10, @on -- ApplicationName_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 20, 11, @on -- LoginName_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 20, 12, @on -- SPID_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 20, 14, @on -- StartTime_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 20, 23, @on -- Success_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 20, 26, @on -- ServerName_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 20, 31, @on -- Error_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 20, 35, @on -- DatabaseName_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 20, 60, @on -- IsSystem_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 20, 64, @on -- SessionLoginName_x000A__x000A__x000A_-- Audit Statement GDR Event_x000A_-- Occurs every time a GRANT, DENY, REVOKE for a statement_x000A_--  permission is issued by any user in SQL Server._x000A__x000A_EXEC SP_TRACE_SETEVENT @TraceID, 102, 1,  @on -- TextData_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 102, 6,  @on -- NTUserName_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 102, 7,  @on -- NTDomainName_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 102, 8,  @on -- HostName_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 102, 10, @on -- ApplicationName_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 102, 11, @on -- LoginName_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 102, 12, @on -- SPID_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 102, 14, @on -- StartTime_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 102, 19, @on -- StartTime_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 102, 23, @on -- Success_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 102, 26, @on -- ServerName_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 102, 28, @on -- ObjectType_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 102, 34, @on -- ObjectName_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 102, 35, @on -- DatabaseName_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 102, 37, @on -- OwnerName_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 102, 39, @on -- TargetUserName_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 102, 40, @on -- DBUserName_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 102, 41, @on -- LoginSid_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 102, 42, @on -- TargetLoginName_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 102, 43, @on -- TargetLoginSid_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 102, 60, @on -- IsSystem_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 102, 64, @on -- SessionLoginName_x000A__x000A_-- Audit Object GDR Event_x000A_-- Occurs every time a GRANT, DENY, REVOKE for an object_x000A_--  permission is issued by any user in SQL Server._x000A__x000A_EXEC SP_TRACE_SETEVENT @TraceID, 103, 1,  @on -- TextData_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 103, 6,  @on -- NTUserName_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 103, 7,  @on -- NTDomainName_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 103, 8,  @on -- HostName_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 103, 10, @on -- ApplicationName_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 103, 11, @on -- LoginName_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 103, 12, @on -- SPID_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 103, 14, @on -- StartTime_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 103, 19, @on -- StartTime_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 103, 23, @on -- Success_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 103, 26, @on -- ServerName_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 103, 28, @on -- ObjectType_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 103, 34, @on -- ObjectName_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 103, 35, @on -- DatabaseName_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 103, 37, @on -- OwnerName_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 103, 39, @on -- TargetUserName_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 103, 40, @on -- DBUserName_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 103, 41, @on -- LoginSid_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 103, 42, @on -- TargetLoginName_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 103, 43, @on -- TargetLoginSid_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 103, 44, @on -- ColumnPermissions_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 103, 59, @on -- ParentName_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 103, 60, @on -- IsSystem_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 103, 64, @on -- SessionLoginName_x000A__x000A_-- Audit AddLogin Event_x000A_-- Occurs when a SQL Server login is added or removed;_x000A_--  for sp_addlogin and sp_droplogin._x000A__x000A_EXEC SP_TRACE_SETEVENT @TraceID, 104, 6,  @on -- NTUserName_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 104, 7,  @on -- NTDomainName_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 104, 8,  @on -- HostName_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 104, 10, @on -- ApplicationName_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 104, 11, @on -- LoginName_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 104, 12, @on -- SPID_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 104, 14, @on -- StartTime_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 104, 23, @on -- Success_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 104, 26, @on -- ServerName_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 104, 35, @on -- DatabaseName_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 104, 41, @on -- LoginSid_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 104, 42, @on -- TargetLoginName_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 104, 43, @on -- TargetLoginSid_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 104, 60, @on -- IsSystem_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 104, 64, @on -- SessionLoginName_x000A__x000A_-- Audit Login GDR Event_x000A_-- Occurs when a Windows login right is added or removed;_x000A_--  for sp_grantlogin, sp_revokelogin, and sp_denylogin._x000A__x000A_EXEC SP_TRACE_SETEVENT @TraceID, 105, 6,  @on -- NTUserName_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 105, 7,  @on -- NTDomainName_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 105, 8,  @on -- HostName_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 105, 10, @on -- ApplicationName_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 105, 11, @on -- LoginName_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 105, 12, @on -- SPID_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 105, 14, @on -- StartTime_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 105, 23, @on -- Success_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 105, 26, @on -- ServerName_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 105, 35, @on -- DatabaseName_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 105, 41, @on -- LoginSid_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 105, 42, @on -- TargetLoginName_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 105, 43, @on -- TargetLoginSid_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 105, 60, @on -- IsSystem_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 105, 64, @on -- SessionLoginName_x000A__x000A_-- Audit Login Change Property Event_x000A_-- Occurs when a property of a login, except passwords,_x000A_--  is modified; for sp_defaultdb and sp_defaultlanguage._x000A__x000A_EXEC SP_TRACE_SETEVENT @TraceID, 106, 1,  @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 106, 6,  @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 106, 7,  @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 106, 8,  @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 106, 10, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 106, 11, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 106, 12, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 106, 14, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 106, 23, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 106, 26, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 106, 28, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 106, 34, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 106, 35, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 106, 37, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 106, 41, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 106, 42, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 106, 43, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 106, 60, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 106, 64, @on_x000A__x000A_-- Audit Login Change Password Event_x000A_-- Occurs when a SQL Server login password is changed._x000A_--  Passwords are not recorded._x000A__x000A_EXEC SP_TRACE_SETEVENT @TraceID, 107, 1,  @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 107, 6,  @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 107, 7,  @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 107, 8,  @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 107, 10, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 107, 11, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 107, 12, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 107, 14, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 107, 23, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 107, 26, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 107, 28, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 107, 34, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 107, 35, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 107, 37, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 107, 41, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 107, 42, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 107, 43, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 107, 60, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 107, 64, @on_x000A__x000A_-- Audit Add Login to Server Role Event_x000A_-- Occurs when a login is added or removed from a fixed server role;_x000A_--  for sp_addsrvrolemember, and sp_dropsrvrolemember._x000A__x000A_EXEC SP_TRACE_SETEVENT @TraceID, 108, 1,  @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 108, 6,  @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 108, 7,  @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 108, 8,  @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 108, 10, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 108, 11, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 108, 12, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 108, 14, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 108, 23, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 108, 26, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 108, 28, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 108, 34, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 108, 35, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 108, 37, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 108, 38, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 108, 40, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 108, 41, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 108, 42, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 108, 43, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 108, 60, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 108, 64, @on_x000A__x000A_-- Audit Add DB User Event_x000A_-- Occurs when a login is added or removed as a database user_x000A_--  (Windows or SQL Server) to a database; for sp_grantdbaccess,_x000A_--  sp_revokedbaccess, sp_adduser, and sp_dropuser._x000A__x000A_EXEC SP_TRACE_SETEVENT @TraceID, 109, 6,  @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 109, 7,  @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 109, 8,  @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 109, 10, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 109, 11, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 109, 12, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 109, 14, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 109, 21, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 109, 23, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 109, 26, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 109, 35, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 109, 37, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 109, 38, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 109, 39, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 109, 40, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 109, 41, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 109, 42, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 109, 43, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 109, 44, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 109, 51, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 109, 60, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 109, 64, @on_x000A__x000A_-- Audit Add Member to DB Role Event_x000A_-- Occurs when a login is added or removed as a database user_x000A_--  (fixed or user-defined) to a database; for sp_addrolemember,_x000A_--  sp_droprolemember, and sp_changegroup._x000A__x000A_EXEC SP_TRACE_SETEVENT @TraceID, 110, 1,  @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 110, 6,  @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 110, 7,  @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 110, 8,  @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 110, 10, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 110, 11, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 110, 12, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 110, 14, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 110, 23, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 110, 26, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 110, 28, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 110, 34, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 110, 35, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 110, 37, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 110, 38, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 110, 39, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 110, 40, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 110, 41, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 110, 60, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 110, 64, @on_x000A__x000A_-- Audit Add Role Event_x000A_-- Occurs when a login is added or removed as a database user to a_x000A_--  database; for sp_addrole and sp_droprole._x000A__x000A_EXEC SP_TRACE_SETEVENT @TraceID, 111, 6,  @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 111, 7,  @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 111, 8,  @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 111, 10, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 111, 11, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 111, 12, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 111, 14, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 111, 23, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 111, 26, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 111, 35, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 111, 38, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 111, 40, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 111, 41, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 111, 60, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 111, 64, @on_x000A__x000A_-- Audit App Role Change Password Event_x000A_-- Occurs when a password of an application role is changed._x000A__x000A_EXEC SP_TRACE_SETEVENT @TraceID, 112, 1,  @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 112, 6,  @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 112, 7,  @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 112, 8,  @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 112, 10, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 112, 11, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 112, 12, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 112, 14, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 112, 23, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 112, 26, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 112, 28, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 112, 34, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 112, 35, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 112, 37, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 112, 38, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 112, 40, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 112, 41, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 112, 60, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 112, 64, @on_x000A__x000A_-- Audit Statement Permission Event_x000A_-- Occurs when a statement permission (such as CREATE TABLE) is used._x000A__x000A_EXEC SP_TRACE_SETEVENT @TraceID, 113, 1,  @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 113, 6,  @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 113, 7,  @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 113, 8,  @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 113, 10, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 113, 11, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 113, 12, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 113, 14, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 113, 19, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 113, 23, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 113, 26, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 113, 35, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 113, 40, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 113, 41, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 113, 60, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 113, 64, @on_x000A__x000A_-- Audit Backup/Restore Event_x000A_-- Occurs when a BACKUP or RESTORE command is issued._x000A__x000A_EXEC SP_TRACE_SETEVENT @TraceID, 115, 1,  @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 115, 6,  @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 115, 7,  @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 115, 8,  @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 115, 10, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 115, 11, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 115, 12, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 115, 14, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 115, 23, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 115, 26, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 115, 35, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 115, 40, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 115, 41, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 115, 60, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 115, 64, @on_x000A__x000A_-- Audit DBCC Event_x000A_-- Occurs when DBCC commands are issued._x000A__x000A_EXEC SP_TRACE_SETEVENT @TraceID, 116, 1,  @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 116, 6,  @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 116, 7,  @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 116, 8,  @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 116, 10, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 116, 11, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 116, 12, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 116, 14, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 116, 23, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 116, 26, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 116, 35, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 116, 37, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 116, 40, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 116, 41, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 116, 44, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 116, 60, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 116, 64, @on_x000A__x000A_-- Audit Change Audit Event_x000A_-- Occurs when audit trace modifications are made._x000A__x000A_EXEC SP_TRACE_SETEVENT @TraceID, 117, 1,  @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 117, 6,  @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 117, 7,  @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 117, 8,  @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 117, 10, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 117, 11, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 117, 12, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 117, 14, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 117, 23, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 117, 26, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 117, 35, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 117, 37, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 117, 40, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 117, 41, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 117, 44, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 117, 60, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 117, 64, @on_x000A__x000A_-- Audit Object Derived Permission Event_x000A_-- Occurs when a CREATE, ALTER, and DROP object commands are issued._x000A__x000A_EXEC SP_TRACE_SETEVENT @TraceID, 118, 1,  @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 118, 6,  @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 118, 7,  @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 118, 8,  @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 118, 10, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 118, 11, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 118, 12, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 118, 14, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 118, 23, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 118, 26, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 118, 28, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 118, 34, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 118, 35, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 118, 37, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 118, 40, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 118, 41, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 118, 60, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 118, 64, @on_x000A__x000A_-- Audit Database Management Event_x000A_-- Occurs when a CREATE, ALTER, or DROP statement executes on_x000A_--  database objects, such as schemas._x000A__x000A_EXEC SP_TRACE_SETEVENT @TraceID, 128, 1,  @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 128, 6,  @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 128, 7,  @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 128, 8,  @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 128, 10, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 128, 11, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 128, 12, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 128, 14, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 128, 23, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 128, 26, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 128, 28, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 128, 34, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 128, 35, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 128, 37, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 128, 40, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 128, 41, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 128, 60, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 128, 64, @on_x000A__x000A_-- Audit Database Object Management Event_x000A_-- Occurs when a CREATE, ALTER, or DROP statement executes on_x000A_--  database objects, such as schemas._x000A__x000A_EXEC SP_TRACE_SETEVENT @TraceID, 129, 1,  @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 129, 6,  @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 129, 7,  @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 129, 8,  @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 129, 10, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 129, 11, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 129, 12, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 129, 14, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 129, 23, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 129, 26, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 129, 28, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 129, 34, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 129, 35, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 129, 37, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 129, 40, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 129, 41, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 129, 60, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 129, 64, @on_x000A_ _x000A_-- Audit Database Principal Management Event_x000A_-- Occurs when principals, such as users, are created, altered, or_x000A_--  dropped from a database._x000A__x000A_EXEC SP_TRACE_SETEVENT @TraceID, 130, 1,  @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 130, 6,  @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 130, 7,  @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 130, 8,  @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 130, 10, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 130, 11, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 130, 12, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 130, 14, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 130, 23, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 130, 26, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 130, 28, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 130, 34, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 130, 35, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 130, 37, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 130, 40, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 130, 41, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 130, 60, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 130, 64, @on_x000A_ _x000A_-- Audit Schema Object Management Event_x000A_-- Occurs when server objects are created, altered, or dropped._x000A__x000A_EXEC SP_TRACE_SETEVENT @TraceID, 131, 1,  @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 131, 6,  @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 131, 7,  @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 131, 8,  @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 131, 10, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 131, 11, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 131, 12, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 131, 14, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 131, 23, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 131, 26, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 131, 28, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 131, 34, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 131, 35, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 131, 37, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 131, 40, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 131, 41, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 131, 59, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 131, 60, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 131, 64, @on_x000A_ _x000A_-- Audit Server Principal Impersonation Event_x000A_-- Occurs when there is an impersonation within server scope, such_x000A_--  as EXECUTE AS LOGIN._x000A__x000A_EXEC SP_TRACE_SETEVENT @TraceID, 132, 1,  @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 132, 6,  @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 132, 7,  @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 132, 8,  @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 132, 10, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 132, 11, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 132, 12, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 132, 14, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 132, 23, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 132, 26, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 132, 28, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 132, 34, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 132, 35, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 132, 40, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 132, 41, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 132, 60, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 132, 64, @on_x000A_ _x000A_-- Audit Database Principal Impersonation Event_x000A_-- Occurs when an impersonation occurs within the database scope,_x000A_--  such as EXECUTE AS USER or SETUSER._x000A__x000A_EXEC SP_TRACE_SETEVENT @TraceID, 133, 1,  @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 133, 6,  @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 133, 7,  @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 133, 8,  @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 133, 10, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 133, 11, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 133, 12, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 133, 14, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 133, 23, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 133, 26, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 133, 28, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 133, 34, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 133, 35, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 133, 38, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 133, 40, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 133, 41, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 133, 60, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 133, 64, @on_x000A__x000A_-- Audit Server Object Take Ownership Event_x000A_-- Occurs when the owner is changed for objects in server scope._x000A__x000A_EXEC SP_TRACE_SETEVENT @TraceID, 134, 1,  @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 134, 6,  @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 134, 7,  @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 134, 8,  @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 134, 10, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 134, 11, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 134, 12, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 134, 14, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 134, 23, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 134, 26, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 134, 28, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 134, 34, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 134, 35, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 134, 37, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 134, 39, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 134, 40, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 134, 41, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 134, 42, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 134, 43, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 134, 60, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 134, 64, @on_x000A_ _x000A_-- Audit Database Object Take Ownership Event_x000A_-- Occurs when a change of owner for objects within database scope_x000A_--  occurs._x000A__x000A_EXEC SP_TRACE_SETEVENT @TraceID, 135, 1,  @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 135, 6,  @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 135, 7,  @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 135, 8,  @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 135, 10, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 135, 11, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 135, 12, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 135, 14, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 135, 23, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 135, 26, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 135, 28, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 135, 34, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 135, 35, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 135, 37, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 135, 39, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 135, 40, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 135, 41, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 135, 60, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 135, 64, @on_x000A_ _x000A_-- Audit Change Database Owner_x000A_-- Occurs when ALTER AUTHORIZATION is used to change the owner of a_x000A_--  database and permissions are checked to do that._x000A__x000A_EXEC SP_TRACE_SETEVENT @TraceID, 152, 1,  @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 152, 6,  @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 152, 7,  @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 152, 8,  @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 152, 10, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 152, 11, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 152, 12, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 152, 14, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 152, 23, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 152, 26, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 152, 35, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 152, 39, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 152, 40, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 152, 41, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 152, 42, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 152, 43, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 152, 60, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 152, 64, @on_x000A_ _x000A_-- Audit Schema Object Take Ownership Event_x000A_-- Occurs when ALTER AUTHORIZATION is used to assign an owner to an_x000A_--  object and permissions are checked to do that. _x000A__x000A_EXEC SP_TRACE_SETEVENT @TraceID, 153, 1,  @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 153, 6,  @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 153, 7,  @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 153, 8,  @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 153, 10, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 153, 11, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 153, 12, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 153, 14, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 153, 23, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 153, 26, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 153, 28, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 153, 34, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 153, 35, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 153, 37, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 153, 39, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 153, 40, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 153, 41, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 153, 59, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 153, 60, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 153, 64, @on_x000A_ _x000A_-- Audit Server Scope GDR Event_x000A_-- Indicates that a grant, deny, or revoke event for permissions in_x000A_--  server scope occurred, such as creating a login._x000A__x000A_EXEC SP_TRACE_SETEVENT @TraceID, 170, 1,  @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 170, 6,  @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 170, 7,  @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 170, 8,  @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 170, 10, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 170, 11, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 170, 12, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 170, 14, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 170, 19, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 170, 23, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 170, 26, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 170, 28, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 170, 34, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 170, 35, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 170, 37, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 170, 40, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 170, 41, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 170, 42, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 170, 43, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 170, 60, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 170, 64, @on_x000A_ _x000A_-- Audit Server Object GDR Event_x000A_-- Indicates that a grant, deny, or revoke event for a schema object,_x000A_--  such as a table or function, occurred._x000A__x000A_EXEC SP_TRACE_SETEVENT @TraceID, 171, 1,  @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 171, 6,  @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 171, 7,  @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 171, 8,  @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 171, 10, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 171, 11, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 171, 12, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 171, 14, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 171, 19, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 171, 23, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 171, 26, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 171, 28, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 171, 34, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 171, 35, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 171, 37, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 171, 40, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 171, 41, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 171, 42, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 171, 43, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 171, 60, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 171, 64, @on_x000A_ _x000A_-- Audit Database Object GDR Event_x000A_-- Indicates that a grant, deny, or revoke event for database_x000A_--  objects, such as assemblies and schemas, occurred._x000A__x000A_EXEC SP_TRACE_SETEVENT @TraceID, 172, 1,  @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 172, 6,  @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 172, 7,  @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 172, 8,  @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 172, 10, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 172, 11, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 172, 12, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 172, 14, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 172, 19, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 172, 23, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 172, 26, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 172, 28, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 172, 34, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 172, 35, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 172, 37, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 172, 39, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 172, 40, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 172, 41, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 172, 42, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 172, 43, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 172, 60, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 172, 64, @on_x000A_ _x000A_-- Audit Server Operation Event_x000A_-- Occurs when Security Audit operations such as altering settings,_x000A_--  resources, external access, or authorization are used._x000A__x000A_EXEC SP_TRACE_SETEVENT @TraceID, 173, 1,  @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 173, 6,  @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 173, 7,  @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 173, 8,  @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 173, 10, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 173, 11, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 173, 12, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 173, 14, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 173, 23, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 173, 26, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 173, 28, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 173, 34, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 173, 35, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 173, 37, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 173, 40, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 173, 41, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 173, 60, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 173, 64, @on_x000A_ _x000A_-- Audit Server Alter Trace Event_x000A_-- Occurs when a statement checks for the ALTER TRACE permission._x000A__x000A_EXEC SP_TRACE_SETEVENT @TraceID, 175, 1,  @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 175, 6,  @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 175, 7,  @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 175, 8,  @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 175, 10, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 175, 11, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 175, 12, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 175, 14, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 175, 23, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 175, 26, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 175, 28, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 175, 34, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 175, 35, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 175, 37, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 175, 40, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 175, 41, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 175, 60, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 175, 64, @on_x000A_ _x000A_-- Audit Server Object Management Event_x000A_-- Occurs when server objects are created, altered, or dropped._x000A__x000A_EXEC SP_TRACE_SETEVENT @TraceID, 176, 1,  @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 176, 6,  @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 176, 7,  @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 176, 8,  @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 176, 10, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 176, 11, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 176, 12, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 176, 14, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 176, 23, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 176, 26, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 176, 28, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 176, 34, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 176, 35, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 176, 37, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 176, 40, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 176, 41, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 176, 45, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 176, 46, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 176, 60, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 176, 64, @on_x000A_ _x000A_-- Audit Server Principal Management Event_x000A_-- Occurs when server principals are created, altered, or dropped._x000A__x000A_EXEC SP_TRACE_SETEVENT @TraceID, 177, 1,  @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 177, 6,  @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 177, 7,  @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 177, 8,  @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 177, 10, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 177, 11, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 177, 12, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 177, 14, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 177, 23, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 177, 26, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 177, 28, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 177, 34, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 177, 35, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 177, 37, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 177, 39, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 177, 40, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 177, 41, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 177, 42, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 177, 43, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 177, 45, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 177, 60, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 177, 64, @on_x000A_ _x000A_-- Audit Database Operation Event_x000A_-- Occurs when database operations occur, such as checkpoint or_x000A_--  subscribe query notification._x000A__x000A_EXEC SP_TRACE_SETEVENT @TraceID, 178, 1,  @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 178, 6,  @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 178, 7,  @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 178, 8,  @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 178, 10, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 178, 11, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 178, 12, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 178, 14, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 178, 23, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 178, 26, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 178, 28, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 178, 34, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 178, 35, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 178, 37, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 178, 40, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 178, 41, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 178, 60, @on_x000A_EXEC SP_TRACE_SETEVENT @TraceID, 178, 64, @on_x000A__x000A_-- Set the Filters._x000A_DECLARE @intfilter INT_x000A_DECLARE @bigintfilter bigint_x000A__x000A_-- Set the trace status to start._x000A_EXEC SP_TRACE_SETSTATUS @TraceID, 1_x000A__x000A_-- Display trace ID for future references._x000A_SELECT TraceID = @TraceID_x000A_GOTO Finish_x000A__x000A_Error:_x000A_SELECT ErrorCode = @rc_x000A__x000A_Finish:_x000A_GO_x000A__x000A_EXEC SP_PROCOPTION 'fso_audit', 'startup', 'true'_x000A_GO_x000A__x000A_Note: Replace ['d:\sqlserver\audit\fsoauditlog.log'] with the PATH and file name to your audit file.</S>
      <Nil N="Check" />
    </MS>
  </Obj>
  <Obj RefId="351">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2005</S>
      <S N="VulnID">V-15648</S>
      <S N="RuleID">SV-21459r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">DG0151-SQLServer9</S>
      <S N="Title">Access to the DBMS should be restricted to static, default network ports.</S>
      <S N="Description">Use of static, default ports helps management of enterprise network device security controls. Use of non-default ports makes tracking and protection of published vulnerabilities to services and protocols more difficult to track and block. and may result in the exposure of the database to unintended network segments and users.falseDatabase AdministratorDCPP-1</S>
      <S N="FixText">Use static, default network ports._x000A__x000A_From the SQL Server Management Studio GUI:_x000A__x000A_1. Connect to the Analysis Services instance_x000A_2. Right click on the Analysis Services instance_x000A_3. Select Properties_x000A_4. View the value listed for Port_x000A_5. Set value = 2383 or IAO-approved value_x000A_6. Click OK_x000A_</S>
      <S N="Check">From the SQL Server Management Studio GUI:_x000A__x000A_1. Connect to the Analysis Services instance_x000A_2. Right click on the Analysis Services instance_x000A_3. Select Properties_x000A_4. View the value listed for Port_x000A__x000A_If the value = 0, this is a Finding (Dynamic port assignment in use)._x000A__x000A_If the value = 2383, this is Not a Finding._x000A__x000A_The Port value may also be viewed in the Analysis Services configuration file, msmdsrv.ini under XML tag: _x000A__x000A_[Port]_x000A__x000A_The configuration file may be found in the [install dir] \ MSSQL.[#] \ OLAP \ Config directory._x000A__x000A_If a different port is assigned, verify that the port reassignment requirement is documented and approved in the System Security Plan and AIS Functional Architecture documentation.</S>
    </MS>
  </Obj>
  <Obj RefId="352">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2005</S>
      <S N="VulnID">V-15649</S>
      <S N="RuleID">SV-25382r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">DG0155-SQLServer9</S>
      <S N="Title">The DBMS should have configured all applicable settings to use trusted files, functions, features, or other components during startup, shutdown, aborts, or other unplanned interruptions.</S>
      <S N="Description">The DBMS opens data files and reads configuration files at system startup, system shutdown and during abort recovery efforts. If the DBMS does not verify the trustworthiness of these files, it is vulnerable to malicious alterations of its configuration or unauthorized replacement of data.falseDatabase AdministratorInformation Assurance OfficerDCSS-1, DCSS-2</S>
      <S N="FixText">Configure DBMS system initialization, shutdown and aborts to ensure DBMS system remains in a secure state._x000A__x000A_For applicable DBMS systems as listed in the check, periodically test configuration to ensure DBMS system state integrity._x000A__x000A_Where DBMS system state integrity is not supported by the DBMS vendor, obtain and apply mitigation strategies to bring risk to a DAA-acceptable level.</S>
      <S N="Check">Ask the DBA and/or IAO to demonstrate that the DBMS system initialization, shutdown, and aborts are configured to ensure that the DBMS system remains in a secure state._x000A__x000A_If the DBA and/or IAO has documented proof from the DBMS vendor demonstrating that the DBMS does not support this either natively or programmatically, this check is a Finding, but can be downgraded to a CAT 3 severity._x000A__x000A_If the DBMS does support this either natively or programmatically and the configuration does not meet the requirements listed above, this is a Finding._x000A__x000A_For all MAC 1, all MAC 2 and Classified MAC 3 systems where the DBMS supports the requirements, review documented procedures and evidence of periodic testing to ensure DBMS system state integrity. _x000A__x000A_If documented procedures do not exist or no evidence of implementation is provided, this is a Finding.</S>
    </MS>
  </Obj>
  <Obj RefId="353">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2005</S>
      <S N="VulnID">V-15651</S>
      <S N="RuleID">SV-25387r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">DG0157-SQLServer9</S>
      <S N="Title">Remote DBMS administration is not authorized and is not disabled.</S>
      <S N="Description">Remote administration may expose configuration and sensitive data to unauthorized viewing during transit across the network or allow unauthorized administrative access to the DBMS to remote users.falseDatabase AdministratorEBRP-1</S>
      <S N="FixText">Where remote admin connection access is part of the designed and approved use of the SQL Server database, document the requirement in the System Security Plan. Where remote admin connection access is not required, disable its use._x000A__x000A_From the query prompt:_x000A__x000A_EXEC SP_CONFIGURE 'remote admin connections', 0_x000A_RECONFIGURE_x000A_</S>
      <S N="Check">From the query prompt:_x000A__x000A_SELECT CAST(value AS INT) 'Config_Value'_x000A_FROM [master].sys.configurations_x000A_WHERE name = 'remote admin connections'_x000A__x000A_If the value of Config_Value is 0, this is Not a Finding._x000A__x000A_If the value of Config_Value is 1, confirm in the System Security Plan that remote admin connection access is required and approved by the IAO. If it is not documented, required and approved, this is a Finding.</S>
    </MS>
  </Obj>
  <Obj RefId="354">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2005</S>
      <S N="VulnID">V-15652</S>
      <S N="RuleID">SV-25389r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">DG0158-SQLServer9</S>
      <S N="Title">DBMS remote administration should be audited.</S>
      <S N="Description">When remote administration is available, the vulnerability to attack for administrative access is increased. An audit of remote administrative access provides additional means to discover suspicious activity and to provide accountability for administrative actions completed by remote users.falseDatabase AdministratorEBRP-1</S>
      <S N="FixText">Develop, document and implement policy and procedures for remote administration auditing. _x000A__x000A_Configure the DBMS to provide an audit trail for remote administrative sessions. Include all actions taken by database administrators during remote sessions. _x000A__x000A_Actions should be tied to a specific user.</S>
      <S N="Check">If the DBMS does not provide auditing of remote administrative actions, this check is Not a Finding._x000A__x000A_Review settings for actions taken during remote administration sessions._x000A__x000A_If auditing of remote administration sessions and actions is not enabled, this is a Finding._x000A__x000A_If audit logs do not include all actions taken by database administrators during remote sessions, this is a Finding._x000A__x000A_Actions should be tied to a specific user.</S>
    </MS>
  </Obj>
  <Obj RefId="355">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2005</S>
      <S N="VulnID">V-15656</S>
      <S N="RuleID">SV-25398r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">DG0171-SQLServer9</S>
      <S N="Title">The DBMS should not have a connection defined to access or be accessed by a DBMS at a different classification level.</S>
      <S N="Description">Applications that access databases and databases connecting to remote databases that differ in their assigned classification levels may expose sensitive data to unauthorized clients. Any interconnections between databases or applications and databases differing in classification levels are required to comply with interface control rules.falseDatabase AdministratorECIC-1</S>
      <S N="FixText">Disassociate or remove connection definitions to remote systems of differing classification levels.</S>
      <S N="Check">Review database links or other connections defined for the database (See Check DG0075 for list)._x000A__x000A_If any interconnections show differences in the DBMS and remote system classification levels, this is a Finding.</S>
    </MS>
  </Obj>
  <Obj RefId="356">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2005</S>
      <S N="VulnID">V-15658</S>
      <S N="RuleID">SV-25405r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">DG0179-SQLServer9</S>
      <S N="Title">The DBMS warning banner does not meet DoD policy requirements.</S>
      <S N="Description">Without sufficient warning of monitoring and access restrictions of a system, legal prosecution to assign responsibility for unauthorized or malicious access may not succeed. A warning message provides legal support for such prosecution. Access to the DBMS or the applications used to access the DBMS require this warning to help assign responsibility for database activities.falseA warning banner displayed as a function of an Operating System or application login for applications that use the database makes this check Not Applicable.Database AdministratorECWM-1</S>
      <S N="FixText">Replace the DBMS banner text with the banner text as shown in this check._x000A__x000A_For all versions of SQL Server, this requirement can be fulfilled where the database user receives the warning message when authenticating or connecting to a front-end system that includes or covers the SQL Server DBMS. Mark this check as a Finding if the display of a warning banner (not necessarily this specific warning banner) cannot be confirmed._x000A__x000A_The banner text listed in the Check section supersedes that referenced in the Database STIG requirement.</S>
      <S N="Check">A warning banner displayed as a function of an Operating System or application login for applications that use the database makes this check Not Applicable._x000A__x000A_View the warning banner. If it does not contain the following text as written below, this is a Finding:_x000A__x000A_[A. Use this banner for desktops, laptops, and other devices accommodating banners of 1300 characters. The banner shall be implemented as a click-through banner at logon (to the extent permitted by the operating system), meaning it prevents further activity on the information system unless and until the user executes a positive action to manifest agreement by clicking on a box indicating "OK."]_x000A__x000A_You are accessing a U.S. Government (USG) Information System (IS) that is provided for USG-authorized use only. By using this IS (which includes any device attached to this IS), you consent to the following conditions:_x000A__x000A_-The USG routinely intercepts and monitors communications on this IS for purposes including, but not limited to, penetration testing, COMSEC monitoring, network operations and defense, personnel misconduct (PM), law enforcement (LE), and counterintelligence (CI) investigations._x000A__x000A_-At any time, the USG may inspect and seize data stored on this IS. _x000A__x000A_-Communications using, or data stored on, this IS are not private, are subject to routine monitoring, interception, and search, and may be disclosed or used for any USG authorized purpose._x000A__x000A_-This IS includes security measures (e.g., authentication and access controls) to protect USG interests--not for your personal benefit or privacy._x000A__x000A_-Notwithstanding the above, using this IS does not constitute consent to PM, LE or CI investigative searching or monitoring of the content of privileged communications, or work product, related to personal representation or services by attorneys, psychotherapists, or clergy, and their assistants. Such communications and work product are private and confidential. See User Agreement for details._x000A_                                            OK_x000A__x000A_[B. For Blackberries and other PDAs/PEDs with severe character limitations:]_x000A__x000A_I've read &amp; consent to terms in IS user agreem't._x000A__x000A_This User Agreement conforms to DoD Standard Notice and Consent Banner and User Agreement â€“ JTF-GNO CTO 08-008A, May 9, 2008.</S>
    </MS>
  </Obj>
  <Obj RefId="357">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2005</S>
      <S N="VulnID">V-15662</S>
      <S N="RuleID">SV-25415r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">DG0198-SQLServer9</S>
      <S N="Title">Remote administration of the DBMS should be restricted to known, dedicated and encrypted network addresses and ports.</S>
      <S N="Description">Remote administration provides many conveniences that can assist in the maintenance of the designed security posture of the DBMS. On the other hand, remote administration of the database also provides malicious users the ability to access from the network a highly privileged function. Remote administration needs to be carefully considered and used only when sufficient protections against its abuse can be applied. Encryption and dedication of ports to access remote administration functions can help prevent unauthorized access to it.falseDatabase AdministratorEBRP-1</S>
      <S N="FixText">Disable remote administration where it is not required or authorized. Consider restricting administrative access to local connections only. Where necessary, configure the DBMS network communications to provide an encrypted, dedicated port for remote administration access._x000A__x000A_Develop and provide procedures for remote administrative access to DBAs that have been authorized for remote administration. Verify during audit reviews that DBAs do not access the database remotely except through the dedicated and encrypted port.</S>
      <S N="Check">If remote administration is disabled or not configured, this check is Not a Finding._x000A__x000A_Review configured network access interfaces for remote DBMS administration with the SA and DBA._x000A__x000A_These may be host-based encryptions such as IPSec or may be configured for the DBMS as part of the network communications and/or in the DBMS listening process._x000A__x000A_For DBMS listeners, verify that encrypted ports exist and are restricted to specific network addresses to access the DBMS._x000A__x000A_View the System Security Plan to review the authorized procedures and access for remote administration._x000A__x000A_If the configuration does not match the documented plan, this is a Finding.</S>
    </MS>
  </Obj>
  <Obj RefId="358">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Database</S>
      <S N="SqlVersion">2012</S>
      <S N="VulnID">V-40911</S>
      <S N="RuleID">SV-53265r4_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL2-00-021300</S>
      <S N="Title">SQL Server must protect data at rest and ensure confidentiality and integrity of data.</S>
      <S N="Description">This control is intended to address the confidentiality and integrity of information at rest in non-mobile devices and covers user information and system information.  Information at rest refers to the state of information when it is located on a secondary storage device (e.g., disk drive, tape drive) within an organizational information system. Applications and application users generate information throughout the course of their application use._x000A__x000A_User-generated data, as well as, application-specific configuration data, needs to be protected. Configurations and/or rule sets for firewalls, gateways, intrusion detection/prevention systems, filtering routers, and authenticator content are examples of system information likely requiring protection. Organizations may choose to employ different mechanisms to achieve confidentiality and integrity protections, as appropriate._x000A__x000A_If the confidentiality and integrity of SQL Server data is not protected, the data will be open to compromise and unauthorized modification._x000A__x000A_Protective measures include encryption, physical security of the facility where the storage devices reside, operating system file permissions, and organizational controls.  Each of these should be applied as necessary and appropriate.</S>
      <S N="FixText">Apply appropriate controls to protect the confidentiality and integrity of data on a secondary device. _x000A__x000A_Where encryption is required, this can be done by full-disk encryption or by database encryption. To enable database encryption, create a master key, create a database encryption key, and protect it by using mechanisms tied to the master key, and then set encryption on._x000A__x000A_Implement physical security measures, operating system access control lists and organizational controls appropriate to the sensitivity level of the data in the database(s).</S>
      <S N="Check">If the application owner and Authorizing Official have determined that encryption of data at rest is required, _x000A_ensure the data on secondary devices is encrypted. If full-disk encryption is being used, this is not a finding._x000A__x000A_If DBMS data encryption is required, ensure the data is encrypted before being put on the secondary device by executing:_x000A__x000A_SELECT _x000A__x0009_d.name AS [Database Name],_x000A__x0009_CASE e.encryption_state _x000A__x0009__x0009_WHEN 0 THEN 'No database encryption key present, no encryption' _x000A__x0009__x0009_WHEN 1 THEN 'Unencrypted' _x000A__x0009__x0009_WHEN 2 THEN 'Encryption in progress' _x000A__x0009__x0009_WHEN 3 THEN 'Encrypted' _x000A__x0009__x0009_WHEN 4 THEN 'Key change in progress' _x000A__x0009__x0009_WHEN 5 THEN 'Decryption in progress' _x000A__x0009__x0009_WHEN 6 THEN 'Protection change in progress' _x000A__x0009_END AS [Encryption State]_x000A_FROM sys.dm_database_encryption_keys e _x000A_RIGHT JOIN sys.databases d ON DB_NAME(e.database_id) = d.name _x000A_WHERE d.name NOT IN ('master','model','msdb')_x000A_ORDER BY 1_x000A_;_x000A__x000A_For each user database where encryption is required, verify that encryption is in effect. If not, this is a finding._x000A__x000A_Verify that there are physical security measures, operating system access control lists and organizational controls appropriate to the sensitivity level of the data in the database(s).  If not, this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="359">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Database</S>
      <S N="SqlVersion">2012</S>
      <S N="VulnID">V-41389</S>
      <S N="RuleID">SV-53912r3_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL2-00-000300</S>
      <S N="Title">SQL Server must maintain and support organization-defined security labels on stored information.</S>
      <S N="Description">Security attributes are abstractions representing the basic properties or characteristics of an entity (e.g., subjects and objects) with respect to safeguarding information._x000A__x000A_These attributes are typically associated with internal data structures (e.g., records, buffers, files) within the information system and are used to enable the implementation of access control and flow control policies; reflect special dissemination, handling, or distribution instructions; or support other aspects of the information security policy._x000A__x000A_One example includes marking data as classified or FOUO. These security attributes may be assigned manually or during data processing but, either way, it is imperative these assignments are maintained while the data is in storage. If the security attributes are lost when the data is stored, there is the risk of a data compromise._x000A__x000A_The sensitivity marking or labeling of stored data items promotes the correct handling and protection of data.  Without such notification, the user may unwittingly disclose sensitive data to unauthorized users.</S>
      <S N="FixText">Develop SQL code or acquire a third party tool to perform data labeling. SQL Server Label Security Toolkit can be downloaded from http://www.codeplex.com. This tool can satisfy all data labeling and security data labeling requirements.</S>
      <S N="Check">Review system documentation to determine if the labeling of sensitive data is required under organization-defined guidelines._x000A_If the labeling of sensitive data is not required, this is NA._x000A__x000A_Obtain system configuration settings to determine how data labeling is being performed. This can be through triggers or some other SQL-developed means or via a third-party tool. Spot check data and ensure the appropriate labels have been applied to stored data.   _x000A__x000A_If the labeling of sensitive data is required and is not being performed, this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="360">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Database</S>
      <S N="SqlVersion">2012</S>
      <S N="VulnID">V-41391</S>
      <S N="RuleID">SV-53914r3_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL2-00-000400</S>
      <S N="Title">SQL Server must maintain and support organization-defined security labels on information in process.</S>
      <S N="Description">Security attributes are abstractions representing the basic properties or characteristics of an entity (e.g., subjects and objects) with respect to safeguarding information._x000A__x000A_These attributes are typically associated with internal data structures (e.g., records, buffers, files) within the application and are used to enable the implementation of access control and flow control policies; reflect special dissemination, handling, or distribution instructions; or support other aspects of the information security policy._x000A__x000A_Organizations define the security attributes of their data (e.g., classified, FOUO). Applications generating and/or processing data assigned these organization-defined security attributes must maintain the binding of these attributes to the data when the data is transmitted._x000A__x000A_If the application does not maintain the data security attributes when it transmits the data, there is a risk of data compromise._x000A__x000A_The sensitivity marking or labeling of data items promotes the correct handling and protection of data. Without such notification, the user may unwittingly disclose sensitive data to unauthorized users. Security labels must be correctly maintained throughout transmission.</S>
      <S N="FixText">Develop SQL code or acquire a third party tool to perform data labeling. SQL Server Label Security Toolkit can be downloaded from http://www.codeplex.com. This tool can satisfy all data labeling and security data labeling requirements.</S>
      <S N="Check">Review system documentation to determine if the labeling of sensitive data is required under organization-defined guidelines._x000A__x000A_If the labeling of sensitive data is not required, this is NA._x000A__x000A_Obtain system configuration settings to determine how data labeling is being performed. This can be through triggers or some other SQL-developed means or via a third-party tool.  _x000A__x000A_If the labeling of sensitive information in process is not being performed, this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="361">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Database</S>
      <S N="SqlVersion">2012</S>
      <S N="VulnID">V-41392</S>
      <S N="RuleID">SV-53916r3_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL2-00-000500</S>
      <S N="Title">SQL Server must maintain and support organization-defined security labels on data in transmission.</S>
      <S N="Description">Security attributes are abstractions representing the basic properties or characteristics of an entity (e.g., subjects and objects) with respect to safeguarding information._x000A__x000A_These attributes are typically associated with internal data structures (e.g., records, buffers, files) within the application and are used to enable the implementation of access control and flow control policies; reflect special dissemination, handling, or distribution instructions; or support other aspects of the information security policy._x000A__x000A_Organizations define the security attributes of their data (e.g., classified, FOUO). Applications generating and/or processing data assigned these organization-defined security attributes must maintain the binding of these attributes to the data when the data is transmitted._x000A__x000A_If the application does not maintain the data security attributes when it transmits the data, there is a risk of data compromise._x000A__x000A_The sensitivity marking or labeling of data items promotes the correct handling and protection of data. Without such notification, the user may unwittingly disclose sensitive data to unauthorized users. Security labels must be correctly maintained throughout transmission.</S>
      <S N="FixText">Develop SQL code or acquire a third party tool to perform data labeling. SQL Server Label Security Toolkit can be downloaded from http://www.codeplex.com. This tool can satisfy all data labeling and security data labeling requirements.</S>
      <S N="Check">Review system documentation to determine if the labeling of sensitive data is required under organization-defined guidelines._x000A_If the labeling of sensitive data is not required, this is NA._x000A__x000A_Obtain system configuration settings to determine how data labeling is being performed. This can be through triggers or some other SQL-developed means or via a third-party tool.  _x000A__x000A_If the labeling of sensitive data in transmission is not being performed, this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="362">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Database</S>
      <S N="SqlVersion">2012</S>
      <S N="VulnID">V-41393</S>
      <S N="RuleID">SV-53917r3_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL2-00-000900</S>
      <S N="Title">SQL Server must allow authorized users to associate security labels to information in the database.</S>
      <S N="Description">Security attributes are abstractions representing the basic properties or characteristics of an entity (e.g., subjects and objects) with respect to safeguarding information._x000A__x000A_These attributes are typically associated with internal data structures (e.g., records, buffers, files) within the information system and are used to enable the implementation of access control and flow control policies; reflect special dissemination, handling, or distribution instructions, or support other aspects of the information security policy._x000A__x000A_Examples of application security attributes are classified, FOUO, sensitive, etc._x000A__x000A_Throughout the course of normal usage, authorized users of applications that handle sensitive data will have the need to associate security attributes with information. Applications that maintain the binding of organization-defined security attributes to data must ensure authorized users can associate security attributes with information. For databases, this is accomplished via labeling.</S>
      <S N="FixText">Develop SQL code or acquire a third party tool to perform data labeling. SQL Server Label Security Toolkit can be downloaded from http://www.codeplex.com. This tool can satisfy all data labeling and security data labeling requirements.</S>
      <S N="Check">Review system documentation to determine if the labeling of sensitive data is required under organization-defined guidelines._x000A_If the labeling of sensitive data is not required, this is NA._x000A__x000A_Obtain system configuration setting to determine how data labeling is being performed. This can be through triggers or some other SQL-developed means or via a third-party tool. Determine how authorized users associate security information to data. If authorized users are not able to associate security labels to data, this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="363">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Database</S>
      <S N="SqlVersion">2012</S>
      <S N="VulnID">V-41394</S>
      <S N="RuleID">SV-53918r3_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL2-00-011050</S>
      <S N="Title">SQL Server utilizing Discretionary Access Control (DAC) must enforce a policy that limits propagation of access rights.</S>
      <S N="Description">Discretionary Access Control (DAC) is based on the premise that individual users are "owners" of objects and therefore have discretion over who should be authorized to access the object and in which mode (e.g., read or write). Ownership is usually acquired as a consequence of creating the object or via specified ownership assignment._x000A__x000A_DAC allows the owner to determine who will have access to objects they control. An example of DAC includes user-controlled file permissions. DAC models have the potential for the access controls to propagate without limit, resulting in unauthorized access to said objects._x000A__x000A_When applications provide a discretionary access control mechanism, the application must be able to limit the propagation of those access rights._x000A__x000A_The DBMS must ensure the recipient of object permissions possesses only the access intended. The database must enforce the ability to limit unauthorized rights propagation. If propagation is not prevented, users can continue to grant rights to other users without limit.tru</S>
      <S N="FixText">Document and obtain approval for each GRANT_WITH_GRANT_OPTION that is required._x000A__x000A_Correct each unapproved GRANT_WITH_GRANT_OPTION with REVOKE and GRANT statements of the form (replacing "UPDATE" with the actual permission at issue):_x000A_REVOKE UPDATE ON SampleTable FROM SampleUserOrRole CASCADE;_x000A_GRANT UPDATE ON SampleTable TO SampleRole;  -- Note, no WITH GRANT OPTION clause here.</S>
      <S N="Check">Check for rights propagation assignment to database permissions by running the following query:_x000A__x000A_USE &lt;name of database being reviewed&gt;;_x000A_SELECT * _x000A_FROM sys.database_permissions_x000A_WHERE state_desc = 'GRANT_WITH_GRANT_OPTION';_x000A__x000A_If any of the permissions listed have not been documented and approved as requiring GRANT_WITH_GRANT_OPTION, this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="364">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Database</S>
      <S N="SqlVersion">2012</S>
      <S N="VulnID">V-41395</S>
      <S N="RuleID">SV-53920r4_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL2-00-009200</S>
      <S N="Title">SQL Server must be protected from unauthorized access by developers.</S>
      <S N="Description">Applications employ the concept of least privilege for specific duties and information systems (including specific functions, ports, protocols, and services). The concept of least privilege is also applied to information system processes, ensuring that the processes operate at privilege levels no higher than necessary to accomplish required organizational missions and/or functions. Organizations consider the creation of additional processes, roles, and information system accounts as necessary to achieve least privilege. Organizations also apply least privilege concepts to the design, development, implementation, and operations of information systems._x000A__x000A_Developers granted elevated database and/or operating system privileges on production databases can affect the operation and/or security of the database system. Operating system and database privileges assigned to developers on production systems should not be allowed.</S>
      <S N="FixText">Remove unnecessary developer accounts from SQL Server instances hosting only production databases, by running the following SQL script:_x000A__x000A_USE master_x000A_DROP LOGIN &lt;'account name'&gt;</S>
      <S N="Check">Check the list of SQL Server users against the list of developer accounts by running the following SQL Server query:_x000A__x000A_SELECT name AS 'Account Name'_x000A_     , create_date AS 'Account Create Date'_x000A_     , LOGINPROPERTY(name, 'PasswordLastSetTime') AS 'Password Last Set on'_x000A_FROM sys.server_principals_x000A_WHERE NOT TYPE IN ('C', 'R', 'U') _x000A_AND NOT name IN ('##MS_PolicyEventProcessingLogin##', '##MS_PolicyTsqlExecutionLogin##')_x000A_AND sid &lt;&gt; CONVERT(VARBINARY(85), 0x01) -- no 'sa' account_x000A_AND is_disabled &lt;&gt; 1_x000A_ORDER BY name; _x000A__x000A_For each developer account found on a production machine, verify if the developer account can change or alter database objects or data in the production database. If any developer account can change or alter database objects or data in a production database, this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="365">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Database</S>
      <S N="SqlVersion">2012</S>
      <S N="VulnID">V-41396</S>
      <S N="RuleID">SV-53921r2_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL2-00-009300</S>
      <S N="Title">SQL Server must be protected from unauthorized access by developers on shared production/development host systems.</S>
      <S N="Description">Applications employ the concept of least privilege for specific duties and information systems (including specific functions, ports, protocols, and services). The concept of least privilege is also applied to information system processes, ensuring that the processes operate at privilege levels no higher than necessary to accomplish required organizational missions and/or functions. Organizations consider the creation of additional processes, roles, and information system accounts as necessary to achieve least privilege. Organizations also apply least privilege concepts to the design, development, implementation, and operations of information systems._x000A__x000A_Developers granted elevated database and/or operating system privileges on systems that support both development and production databases can affect the operation and/or security of the production database system. Operating system and database privileges assigned to developers on shared development and production systems must be restricted.</S>
      <S N="FixText">Within the system documentation, clearly identify if SQL Server is hosting both development and production databases._x000A__x000A_Restrict developer privileges to production objects to only objects and data where those privileges are required and authorized by running the following scripts as needed:_x000A__x000A_Remove the user from direct access to server permission by running the following script:_x000A_USE master_x000A_REVOKE &lt;'server permission name'&gt; TO &lt;'account name'&gt; CASCADE_x000A__x000A_Remove the user from user-defined role access by running the following script:_x000A_USE master_x000A_ALTER SERVER ROLE [&lt;'server role name'&gt;] DROP MEMBER &lt;'user name'&gt;_x000A__x000A_Remove permissions from developer user accounts that grant permissions beyond the development database._x000A__x000A_Navigate to SQL Server Management Studio &gt;&gt; Object Explorer &gt;&gt; &lt;'SQL Server name'&gt; &gt;&gt; Security &gt;&gt; Logins &gt;&gt; right click &lt;'administrator account name'&gt; &gt;&gt; Properties &gt;&gt; User &gt;&gt; Securables._x000A__x000A_Remove 'Securables' permissions from accounts that are beyond what is required._x000A__x000A_Navigate from 'Securables' to 'Server Roles'._x000A__x000A_Remove 'Server Roles' permissions from accounts that are beyond what is required._x000A__x000A_Navigate from 'Server Roles' to 'Users mapped to the login'._x000A__x000A_Remove 'Users mapped to the login' permissions from accounts that are beyond what is required.</S>
      <S N="Check">Identify whether SQL Server contains both development and production databases from the system documentation._x000A__x000A_If SQL Server is not hosting both production and development databases, this is NA._x000A__x000A__x000A_If SQL Server is hosting both development and production databases, but this is not clearly documented in the system documentation, this is a finding._x000A_Check the list of SQL Server users against the list of developer accounts by running the following SQL Server query:_x000A__x000A_SELECT name AS 'Account Name'_x000A_     , create_date AS 'Account Create Date'_x000A_     , LOGINPROPERTY(name, 'PasswordLastSetTime') AS 'Password Last Set on'_x000A_  FROM sys.server_principals_x000A_ WHERE NOT TYPE IN ('C', 'R', 'U') -- ('C', 'G', 'K', 'R', 'S', 'U')_x000A_  AND NOT name IN ('##MS_PolicyEventProcessingLogin##', '##MS_PolicyTsqlExecutionLogin##')_x000A_  AND sid &lt;&gt; CONVERT(VARBINARY(85), 0x01) -- no 'sa' account_x000A_  AND is_disabled &lt;&gt; 1_x000A_ ORDER BY name_x000A__x000A__x000A_If no developer user account is listed, this is not a finding._x000A__x000A_Check each developer user account privilege listed above._x000A__x000A_Navigate to SQL Server Management Studio &gt;&gt; Object Explorer &gt;&gt; &lt;'SQL Server name'&gt; &gt;&gt; Security &gt;&gt; Logins &gt;&gt; right click &lt;'developer account name'&gt; &gt;&gt; Properties &gt;&gt; User &gt;&gt; Securables._x000A__x000A_If any item in the 'Permission' listing, for each highlighted item that exists in the 'Securables' listing, grants production privileges, this is a finding._x000A__x000A_Navigate from 'Securables' to 'Server Roles'._x000A__x000A_If any 'Server roles' are checked that grant production privileges, this is a finding._x000A__x000A_Navigate from 'Server Roles' to 'Users mapped to the login'._x000A__x000A_If any checked 'Database role membership' of each highlighted and checked 'Database' are determined to be granting production privileges, this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="366">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Database</S>
      <S N="SqlVersion">2012</S>
      <S N="VulnID">V-41397</S>
      <S N="RuleID">SV-53922r5_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL2-00-009500</S>
      <S N="Title">Administrative privileges, built-in server roles and built-in database roles must be assigned to the DBMS login accounts that require them via custom roles, and not directly.</S>
      <S N="Description">SQL Server must employ the concept of least privilege for specific duties and information systems (including specific functions, ports, protocols, and services). The concept of least privilege is also applied to information system processes, ensuring that the processes operate at privilege levels no higher than necessary to accomplish required organizational missions and/or functions. Organizations consider the creation of additional processes, roles, and information system accounts as necessary to achieve least privilege. Organizations also apply least privilege concepts to the design, development, implementation, and operations of information systems._x000A__x000A_Privileges granted outside the role of the application user job function are more likely to go unmanaged or without oversight for authorization. Maintenance of privileges using roles defined for discrete job functions offers improved oversight of application user privilege assignments and helps to protect against unauthorized privilege assignment._x000A__x000A_SQL Server built-in administrative privileges, built-in server roles and built-in database roles must not be assigned directly to administrative user accounts (that is, server logins and database users). If administrative user accounts have direct access to administrative roles, this access must be removed, with the exception of administrative roles that the DBMS assigns to the special database principal [dbo], and will not allow to be altered._x000A__x000A_The built-in server role "sysadmin" is a partial exception. This cannot be granted to a user-defined role, only to a login account. Most (not necessarily all) database administrators will need to be members of sysadmin. Without this, most DBCC commands and the system stored procedures/functions listed below are unavailable. The users who require such access must be documented and approved.tru</S>
      <S N="FixText">Navigate to SQL Server Management Studio &gt;&gt; Object Explorer &gt;&gt; &lt;'SQL Server name'&gt; &gt;&gt; Security &gt;&gt; Logins &gt;&gt; right click &lt;'administrator account name'&gt; &gt;&gt; Properties &gt;&gt; User Mapping &gt;&gt; &lt;'highlight the database'&gt; &gt;&gt; review 'Database role membership' each database._x000A__x000A_Remove 'Database role membership' by clicking the appropriate check box._x000A__x000A_Navigate to SQL Server Management Studio &gt;&gt; Object Explorer &gt;&gt; &lt;'SQL Server name'&gt; &gt;&gt; Security &gt;&gt; Logins &gt;&gt; right click &lt;'administrator account name'&gt; &gt;&gt; Properties &gt;&gt; Server Roles._x000A__x000A_Remove 'Server roles' by clicking the appropriate check box._x000A__x000A_The special database principal [dbo] is an exception.  It is mapped to the server login that is the database owner.  Some roles cannot be mapped to it or unmapped from it._x000A__x000A_The built-in server role "sysadmin" is a partial exception.  See the Vulnerability Discussion.</S>
      <S N="Check">Check administrative accounts for direct database role membership:_x000A__x000A_Navigate to SQL Server Management Studio &gt;&gt; Object Explorer &gt;&gt; &lt;'SQL Server name'&gt; &gt;&gt; Security &gt;&gt; Logins &gt;&gt; right click &lt;'administrator account name'&gt; &gt;&gt; Properties &gt;&gt; User Mapping &gt;&gt; &lt;'highlight database'&gt; &gt;&gt; review 'Database role membership' for each database._x000A__x000A_If any administration accounts have a direct privilege to any 'Database role membership' that is part of the SQL Server system, this is a finding._x000A__x000A_Check administrative accounts for direct server role membership:_x000A__x000A_Navigate to SQL Server Management Studio &gt;&gt; Object Explorer &gt;&gt; &lt;'SQL Server name'&gt; &gt;&gt; Security &gt;&gt; Logins &gt;&gt; right click &lt;'administrator account name'&gt; &gt;&gt; Properties &gt;&gt; Server Roles._x000A__x000A_If any administration accounts have direct access to any 'Server roles' privilege that is part of the SQL Server system, this is a finding._x000A__x000A_The special database principal [dbo] is an exception.  It is mapped to the server login that is the database owner.  Some roles cannot be mapped to it or unmapped from it.  These role assignments are not a finding._x000A__x000A_The built-in server role "sysadmin" is a partial exception.  See the Vulnerability Discussion.</S>
    </MS>
  </Obj>
  <Obj RefId="367">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Database</S>
      <S N="SqlVersion">2012</S>
      <S N="VulnID">V-41399</S>
      <S N="RuleID">SV-53925r2_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL2-00-023500</S>
      <S N="Title">SQL Server job/batch queues must be reviewed regularly to detect unauthorized SQL Server job submissions.</S>
      <S N="Description">When dealing with unauthorized SQL Server job submissions, it should be noted any unauthorized job submissions to SQL Server job/batch queues can potentially have significant effects on the overall security of the system._x000A__x000A_If SQL Server were to allow any user to make SQL Server job/batch queue submissions, then those submissions might lead to a compromise of system integrity and/or data. This requirement is contingent upon the SQL Server job/batch queue being review regularly for unauthorized submissions._x000A__x000A_Accordingly, only qualified and authorized individuals shall be allowed to obtain access to submit SQL Server jobs. Job/batch queue submissions must adhere to an organization-defined job submission process. _x000A__x000A_Unmanaged changes that occur to SQL Server job/batch queues can lead to a compromised system.</S>
      <S N="FixText">Document procedures, within the system documentation, that detect for unauthorized SQL Server job submissions._x000A__x000A_Develop and implement procedures to detect for unauthorized SQL Server job submissions of Stored Procedures that are automatically executed and Agent jobs that are enabled.</S>
      <S N="Check">Check system documentation for procedures that are regularly implemented in an effort to detect unauthorized SQL Server job submissions._x000A__x000A_If procedures that are regularly implemented are not documented in the system documentation, this is a finding._x000A__x000A_If the procedures are not implemented regularly or do not detect for unauthorized SQL Server job submissions, this is a finding._x000A__x000A_Review Stored Procedures that are able to automatically execute jobs scheduled to start automatically at system startup by running the following query:_x000A_SELECT name_x000A_  FROM master.sys.procedures_x000A_ WHERE is_auto_executed = 1_x000A__x000A_If any Stored Procedures listed are not documented as authorized, this is a finding.  _x000A__x000A_Review the SQL Server job history by running the following query:_x000A__x000A_SELECT *   FROM msdb.dbo.sysjobhistory _x000A__x000A__x000A_If any jobs listed are not documented as authorized, this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="368">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Database</S>
      <S N="SqlVersion">2012</S>
      <S N="VulnID">V-41402</S>
      <S N="RuleID">SV-53928r4_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL2-00-011200</S>
      <S N="Title">SQL Server must provide audit record generation capability for organization-defined auditable events within the database.</S>
      <S N="Description">Audit records can be generated from various components within the information system (e.g., network interface, hard disk, modem, etc.). From an application perspective, certain specific application functionalities may be audited as well._x000A__x000A_The list of audited events is the set of events for which audits are to be generated. This set of events is typically a subset of the list of all events for which the system is capable of generating audit records.  Examples are auditable events, time stamps, source and destination addresses, user/process identifiers, event descriptions, success/fail indications, file names involved, and access control or flow control rules invoked._x000A__x000A_Organizations define which application components shall provide auditable events. _x000A__x000A_The DBMS must provide auditing for the list of events defined by the organization or risk negatively impacting forensic investigations into malicious behavior in the information system.</S>
      <S N="FixText">Create a trace that meets all auditing requirements._x000A__x000A_The script provided in the supplemental file, Trace.sql, can be used to do this; edit it as necessary to capture any additional, locally defined events.</S>
      <S N="Check">Check to see that all required events are being audited._x000A_From the query prompt:_x000A_     SELECT DISTINCT traceid FROM sys.fn_trace_getinfo(0);_x000A_All currently defined traces for the SQL server instance will be listed. If no traces are returned, this is a finding._x000A__x000A_Determine the trace(s) being used for the auditing requirement. _x000A_In the following, replace # with a trace ID being used for the auditing requirements._x000A_From the query prompt:_x000A_     SELECT DISTINCT(eventid) FROM sys.fn_trace_geteventinfo(#);_x000A_The following required event IDs should be listed:_x000A_     14, 15, 18, 20, _x000A_     102, 103, 104, 105, 106, 107, 108, 109, 110, _x000A_     111, 112, 113, 115, 116, 117, 118, _x000A_     128, 129, 130, _x000A_     131, 132, 133, 134, 135, _x000A_     152, 153, _x000A_     170, 171, 172, 173, 175, 176, 177, 178._x000A_If any of the audit event IDs required above is not listed, this is a finding._x000A__x000A_Notes:_x000A_1. It is acceptable to have the required event IDs spread across multiple traces, provided all of the traces are always active, and the event IDs are grouped in a logical manner._x000A_2. It is acceptable, from an auditing point of view, to include the same event IDs in multiple traces.  However, the effect of this redundancy on performance, storage, and the consolidation of audit logs into a central repository, should be taken into account._x000A_3. It is acceptable to trace additional event IDs. This is the minimum list._x000A_4. Once this check is satisfied, the DBA may find it useful to disable or modify the default trace that is set up by the SQL Server installation process. (Note that the Fix does NOT include code to do this.)  _x000A_Use the following query to obtain a list of all event IDs, and their meaning:_x000A_     SELECT * FROM sys.trace_events; _x000A_5. Because this check procedure is designed to address multiple requirements/vulnerabilities, it may appear to exceed the needs of some individual requirements.  However, it does represent the aggregate of all such requirements._x000A_6. Microsoft has flagged the trace techniques and tools used in this Check and Fix as deprecated.  They will be removed at some point after SQL Server 2014.  The replacement feature is Extended Events.  If Extended Events are in use, and cover all the required audit events listed above, this is not a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="369">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Database</S>
      <S N="SqlVersion">2012</S>
      <S N="VulnID">V-41403</S>
      <S N="RuleID">SV-53930r4_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL2-00-014900</S>
      <S N="Title">SQL Server must be monitored to discover unauthorized changes to functions.</S>
      <S N="Description">When dealing with change control issues, it should be noted, any changes to the hardware, software, and/or firmware components of SQL Server and/or application can potentially have significant effects on the overall security of the system._x000A__x000A_If SQL Server were to allow any user to make changes to software libraries, then those changes might be implemented without undergoing the appropriate testing and approvals that are part of a robust change management process._x000A__x000A_This requirement is contingent upon the language in which the application is programmed, as many application architectures in use today incorporate their software libraries into, and make them inseparable from, their compiled distributions, rendering them static and version-dependent. However, this requirement does apply to applications with software libraries accessible and configurable, as in the case of interpreted languages._x000A__x000A_Accordingly, only qualified and authorized individuals shall be allowed to obtain access to SQL Server components for purposes of initiating changes, including upgrades and modifications._x000A__x000A_Unmanaged changes that occur to the SQL Server software libraries or configuration, such as Functions, can lead to unauthorized or compromised installations.tru</S>
      <S N="FixText">Configure a SQL Server timed job that automatically checks all system and user-defined Functions for being modified. _x000A__x000A_(The supplemental file Track.sql, provided with this STIG, can be used to establish a monitoring job.  This should be supplemented with a process for informing the appropriate personnel.  Other techniques for achieving the same ends, such as the use of DDL triggers, are acceptable.)</S>
      <S N="Check">Check the SQL Server configuration for a timed job that automatically checks all system and user-defined Functions for being modified by running the following SQL Server query:_x000A_EXEC msdb.dbo.sp_help_job  @job_name = '&lt;enter . . . job name&gt;';_x000A__x000A_(Alternatively, in SQL Server Management Studio, navigate to SQL Server Agent and examine the job from there.)_x000A__x000A_If a timed job or some other method is not implemented to check for Functions being modified, this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="370">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Database</S>
      <S N="SqlVersion">2012</S>
      <S N="VulnID">V-41404</S>
      <S N="RuleID">SV-53931r4_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL2-00-015100</S>
      <S N="Title">SQL Server must be monitored to discover unauthorized changes to triggers.</S>
      <S N="Description">When dealing with change control issues, it should be noted, any changes to the hardware, software, and/or firmware components of SQL Server and/or application can potentially have significant effects on the overall security of the system._x000A__x000A_If SQL Server were to allow any user to make changes to software libraries, then those changes might be implemented without undergoing the appropriate testing and approvals that are part of a robust change management process._x000A__x000A_This requirement is contingent upon the language in which the application is programmed, as many application architectures in use today incorporate their software libraries into, and make them inseparable from, their compiled distributions, rendering them static and version-dependent. However, this requirement does apply to applications with software libraries accessible and configurable, as in the case of interpreted languages._x000A__x000A_Accordingly, only qualified and authorized individuals shall be allowed to obtain access to SQL Server components for purposes of initiating changes, including upgrades and modifications._x000A__x000A_Unmanaged changes that occur to the SQL Server software libraries or configuration, such as Triggers, can lead to unauthorized or compromised installations.</S>
      <S N="FixText">Configure a SQL Server timed job that automatically checks all system and user-defined Triggers for modification._x000A__x000A_(The supplemental file Track.sql, provided with this STIG, can be used to establish a monitoring job.  This should be supplemented with a process for informing the appropriate personnel.  Other techniques for achieving the same ends, such as the use of DDL triggers, are acceptable.)</S>
      <S N="Check">Check the SQL Server configuration for the timed job that automatically checks all system and user-defined Triggers for being modified by running the following SQL Server query:_x000A_EXEC msdb.dbo.sp_help_job  @job_name = '&lt;enter . . . job name&gt;';_x000A__x000A_(Alternatively, in SQL Server Management Studio, navigate to SQL Server Agent and examine the job from there.)_x000A__x000A_If such a job, or an alternative method of monitoring triggers for modification, does not exist, this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="371">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Database</S>
      <S N="SqlVersion">2012</S>
      <S N="VulnID">V-41406</S>
      <S N="RuleID">SV-53933r4_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL2-00-015200</S>
      <S N="Title">SQL Server must be monitored to discover unauthorized changes to stored procedures.</S>
      <S N="Description">When dealing with change control issues, it should be noted, any changes to the hardware, software, and/or firmware components of SQL Server and/or application can potentially have significant effects on the overall security of the system._x000A__x000A_If SQL Server were to allow any user to make changes to software libraries, then those changes might be implemented without undergoing the appropriate testing and approvals that are part of a robust change management process._x000A__x000A_This requirement is contingent upon the language in which the application is programmed, as many application architectures in use today incorporate their software libraries into, and make them inseparable from, their compiled distributions, rendering them static and version-dependent. However, this requirement does apply to applications with software libraries accessible and configurable, as in the case of interpreted languages._x000A__x000A_Accordingly, only qualified and authorized individuals shall be allowed to obtain access to SQL Server components for purposes of initiating changes, including upgrades and modifications._x000A__x000A_Unmanaged changes that occur to the SQL Server software libraries or configuration, such as Stored Procedures, can lead to unauthorized or compromised installations.</S>
      <S N="FixText">Configure a SQL Server timed job that automatically checks all system and user-defined Stored Procedures for modification.  _x000A__x000A_(The supplemental file Track.sql, provided with this STIG, can be used to establish a monitoring job.  This should be supplemented with a process for informing the appropriate personnel.  Other techniques for achieving the same ends, such as the use of DDL triggers, are acceptable.)</S>
      <S N="Check">Check for the existence of a job to monitor for changes to stored procedures:_x000A_EXEC msdb.dbo.sp_help_job  @job_name = '&lt;enter . . . job name&gt;';_x000A__x000A_(Alternatively, in SQL Server Management Studio, navigate to SQL Server Agent and examine the job from there.)_x000A__x000A_If such a job, or an alternative method of monitoring stored procedures for modification, does not exist, this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="372">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Database</S>
      <S N="SqlVersion">2012</S>
      <S N="VulnID">V-41407</S>
      <S N="RuleID">SV-53935r2_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL2-00-015600</S>
      <S N="Title">Database objects must be owned by accounts authorized for ownership.</S>
      <S N="Description">SQL Server database ownership is a higher level privilege that grants full rights to everything in that database, including the right to grant privileges to others. SQL Server requires that the owner of a database object be a user, and only one user can be the assigned owner of a database object. This tends to minimize the risk that multiple users could gain unauthorized access, except the one individual who is the owner._x000A__x000A_Within the database, object ownership implies full privileges to the owned object, including the privilege to assign access to the owned objects to other subjects. Unmanaged or uncontrolled ownership of databases can lead to unauthorized granting of privileges and database alterations.</S>
      <S N="FixText">Add and/or update system documentation to include any accounts authorized for object ownership and remove any account not authorized._x000A__x000A_Reassign database ownership to authorized database owner account:_x000A_Navigate to SQL Server Management Studio &gt;&gt; Object Explorer &gt;&gt; &lt;'SQL Server name'&gt; &gt;&gt; Databases &gt;&gt; right click &lt;'database name'&gt; &gt;&gt; Properties &gt;&gt; Files._x000A_Select new database "Owner":_x000A_Navigate to click on [â€¦] &gt;&gt; Select new Database Owner &gt;&gt; Browseâ€¦ &gt;&gt; click on box to indicate account &gt;&gt; &lt;'OK'&gt; &gt;&gt; &lt;'OK'&gt; &gt;&gt; &lt;'OK'&gt;</S>
      <S N="Check">Review system documentation to identify SQL Server accounts authorized to own database objects._x000A__x000A_If the SQL Server database ownership list does not exist or needs to be updated, this is a finding._x000A__x000A_Run the following SQL query to determine SQL Server ownership of all database objects:_x000A_SELECT name AS 'Database name'_x000A_     , SUSER_SNAME(owner_sid) AS 'Database Owner'_x000A_     , state_desc AS 'Database state'_x000A_  FROM sys.databases_x000A_</S>
    </MS>
  </Obj>
  <Obj RefId="373">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Database</S>
      <S N="SqlVersion">2012</S>
      <S N="VulnID">V-41409</S>
      <S N="RuleID">SV-53937r2_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL2-00-016900</S>
      <S N="Title">Unused database components and database objects must be removed.</S>
      <S N="Description">Information systems are capable of providing a wide variety of functions and services. Some of the functions and services, provided by default, may not be necessary to support essential organizational operations (e.g., key missions, functions)._x000A__x000A_It is detrimental for applications to provide or install by default, functionality exceeding requirements or mission objectives. Examples include, but are not limited to, installing advertising software demonstrations or browser plug-ins not related to requirements or providing a wide array of functionality not required for every mission, yet cannot be disabled._x000A__x000A_Applications must adhere to the principles of least functionality by providing only essential capabilities._x000A__x000A_Unused and unnecessary SQL Server components increase the number of available attack vectors to SQL Server by introducing additional targets for attack. By minimizing the services and applications installed on the system, the number of potential vulnerabilities is reduced.</S>
      <S N="FixText">If any database components or objects of SQL Server are required for operation of applications that will be accessing SQL Server data or configuration, include them in the system documentation. If any unused components or objects of SQL Server are installed, uninstall or remove unused components or objects.</S>
      <S N="Check">Review the list of components or optional features installed with SQL Server._x000A_If optional features or components of SQL Server are installed, this is not a finding. _x000A__x000A_If unused components or features of SQL Server are installed, then review the system documentation to verify unused components or features are documented and authorized._x000A_If any are not documented and authorized, this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="374">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Database</S>
      <S N="SqlVersion">2012</S>
      <S N="VulnID">V-41411</S>
      <S N="RuleID">SV-53939r5_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL2-00-019300</S>
      <S N="Title">SQL Server must encrypt information stored in the database.</S>
      <S N="Description">When data is written to digital media, such as hard drives, mobile computers, external/removable hard drives, personal digital assistants, flash/thumb drives, etc., there is risk of data loss and/or compromise._x000A__x000A_An organizational assessment of risk guides the selection of media and associated information contained on that media requiring restricted access. Organizations need to document, in policy and procedures, the media requiring restricted access, individuals authorized to access the media, and the specific measures taken to restrict access._x000A__x000A_Fewer protection measures are needed for media containing information determined by the organization to be in the public domain, to be publicly releasable, or to have limited or no adverse impact if accessed by other than authorized personnel. In these situations, it is assumed the physical access controls where the media resides provide adequate protection._x000A__x000A_As part of a defense-in-depth strategy, the organization considers routinely encrypting information at rest on selected secondary storage devices. The decision whether to employ cryptography is the responsibility of the information owner/steward, who exercises discretion within the framework of applicable rules, policies and law. The selection of the cryptographic mechanisms used is based upon maintaining the confidentiality and integrity of the information._x000A__x000A_The strength of mechanisms is commensurate with the classification and sensitivity of the information._x000A__x000A_Information at rest, when not encrypted, is open to compromise from attackers who have gained unauthorized access to the data files.</S>
      <S N="FixText">Use third-party tools or configure SQL Server to encrypt data stored in the database. Use only NIST-certified or NSA-approved cryptography to provide encryption._x000A__x000A_Run the following SQL script to create a certificate:_x000A_USE &lt;'database name'&gt;_x000A_CREATE CERTIFICATE &lt;'certificate name'&gt;_x000A_   ENCRYPTION BY PASSWORD = '&lt;'password'&gt;'_x000A_   FROM FILE = &lt;'path/file_name'&gt;_x000A_   WITH SUBJECT = 'name of person creating key',_x000A_   EXPIRY_DATE = '&lt;'expiration date: yyyymmdd'&gt;'_x000A__x000A_Run the following SQL script to create a symmetric key and assign an existing certificate:_x000A_USE &lt;'database name'&gt;_x000A_CREATE SYMMETRIC KEY &lt;'key name'&gt;_x000A_   WITH ALGORITHM = AES_256 _x000A_   ENCRYPTION BY &lt;'certificate name'&gt;_x000A__x000A_Set SQL Server configuration settings to encrypt databases, tables, columns, and/or data elements as required by the organization and the system owner._x000A__x000A_Document all instances of acceptance of risk by the information owner where sensitive or classified data is not encrypted. Have the ISSO document assurance that the unencrypted sensitive or classified information is otherwise inaccessible to those who do not have need-to-know access to the data. Developers should consider using a record-specific encryption method to protect individual records. For example, by employing the session username or other individualized element as part of the encryption key, then decryption of a data element is only possible by that user or other data accessible only by that user. Data labeling can be helpful in implementation. Consider applying additional auditing of access to any unencrypted sensitive or classified data when accessed by users (with and/or without a need to know).</S>
      <S N="Check">Review SQL Server's cryptographic settings to determine whether data stored in databases is encrypted according to organizational requirements and the system owner._x000A__x000A_If all of the data on SQL Server is unclassified and encryption of information is not required, this requirement is NA._x000A__x000A_Ensure the data is encrypted by executing:_x000A_USE &lt;databse name&gt;;_x000A_IF NOT EXISTS_x000A_      (_x000A_      SELECT 1_x000A_      FROM sys.dm_database_encryption_keys_x000A_      WHERE DB_NAME(database_id) = DB_NAME()_x000A_      )_x000A_      SELECT_x000A_            DB_NAME() AS [Database Name],_x000A_            'No database encryption key present, no encryption' AS [Encryption State]_x000A_ELSE_x000A_      SELECT_x000A_            DB_NAME(database_id) AS [Database Name],_x000A_            CASE encryption_state_x000A_                  WHEN 0 THEN 'No database encryption key present, no encryption'_x000A_                  WHEN 1 THEN 'Unencrypted'_x000A_                  WHEN 2 THEN 'Encryption in progress'_x000A_                  WHEN 3 THEN 'Encrypted'_x000A_                  WHEN 4 THEN 'Key change in progress'_x000A_                  WHEN 5 THEN 'Decryption in progress'_x000A_                  WHEN 6 THEN 'Protection change in progress'_x000A_            END AS [Encryption State]_x000A_      FROM sys.dm_database_encryption_keys_x000A_      WHERE DB_NAME(database_id) = DB_NAME()_x000A_;_x000A__x000A_If any database that is supposed to have encryption enabled is not listed as such, this is a finding._x000A__x000A_If encryption is required by the information owner and an approved, NIST-certified cryptography is not used to encrypt stored sensitive information, this is a finding._x000A__x000A_Verify all sensitive information is encrypted: entire database, tables, columns and/or data elements, as required by the organization and the system owner.</S>
    </MS>
  </Obj>
  <Obj RefId="375">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Database</S>
      <S N="SqlVersion">2012</S>
      <S N="VulnID">V-41412</S>
      <S N="RuleID">SV-53940r5_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL2-00-019500</S>
      <S N="Title">SQL Server must implement required cryptographic protections using cryptographic modules complying with applicable federal laws, Executive Orders, directives, policies, regulations, standards, and guidance.</S>
      <S N="Description">Cryptography is only as strong as the encryption modules/algorithms employed to encrypt the data._x000A__x000A_Use of weak or untested encryption algorithms undermines the purposes of utilizing encryption to protect data._x000A__x000A_Use of cryptography to provide confidentiality and non-repudiation is not effective unless strong methods are employed with its use. Many earlier encryption methods and modules have been broken and/or overtaken by increasing computing power. The NIST FIPS 140-2 cryptographic standards provide proven methods and strengths to employ cryptography effectively._x000A__x000A_Detailed information on the NIST Cryptographic Module Validation Program (CMVP) is available at the following website:  http://csrc.nist.gov/groups/STM/cmvp/index.html.</S>
      <S N="FixText">Implement required cryptographic protections using cryptographic modules complying with applicable federal laws, Executive Orders, directives, policies, regulations, standards, and guidance._x000A__x000A_Ensure the database is backed up._x000A__x000A_Run the following SQL to undo encryption and drop the existing database encryption key:_x000A_USE master;_x000A_GO_x000A_ALTER DATABASE &lt;database name&gt; SET ENCRYPTION OFF;_x000A_GO_x000A_USE &lt;database name&gt; ;_x000A_GO_x000A_DROP DATABASE ENCRYPTION KEY;_x000A_GO_x000A__x000A_Run the following SQL to drop a server certificate from the SQL Server instance:_x000A_USE master;_x000A_GO_x000A_DROP CERTIFICATE &lt;certificate name&gt;;_x000A_GO_x000A__x000A_If applicable, run the following SQL to drop a symmetric key:_x000A_USE &lt;database name&gt;;_x000A_GO_x000A_DROP SYMMETRIC KEY &lt;key name&gt;;_x000A_GO_x000A__x000A_Configure encryption to use approved encryption algorithms. Existing keys are not reconfigurable to use different algorithms._x000A__x000A_Run SQL along the lines of the following to import an externally-created server certificate (see Microsoft documentation for options and syntax details):_x000A_USE master;_x000A_GO_x000A_CREATE CERTIFICATE &lt;certificate name&gt;_x000A_   FROM FILE = '&lt;path\file_name&gt;'_x000A_..._x000A_;_x000A_GO_x000A__x000A_Run the following SQL to create a database encryption key and encrypt the database:_x000A_USE &lt;database name&gt;;_x000A_GO_x000A_CREATE DATABASE ENCRYPTION KEY _x000A_   WITH ALGORITHM = AES_256 _x000A_   ENCRYPTION BY SERVER CERTIFICATE &lt;certificate name&gt;;_x000A_GO_x000A_USE master;_x000A_GO_x000A_ALTER DATABASE &lt;database name&gt; SET ENCRYPTION ON;_x000A_GO_x000A__x000A_Note: The acceptable algorithms are: "AES 128", "AES 192", "AES 256" and "Triple DES"._x000A__x000A_If required, run the following SQL to create a symmetric key and assign an existing certificate:_x000A_USE &lt;database name&gt;;_x000A_GO_x000A_CREATE SYMMETRIC KEY &lt;key name&gt;_x000A_   WITH ALGORITHM = AES_256 _x000A_   ENCRYPTION BY CERTIFICATE &lt;certificate name&gt;;_x000A_</S>
      <S N="Check">If encryption is not required for this database, this is not a finding._x000A__x000A_Run the following SQL queries to review SQL Server's cryptographic settings for the database:_x000A__x000A_USE &lt;database name&gt; ;_x000A_IF NOT EXISTS_x000A_       (_x000A_       SELECT 1 _x000A_       FROM sys.dm_database_encryption_keys_x000A_       WHERE DB_NAME(database_id) = DB_NAME()_x000A_       )_x000A_       SELECT _x000A_             DB_NAME() AS [Database Name],_x000A_             'No database encryption key present, no encryption' AS [Encryption State],_x000A_                     NULL AS [Algorithm],_x000A_                     NULL AS [Key Length]_x000A_ELSE_x000A_       SELECT_x000A_             DB_NAME(database_id) AS [Database Name],_x000A_             CASE encryption_state _x000A_                   WHEN 0 THEN 'No database encryption key present, no encryption' _x000A_                   WHEN 1 THEN 'Unencrypted' _x000A_                   WHEN 2 THEN 'Encryption in progress' _x000A_                   WHEN 3 THEN 'Encrypted' _x000A_                   WHEN 4 THEN 'Key change in progress' _x000A_                   WHEN 5 THEN 'Decryption in progress' _x000A_                   WHEN 6 THEN 'Protection change in progress' _x000A_             END AS [Encryption State],_x000A_                     key_algorithm AS [Algorithm],_x000A_                     key_length AS [Key Length]_x000A_       FROM sys.dm_database_encryption_keys_x000A_       WHERE DB_NAME(database_id) = DB_NAME()_x000A__x000A_SELECT DB_NAME() AS [Database], name, algorithm_desc _x000A_FROM sys.symmetric_keys _x000A_ORDER BY name, algorithm_desc;_x000A__x000A_Note:  The acceptable algorithms are:  "AES 128", "AES 192", "AES 256" and "Triple DES"._x000A__x000A_If SQL Server cryptographic algorithms are not listed or are found not to be compliant with applicable federal laws, Executive Orders, directives, policies, regulations, standards and guidance, this is a finding._x000A__x000A_If the encryption state indicates that the database is unencrypted, this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="376">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Database</S>
      <S N="SqlVersion">2012</S>
      <S N="VulnID">V-41415</S>
      <S N="RuleID">SV-53944r3_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL2-00-024100</S>
      <S N="Title">The Database Master Key must be encrypted by the Service Master Key where required.</S>
      <S N="Description">When not encrypted by the Service Master Key, system administrators or application administrators may access and use the Database Master Key to view sensitive data that they are not authorized to view. Where alternate encryption means are not feasible, encryption by the Service Master Key may be necessary. To help protect sensitive data from unauthorized access by DBAs, mitigations may be in order. Mitigations may include automatic alerts or other audit events when the Database Master Key is accessed outside of the application or by a DBA account.tru</S>
      <S N="FixText">Where possible, encrypt the Database Master Key with a password known only to the application administrator._x000A_Where not possible, configure additional audit events or alerts to detect unauthorized access to the Database Master Key by users not authorized to view sensitive data.</S>
      <S N="Check">From the query prompt:_x000A_SELECT name_x000A_FROM [master].sys.databases_x000A_WHERE is_master_key_encrypted_by_server = 1_x000A_AND owner_sid &lt;&gt; 1_x000A_AND state = 0_x000A_If no databases are returned, this is not a finding._x000A_For any databases returned, verify in the System Security Plan that encryption of the Database_x000A_Master Key using the Service Master Key is acceptable and approved by the Information Owner, and the encrypted data does not require additional protections to deter or detect DBA access. If not approved, this is a finding._x000A__x000A_If approved and additional protections are required, then verify the additional requirements are in place in accordance with the System Security Plan. These may include additional auditing on access of the Database Master Key with alerts or other automated monitoring._x000A__x000A_If the additional requirements are not in place, this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="377">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Database</S>
      <S N="SqlVersion">2012</S>
      <S N="VulnID">V-41416</S>
      <S N="RuleID">SV-53945r2_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL2-00-024200</S>
      <S N="Title">Database Master Key passwords must not be stored in credentials within the database.</S>
      <S N="Description">Storage of the Database Master Key password in a database credential allows decryption of sensitive data by privileged users who may not have a need-to-know requirement to access the_x000A_data.</S>
      <S N="FixText">Use the stored procedure sp_control_dbmasterkey_password to remove any credentials that_x000A_store Database Master Key passwords._x000A_From the query prompt:_x000A_EXEC SP_CONTROL_DBMASTERKEY_PASSWORD @db_name = '[database name]', @action_x000A_= N'drop'</S>
      <S N="Check">From the query prompt:_x000A_SELECT COUNT(credential_id)_x000A_FROM [master].sys.master_key_passwords_x000A__x000A_If count is not 0, this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="378">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Database</S>
      <S N="SqlVersion">2012</S>
      <S N="VulnID">V-41417</S>
      <S N="RuleID">SV-53946r5_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL2-00-024300</S>
      <S N="Title">Symmetric keys (other than the database master key) must use a DoD certificate to encrypt the key.</S>
      <S N="Description">Data within the database is protected by use of encryption. The symmetric keys are critical for this process. If the symmetric keys were to be compromised the data could be disclosed to unauthorized personnel.tru</S>
      <S N="FixText">Configure or alter symmetric keys to encrypt keys with certificates or authorized asymmetric keys._x000A_From the query prompt:_x000A_ALTER SYMMETRIC KEY [key name] ADD ENCRYPTION BY CERTIFICATE [certificate name]_x000A_ALTER SYMMETRIC KEY [key name] DROP ENCRYPTION BY [password, symmetric key or asymmetric key]_x000A__x000A_The symmetric key must specify a certificate or asymmetric key for encryption.</S>
      <S N="Check">In a query tool:_x000A_USE &lt;database name&gt;;_x000A_GO_x000A_SELECT s.name, k.crypt_type_desc_x000A_FROM sys.symmetric_keys s, sys.key_encryptions k_x000A_WHERE s.symmetric_key_id = k.key_id_x000A_AND s.name &lt;&gt; '##MS_DatabaseMasterKey##'_x000A_AND k.crypt_type IN ('ESKP', 'ESKS')_x000A_ORDER BY s.name, k.crypt_type_desc;_x000A_GO_x000A__x000A_Review any symmetric keys that have been defined against the System Security Plan._x000A__x000A_If any keys are defined that are not documented in the System Security Plan, this is a finding._x000A__x000A_Review the System Security Plan to review the encryption mechanism specified for each symmetric key. If the method does not indicate use of certificates, this is a finding._x000A__x000A_If the certificate specified is not a DoD PKI certificate, this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="379">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Database</S>
      <S N="SqlVersion">2012</S>
      <S N="VulnID">V-41420</S>
      <S N="RuleID">SV-53949r6_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL2-00-021400</S>
      <S N="Title">SQL Server must employ cryptographic mechanisms preventing the unauthorized disclosure of information at rest.</S>
      <S N="Description">This control is intended to address the confidentiality and integrity of information at rest in non-mobile devices and covers user information and system information. If the data is not encrypted, it is subject to compromise and unauthorized disclosure._x000A__x000A_Note:  the system databases (master, msdb, model, resource and tempdb) cannot be encrypted._x000A__x000A_The decision whether to employ cryptography is the responsibility of the information owner/steward, who exercises discretion within the framework of applicable rules, policies and law.</S>
      <S N="FixText">Use encryption to protect the data. To enable database encryption, create a master key, create a database encryption key, and protect it by using mechanisms tied to the master key, and then set encryption on.</S>
      <S N="Check">If this is a system database (master, msdb, resource, tempdb or model), this is not applicable (NA)._x000A__x000A_If the application owner and authorizing official have determined that the database does not require encryption, this is not a finding._x000A__x000A_Ensure the data is encrypted by executing:_x000A_USE &lt;database name&gt;;_x000A_IF NOT EXISTS_x000A__x0009_(_x000A__x0009_SELECT 1 _x000A__x0009_FROM sys.dm_database_encryption_keys_x000A__x0009_WHERE DB_NAME(database_id) = DB_NAME()_x000A__x0009_)_x000A__x0009_SELECT _x000A__x0009__x0009_DB_NAME() AS [Database Name],_x000A__x0009__x0009_'No database encryption key present, no encryption' AS [Encryption State]_x000A_ELSE_x000A__x0009_SELECT_x000A__x0009__x0009_DB_NAME(database_id)  AS [Database Name],_x000A__x0009__x0009_CASE encryption_state _x000A__x0009__x0009__x0009_WHEN 0 THEN 'No database encryption key present, no encryption' _x000A__x0009__x0009__x0009_WHEN 1 THEN 'Unencrypted' _x000A__x0009__x0009__x0009_WHEN 2 THEN 'Encryption in progress' _x000A__x0009__x0009__x0009_WHEN 3 THEN 'Encrypted' _x000A__x0009__x0009__x0009_WHEN 4 THEN 'Key change in progress' _x000A__x0009__x0009__x0009_WHEN 5 THEN 'Decryption in progress' _x000A__x0009__x0009__x0009_WHEN 6 THEN 'Protection change in progress' _x000A__x0009__x0009_END AS [Encryption State] _x000A__x0009_FROM sys.dm_database_encryption_keys_x000A__x0009_WHERE DB_NAME(database_id) = DB_NAME()_x000A_;_x000A__x000A_For each user database, ensure that encryption is in effect.  If not, this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="380">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Database</S>
      <S N="SqlVersion">2012</S>
      <S N="VulnID">V-41421</S>
      <S N="RuleID">SV-53950r2_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL2-00-021800</S>
      <S N="Title">SQL Server must prevent unauthorized and unintended information transfer via shared system resources.</S>
      <S N="Description">The purpose of this control is to prevent information, including encrypted representations of information, produced by the actions of a prior user/role (or the actions of a process acting on behalf of a prior user/role) from being available to any current user/role (or current process) that obtains access to a shared system resource (e.g., registers, main memory, secondary storage) after the resource has been released back to the information system. Control of information in shared resources is also referred to as object reuse._x000A__x000A_Data used for the development and testing of applications often involves copying data from production. It is important that specific procedures exist for this process, so copies of sensitive data are not misplaced or left in a temporary location without the proper controls.</S>
      <S N="FixText">Create and document a process for moving data from production to development/test systems and follow the process._x000A__x000A_Modify any code used for moving data from production to development/test systems to ensure copies of production data are not left in unsecured locations.</S>
      <S N="Check">Verify there are proper procedures in place for the transfer of development/test data from production. Review any scripts or code that exists for the movement of production data to development/test and verify copies of production data are not left in unprotected locations._x000A__x000A_If there is no documented procedure for data movement from production to development/test, this is a finding._x000A__x000A_If data movement code that copies from production to development/test does exist and leaves any copies of production data in unprotected locations, this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="381">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Database</S>
      <S N="SqlVersion">2012</S>
      <S N="VulnID">V-41422</S>
      <S N="RuleID">SV-53951r2_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL2-00-022000</S>
      <S N="Title">SQL Server must protect against or limit the effects of the organization-defined types of Denial of Service (DoS) attacks.</S>
      <S N="Description">Application management includes the ability to control the number of users and user sessions utilizing an application. Limiting the number of allowed users, and sessions per user, is helpful in limiting risks related to DoS attacks._x000A__x000A_This requirement addresses concurrent session control for a single information system account and does not address concurrent sessions by a single user via multiple system accounts._x000A__x000A_This requirement may be met via the application or by utilizing information system session control provided by a web server with specialized session management capabilities. If it has been specified that this requirement will be handled by the application, the capability to limit the maximum number of concurrent single user sessions must be designed and built into the application._x000A__x000A_The organization will need to define the maximum number of concurrent sessions for SQL Server accounts by account type, by account, or a combination thereof and SQL Server shall enforce this requirement._x000A__x000A_Unlimited concurrent connections to SQL Server could allow a successful DoS attack by exhausting connection resources.</S>
      <S N="FixText">Configure SQL Server number of concurrent sessions to the organization-defined maximum number of sessions by running the following script:_x000A__x000A_USE MASTER_x000A_GO_x000A__x000A_EXEC sys.sp_configure N'show advanced options', N'1'  RECONFIGURE WITH OVERRIDE_x000A_GO_x000A_EXEC sys.sp_configure N'user connections', &lt;'maximum number of SQL Server concurrent connections'&gt;_x000A_EXEC sys.sp_configure N'show advanced options', N'0'  RECONFIGURE WITH OVERRIDE_x000A_GO</S>
      <S N="Check">Check SQL Server settings for the number of concurrent Check SQL Server settings for the number of concurrent sessions by running the following script:_x000A__x000A_USE MASTER_x000A_GO_x000A__x000A_EXEC sys.sp_configure N'show advanced options', N'1'  RECONFIGURE WITH OVERRIDE_x000A_GO_x000A_EXEC sys.sp_configure N'user connections'_x000A_EXEC sys.sp_configure N'show advanced options', N'0'  RECONFIGURE WITH OVERRIDE_x000A_GO_x000A__x000A_If SQL Server settings for concurrent sessions is not lower than or equal to the organization-defined maximum number of sessions, this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="382">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Database</S>
      <S N="SqlVersion">2012</S>
      <S N="VulnID">V-41424</S>
      <S N="RuleID">SV-53953r3_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL2-00-022500</S>
      <S N="Title">SQL Server must check the validity of data inputs.</S>
      <S N="Description">Invalid user input occurs when a user inserts data or characters into an applicationâ€™s data entry fields and the application is unprepared to process that data. This results in unanticipated application behavior potentially leading to an application or information system compromise. Invalid user input is one of the primary methods employed when attempting to compromise an application._x000A__x000A_SQL Server needs to validate the data userâ€™s attempt to input to the application for processing. Rules for checking the valid syntax and semantics of information system inputs (e.g., character set, length, numerical range, acceptable values) are in place to verify inputs match specified definitions for format and content. Inputs passed to interpreters are prescreened to prevent the content from being unintentionally interpreted as commands._x000A__x000A_A poorly designed database system can have many problems. A common issue with these types of systems is the missed opportunity to use constraints._x000A__x000A_While this matter is of great importance to the secure operation of database management systems, the DBA in a typical installation will communicate with the application development/support staff to obtain assurance that this requirement is met.</S>
      <S N="FixText">Use triggers, constraints, foreign keys, etc. to validate data input._x000A__x000A_Modify SQL Server to properly use the correct column data types as required in the database.</S>
      <S N="Check">Review SQL Server field definitions, constraints, and foreign keys to determine whether or not data being input into the database is valid._x000A_If field definitions are not reflective of the data, this is a finding._x000A__x000A_If column data types are not assigned correctly where required within the database, this is a finding._x000A__x000A_If columns do not contain reasonable constraints based on column use, this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="383">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Database</S>
      <S N="SqlVersion">2012</S>
      <S N="VulnID">V-60671</S>
      <S N="RuleID">SV-75113r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL2-00-015620</S>
      <S N="Title">In a database owned by a login not having administrative privileges at the instance level, the database property TRUSTWORTHY must be OFF unless required and authorized.</S>
      <S N="Description">SQL Server's fixed (built-in) server roles, especially [sysadmin], have powerful capabilities that could cause great harm if misused, so their use must be tightly controlled._x000A__x000A_The SQL Server instance uses each database's TRUSTWORTHY property to guard against tampering that could enable unwarranted privilege escalation.  When TRUSTWORTHY is 0/False/Off, SQL Server prevents the database from accessing resources in other databases.  When TRUSTWORTHY is 1/True/On, SQL Server permits access to other databases (subject to other protections).  SQL Server sets TRUSTWORTHY OFF when it creates a new database.  SQL Server forces TRUSTWORTHY OFF, irrespective of its prior value, when an existing database is attached to it, to address the possibility that an adversary may have tampered with the database, introducing malicious code.  To set TRUSTWORTHY ON, an account with the [sysadmin] role must issue an ALTER DATABASE command._x000A__x000A_Although SQL Server itself treats this property conservatively, application installer programs may set TRUSTWORTHY ON and leave it on.  This provides an opportunity for misuse._x000A__x000A_When TRUSTWORTHY is ON, users of the database can take advantage of the database owner's privileges, by impersonating the owner.  This can have particularly serious consequences if the database owner is the [sa] login (which may have been renamed in accordance with SQL2-00-010200, and disabled in accordance with SQL2-00-017100, but nonetheless can be invoked in an EXECUTE AS USER = 'dbo' statement, or CREATE PROCEDURE ... WITH EXECUTE AS OWNER ...).   The [sa] login cannot be removed from the [sysadmin] role.  The user impersonating [sa] - or another [sysadmin] account - is then able to perform administrative actions across all databases under the instance, including making any himself or any other login a member of [sysadmin]._x000A__x000A_Most of the other fixed server roles could be similarly abused._x000A__x000A_Therefore, TRUSTWORTHY must not be used on databases owned by logins that are members of the fixed server roles.  Further, if TRUSTWORTHY is to be used for any other database, the need must be documented and approved._x000A__x000A_The system database [msdb] is an exception: it is required to be TRUSTWORTHY.</S>
      <S N="FixText">USE [master];_x000A_GO_x000A_ALTER DATABASE &lt;name&gt; SET TRUSTWORTHY OFF;_x000A_GO</S>
      <S N="Check">If the database is owned by an account that is directly or indirectly a member of a fixed (built-in) server role, this is not applicable (NA)._x000A__x000A_Run the query:_x000A_USE &lt;database name&gt;;_x000A_GO_x000A_SELECT _x000A_       DB_NAME()                  AS [Database], _x000A_       SUSER_SNAME(D.owner_sid)   AS [Database Owner], _x000A_       CASE WHEN D.is_trustworthy_on = 1 THEN 'ON' ELSE 'off' END_x000A_                                  AS [Trustworthy]_x000A_FROM_x000A_       sys.databases D _x000A_WHERE_x000A_       D.[name] = DB_NAME()_x000A_AND    DB_NAME() &lt;&gt; 'msdb'_x000A_AND    D.is_trustworthy_on = 1;_x000A_GO_x000A_If the query returns a row indicating that the TRUSTWORTHY setting is OFF, or returns no rows, this is not a finding. _x000A__x000A_Review the system security plan to determine whether the need for TRUSTWORTHY is documented and approved.  If not, this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="384">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Database</S>
      <S N="SqlVersion">2012</S>
      <S N="VulnID">V-60781</S>
      <S N="RuleID">SV-75233r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL2-00-015610</S>
      <S N="Title">In a database owned by [sa], or by any other login having administrative privileges at the instance level, the database property TRUSTWORTHY must be OFF.</S>
      <S N="Description">SQL Server's fixed (built-in) server roles, especially [sysadmin], have powerful capabilities that could cause great harm if misused, so their use must be tightly controlled._x000A__x000A_The SQL Server instance uses each database's TRUSTWORTHY property to guard against tampering that could enable unwarranted privilege escalation.  When TRUSTWORTHY is 0/False/Off, SQL Server prevents the database from accessing resources in other databases.  When TRUSTWORTHY is 1/True/On, SQL Server permits access to other databases (subject to other protections).  SQL Server sets TRUSTWORTHY OFF when it creates a new database.  SQL Server forces TRUSTWORTHY OFF, irrespective of its prior value, when an existing database is attached to it, to address the possibility that an adversary may have tampered with the database, introducing malicious code.  To set TRUSTWORTHY ON, an account with the [sysadmin] role must issue an ALTER DATABASE command._x000A__x000A_Although SQL Server itself treats this property conservatively, application installer programs may set TRUSTWORTHY ON and leave it on.  This provides an opportunity for misuse._x000A__x000A_When TRUSTWORTHY is ON, users of the database can take advantage of the database owner's privileges, by impersonating the owner.  This can have particularly serious consequences if the database owner is the [sa] login (which may have been renamed in accordance with SQL2-00-010200, and disabled in accordance with SQL2-00-017100, but nonetheless can be invoked in an EXECUTE AS USER = 'dbo' statement, or CREATE PROCEDURE ... WITH EXECUTE AS OWNER ...).   The [sa] login cannot be removed from the [sysadmin] role.  The user impersonating [sa] - or another [sysadmin] account - is then able to perform administrative actions across all databases under the instance, including making any himself or any other login a member of [sysadmin]._x000A__x000A_Most of the other fixed server roles could be similarly abused._x000A__x000A_Therefore, TRUSTWORTHY must not be used on databases owned by logins that are members of the fixed server roles.  Further, if TRUSTWORTHY is to be used for any other database, the need must be documented and approved._x000A__x000A_The system database [msdb] is an exception: it is required to be TRUSTWORTHY.</S>
      <S N="FixText">Set the TRUSTWORTHY property OFF; or remove the database owner from the fixed server role(s); or change the database owner._x000A__x000A__x000A_To set the TRUSTWORTHY property OFF:_x000A_USE [master];_x000A_GO_x000A_ALTER DATABASE &lt;name&gt; SET TRUSTWORTHY OFF;_x000A_GO_x000A_Verify that this produced the intended result by re-running the query specified in the Check._x000A__x000A__x000A_To determine the path or paths by which the database owner is assigned the fixed server role or roles, run this query:_x000A__x000A_USE &lt;database name&gt;;_x000A_GO_x000A_WITH C AS_x000A_(_x000A_SELECT _x000A__x0009_P.name_x0009__x0009_AS [Parent Server Role],_x000A__x0009_CAST('Fixed' AS varchar(8))_x000A__x0009__x0009__x0009__x0009_AS [Server Role Type],_x000A__x0009_M.name_x0009__x0009_AS [Member],_x000A__x0009_M.type_desc_x0009_AS [Member Type],_x000A__x0009_P.name _x0009__x0009_AS [Root],_x000A__x0009_1_x0009__x0009__x0009_AS [Level]_x000A_FROM_x000A__x0009_[sys].[server_role_members] X_x000A__x0009_INNER JOIN [sys].[server_principals] P ON P.principal_id = X.role_principal_id_x000A__x0009_INNER JOIN [sys].[server_principals] M ON M.principal_id = X.member_principal_id_x000A_WHERE_x000A__x0009_P.is_fixed_role = 1_x000A_UNION ALL_x000A_SELECT _x000A__x0009_P.name_x0009__x0009_AS [Parent Server Role],_x000A__x0009_CASE WHEN M.is_fixed_role = 1 THEN CAST('Fixed' AS varchar(8)) ELSE CAST('Custom' AS varchar(8)) END_x000A__x0009__x0009__x0009__x0009_AS [Server Role Type],_x000A__x0009_M.name_x0009__x0009_AS [Member],_x000A__x0009_M.type_desc_x0009_AS [Member Type],_x000A__x0009_C.[Root]_x0009_AS [Root],_x000A__x0009_C.[Level] + 1_x0009_AS [Level]_x000A_FROM_x000A__x0009_[sys].[server_role_members] X_x000A__x0009_INNER JOIN [sys].[server_principals] P ON P.principal_id = X.role_principal_id_x000A__x0009_INNER JOIN [sys].[server_principals] M ON M.principal_id = X.member_principal_id_x000A__x0009_INNER JOIN C ON P.name = C.Member_x000A_)_x000A_,_x000A_B AS_x000A_(_x000A_SELECT _x000A__x0009_C.[Member] AS [Leaf],_x000A__x0009_C.[Root],_x000A__x0009_C.[Parent Server Role],_x000A__x0009_C.[Server Role Type],_x000A__x0009_C.[Member],_x000A__x0009_C.[Member Type],_x000A__x0009_C.[Level]_x000A_FROM C _x000A_WHERE_x000A__x0009_C.[Member Type] NOT LIKE '%ROLE%'_x000A_UNION ALL_x000A_SELECT  _x000A__x0009_B.[Leaf],_x000A__x0009_C.[Root],_x000A__x0009_C.[Parent Server Role],_x000A__x0009_C.[Server Role Type],_x000A__x0009_C.[Member],_x000A__x0009_C.[Member Type],_x000A__x0009_C.[Level]_x000A_FROM C_x000A_INNER JOIN B_x000A__x0009_ON_x0009_C.[Member] = B.[Parent Server Role]_x000A__x0009_AND_x0009_C.[Level] = B.[Level] - 1_x000A__x0009_AND_x0009_C.[Root] = B.[Root]_x000A_)_x000A_SELECT_x000A__x0009_DB_NAME()_x0009_AS [Database],  _x000A__x0009_B.[Leaf]_x0009_AS [Owner Login],_x000A__x0009_B.[Root]_x0009_AS[Top-Level Server Role],_x000A__x0009_B.[Parent Server Role],_x000A__x0009_B.[Server Role Type],_x000A__x0009_B.[Member],_x000A__x0009_B.[Member Type],_x000A__x0009_B.[Level]_x000A_FROM B _x000A_WHERE B.[Leaf] = (SELECT SUSER_SNAME(D.owner_sid) FROM sys.databases D WHERE D.Name = DB_NAME())_x000A_ORDER BY B.[Root], B.[Level], B.[Parent Server Role], B.[Member]_x000A_;_x000A_GO_x000A__x000A_To remove the database owner from a fixed server role or a custom server role:_x000A_USE [master];_x000A_GO_x000A_ALTER SERVER ROLE &lt;fixed/custom server role name&gt;_x000A__x0009_DROP MEMBER &lt;database owner name&gt;;_x000A_GO_x000A_Verify that this produced the intended result by re-running the Check query._x000A__x000A__x000A_To change the database owner:_x000A_USE [master];_x000A_GO_x000A_ALTER AUTHORIZATION ON DATABASE::&lt;DB name&gt; TO &lt;new owner name&gt;;_x000A_GO_x000A_Verify that this produced the intended result by re-running the Check query.</S>
      <S N="Check">USE &lt;database name&gt;;_x000A_GO_x000A_WITH FixedServerRoles(RoleName) AS_x000A_(_x000A__x0009_SELECT 'sysadmin'_x000A__x0009_UNION SELECT 'securityadmin'_x000A__x0009_UNION SELECT 'serveradmin'_x000A__x0009_UNION SELECT 'setupadmin'_x000A__x0009_UNION SELECT 'processadmin'_x000A__x0009_UNION SELECT 'diskadmin'_x000A__x0009_UNION SELECT 'dbcreator'_x000A__x0009_UNION SELECT 'bulkadmin'_x000A_)_x000A_SELECT _x000A__x0009_DB_NAME() AS [Database], _x000A__x0009_SUSER_SNAME(D.owner_sid) AS [Database Owner], _x000A__x0009_F.RoleName AS [Fixed Server Role],_x000A__x0009_CASE WHEN D.is_trustworthy_on = 1 THEN 'ON' ELSE 'off' END_x000A__x0009__x0009_AS [Trustworthy]_x0009__x000A_FROM_x000A__x0009_FixedServerRoles F_x000A__x0009_INNER JOIN sys.databases D ON D.Name = DB_NAME()_x000A_WHERE _x000A__x0009_IS_SRVROLEMEMBER(F.RoleName, SUSER_SNAME(D.owner_sid)) = 1_x000A_AND_x0009_DB_NAME()  &lt;&gt;  'msdb'_x000A_AND_x0009_D.is_trustworthy_on = 1;_x000A_GO_x000A_If the query returns any rows, this is a finding.  </S>
    </MS>
  </Obj>
  <Obj RefId="385">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Database</S>
      <S N="SqlVersion">2012</S>
      <S N="VulnID">V-70627</S>
      <S N="RuleID">SV-85249r1_rule</S>
      <S N="Severity">low</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL2-00-017510</S>
      <S N="Title">Appropriate staff must be alerted when the amount of storage space used by the SQL Server transaction log file(s) exceeds an organization-defined value.</S>
      <S N="Description">It is important for the appropriate personnel to be aware if the system is at risk of failing to record transaction log data.  The transaction log is the heart of a SQL Server database.  If it fails, processing will stop.  It must always have enough available storage space to cope with peak load.  Administrators must be warned about abnormally high space consumption soon enough to take corrective action before all space is used up.</S>
      <S N="FixText">Decide on, and document, the threshold value for alerting administrators to a shortage of storage for the transaction log._x000A__x000A_Establish automated or manual monitoring and alerting.</S>
      <S N="Check">Review system documentation and/or organizational procedures to determine the threshold value for the storage used by the transaction log, above which staff must be alerted.  The threshold may be expressed as an absolute quantity, or a percentage of total available space._x000A__x000A_If this threshold has not been defined, this is a finding._x000A__x000A_If monitoring software is in use, and has been configured to alert system and database administrators when the threshold is exceeded, this is not a finding._x000A__x000A_If manual procedures exist for frequently checking the space used and alerting system and database administrators, and there is evidence that the procedures are adhered to, this is not a finding._x000A__x000A_Otherwise, this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="386">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2012</S>
      <S N="VulnID">V-40905</S>
      <S N="RuleID">SV-53259r5_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL2-00-023000</S>
      <S N="Title">The system must activate an alarm and/or automatically shut SQL Server down if a failure is detected in its software components. </S>
      <S N="Description">Predictable failure prevention requires organizational planning to address system failure issues. If components key to maintaining system security fail to function, then SQL Server could continue operating in an unsecure state. The organization must be prepared, and the system must be configured, to send an alarm for such conditions and/or automatically shut SQL Server down._x000A__x000A_If appropriate actions are not taken when component failures occur, a denial of service condition may occur. Appropriate actions can include conducting a graceful application shutdown to avoid losing information._x000A__x000A_For the purposes of this requirement, "component" may be interpreted as meaning any of the Windows services that comprise a SQL Server instance.  "The system" encompasses SQL Server itself, the Windows operating system, and any monitoring/management tools used to control the server.tru</S>
      <S N="FixText">Configure the system to activate an alarm and/or trigger a SQL Server shutdown when a component failure is detected.</S>
      <S N="Check">Check the configuration of SQL Server, the operating system and any monitoring/management tools to verify the system activates an alarm and/or triggers a shutdown of SQL Server when a component failure is detected._x000A__x000A_If system does not take either or both actions, this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="387">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2012</S>
      <S N="VulnID">V-40906</S>
      <S N="RuleID">SV-53260r2_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL2-00-022700</S>
      <S N="Title">SQL Server must identify potential security-relevant error conditions.</S>
      <S N="Description">The structure and content of SQL Server error messages need to be carefully considered by the organization and development team. The extent to which the application is able to identify and handle error conditions is guided by organizational policy and operational requirements._x000A__x000A_Database logs can be monitored for specific security-related errors. Any error that can have a negative effect on database security should be quickly identified and forwarded to the appropriate personnel. If security-relevant error conditions are not identified by SQL Server they may be overlooked by the personnel responsible for addressing them.</S>
      <S N="FixText">Monitor SQL Server log files to determine when a security-related error occurs._x000A__x000A_Add/Update list of appropriate personnel that are to be alerted when a security related error condition occurs to system documentation. Consider an automated job for both the monitor and the alerting.</S>
      <S N="Check">Security-related errors must be identified and monitored. In most cases, these items would appear in the SQL Server log file.  _x000A__x000A_If security-related error conditions are not being monitored to meet this requirement, this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="388">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2012</S>
      <S N="VulnID">V-40907</S>
      <S N="RuleID">SV-53261r4_rule</S>
      <S N="Severity">high</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL2-00-022600</S>
      <S N="Title">SQL Server must employ cryptographic mechanisms preventing the unauthorized disclosure of information during transmission.</S>
      <S N="Description">Preventing the disclosure of transmitted information requires that applications take measures to employ some form of cryptographic mechanism in order to protect the information during transmission. This is usually achieved through the use of Transport Layer Security (TLS), VPN, or IPSEC tunnel. _x000A__x000A_Information in transmission is particularly vulnerable to attack. If the DBMS does not employ cryptographic mechanisms preventing unauthorized disclosure of information during transit, the information may be compromised.tru</S>
      <S N="FixText">Deploy organization-approved encryption to the SQL Server network connections._x000A__x000A_Where physical network devices are used for encryption, set them up such that:_x000A__x000A_1. The plaintext connection to the database server is afforded the highest protections, allowing no access to unauthorized or non-cleared personnel._x000A_2. The encryption device is configured to pass traffic to only the specific IP addresses as identified by the database documentation._x000A_3. The encryption keys utilized are current and valid keys._x000A_4. The keys utilized meet approved organizationally defined compliant algorithms._x000A__x000A_Where SQL Server network encryption is used, open SQL Server Configuration Manager.  Navigate to SQL Server Configuration Manager &gt;&gt; SQL Server Network Configuration. Right click on Protocols for [NAME OF INSTANCE], where [NAME OF INSTANCE] is a placeholder for the SQL Server instance name, and click on Properties.  On the Flags tab, set Force Encryption to YES, provide a DoD certificate on the Certificate tab.   </S>
      <S N="Check">If the DBMS exists in the unclassified environment, and data transmission does not cross the boundary between the NIPRNet and the wider Internet, and the application owner and authorizing official have determined that encryption is not required, this is not a finding._x000A__x000A_Check SQL Server and network settings to determine whether cryptographic mechanisms are used to prevent the unauthorized disclosure of information during transmission. If not, this is a finding._x000A__x000A_Review system documentation to determine whether the system handles classified information. If the system does not handle classified information, the severity of this check should be downgraded to Category II._x000A__x000A_From Command Prompt, open SQL Server Configuration Manager by typing sqlservermanager11.msc, and pressing [ENTER]._x000A__x000A_Navigate to SQL Server Configuration Manager &gt;&gt; SQL Server Network Configuration. Right click on Protocols for [NAME OF INSTANCE], where [NAME OF INSTANCE] is a placeholder for the SQL Server instance name, and click on Properties._x000A__x000A_On the Flags tab, if Force Encryption is set to "YES", examine the certificate used on the Certificate tab._x000A__x000A_If Force Encryption is set, a DoD Certificate is not utilized, and a physical encryption measure is utilized, examine the physical encryption devices to determine the following:_x000A__x000A_1. The plaintext connection to the database server is afforded the highest protections, allowing no access to unauthorized or non-cleared personnel._x000A_2. The encryption device is configured to pass traffic to only the specific IP addresses as identified by the database documentation._x000A_3. The encryption keys utilized are current and valid keys._x000A_4. The keys utilized meet approved organizationally defined compliant algorithms._x000A__x000A_If any of the preceding requirements is not met, this is a finding._x000A__x000A_If Force Encryption is set to "NO" or a DoD Certificate is not utilized, and physical encryption measures are not utilized, this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="389">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2012</S>
      <S N="VulnID">V-40908</S>
      <S N="RuleID">SV-53262r3_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL2-00-022400</S>
      <S N="Title">SQL Server must ensure, if Database Availability Groups are being used and there is a server failure, that none of the potential failover servers would suffer from resource exhaustion.</S>
      <S N="Description">SQL Server has a feature called 'Availability Group' which provides automatic failover from a primary SQL Server to a secondary server. This concept is not new, but because SQL Server does warn that if the secondary SQL Server is not dedicated 100% to being a backup server, that "resource exhaustion" may be an issue if there is some load balancing going on._x000A__x000A_If the primary SQL Server has a backup/secondary server that is dedicated 100% to the primary server's process, this is not a finding. If, however, the processing of the primary SQL Server is loaded to a secondary server that is already partly resourced to process something other than that of the primary SQL Server responsibility, then there can be load balancing issues._x000A__x000A_Load balancing for the purpose of sharing a secondary/backup SQL Server is often done to share and save on resources.</S>
      <S N="FixText">Allocate replacement server(s) to provide failover support to the Primary SQL Server. _x000A__x000A_If a single solution cannot be employed, split the processing of a secondary SQL Server amongst two or more secondary servers.</S>
      <S N="Check">If Database Availability Groups are not being used, this is not applicable (NA)._x000A__x000A_Check the system documentation and check with the administrator regarding processing resources of the backup/secondary SQL Server. _x000A__x000A_If the primary SQL Server has a backup/secondary server that is dedicated 100% to the primary server's processing, this is not a finding._x000A__x000A_If the secondary/backup SQL Server is already partly resourced to process something other than that of the primary SQL Server processing, then determine what resources would be required for the secondary/backup SQL Server._x000A__x000A_If the secondary/backup SQL Server is determined to not have enough processing resources to fulfill the function of the primary server's SQL Server process, this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="390">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2012</S>
      <S N="VulnID">V-40909</S>
      <S N="RuleID">SV-53263r2_rule</S>
      <S N="Severity">low</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL2-00-022300</S>
      <S N="Title">SQL Server must limit the use of resources by priority and not impede the host from servicing processes designated as a higher priority.</S>
      <S N="Description">Priority protection helps prevent a lower-priority process from delaying or interfering with the information system servicing any higher-priority process. This control does not apply to components in the information system for which there is only a single user/role. The application must limit the use of resources by priority._x000A__x000A_SQL Server often runs queries for multiple users at the same time. If lower priority processes are utilizing a disproportionately high amount of database resources, this can severely impact higher priority processes._x000A__x000A_Even if SQL Server's utilization is very small and there may seem to be no need to priority protection, often resources grow exponentially and must be implemented as part of an initial deployment.</S>
      <S N="FixText">SQL Server utilizes the "Resource Governor" to determine who is allowed high processing resources. There are several configurations regarding the "Resource Governor" that mostly comes down to users or groups of users having a "MAX_CPU_PERCENT", "MIN_CPU_PERCENT", "MIN_MEMORY_PERCENT", and/or "MAX_MEMORY_PERCENT" settings._x000A__x000A_Users are assigned to Workgroups and the Workgroups are configured processing resources via the "Resource Governor".</S>
      <S N="Check">Review system documentation and determine if one type or more of SQL Server users has a business need for priority usage over other types of users. The need for prioritization most frequently occurs when SQL Server resources are shared between two or more applications or systems where the number of users on more than one system is small or non-existent. This needs to be the case, because SQL Server limits resource based on user accounts and not what process is running._x000A__x000A_If SQL Server has users that are determined to run significantly high priority processes than other users and the SQL Server "Resource Governor" is not being implemented, this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="391">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2012</S>
      <S N="VulnID">V-40910</S>
      <S N="RuleID">SV-53264r3_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL2-00-021500</S>
      <S N="Title">SQL Server must isolate security functions from nonsecurity functions by means of separate security domains.</S>
      <S N="Description">Security functions are defined as "the hardware, software, and/or firmware of the information system responsible for enforcing the system security policy and supporting the isolation of code and data on which the protection is based"._x000A__x000A_Developers and implementers can increase the assurance in security functions by employing well-defined security policy models; structured, disciplined, and rigorous hardware and software development techniques; and sound system/security engineering principles._x000A__x000A_Database Management Systems typically separate security functionality from nonsecurity functionality via separate databases or schemas. Database objects or code implementing security functionality should not be commingled with objects or code implementing application logic. When security and nonsecurity functionality is commingled, users who have access to nonsecurity functionality may be able to access security functionality.tru</S>
      <S N="FixText">Locate security-related database objects and code in a separate database, schema, or other separate security domain from database objects and code implementing application logic.</S>
      <S N="Check">Determine elements of security functionality (lists of permissions, additional authentication information, stored procedures, application specific auditing, etc.) which are being housed inside SQL server._x000A__x000A_For any elements found, check SQL Server to determine if these objects or code implementing security functionality are located in a separate security domain, such as a separate database or schema created specifically for security functionality._x000A__x000A_Run the following queryto list all the user-defined databases:_x000A_SELECT Name _x000A_FROM sys.databases _x000A_WHERE database_id &gt; 4 _x000A_ORDER BY 1;_x000A__x000A_If security-related database objects or code are not kept separate, this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="392">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2012</S>
      <S N="VulnID">V-40912</S>
      <S N="RuleID">SV-53266r3_rule</S>
      <S N="Severity">low</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL2-00-020400</S>
      <S N="Title">SQL Server must associate and maintain security labels when exchanging information between systems.</S>
      <S N="Description">When data is exchanged between information systems, the security attributes associated with said data need to be maintained.  _x000A__x000A_Security attributes are an abstraction representing the basic properties or characteristics of an entity with respect to safeguarding information, typically associated with internal data structures (e.g., records, buffers, files) within the information system and used to enable the implementation of access control and flow control policies, reflect special dissemination, handling or distribution instructions, or support other aspects of the information security policy. _x000A__x000A_Security attributes may be explicitly or implicitly associated with the information contained within the information system. _x000A__x000A_If database security labels are not maintained as information moves between systems, handling instructions can be lost and data can be accidentally distributed to unauthorized individuals.</S>
      <S N="FixText">Develop SQL code or acquire a third party tool to perform data labeling. SQL Server Label Security Toolkit can be downloaded from http://www.codeplex.com. This tool can satisfy all data labeling and security data labeling requirements.</S>
      <S N="Check">Review system documentation to determine if the labeling of sensitive data is required under organization-defined guidelines._x000A__x000A_If the labeling of sensitive data is not required, this is NA._x000A__x000A_Obtain system configuration setting to determine how data labeling is being performed. This can be through triggers or some other SQL developed means or via a third-party tool. Check to ensure that labels are being associated to data when information is being exchanged between systems.   _x000A__x000A_If the labeling is not being associated to data when exchanging data between systems, this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="393">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2012</S>
      <S N="VulnID">V-40913</S>
      <S N="RuleID">SV-53267r3_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL2-00-020300</S>
      <S N="Title">SQL Server must protect the integrity of publicly available information and SQL Servers configuration from unauthorized Server Roles access.</S>
      <S N="Description">The purpose of this control is to ensure organizations explicitly address the protection needs for public information and applications, with such protection likely being implemented as part of other security controls. If SQL Server contains publicly available information, though not concerned with confidentiality, SQL Server must maintain the integrity of the data. If data available to the public is not protected from unauthorized modification or deletion, then the data cannot be trusted by those accessing it._x000A__x000A_The user account associated with public access must not have access to the OS or SQL Server configuration information, include read access to schema information._x000A__x000A_This requirement is not intended to prevent the establishment of public-facing systems for the purpose of collecting data from the public.</S>
      <S N="FixText">Navigate to SQL Server Management Studio &gt;&gt; Object Explorer &gt;&gt; &lt;'SQL Server name'&gt; &gt;&gt; Security &gt;&gt; Logins &gt;&gt; right click &lt;'user account'&gt; &gt;&gt; Properties &gt;&gt; Server Roles._x000A__x000A_Uncheck the 'Server Roles' that are checked and grant more than read-only access to the publicly available information.</S>
      <S N="Check">If SQL Server is not housing or distributing publicly available information, this finding is NA._x000A__x000A_Obtain from the DBA or system documentation the list of publicly available data within SQL Server and the role names that assign read-only access to that public data._x000A__x000A_Obtain the publicly available user account name being used to access SQL Server._x000A__x000A_Navigate to Start &gt;&gt; Administrative Tools &gt;&gt; Server Manager &gt;&gt; Server Manager (&lt;'server name'&gt;) &gt;&gt; Configuration &gt;&gt; Local Users and Groups &gt;&gt; Groups &gt;&gt; right click 'Guests' &gt;&gt; Properties &gt;&gt; 'Members:'_x000A_The publicly available user account will likely be in the OS 'Guests' group._x000A__x000A_Determine if SQL Server is granting more than read access to the publicly available information through SQL Server 'Server Roles'._x000A__x000A_Navigate to SQL Server Management Studio &gt;&gt; Object Explorer &gt;&gt; &lt;'SQL Server name'&gt; &gt;&gt; Security &gt;&gt; Logins &gt;&gt; right click &lt;'user account'&gt; &gt;&gt; Properties &gt;&gt; Server Roles._x000A__x000A_If any 'Server Roles' are marked that grant more than read access to the publicly available information, this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="394">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2012</S>
      <S N="VulnID">V-40914</S>
      <S N="RuleID">SV-53268r3_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL2-00-020200</S>
      <S N="Title">SQL Server must protect the integrity of publicly available information and SQL Servers configuration from unauthorized User Mapping access.</S>
      <S N="Description">The purpose of this control is to ensure organizations explicitly address the protection needs for public information and applications, with such protection likely being implemented as part of other security controls. If SQL Server contains publicly available information, though not concerned with confidentiality, SQL Server must maintain the integrity of the data. If data available to the public is not protected from unauthorized modification or deletion, then the data cannot be trusted by those accessing it._x000A__x000A_The user account  associated with public access must not have access to the OS or SQL Server configuration information, include read access to schema information. This access includes, but is not limited to, SQL Server 'User Mapping' assignments._x000A__x000A_SQL Server access to any of the three system databases (master, model, or msdb) is restricted from the publicly available user account, because this would grant more than read-only access to public information. Of the existing user-defined databases, privileges must be checked to allow only read access to publically available data._x000A__x000A_This requirement is not intended to prevent the establishment of public-facing systems for the purpose of collecting data from the public.</S>
      <S N="FixText">Navigate to SQL Server Management Studio &gt;&gt; Object Explorer &gt;&gt; &lt;'SQL Server name'&gt; &gt;&gt; Security &gt;&gt; Logins &gt;&gt; right click &lt;'user account'&gt; &gt;&gt; Properties &gt;&gt; User Mapping &gt;&gt; highlight checked database._x000A__x000A_Uncheck the 'Database role membership' that is checked and grants more than read-only access to the publicly available information.</S>
      <S N="Check">If SQL Server is not housing or distributing publicly available information, this finding is NA._x000A__x000A_Obtain from the DBA or system documentation the list of publicly available data within SQL Server._x000A__x000A_Obtain the publicly available user account name being used to access SQL Server._x000A__x000A_Navigate to Start &gt;&gt; Administrative Tools &gt;&gt; Server Manager &gt;&gt; Server Manager (&lt;'server name'&gt;) &gt;&gt; Configuration &gt;&gt; Local Users and Groups &gt;&gt; Groups &gt;&gt; right click 'Guests' &gt;&gt; Properties &gt;&gt; 'Members:'_x000A_The publicly available user account will likely be in the OS 'Guests' group._x000A__x000A_Determine if SQL Server is granting more than read access to the publicly available information through SQL Server 'User Mapping'._x000A__x000A_Navigate to SQL Server Management Studio &gt;&gt; Object Explorer &gt;&gt; &lt;'SQL Server name'&gt; &gt;&gt; Security &gt;&gt; Logins &gt;&gt; right click &lt;'user account'&gt; &gt;&gt; Properties &gt;&gt; User Mapping._x000A__x000A_If any of the three system databases are checked (indicating a granted privilege): master, model, or msdb, this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="395">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2012</S>
      <S N="VulnID">V-40915</S>
      <S N="RuleID">SV-53269r3_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL2-00-020100</S>
      <S N="Title">SQL Server must protect the integrity of publicly available information and applications.</S>
      <S N="Description">The purpose of this control is to ensure organizations explicitly address the protection needs for public information and applications, with such protection likely being implemented as part of other security controls. If SQL Server contains publicly available information, though not concerned with confidentiality, SQL Server OS must maintain the integrity of the data. If data available to the public is not protected from unauthorized modification or deletion, then the data cannot be trusted by those accessing it._x000A__x000A_The user account associated with public access must not have access to the OS configuration information. Determine what publicly available user account is being used to access SQL Server and validate that the publicly available user account only has read access to the public data and nothing else._x000A__x000A_The OS level 'Guests' role grants connection access to the server without granting any other privileges. SQL Server configuration settings are used to grant access to the publicly available information, but this control ensures that the OS only is granted connection access to the server._x000A__x000A_This requirement is not intended to prevent the establishment of public-facing systems for the purpose of collecting data from the public.</S>
      <S N="FixText">Using an account with System Administrator privileges, from a command prompt, type lusrmgr.msc, and press [ENTER]._x000A_Navigate to Groups._x000A__x000A_Locate the additional group(s) from which the publicly available user account must be removed._x000A__x000A_Right click &lt;'the group to modify' &gt;&gt; Properties &gt;&gt; 'Members:'_x000A__x000A_Remove the publicly available user account from the group by clicking/highlighting the account and then clicking the 'Remove' button._x000A__x000A_Revoke any update permissions for a guest being used in the context of a guest account.</S>
      <S N="Check">If SQL Server is not housing or distributing publicly available information, this finding is NA._x000A__x000A_If SQL Server supports an application collecting information from the public, this is NA._x000A__x000A_Obtain the publicly available user account name being used to access SQL Server._x000A__x000A_Using an account with System Administrator privileges, from a command prompt, type lusrmgr.msc, and press [ENTER]._x000A_Navigate to Groups &gt;&gt; right click 'Guests' &gt;&gt; Properties &gt;&gt; 'Members:'_x000A_The publicly available user account will be in the OS 'Guests' group, or another explicitly defined group._x000A__x000A_Determine if the obtained publicly available user account is located in any other groups._x000A__x000A_In lusrmgr.msc, navigate to Users. Right click publicly available account name. Click Properties, then click the 'Member of' tab._x000A__x000A_If the publicly available user account is found in any group 'Members' listing other than 'Guests', this is a finding._x000A__x000A_In SQL, for the account that is used for public access, ensure that read-only access is the only access granted. If any other access is granted, this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="396">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2012</S>
      <S N="VulnID">V-40916</S>
      <S N="RuleID">SV-53270r3_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL2-00-020000</S>
      <S N="Title">SQL Server must protect the integrity of publicly available information and SQL Servers configuration from unauthorized Securables access.</S>
      <S N="Description">The purpose of this control is to ensure organizations explicitly address the protection needs for public information and applications, with such protection likely being implemented as part of other security controls._x000A__x000A_SQL Server must be configured to contain publicly available information. Though not concerned with confidentiality, SQL Server must maintain the integrity of the data. If data available to the public is not protected from unauthorized modification or deletion, then the data cannot be trusted by those accessing it. A publicly available user account must not have access to the OS or SQL Server configuration information, including read access to schema information. Determine what publicly available user account is being used to access SQL Server and validate that the publicly available user account only has read access to the public data and nothing else. This read-only access does not include SQL Server 'Securables' assignments._x000A__x000A_SQL Server 'Securables' assignments grant the assignee privileges that are beyond read access to data. No public user account must have SQL Server 'Securables' privileges. Any assigned 'Securables' privileges to the public user account must be removed._x000A__x000A_Likely the only 'Server roles' assignment for the publicly available user account would be 'public'. The only other 'Server roles' that could be authorized as read-only is a user-defined 'Server role'. It is more likely that read-only access is set up at the user database instance in role(s) specifically set up for this purpose. Assignment to the user database instances are made in the 'User Mapping' highlight within a user's properties._x000A__x000A_This requirement is not intended to prevent the establishment of public-facing systems for the purpose of collecting data from the public.</S>
      <S N="FixText">Navigate to SQL Server Management Studio &gt;&gt; Object Explorer &gt;&gt; &lt;'SQL Server name'&gt; &gt;&gt; Security &gt;&gt; Logins &gt;&gt; right click &lt;'user account'&gt; &gt;&gt; Properties &gt;&gt; Securables &gt;&gt; highlight 'Securable Name'._x000A__x000A_Uncheck all 'Grant', 'With Grant', and 'Deny' for the highlighted 'Securable'.</S>
      <S N="Check">If SQL Server is not housing or distributing publicly available information, this finding is NA._x000A__x000A_If SQL Server supports an application collecting information from the public, this is NA._x000A__x000A_Obtain from the DBA or system documentation the list of publicly available data within SQL Server._x000A_Obtain the publicly available user account(s) being used to access SQL Server. _x000A__x000A_Determine if SQL Server is granting more than read access to the publicly available information through SQL Server 'Securables'._x000A__x000A_Navigate to SQL Server Management Studio &gt;&gt; Object Explorer &gt;&gt; &lt;'SQL Server name'&gt; &gt;&gt; Security &gt;&gt; Logins &gt;&gt; right click &lt;'user account'&gt; &gt;&gt; Properties &gt;&gt; Securables._x000A__x000A_If any 'Securables' are listed, this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="397">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2012</S>
      <S N="VulnID">V-40917</S>
      <S N="RuleID">SV-53271r4_rule</S>
      <S N="Severity">high</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL2-00-019600</S>
      <S N="Title">SQL Server databases in the classified environment, containing classified or sensitive information, must be encrypted using approved cryptography.</S>
      <S N="Description">Cryptography is only as strong as the encryption modules/algorithms employed to encrypt the data._x000A__x000A_Use of weak or untested encryption algorithms undermines the purposes of utilizing encryption to protect data._x000A__x000A_Data files that are not encrypted are vulnerable to theft. When data files are not encrypted, they can be copied and opened on a separate system. The data can be compromised without the information owner's knowledge that the theft has even taken place._x000A__x000A_NSA has developed Type 1 algorithms for protecting classified information. The Committee on National Security Systems (CNSS) National Information Assurance Glossary (CNSS Instruction No. 4009) defines Type 1 products as:_x000A_“Cryptographic equipment, assembly or component classified or certified by NSA for encrypting and decrypting classified and sensitive national security information when appropriately keyed._x000A_Developed using established NSA business processes and containing NSA approved algorithms are used to protect systems requiring the most stringent protection mechanisms.”_x000A__x000A_NSA-approved cryptography is required to be used for classified information system processing._x000A__x000A_See FIPS Publication 140-2 and related documents for guidance on approved encryption techniques and certified encryption modules.tru</S>
      <S N="FixText">Configure SQL Server to encrypt sensitive or classified data stored in each database. Use only NIST-certified or NSA-approved cryptography to provide encryption.</S>
      <S N="Check">If the system exists in the non-classified environment, this is NA._x000A__x000A_For each database under the SQL Server instance, review the system documentation to determine whether the database holds classified or sensitive information. If it does not, this is not a finding._x000A__x000A_If it does handle classified or sensitive information, review the system documentation and configuration to determine whether the classified information is protected by NSA- and NIST-approved cryptography.  If not, this is a finding._x000A__x000A_If DBMS data encryption is required, ensure the status of encryption by executing:_x000A__x000A_SELECT_x000A_      d.name AS [Database Name],_x000A_      CASE e.encryption_state_x000A_            WHEN 0 THEN 'No database encryption key present, no encryption'_x000A_            WHEN 1 THEN 'Unencrypted'_x000A_            WHEN 2 THEN 'Encryption in progress'_x000A_            WHEN 3 THEN 'Encrypted'_x000A_            WHEN 4 THEN 'Key change in progress'_x000A_            WHEN 5 THEN 'Decryption in progress'_x000A_            WHEN 6 THEN 'Protection change in progress'_x000A_      END AS [Encryption State]_x000A_FROM sys.dm_database_encryption_keys e_x000A_RIGHT JOIN sys.databases d ON DB_NAME(e.database_id) = d.name_x000A_WHERE d.name NOT IN ('master','model','msdb')_x000A_ORDER BY 1_x000A_;_x000A_For each user database where encryption is required, verify that encryption is in effect. If not, this is a finding._x000A_</S>
    </MS>
  </Obj>
  <Obj RefId="398">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2012</S>
      <S N="VulnID">V-40918</S>
      <S N="RuleID">SV-53272r6_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL2-00-019800</S>
      <S N="Title">SQL Server must employ NSA-approved cryptography to protect classified information.</S>
      <S N="Description">Cryptography is only as strong as the encryption modules/algorithms employed to encrypt the data. Use of weak or untested encryption algorithms undermines the purposes of utilizing encryption to protect data._x000A__x000A_NSA has developed Type 1 algorithms for protecting classified information. The Committee on National Security Systems (CNSS) National Information Assurance Glossary (CNSS Instruction No. 4009) defines Type 1 products as:_x000A_“Cryptographic equipment, assembly or component classified or certified by NSA for encrypting and decrypting classified and sensitive national security information when appropriately keyed._x000A_Developed using established NSA business processes and containing NSA approved algorithms are used to protect systems requiring the most stringent protection mechanisms.”_x000A__x000A_NSA-approved cryptography is required to be used for classified information system processing.</S>
      <S N="FixText">Document within the system documentation the type of information hosted on SQL Server: classified, sensitive, and/or unclassified._x000A__x000A_Obtain and utilize native or third-party NIST-validated FIPS 140-2 compliant cryptography solution on SQL Server._x000A__x000A_Configure cryptographic functions to use FIPS 140-2 compliant algorithms functions._x000A__x000A_Use DoD certificates to create asymmetric keys stored in the database and used to encrypt sensitive data stored in the database._x000A__x000A_Run the following SQL script to create a certificate:_x000A_USE &lt;database name&gt;_x000A_CREATE CERTIFICATE &lt;certificate name&gt;_x000A_   ENCRYPTION BY PASSWORD = '&lt;password&gt;'_x000A_   FROM FILE = '&lt;path/file_name&gt;'_x000A_   WITH SUBJECT = '&lt;name of person creating key&gt;',_x000A_   EXPIRY_DATE = '&lt;expiration date: yyyymmdd&gt;'_x000A__x000A_Run the following SQL script to create a symmetric key and assign an existing certificate:_x000A_USE &lt;database name&gt;_x000A_CREATE SYMMETRIC KEY &lt;'key name'&gt;_x000A_   WITH ALGORITHM = AES_256 _x000A_   ENCRYPTION BY CERTIFICATE &lt;certificate name&gt;_x000A__x000A_Assign the application object owner account as the owner of asymmetric and symmetric keys, and certificates.  (Ownership is assigned via the AUTHORIZATION clause of the CREATE statement, or the ALTER AUTHORIZATION statement.)_x000A__x000A_Create audit events for access to the key by other than the application owner account or approved application objects.  (If using a server-level SQL Server Audit specification, DATABASE_OBJECT_PERMISSION_CHANGE_GROUP accomplishes this.)_x000A__x000A_Revoke any privileges on encryption keys assigned to principals other than the application object owner account and authorized users._x000A__x000A_Protect the private key by encrypting it with the database or service master key._x000A__x000A_For whole-database encryption (Transparent Data Encryption - TDE):_x000A_USE master;_x000A_CREATE MASTER KEY ENCRYPTION BY PASSWORD = '&lt;password&gt;';_x000A_CREATE CERTIFICATE &lt;certificate name&gt; . . .;_x000A_USE &lt;database name&gt;;_x000A_CREATE DATABASE ENCRYPTION KEY_x000A_WITH ALGORITHM = AES_256_x000A_ENCRYPTION BY SERVER CERTIFICATE &lt;certificate name&gt;;_x000A_ALTER DATABASE &lt;database name&gt;_x000A_SET ENCRYPTION ON;_x000A_</S>
      <S N="Check">Review system documentation to determine whether cryptography for classified or sensitive information is required by the information owner._x000A__x000A_If the system documentation does not specify the type of information hosted on SQL Server: classified, sensitive and/or unclassified, this is a finding._x000A__x000A_If neither classified nor sensitive information exists within SQL Server databases or configuration, this requirement is NA._x000A_Note:  If the SQL Server is compliant, nothing is displayed._x000A__x000A_If cryptography is being used by SQL Server, examine evidence that an audit record is created whenever the asymmetric key is accessed by other than authorized users. In particular, view evidence that access by a SYSADMIN or other system privileged account results in the generation of an audit record. This is required because system privileges allow access to encryption keys and can be used to access sensitive data where there is not a need-to-know._x000A__x000A_Note:  The list of acceptable algorithms: "AES 128", "AES 192", "AES 256" and "Triple DES"._x000A__x000A_If cryptography is being used by SQL Server, verify that the cryptography is NIST FIPS 140-2 certified by running the following SQL query:_x000A_EXEC sp_MSforeachdb_x000A_'_x000A_DECLARE @nCount integer;_x000A__x000A_SELECT @nCount = Count(*)_x000A_  FROM [?].sys.symmetric_keys_x000A_ WHERE key_algorithm NOT IN (''D3'',''A1'',''A2'',''A3'');_x000A__x000A_IF @nCount &gt; 0_x000A_   SELECT ''?'' AS ''database ?''_x000A_        , name_x000A_        , algorithm_desc_x000A_     FROM [?].sys.symmetric_keys_x000A_    WHERE key_algorithm NOT IN (''D3'',''A1'',''A2'',''A3'')_x000A_    ORDER BY name, algorithm_desc;_x000A_'_x000A_;_x000A__x000A_If any items list showing an uncertified NIST FIPS 140-2 algorithm type, this is a finding._x000A_If an audit record is not generated for unauthorized access to the asymmetric key, this is a finding._x000A__x000A_Detailed information on the NIST Cryptographic Module Validation Program (CMVP) is available at the following website:  http://csrc.nist.gov/groups/STM/cmvp/index.html.</S>
    </MS>
  </Obj>
  <Obj RefId="399">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2012</S>
      <S N="VulnID">V-40919</S>
      <S N="RuleID">SV-53273r3_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL2-00-018900</S>
      <S N="Title">SQL Server must uniquely identify and authenticate non-organizational users (or processes acting on behalf of non-organizational users).</S>
      <S N="Description">Non-organizational users include all information system users other than organizational users, which include organizational employees or individuals the organization deems to have equivalent status of employees (e.g., contractors, guest researchers, individuals from allied nations)._x000A__x000A_Non-organizational users shall be uniquely identified and authenticated for all accesses other than those accesses explicitly identified and documented by the organization when related to the use of anonymous access, such as accessing a web server._x000A__x000A_This may be accomplished by a code embedded within the userid, or via a flag or code columns in a table of users, or by some other means. In any case, the user must be individually identified to, and within, SQL Server via a mapping to an individual account and not mapping to a shared account. _x000A__x000A_Accordingly, a risk assessment is used in determining the authentication needs of the organization._x000A__x000A_Scalability, practicality, and security are simultaneously considered in balancing the need to ensure ease of use for access to federal information and information systems with the need to protect and adequately mitigate risk to organizational operations, organizational assets, individuals, and other organizations.</S>
      <S N="FixText">Configure SQL Server to uniquely identify and authenticate all non-organizational users who log onto the system. This likely would be done via a combination of the operating system with unique accounts and the SQL Server by ensuring mapping to individual accounts.</S>
      <S N="Check">Review documentation, SQL Server settings and authentication system settings to determine if non-organizational users are individually identified and authenticated when logging onto the system._x000A__x000A_If non-organizational users are not uniquely identified and authenticated, this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="400">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2012</S>
      <S N="VulnID">V-40922</S>
      <S N="RuleID">SV-53276r2_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL2-00-018600</S>
      <S N="Title">SQL Server must enforce password encryption for storage.</S>
      <S N="Description">SQL Server must enforce password encryption when storing passwords. Passwords need to be protected at all times, and encryption is the standard method for protecting passwords. If passwords are not encrypted, they can be plainly read and easily compromised._x000A__x000A_Passwords stored in clear text are vulnerable to unauthorized disclosure. Database passwords should always be encoded or encrypted when stored internally or externally to SQL Server.</S>
      <S N="FixText">Develop, document, and maintain a list of SQL Server database objects, database configuration files, associated scripts, and applications defined within or external to SQL Server that access the database/user environment files/settings in the System Security Plan._x000A__x000A_Record whether they do or do not contain SQL Server passwords. If passwords are present, ensure they are encrypted.</S>
      <S N="Check">Since Windows security is being leveraged, this check applies to database configuration files, associated scripts, and applications external to SQL Server that access the database.  _x000A__x000A_Ask the DBA and/or IAO to determine if any SQL Server database objects, database configuration files, associated scripts, or applications defined as external to SQL Server that access the database/user environment files/settings contain database passwords. If any do, confirm that SQL Server passwords stored externally to the SQL Server are encoded or encrypted. If any passwords are stored in clear text, this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="401">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2012</S>
      <S N="VulnID">V-40923</S>
      <S N="RuleID">SV-53277r3_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL2-00-018500</S>
      <S N="Title">SQL Server must ensure users are authenticated with an individual authenticator prior to using a shared authenticator.</S>
      <S N="Description">To ensure individual accountability and prevent unauthorized access, application users (and any processes acting on behalf of users) must be individually identified and authenticated._x000A__x000A_A shared authenticator is a generic account used by multiple individuals. Use of a shared authenticator alone does not uniquely identify individual users. An example of a shared authenticator is the UNIX OS 'root' user account, a Windows 'administrator' account, an 'sa' account, or a 'helpdesk' account._x000A__x000A_Legitimate use of shared accounts includes, for example, connection pooling.  Since this is insufficient to ensure non-repudiation, such shared accounts should be kept "under the covers," be inaccessible directly to end users, be invoked only after successful individual authentication, be communicated to the DBMS by the application, and be recorded in all relevant audit contexts._x000A__x000A_(Shared accounts should not be confused with Windows groups, which are used in role-based access control.)</S>
      <S N="FixText">Remove user-accessible shared accounts and use individual userids._x000A__x000A_Build/configure applications to ensure successful individual authentication prior to shared account access._x000A__x000A_Ensure each user's identity is received and used in audit data in all relevant circumstances.</S>
      <S N="Check">Review SQL Server users to determine whether shared accounts exist._x000A__x000A_If accounts are determined to be shared, determine if individuals are first individually authenticated. If individuals are not individually authenticated before using the shared account (e.g., by the operating system or possibly by an application making calls to the database), this is a finding._x000A__x000A_If accounts are determined to be shared, determine if they are directly accessible to end users.  If so, this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="402">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2012</S>
      <S N="VulnID">V-40924</S>
      <S N="RuleID">SV-53278r3_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL2-00-018400</S>
      <S N="Title">SQL Server must uniquely identify and authenticate organizational users (or processes acting on behalf of organizational users).</S>
      <S N="Description">To ensure accountability and prevent unauthorized SQL Server access, organizational users shall be identified and authenticated._x000A__x000A_Organizational users include organizational employees or individuals the organization deems to have equivalent status of employees (e.g., contractors, guest researchers, individuals from allied nations)._x000A__x000A_Users (and any processes acting on behalf of users) are uniquely identified and authenticated for all accesses other than those accesses explicitly identified and documented by the organization, which outlines specific user actions that can be performed on SQL Server without identification or authentication.</S>
      <S N="FixText">Remove user-accessible shared accounts and use individual userids._x000A__x000A_Build/configure applications to ensure successful individual authentication prior to shared account access._x000A__x000A_Ensure each user's identity is received and used in audit data in all relevant circumstances.</S>
      <S N="Check">Review SQL Server users to determine whether shared accounts exist. (This does not include when SQL Server has a guest or public account that is providing access to publicly available information.)_x000A__x000A_If accounts are determined to be shared, determine if individuals are first individually authenticated. If individuals are not individually authenticated before using the shared account (e.g., by the operating system or possibly by an application making calls to the database), this is a finding._x000A__x000A_If accounts are determined to be shared, determine if they are directly accessible to end users.  If so, this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="403">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2012</S>
      <S N="VulnID">V-40925</S>
      <S N="RuleID">SV-53279r2_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL2-00-018300</S>
      <S N="Title">SQL Server software libraries must be periodically backed up.</S>
      <S N="Description">SQL Server backups are a critical step in maintaining data assurance and availability._x000A__x000A_System-level information includes system-state information, operating system and application software, and licenses._x000A__x000A_Backups shall be consistent with organization-defined recovery time and recovery point objectives._x000A__x000A_SQL Server depends upon the availability and integrity of its software libraries. Without backups, compromise or loss of the software libraries can prevent a successful recovery of SQL Server operations._x000A__x000A_A mixture of full and incremental server-level backups by a third-party tool that backs up those software library directories would satisfy this requirement.</S>
      <S N="FixText">Ensure inclusion of all SQL Server software libraries into the backup process.</S>
      <S N="Check">Review evidence of inclusion of SQL Server software libraries in current backup records._x000A_If the backup tool does not include SQL Server, this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="404">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2012</S>
      <S N="VulnID">V-40926</S>
      <S N="RuleID">SV-53280r2_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL2-00-018200</S>
      <S N="Title">SQL Server backups of system-level information per organization-defined frequency must be performed that is consistent with recovery time and recovery point objectives.</S>
      <S N="Description">SQL Server backups are a critical step in maintaining data assurance and availability._x000A__x000A_System-level information includes:  system-state information, operating system and application software, and licenses._x000A__x000A_Backups shall be consistent with organizationally defined recovery time and recovery point objectives._x000A__x000A_SQL Server depends upon the availability and integrity of its system-level information. Without backups, compromise or loss of system-level information can prevent a successful recovery of SQL Server operations. If SQL Server system-level information is not backed up regularly this risks the loss of SQL Server data in the event of a system failure._x000A__x000A_A mixture of full and incrementally server level backups that backup the system-level information would satisfy this requirement.</S>
      <S N="FixText">Deploy a backup solution to perform backups as per organizationally defined Backup Policy.</S>
      <S N="Check">Windows Server Backup, or a 3rd Party Backup Tool, can be utilized to perform this function. Determine how SQL Server is being backed up. If there is no scheduled backup or if organizationally defined backup policy and procedures does not exist, this is finding._x000A__x000A_Check evidence of inclusion of system-level information into current backup records, if the organizationally defined backup policy, procedures, and backup configurations is not including system-level information backups, this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="405">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2012</S>
      <S N="VulnID">V-40927</S>
      <S N="RuleID">SV-53281r2_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL2-00-018100</S>
      <S N="Title">SQL Server backup and restoration files must be protected from unauthorized access.</S>
      <S N="Description">SQL Server backups are a critical step in maintaining data assurance and availability._x000A__x000A_User-level information is data generated by information system and/or application users. In order to assure availability of this data in the event of a system failure, DoD organizations are required to ensure user generated data is backed up at a defined frequency. This includes data stored on file systems, within databases or within any other storage media._x000A__x000A_Applications performing backups must be capable of backing up user-level information per the DoD-defined frequency._x000A__x000A_Lost or compromised SQL Server backup or restoration files may lead to not only the loss of data, but also the unauthorized access to sensitive data._x000A__x000A_SQL Server can maintain local copies of critical control files to provide transparent or easy recovery from hard disk loss or other interruptions to database operation._x000A__x000A_Backup files, both local to the SQL Server machine and not local to the machine, need the same protections against unauthorized access when stored on backup media as when online and actively in use by the database system. In addition, the backup media needs to be protected against physical loss.</S>
      <S N="FixText">Develop, document, and implement protection against unauthorized access of backup and restoration files._x000A__x000A_Document personnel and the level of access authorized for each to the backup and restoration files in the system documentation.</S>
      <S N="Check">Obtain authorized access list for backup and restoration procedures from system documentation._x000A__x000A_If documented procedures are insufficient to show or describe authorized personnel, this is a finding._x000A__x000A_Review file protections assigned to online backup and restoration files._x000A__x000A_Review access protections and procedures for offline backup and restoration files._x000A__x000A_If backup or restoration files are subject to unauthorized access, this is a finding._x000A__x000A_It may be necessary to review backup and restoration procedures to determine ownership and access during all phases of backup and recovery. In addition to physical and host system protections, consider other methods including encryption protection of the files.</S>
    </MS>
  </Obj>
  <Obj RefId="406">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2012</S>
      <S N="VulnID">V-40928</S>
      <S N="RuleID">SV-53282r2_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL2-00-017900</S>
      <S N="Title">SQL Server recovery procedures that are documented must be implemented and periodically tested.</S>
      <S N="Description">SQL Server backups are a critical step in maintaining data assurance and availability._x000A__x000A_User-level information is data generated by the information system and/or application users. In order to assure availability of this data in the event of a system failure, DoD organizations are required to ensure user-generated data is backed up at a defined frequency. This includes data stored on file systems, within SQL Server or within any other storage media._x000A__x000A_Applications performing backups must be capable of backing up user-level information per the DoD-defined frequency._x000A__x000A_Problems with backup procedures or backup media may not be discovered until after a recovery is needed. Testing and verification of procedures provides the opportunity to discover oversights, conflicts, or other issues in the backup procedures or use of media designed to be used._x000A__x000A_Part of an overall backup and recovery methodology includes regular recovery testing. This is very important and helps to expose any issue in the recovery process (e.g., hardware, procedures, etc.).</S>
      <S N="FixText">Develop or update recovery procedures and add the new recovery procedures to the system documentation._x000A__x000A_Plan for and test system recovery procedures and document the test.</S>
      <S N="Check">Review SQL Server's documented testing and recovery procedures that exist in the system documentation._x000A__x000A_If the testing or recovery procedures are not documented in the system documentation, this is a finding._x000A__x000A_If the documented testing or recovery procedures are not sufficient to test or recover SQL Server configuration and databases, this is a finding._x000A__x000A_Review evidence of implementation of testing and verification procedures by reviewing logs from backup and recovery implementation. Logs may be in electronic form or hardcopy, and may include email or other notification._x000A__x000A_If the system recovery testing has not been implemented and documented, this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="407">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2012</S>
      <S N="VulnID">V-40929</S>
      <S N="RuleID">SV-53283r2_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL2-00-017800</S>
      <S N="Title">SQL Server backup procedures must be defined, documented, and implemented.</S>
      <S N="Description">SQL Server backup is a critical step in maintaining data assurance and availability._x000A__x000A_User-level information is data generated by the information system and/or application users. In order to assure availability of this data in the event of a system failure, DoD organizations are required to ensure user-generated data is backed up at a defined frequency. This includes data stored on file systems, within SQL Server or within any other storage media._x000A__x000A_Applications performing backups must be configured to back up user-level information per the DoD-defined frequency._x000A__x000A_SQL Server Database backups provide the required means to restore databases after compromise or loss. Backups help reduce the vulnerability to unauthorized access or hardware loss.</S>
      <S N="FixText">Develop, document, and implement database backup procedures.</S>
      <S N="Check">Review the database backup procedures and implementation evidence._x000A__x000A_Evidence of implementation includes records of backup events and physical review of backup media._x000A__x000A_Evidence should match the backup plan as recorded in the system documentation._x000A__x000A_If backup procedures do not exist or are not implemented in accordance with the procedures, this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="408">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2012</S>
      <S N="VulnID">V-40930</S>
      <S N="RuleID">SV-53284r2_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL2-00-017700</S>
      <S N="Title">SQL Server user-level information must be backed up based on a defined frequency.</S>
      <S N="Description">SQL Server backups are a critical step in maintaining data assurance and availability._x000A__x000A_User-level information is data generated by information system and/or application users. In order to assure availability of this data in the event of a system failure, DoD organizations are required to ensure user generated data is backed up at a defined frequency. This includes data stored on file systems, within SQL Server or within any other storage media._x000A__x000A_Applications performing backups must be capable of backing up user-level information per the DoD defined frequency._x000A__x000A_Databases that do not backup information regularly risk the loss of that information in the event of a system failure.</S>
      <S N="FixText">Deploy a backup solution to perform backups as per organizationally defined Backup Policy.</S>
      <S N="Check">Windows Server Backup, or a 3rd Party Backup Tool, can be utilized to perform this function. Determine how SQL Server is being backed up. If there is no scheduled backup or if organizationally defined backup policy and procedures does not exist, this is finding._x000A__x000A_Check evidence of inclusion user-level information into current backup records, if the organizationally defined backup policy, procedures, and backup configurations is not including user-level information backups, this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="409">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2012</S>
      <S N="VulnID">V-40932</S>
      <S N="RuleID">SV-53286r4_rule</S>
      <S N="Severity">high</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL2-00-017500</S>
      <S N="Title">SQL Server must recover to a known state that is verifiable.</S>
      <S N="Description">Application recovery and reconstitution constitutes executing an information system contingency plan comprising activities that restore essential missions and business functions._x000A__x000A_SQL Server utilizes transaction-based processing and is a good example of information systems that are transaction-based. Transaction rollback and transaction journaling are examples of mechanisms supporting transaction recovery._x000A__x000A_SQL Server may be vulnerable to use of compromised data or other critical files during recovery. Use of compromised files could introduce maliciously altered application code, relaxed security settings, or loss of data integrity. SQL Server mechanisms must be configured to protect all files that could compromise the system or its data during a SQL Server recovery.</S>
      <S N="FixText">Implement SQL Server recovery procedures to ensure the use of trusted files during SQL Server recovery._x000A__x000A_Modify the parameters for the transaction log file(s) for the system databases:_x000A__x000A_Navigate to SQL Server Management Studio &gt;&gt; Object Explorer &gt;&gt; &lt;SQL Server instance name&gt; &gt;&gt; Databases &gt;&gt; System Databases &gt;&gt; right-click on &lt;system database name&gt; &gt;&gt; Properties &gt;&gt; Files._x000A__x000A_OR_x000A__x000A_Modify the parameters for the transaction log file(s) for application databases:_x000A__x000A_Navigate to SQL Server Management Studio &gt;&gt; Object Explorer &gt;&gt; &lt;SQL Server instance name&gt; &gt;&gt; Databases &gt;&gt; right-click on &lt;user-defined database name&gt; &gt;&gt; Properties &gt;&gt; Files._x000A__x000A_THEN_x000A__x000A_Define additional space for the transaction log file, or extra transaction log files, as necessary._x000A__x000A_To modify Initial Size (MB), click in the "Initial Size (MB)" field for the log file in question, then edit the value._x000A__x000A_To modify Autogrowth, click on the "Autogrowth/Maxsize" button for the log file in question, choose "In Percent" or "In Megabytes", enter value, and then click OK._x000A__x000A_To modify Maximum File Size, click on the "Autogrowth/Maxsize" button for the log file in question, choose "Limited to (MB)", enter value, and then click OK. Do not select "Unlimited".</S>
      <S N="Check">Obtain the SQL Server recovery procedures and technical system features to determine if mechanisms exist and are in place to specify use of trusted files during SQL Server recovery._x000A__x000A_If recovery procedures do not exist or are not sufficient to ensure recovery is done in a secure and verifiable manner, this is a finding._x000A__x000A_Check the configurations of all transaction log files that are enabled by running the following SQL Server query:_x000A__x000A_EXEC sp_MSforeachdb_x000A_'_x000A_SELECT ''?'' AS ''database name''_x000A_       , name AS ''log file name''_x000A_       , physical_name AS ''log file location and name''_x000A_       , state_desc_x000A_       , size_x000A_       , max_size_x000A_       , growth_x000A_       , is_percent_growth_x000A_  FROM [?].sys.database_files_x000A_ WHERE type_desc = ''LOG''_x000A_   AND state = 0;_x000A_'_x000A_; _x000A__x000A_If any transaction log files are not configured correctly for size, max_size, and growth to log sufficient transaction information, this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="410">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2012</S>
      <S N="VulnID">V-40933</S>
      <S N="RuleID">SV-53287r3_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL2-00-017400</S>
      <S N="Title">SQL Server must support the organizational requirements to specifically prohibit or restrict the use of unauthorized functions, ports, protocols, and/or services.</S>
      <S N="Description">Information systems are capable of providing a wide variety of functions and services. Some of the functions and services, provided by default, may not be necessary to support essential organizational operations (e.g., key missions, functions). _x000A__x000A_Additionally, it is sometimes convenient to provide multiple services from a single component of an information system (e.g., email and web services) but doing so increases risk over limiting the services provided by any one component.  _x000A__x000A_To support the requirements and principles of least functionality, the application must support the organizational requirements providing only essential capabilities and limiting the use of ports, protocols, and/or services to only those required, authorized, and approved to conduct official business or to address authorized quality of life issues._x000A__x000A_Database Management Systems using ports, protocols, and services deemed unsafe are open to attack through those ports, protocols, and services. This can allow unauthorized access to the database and, through the database, to other components of the information system._x000A__x000A_For detailed guidance on Ports, Protocols, and Services Management (PPSM), refer to the PPSM section of the Information Assurance Support Environment (IASE) web site, at http://iase.disa.mil/ppsm/Pages/index.aspx.</S>
      <S N="FixText">Disable functions, ports, protocols, and services that are not approved or are not used, but are enabled.</S>
      <S N="Check">Review the SQL Server configuration and settings for functions, ports, protocols, and services that are not approved or are not used, but are available._x000A__x000A_To determine the protocol(s) enabled for SQL Server, open SQL Server Configuration Manager.  In the left-hand pane, expand SQL Server Network Configuration.  Click on the entry for the SQL Server instance under review:  "Protocols for &lt;instance name&gt;".  The right-hand pane displays the protocols enabled for the instance._x000A__x000A_To determine whether SQL Server is configured to use a fixed port or dynamic ports, in the right-hand pane double-click on the TCP/IP entry, to open the Properties dialog.  (The default fixed port is 1433.)_x000A__x000A_To see which ports are open on the server, run netstat-a from a Windows command prompt._x000A__x000A_If any ports, protocols, and/or services that are not approved or are not used, are available, this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="411">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2012</S>
      <S N="VulnID">V-40934</S>
      <S N="RuleID">SV-53288r3_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL2-00-017300</S>
      <S N="Title">SQL Server must specifically prohibit or restrict the use of unauthorized functions and services in each instance.</S>
      <S N="Description">SQL Server is capable of providing a wide variety of functions and services. Some of the functions and services, provided by default, may not be necessary to support essential organizational operations (e.g., key missions, functions)._x000A__x000A_Additionally, it is sometimes convenient to provide multiple services from a single component of an information system (e.g., email and web services), but doing so increases risk over limiting the services provided by any one component.</S>
      <S N="FixText">To remove a function from SQL Server, run the following SQL Script:_x000A_DROP FUNCTION &lt;'function name'&gt;_x000A__x000A_To remove a Stored Procedure from SQL Server, run the following SQL Script:_x000A_DROP PROCEDURE &lt;'stored procedure name'&gt;_x000A__x000A_If the user-defined Stored Procedures and Functions need to remain available, but access needs to be more restricted, then the user-defined Stored Procedures and Functions should be moved to a separate schema or database that has more restrictive access.</S>
      <S N="Check">Review the list of user-defined Stored Procedures and Functions by running the following SQL query:_x000A_EXEC sp_MSforeachdb_x000A_'_x000A_DECLARE @nCount integer;_x000A__x000A_SELECT @nCount = Count(*)_x000A_  FROM [?].sys.objects_x000A_ WHERE type in (''FN'', ''P'')_x000A_   AND is_ms_shipped &lt;&gt; 1;_x000A__x000A_IF @nCount &gt; 0_x000A_SELECT ''?'' AS ''Table Name'', *_x000A_  FROM [?].sys.objects_x000A_ WHERE type in (''FN'', ''P'')_x000A_   AND is_ms_shipped &lt;&gt; 1;_x000A_'_x000A_;_x000A__x000A_If any user-defined Stored Procedures and Functions are unauthorized and therefore should be prohibited or restricted and are not, this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="412">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2012</S>
      <S N="VulnID">V-40935</S>
      <S N="RuleID">SV-53289r2_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL2-00-017200</S>
      <S N="Title">Access to xp_cmdshell must be disabled.</S>
      <S N="Description">Information systems are capable of providing a wide variety of functions and services. Some of the functions and services, provided by default, may not be necessary to support essential organizational operations (e.g., key missions, functions).  _x000A__x000A_It is detrimental for applications to provide, or install by default, functionality exceeding requirements or mission objectives. Examples include, but are not limited to, installing advertising software, demonstrations, or browser plug-ins not related to requirements; or providing a wide array of functionality not required for every mission, but which cannot be disabled. _x000A__x000A_Applications must adhere to the principles of least functionality by providing only essential capabilities._x000A__x000A_DBMSs may spawn additional external processes to execute procedures that are defined in the DBMS, but stored in external host files (external procedures). The spawned process used to execute the external procedure may operate within a different OS security context than the DBMS and provide unauthorized access to the host system._x000A__x000A_The xp_cmdshell extended stored procedure allows execution of host executables outside the controls of database access permissions. This access may be exploited by malicious users who have compromised the integrity of the SQL Server database process to control the host operating system to perpetrate additional malicious activity.</S>
      <S N="FixText">To disable the use of xp_cmdshell, from the query prompt:_x000A_EXEC sp_configure 'show advanced options', 1_x000A_GO_x000A__x000A_RECONFIGURE_x000A_GO_x000A__x000A_EXEC sp_configure 'xp_cmdshell', 0_x000A_GO_x000A__x000A_RECONFIGURE_x000A_GO</S>
      <S N="Check">To determine if xp_cmdshell is enabled, execute the following commands:_x000A__x000A_EXEC SP_CONFIGURE 'show advanced option', '1';_x000A_RECONFIGURE WITH OVERRIDE;_x000A_EXEC SP_CONFIGURE 'xp_cmdshell';_x000A__x000A_If the value of config_value is 1, this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="413">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2012</S>
      <S N="VulnID">V-40936</S>
      <S N="RuleID">SV-53290r3_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL2-00-017100</S>
      <S N="Title">SQL Server default account sa must be disabled.</S>
      <S N="Description">SQL Server's 'sa' account has special privileges required to administer the database. The 'sa' account is a well-known SQL Server account and is likely to be targeted by attackers and thus more prone to providing unauthorized access to the database._x000A__x000A_This 'sa' default account is administrative and could lead to catastrophic consequences, including the complete loss of control over SQL Server._x000A__x000A_If the 'sa' default account is not disabled, an attacker might be able to gain access through the account. SQL Server by default, at installation, disables the 'sa' account._x000A__x000A_Some applications that run on SQL Server require the 'sa' account to be enabled in order for the application to function properly. These applications that require the 'sa' account to be enabled are usually legacy systems.tru</S>
      <S N="FixText">Modify the enabled flag of SQL Server's "sa" (sysadmin) account by running the following script.  If the account name has been changed per SQL2-00-010200, replace the letters "sa" in the query with the new name._x000A__x000A_USE master;_x000A_GO_x000A_ALTER LOGIN [sa] DISABLE;</S>
      <S N="Check">Check SQL Server settings to determine if the 'sa' (sysadmin) account has been disabled by executing the following query:_x000A__x000A_USE MASTER_x000A_GO_x000A_SELECT name, is_disabled _x000A_FROM sys.sql_logins _x000A_WHERE principal_id = 1;_x000A__x000A_Verify that the "name" column contains the current name of the sa database server account (see note)._x000A__x000A_If the "is_disabled" column is not set to 1, this is a finding._x000A__x000A_Note:  If the 'sa' account name has been changed per SQL2-00-010200, its new name should appear in the query results.</S>
    </MS>
  </Obj>
  <Obj RefId="414">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2012</S>
      <S N="VulnID">V-40937</S>
      <S N="RuleID">SV-53291r3_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL2-00-017000</S>
      <S N="Title">Unused database components that are integrated in SQL Server and cannot be uninstalled must be disabled.</S>
      <S N="Description">SQL Server is capable of providing a wide variety of functions and services. Some of the functions and services, provided by default, may not be necessary to support essential organizational operations (e.g., key missions, functions)._x000A__x000A_It is detrimental for applications to provide, or install by default, functionality exceeding requirements or mission objectives. Examples include, but are not limited to, installing advertising software demonstrations, or browser plug-ins not related to requirements or providing a wide array of functionality not required for every mission, but which cannot be disabled._x000A__x000A_Applications must adhere to the principles of least functionality by providing only essential capabilities._x000A__x000A_Unused and unnecessary SQL Server components increase the number of available attack vectors to SQL Server by introducing additional targets for attack. By minimizing the services and applications installed on the system, the number of potential vulnerabilities is reduced. Components of the system that are unused and cannot be uninstalled must be disabled.</S>
      <S N="FixText">If any components or features of SQL Server are required for operation of applications that will be accessing SQL Server data or configuration, include them in the system documentation._x000A__x000A_If any unused components or features of SQL Server are installed and cannot be uninstalled or removed, then disable those components or features.</S>
      <S N="Check">Review the components and features included in SQL Server and capable of being disabled (by configuration settings, permissions and privileges, etc.).  Take note of those which are enabled._x000A__x000A_Review the system documentation to verify that the enabled components or features are documented and authorized.  If any enabled components or features are not authorized, this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="415">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2012</S>
      <S N="VulnID">V-40938</S>
      <S N="RuleID">SV-53292r2_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL2-00-016800</S>
      <S N="Title">SQL Server must have the SQL Server Analysis Service (SSAS) software component removed from SQL Server if SSAS is unused.</S>
      <S N="Description">Information systems are capable of providing a wide variety of functions and services. Some of the functions and services, provided by default, may not be necessary to support essential organizational operations (e.g., key missions, functions)._x000A__x000A_It is detrimental for applications to provide or install by default, functionality exceeding requirements or mission objectives. Examples include, but are not limited to, installing advertising software demonstrations or browser plug-ins not related to requirements or providing a wide array of functionality not required for every mission, yet cannot be disabled. _x000A__x000A_Applications must adhere to the principles of least functionality by providing only essential capabilities._x000A__x000A_Unused and unnecessary SQL Server components increase the number of available attack vectors to SQL Server by introducing additional targets for attack. By minimizing the services and applications installed on the system, the number of potential vulnerabilities is reduced._x000A__x000A_SQL Server must have the SQL Server Analysis Service (SSAS) software component removed from SQL Server if SSAS is unused.</S>
      <S N="FixText">Remove the SQL Server Analysis Service (SSAS) software component.</S>
      <S N="Check">If the SQL Server service "SQL Server Analysis Services (MSSQLSERVER)" is used and the service satisfies functional organizational requirement, this is not a finding._x000A__x000A_If there is no functional organizational requirement for the "SQL Server Analysis Services (MSSQLSERVER)" service make sure that the service is not installed or is disabled._x000A__x000A_From command prompt, using an account with System Administrator Privilege, open dcomcnfg. Navigate to Console Root &gt;&gt; Services (Local) &gt;&gt; [sort by name] &gt;&gt; locate: "SQL Server Analysis Services (MSSQLSERVER)"._x000A__x000A_If the "SQL Server Analysis Services (MSSQLSERVER)" service does not exist, this is not a finding._x000A__x000A_If the "SQL Server Analysis Services (MSSQLSERVER)" status is "Started" or the "Startup Type" is not "Disabled", this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="416">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2012</S>
      <S N="VulnID">V-40939</S>
      <S N="RuleID">SV-53293r2_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL2-00-016700</S>
      <S N="Title">SQL Server must have the SQL Server Integrated Services (SSIS) software component removed from SQL Server if SSIS is unused.</S>
      <S N="Description">Information systems are capable of providing a wide variety of functions and services. Some of the functions and services, provided by default, may not be necessary to support essential organizational operations (e.g., key missions, functions)._x000A__x000A_It is detrimental for applications to provide or install by default, functionality exceeding requirements or mission objectives. Examples include, but are not limited to, installing advertising software demonstrations or browser plug-ins not related to requirements or providing a wide array of functionality not required for every mission, yet cannot be disabled._x000A__x000A_Applications must adhere to the principles of least functionality by providing only essential capabilities._x000A__x000A_Unused and unnecessary SQL Server components increase the number of available attack vectors to SQL Server by introducing additional targets for attack. By minimizing the services and applications installed on the system, the number of potential vulnerabilities is reduced._x000A__x000A_SQL Server must have the SQL Server Integrated Services (SSIS) software component removed from SQL Server if SSIS is unused.</S>
      <S N="FixText">Remove the SQL Server Integrated Services (SSIS) software component.</S>
      <S N="Check">If the SQL Server service "SQL Server Integration Services 11.0" is used and the service satisfies functional organizational requirement, this is not a finding._x000A__x000A_If there is no functional organizational requirement for the "SQL Server Integration Services 11.0" service make sure that the service is not installed or is disabled._x000A__x000A_From command prompt, using an account with System Administrator Privilege, open dcomcnfg. Navigate to Console Root &gt;&gt; Services (Local) &gt;&gt; [sort by name] &gt;&gt; locate: "SQL Server Integration Services 11.0"._x000A__x000A_If the "SQL Server Integration Services 11.0" service does not exist, this is not a finding._x000A__x000A_If the "SQL Server Integration Services 11.0" status is "Started" or the "Startup Type" is not "Disabled", this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="417">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2012</S>
      <S N="VulnID">V-40940</S>
      <S N="RuleID">SV-53294r2_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL2-00-016600</S>
      <S N="Title">SQL Server must have the SQL Server Reporting Service (SSRS) software component removed from SQL Server if SSRS is unused.</S>
      <S N="Description">Information systems are capable of providing a wide variety of functions and services. Some of the functions and services, provided by default, may not be necessary to support essential organizational operations (e.g., key missions, functions)._x000A__x000A_It is detrimental for applications to provide or install by default, functionality exceeding requirements or mission objectives. Examples include, but are not limited to, installing advertising software demonstrations or browser plug-ins not related to requirements or providing a wide array of functionality not required for every mission, yet cannot be disabled._x000A__x000A_Applications must adhere to the principles of least functionality by providing only essential capabilities._x000A__x000A_Unused and unnecessary SQL Server components increase the number of available attack vectors to SQL Server by introducing additional targets for attack. By minimizing the services and applications installed on the system, the number of potential vulnerabilities is reduced._x000A__x000A_SQL Server must have the SQL Server Reporting Service (SSRS) software component removed from SQL Server if SSRS is unused.</S>
      <S N="FixText">Remove the SSRS from SQL Server.</S>
      <S N="Check">If there is no functional organizational requirement for the "SQL Server Reporting Services (MSSQLSERVER)" service, make sure that the service is not installed or that the service is disabled._x000A__x000A_If the SQL Server service "SQL Server Reporting Services (MSSQLSERVER)" is used and the service satisfies functional organizational requirement, this is not a finding._x000A__x000A__x000A_From command prompt, using an account with System Administrator Privilege, open dcomcnfg. Navigate to Console Root &gt;&gt; Services (Local) &gt;&gt; [sort by name] &gt;&gt; locate: "SQL Server Reporting Services (MSSQLSERVER)"._x000A__x000A_If the "SQL Server Reporting Services (MSSQLSERVER)" service does not exist, this is not a finding._x000A__x000A_If the "SQL Server Reporting Services (MSSQLSERVER)" status is "Started" or the "Startup Type" is not set to "Disabled", this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="418">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2012</S>
      <S N="VulnID">V-40941</S>
      <S N="RuleID">SV-53295r2_rule</S>
      <S N="Severity">high</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL2-00-016500</S>
      <S N="Title">SQL Server must have the SQL Server Data Tools (SSDT) software component removed from SQL Server if SSDT is unused.</S>
      <S N="Description">Information systems are capable of providing a wide variety of functions and services. Some of the functions and services, provided by default, may not be necessary to support essential organizational operations (e.g., key missions, functions).  _x000A__x000A_It is detrimental for applications to provide, or install by default, functionality exceeding requirements or mission objectives. Examples include, but are not limited to, installing advertising software, demonstrations, or browser plug-ins not related to requirements or providing a wide array of functionality not required for every mission, yet cannot be disabled. _x000A__x000A_Applications must adhere to the principles of least functionality by providing only essential capabilities._x000A__x000A_Unused and unnecessary DBMS components increase the attack vector for the DBMS by introducing additional targets for attack. By minimizing the services and applications installed on the system, the number of potential vulnerabilities is reduced._x000A__x000A__x000A_SQL Server must have the SQL Server Data Tools (SSDT) software component removed from SQL Server if SSDT is unused.</S>
      <S N="FixText">Document the requirement for SQL Server Data Tools to reside on this server._x000A__x000A_If it is not required, using an account with System Administrator privileges, from Command Prompt, open control.exe._x000A__x000A_Navigate to Programs and Features. Remove the following entries in the 'Uninstall or change a program' window._x000A__x000A_Microsoft SQL Server Data Tools - Database Projects - Web installer entry point_x000A_Prerequisites for SSDT</S>
      <S N="Check">Review the list of components and features installed with the database. Using an account with System Administrator privileges, from Command Prompt, open control.exe._x000A__x000A_Navigate to Programs and Features. Check for the following entries in the 'Uninstall or change a program' window._x000A__x000A_Microsoft SQL Server Data Tools - Database Projects - Web installer entry point_x000A_Prerequisites for SSDT_x000A__x000A_If SQL Server Data Tools is not documented as a server requirement, and these entries exist, this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="419">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2012</S>
      <S N="VulnID">V-40942</S>
      <S N="RuleID">SV-53296r3_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL2-00-016300</S>
      <S N="Title">SQL Server must have the publicly available AdventureWorks sample database removed.</S>
      <S N="Description">Information systems are capable of providing a wide variety of functions and services. Some of the functions and services, provided by default, may not be necessary to support essential organizational operations (e.g., key missions, functions)._x000A__x000A_It is detrimental for applications to provide, or install by default, functionality exceeding requirements or mission objectives. Examples include, but are not limited to, installing advertising software, demonstrations, or browser plug-ins not related to requirements and providing a wide array of functionality not required for every mission, but which cannot be disabled._x000A__x000A_Applications must adhere to the principles of least functionality by providing only essential capabilities. Even though the very popular "AdventureWorks" database is no longer available by default, it introduces a vulnerability to SQL Server and must be removed._x000A__x000A_Demonstration and sample database objects and applications present publicly known attack points for malicious users. These demonstration and sample objects are meant to provide simple examples of coding specific functions and are not developed to prevent vulnerabilities from being introduced to the SQL Server and the OS.</S>
      <S N="FixText">Remove the publicly available "AdventureWorks" database from SQL Server by running the following query:_x000A__x000A_DROP DATABASE AdventureWorks</S>
      <S N="Check">Check SQL Server for the existence of the publicly available "AdventureWorks" database by performing the following query:_x000A__x000A_SELECT name from sysdatabases where name like 'AdventureWorks%';_x000A__x000A_If the "AdventureWorks" database is present, this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="420">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2012</S>
      <S N="VulnID">V-40943</S>
      <S N="RuleID">SV-53297r3_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL2-00-016200</S>
      <S N="Title">SQL Server must have the publicly available NorthWind sample database removed.</S>
      <S N="Description">Information systems are capable of providing a wide variety of functions and services. Some of the functions and services, provided by default, may not be necessary to support essential organizational operations (e.g., key missions, functions)._x000A__x000A_It is detrimental for applications to provide, or install by default, functionality exceeding requirements or mission objectives. Examples include, but are not limited to, installing advertising software, demonstrations, or browser plug-ins not related to requirements and providing a wide array of functionality not required for every mission, but which cannot be disabled._x000A__x000A_Applications must adhere to the principles of least functionality by providing only essential capabilities. Even though the very popular "NorthWind" database is no longer available by default, it introduces a vulnerability to SQL Server and must be removed._x000A__x000A_Demonstration and sample database objects and applications present publicly known attack points for malicious users. These demonstration and sample objects are meant to provide simple examples of coding specific functions and are not developed to prevent vulnerabilities from being introduced to the SQL Server and the OS.</S>
      <S N="FixText">Remove the publicly available "Northwind" database from SQL Server by running the following query:_x000A__x000A__x000A_DROP DATABASE Northwind</S>
      <S N="Check">Check SQL Server for the existence of the publicly available "NorthWind" database by performing the following query:_x000A__x000A_SELECT name from sysdatabases where name like 'Northwind%';_x000A__x000A_If the "Northwind" database is present, this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="421">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2012</S>
      <S N="VulnID">V-40944</S>
      <S N="RuleID">SV-53298r8_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL2-00-015800</S>
      <S N="Title">The OS must limit privileges to change SQL Server software resident within software libraries (including privileged programs).</S>
      <S N="Description">When dealing with change control issues, it should be noted, any changes to the hardware, software, and/or firmware components of the information system can potentially have significant effects on the overall security of the system._x000A__x000A_If any user were allowed to make changes to software libraries, then those changes might be implemented without undergoing the appropriate testing and approvals that are part of a robust change management process.  The DBMS software libraries contain the executables used by the DBMS to operate. Unauthorized access to the libraries can result in compromised installations. This may in turn jeopardize data stored in the DBMS and/or operation of the host system._x000A__x000A_Accordingly, only qualified and authorized individuals shall be allowed to obtain access to information system components for purposes of initiating changes, including upgrades and modifications._x000A__x000A_Of particular note in this context is that any software installed for auditing and/or audit file management must be protected and monitored.tru</S>
      <S N="FixText">Navigate to the SQL Server software directory (\binn) location. Right-click the folder, click Properties. On the Security tab, modify the security permissions, so that files and folders that are part of the SQL Server 2012 installation have at most the following privileges. Right-click each folder under the installation folder, click Properties. On the Security tab, modify the security permissions, so that at most the following permissions are present:_x000A_Trusted Installer (Full Control)_x000A_CREATOR OWNER (Full Control)_x000A_SYSTEM (Full Control)_x000A_Administrators (Full Control) [See Note 3]_x000A_Users (Read, List Folder Contents, Read &amp; Execute)_x000A_Creator Owner (Special Permissions - Full control - Subfolders and files only)_x000A_All Application Packages (Read &amp; Execute) [Only as needed - see Note 4]_x000A_SQL Server Service SID OR Service Account (Read &amp; Execute) [Notes 1, 2]_x000A_SQL Server SQL Agent Service SID OR Service Account, if SQL Server Agent is in use. (Full Control) [Notes 1, 2]_x000A_SQL Server FD Launcher Service SID OR Service Account, if full-text indexing is in use. (Read &amp; Execute) [Notes 1, 2]_x000A_System Administrators (Full Control) [Note 3]_x000A_Repeat the above for the \Install folder._x000A__x000A_Navigate to the ...\Microsoft SQL Server\110\Shared folder. On the Security tab, modify the security permissions, so that at most the following permissions are present:_x000A_Trusted Installer (Full Control)_x000A_CREATOR OWNER (Full Control)_x000A_System (Full Control)_x000A_SQL Server Service SID OR Service Account (Read &amp; Execute) [Notes 1, 2]_x000A_System Administrators (Full Control) [Note 3]_x000A_Local Administrators (Read)_x000A_SQL Server Analysis Services (SSAS) Service SID or Service Account, if SSAS is in use (Read &amp; Execute) [Notes 1, 2]_x000A_SQL Server SQL Agent Service SID OR Service Account, if SQL Server Agent is in use. (Read, Execute, Write) [Notes 1, 2]_x000A_SQL Server FD Launcher Service SID OR Service Account, if full-text indexing is in use. (Read, Write) [Notes 1, 2]_x000A_Users (Read, List Folder Contents, Read &amp; Execute)_x000A_[MsDtsServer110 (Read &amp; Execute) is also permitted, if SSIS/DTS is in use.]_x000A_[NT AUTHORITY\NETWORK SERVICE (Read &amp; Execute) may also be required for SQL Server Configuration Manager to operate.]_x000A__x000A_-----_x000A__x000A_Note 1: It is highly advisable to use a separate account for each service. When installing SQL Server in single-server mode, you can opt to have these provisioned for you. These automatically generated accounts are referred to as virtual accounts. Each virtual account has an equivalent Service SID, with the same name. The installer also creates an equivalent SQL Server login, also with the same name. Applying folder and file permissions to Service SIDs, rather than to domain accounts or local computer accounts, provides tighter control because these permissions are available only to the specific service when it is running and not in any other context. (However, when using failover clustering, a domain account must be specified at installation, rather than a virtual account.) For more on this topic, see http://msdn.microsoft.com/en-us/library/ms143504(v=sql.110).aspx._x000A__x000A_Note 2: Tips for adding a service SID/virtual account to a folder's permission list._x000A_1) In Windows Explorer, right-click on the folder and select "Properties."_x000A_2) Select the "Security" tab_x000A_3) Click "Edit"_x000A_4) Click "Add"_x000A_5) Click "Locations"_x000A_6) Select the computer name_x000A_7) Search for the name_x000A_7.a) SQL Server Service_x000A_7.a.i) Type "NT SERVICE\MSSQL" and click "Check Names". (What you have just typed in is the first 16 characters of the name. At least one character must follow "NT SERVICE\"; you will be presented with a list of all matches. If you have typed in the full, correct name, step 7.a.ii is bypassed.)_x000A_7.a.ii) Select the "MSSQL$&lt;instance name&gt;" user and click "OK"_x000A_7.b) SQL Agent Service_x000A_7.b.i) Type "NT SERVICE\SQL" and click "Check Names"_x000A_7.b.ii) Select the "SQLAgent$&lt;instance name&gt;" user and click "OK"_x000A_8) Click "OK"_x000A_9) Permission like a normal user from here_x000A__x000A_Note 3: In the interest of separation of responsibilities with least privilege, consider granting Full Control only to SQL Database Administrators (create a custom group for these) and providing the local Administrators group with Read access only. _x000A__x000A_Note 4: Some files also require 'ALL APPLICATION PACKAGES (READ, EXECUTE)' permissions for certain functionality to work appropriately, and this is considered acceptable where those permissions are required. (All SQL Server files that require this access reside by default in the ..\Microsoft SQL Server\110\ directory.)</S>
      <S N="Check">Obtain the SQL Server software directory location: from a command prompt, open the registry editor by typing regedit.exe and pressing [ENTER]. Navigate to the following registry location:_x000A_HKEY_LOCAL_MACHINE_x000A_&gt;&gt; SOFTWARE_x000A_&gt;&gt; Microsoft_x000A_&gt;&gt; Microsoft SQL Server_x000A_&gt;&gt; [INSTANCE NAME]_x000A_&gt;&gt; Setup_x000A_&gt;&gt; SQLBinRoot_x000A__x000A_In the registry tree, the [INSTANCE NAME] for a SQL Server 2012 database engine instance is normally shown as "MSSQL11" followed by a period and the name that was specified for the SQL Server service at installation time. If multiple SQL Server instances are installed, each will have its own [INSTANCE NAME] node and subtree in the registry._x000A__x000A_The value in the Data column for the SQLBinRoot registry entry is the file system path for the SQL Server 2012 binaries. Navigate to that folder location using a command prompt or Windows Explorer. The following instructions assume that Windows Explorer is used._x000A__x000A_Verify that files and folders that are part of the SQL Server 2012 instance have only authorized privileges. Right-click the binaries (\binn) folder, click Properties. On the Security tab, verify that at most the following permissions are present:_x000A_Trusted Installer (Full Control)_x000A_CREATOR OWNER (Full Control)_x000A_SYSTEM (Full Control)_x000A_Administrators (Full Control) [See Note 3]_x000A_Users (Read, List Folder Contents, Read &amp; Execute)_x000A_Creator Owner (Special Permissions - Full control - Subfolders and files only)_x000A_All Application Packages (Read &amp; Execute) [Only as needed - see Note 4]_x000A_SQL Server Service SID OR Service Account (Read &amp; Execute) [Notes 1, 2]_x000A_SQL Server SQL Agent Service SID OR Service Account, if SQL Server Agent is in use. (Full Control) [Notes 1, 2]_x000A_SQL Server FD Launcher Service SID OR Service Account, if full-text indexing is in use. (Read &amp; Execute) [Notes 1, 2]_x000A_System Administrators (Full Control) [Note 3]_x000A__x000A_If any less restrictive permissions are present (and not specifically justified and approved), this is a finding._x000A__x000A_Right-click each folder under the binaries folder; click Properties. On the Security tab, verify that at most the permissions listed in the preceding paragraph are present._x000A_If any less restrictive permissions are present (and not specifically justified and approved), this is a finding._x000A__x000A_Right-click the \Install folder, which is a peer of \binn, under ...\MSSQL. On the Security tab, verify that at most the permissions listed in the preceding paragraphs are present. If any less restrictive permissions are present (and not specifically justified and approved), this is a finding._x000A__x000A__x000A_Locate the ...\Microsoft SQL Server\110\Shared folder, either by stepping up the tree in Windows Explorer or by finding the file path in the registry at:_x000A_HKEY_LOCAL_MACHINE_x000A_&gt;&gt; SOFTWARE_x000A_&gt;&gt; Microsoft_x000A_&gt;&gt; Microsoft SQL Server_x000A_&gt;&gt; 110_x000A_&gt;&gt; SharedCode_x000A__x000A_Right-click on the ...\110\Shared folder; click Properties. On the Security tab, verify that at most the following permissions are present:_x000A_Trusted Installer (Full Control)_x000A_CREATOR OWNER (Full Control)_x000A_System (Full Control)_x000A_SQL Server Service SID OR Service Account (Read &amp; Execute) [Notes 1, 2]_x000A_System Administrators (Full Control) [Note 3]_x000A_Local Administrators (Read)_x000A_SQL Server Analysis Services (SSAS) Service SID or Service Account, if SSAS is in use (Read &amp; Execute) [Notes 1, 2]_x000A_SQL Server SQL Agent Service SID OR Service Account, if SQL Server Agent is in use. (Read, Execute, Write) [Notes 1, 2]_x000A_SQL Server FD Launcher Service SID OR Service Account, if full-text indexing is in use. (Read, Write) [Notes 1, 2]_x000A_Users (Read, List Folder Contents, Read &amp; Execute)_x000A_[MsDtsServer110 (Read &amp; Execute) is also permitted, if SSIS/DTS is in use.]_x000A_[NT AUTHORITY\NETWORK SERVICE (Read &amp; Execute) may also be required for SQL Server Configuration Manager to operate.]_x000A__x000A_If any less restrictive permissions are present (and not specifically justified and approved), this is a finding._x000A__x000A_Right-click each folder under the ...\110\Shared folder; click Properties. On the Security tab, verify that at most the permissions listed in the preceding paragraph are present. If any less restrictive permissions are present (and not specifically justified and approved), this is a finding._x000A__x000A_-----_x000A__x000A_Note 1: It is highly advisable to use a separate account for each service. When installing SQL Server in single-server mode, you can opt to have these provisioned for you. These automatically generated accounts are referred to as virtual accounts. Each virtual account has an equivalent Service SID, with the same name. The installer also creates an equivalent SQL Server login, also with the same name. Applying folder and file permissions to Service SIDs, rather than to domain accounts or local computer accounts, provides tighter control because these permissions are available only to the specific service when it is running and not in any other context. (However, when using failover clustering, a domain account must be specified at installation, rather than a virtual account.) For more on this topic, see http://msdn.microsoft.com/en-us/library/ms143504(v=sql.110).aspx._x000A__x000A_Note 2: Tips for adding a service SID/virtual account to a folder's permission list._x000A_1) In Windows Explorer, right-click on the folder and select "Properties."_x000A_2) Select the "Security" tab_x000A_3) Click "Edit"_x000A_4) Click "Add"_x000A_5) Click "Locations"_x000A_6) Select the computer name_x000A_7) Search for the name_x000A_7.a) SQL Server Service_x000A_7.a.i) Type "NT SERVICE\MSSQL" and click "Check Names". (What you have just typed in is the first 16 characters of the name. At least one character must follow "NT SERVICE\"; you will be presented with a list of all matches. If you have typed in the full, correct name, step 7.a.ii is bypassed.)_x000A_7.a.ii) Select the "MSSQL$&lt;instance name&gt;" user and click "OK"_x000A_7.b) SQL Agent Service_x000A_7.b.i) Type "NT SERVICE\SQL" and click "Check Names"_x000A_7.b.ii) Select the "SQLAgent$&lt;instance name&gt;" user and click "OK"_x000A_8) Click "OK"_x000A_9) Permission like a normal user from here_x000A__x000A_Note 3: In the interest of separation of responsibilities with least privilege, consider granting Full Control only to SQL Database Administrators (create a custom group for these) and providing the local Administrators group with Read access only. _x000A__x000A_Note 4: Some files also require 'ALL APPLICATION PACKAGES (READ, EXECUTE)' permissions for certain functionality to work appropriately, and this is considered acceptable where those permissions are required. (All SQL Server files that require this access reside by default in the ..\Microsoft SQL Server\110\ directory.)_x000A_</S>
    </MS>
  </Obj>
  <Obj RefId="422">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2012</S>
      <S N="VulnID">V-40945</S>
      <S N="RuleID">SV-53299r3_rule</S>
      <S N="Severity">high</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL2-00-015700</S>
      <S N="Title">Vendor-supported software and patches must be evaluated and patched against newly found vulnerabilities.</S>
      <S N="Description">Security faults with software applications and operating systems are discovered daily. Vendors are constantly updating and patching their products to address newly discovered security vulnerabilities. Organizations (including any contractor to the organization) are required to promptly install security-relevant software updates (e.g., patches, service packs, and hot fixes). Flaws discovered during security assessments, continuous monitoring, incident response activities, or information system error handling must also be addressed expeditiously._x000A__x000A_Any time new software code is introduced to a system there is the potential for unintended consequences. There have been documented instances where the application of a patch has caused problems with system integrity or availability. Due to information system integrity and availability concerns, organizations must give careful consideration to the methodology used to carry out automatic updates._x000A__x000A_If SQL Server were no longer supported, no patches from Microsoft would address newly discovered security vulnerabilities. Unpatched software is vulnerable to attack.</S>
      <S N="FixText">Upgrade SQL Server to the Microsoft-supported version._x000A__x000A_Apply the latest SQL Server patches after evaluation of impact.</S>
      <S N="Check">Check Microsoft's list of supported SQL Server versions.  To locate the correct web page, perform a web search for "Microsoft SQL Server end of support."_x000A__x000A_To be considered supported, Microsoft must report that the version is supported by security patches to known vulnerabilities._x000A__x000A_Check SQL Server version by running the following command:_x000A_print @@version_x000A__x000A_If the security patch support for SQL Server cannot be determined or SQL Server version is not shown as supported, this is a finding._x000A__x000A_If SQL Server does not contain the latest security patches, this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="423">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2012</S>
      <S N="VulnID">V-40946</S>
      <S N="RuleID">SV-53300r4_rule</S>
      <S N="Severity">low</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL2-00-015500</S>
      <S N="Title">Database software directories, including SQL Server configuration files, must be stored in dedicated directories, separate from the host OS and other applications.</S>
      <S N="Description">When dealing with change control issues, it should be noted any changes to the hardware, software, and/or firmware components of the information system and/or application can potentially have significant effects on the overall security of the system. _x000A__x000A_Multiple applications can provide a cumulative negative effect. A vulnerability and subsequent exploit of one application can lead to an exploit of other applications sharing the same security context. For example, an exploit of a web server process that leads to unauthorized administrative access to host system directories can most likely lead to a compromise of all applications hosted by the same system. Database software not installed using dedicated directories both threatens and is threatened by other hosted applications. Access controls defined for one application may by default provide access to other applications’ database objects or directories. Any method that provides any level of separation of security context assists in the protection between applications.</S>
      <S N="FixText">Separate database files (software, data) into dedicated directories.</S>
      <S N="Check">Verify the SQL Server installations present on the server._x000A__x000A_From a Command Prompt, type regedit.exe, and press [ENTER]._x000A__x000A_Navigate to HKEY_LOCAL_MACHINE &gt;&gt; SOFTWARE &gt;&gt; Microsoft &gt;&gt; Microsoft SQL Server &gt;&gt; Instance Names. Each instance installed on the server possesses a key inside a folder under this registry entry._x000A__x000A_Analysis Services Instances are registered in the OLAP subfolder._x000A_Reporting Services Instances are registered in the RS subfolder._x000A_Standard SQL Server Instances are registered in the SQL subfolder._x000A__x000A_Inside each of these folders, a single key is used to reference an Instance's specific Windows Registry tree. Each key will have its own registry tree at the following registry location: _x000A__x000A_HKEY_LOCAL_MACHINE &gt;&gt; SOFTWARE &gt;&gt; Microsoft &gt;&gt; Microsoft SQL Server &gt;&gt; [INSTANCE NAME]._x000A__x000A_An [INSTANCE NAME] is listed as the Data component of a key found in one of the above OLAP, RS, or SQL folders.  _x000A__x000A_To find the installation location of a particular instance, navigate to the following location in the Windows Registry:_x000A__x000A_HKEY_LOCAL_MACHINE &gt;&gt; SOFTWARE &gt;&gt; Microsoft &gt;&gt; Microsoft SQL Server &gt;&gt; [INSTANCE NAME] &gt;&gt; Setup.  _x000A__x000A_Examine the value of the 'SqlProgramDir' key. The value of the 'SqlProgramDir' key is the SQL Server installation directory for that SQL Server Instance._x000A__x000A_Navigate to that folder location using a Command Prompt or Windows Explorer. Only applications that are required for the functioning and administration, not use, of the SQL Server should be located on the same directory node as the SQL Server software libraries._x000A__x000A_If any files or subfolders that are not part of the SQL Server installation are in the folder, this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="424">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2012</S>
      <S N="VulnID">V-40947</S>
      <S N="RuleID">SV-53301r2_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL2-00-015400</S>
      <S N="Title">SQL Server software installation account(s) must be restricted to authorized users.</S>
      <S N="Description">When dealing with change control issues, it should be noted, any changes to the hardware, software, and/or firmware components of the information system and/or application can potentially have significant effects on the overall security of the system._x000A__x000A_If the application were to allow any user to make changes to software libraries, then those changes might be implemented without undergoing the appropriate testing and approvals that are part of a robust change management process._x000A__x000A_This requirement is contingent upon the language in which the application is programmed, as many application architectures in use today incorporate their software libraries into, and make them inseparable from, their compiled distributions, rendering them static and version dependant. However, this requirement does apply to applications with software libraries accessible and configurable, as in the case of interpreted languages._x000A__x000A_Accordingly, only qualified and authorized individuals shall be allowed to obtain access to information system components for purposes of initiating changes, including upgrades and modifications._x000A__x000A_DBA and other privileged administrative or application owner accounts are granted privileges that allow actions that can have a greater impact on SQL Server security and operation. It is especially important to grant access to privileged accounts to only those persons who are qualified and authorized to use them.</S>
      <S N="FixText">From a Command Prompt, open lusrmgr.msc.  Navigate to Users &gt;&gt; right click individual user &gt;&gt; Properties &gt;&gt; Member Of._x000A__x000A__x000A_Configure SQL Server &amp; OS settings and access controls, to restrict user access to objects and data that the user is authorized to view or interact with._x000A__x000A_Develop, document, and implement procedures to restrict use of the DBMS software installation account.</S>
      <S N="Check">Check system documentation for policy and procedures to restrict use of the SQL Server software installation account._x000A__x000A__x000A_Check OS settings to determine whether users are restricted from accessing SQL Server objects and data they are not authorized to access by checking the local OS user accounts._x000A_From a Command Prompt, open lusrmgr.msc. Navigate to Users &gt;&gt; right click individual user &gt;&gt; Properties &gt;&gt; Member Of._x000A__x000A__x000A_If appropriate access controls for all users are not implemented to restrict access to only authorized users and to restrict the access of those users to objects and data they are authorized, this is a finding._x000A__x000A__x000A_Review procedures for controlling and granting access to use of the SQL Server software installation account._x000A__x000A_If access or use of this account is not restricted to the minimum number of personnel required, or unauthorized access to this account has been granted, this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="425">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2012</S>
      <S N="VulnID">V-40948</S>
      <S N="RuleID">SV-53302r5_rule</S>
      <S N="Severity">high</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL2-00-015350</S>
      <S N="Title">Software, applications, and configuration files that are part of, or related to, the SQL Server 2012 installation must be monitored to discover unauthorized changes.</S>
      <S N="Description">When dealing with change control issues, it should be noted, any changes to the hardware, software, and/or firmware components of applications and tools related to SQL Server can potentially have significant effects on the overall security of the system. Only qualified and authorized individuals shall be allowed to obtain access to components related to SQL Server for purposes of initiating changes, including upgrades and modifications._x000A__x000A_Unmanaged changes that occur to the software libraries or configuration can lead to unauthorized or compromised installations._x000A__x000A_Of particular note in this context is that any software installed for auditing and/or audit file management must be protected and monitored._x000A_tru</S>
      <S N="FixText">Include locations of all files, libraries, scripts, and executables that are part of, or related to, the SQL Server 2012 installation in the documentation._x000A__x000A_Deploy a security and data integrity tool for monitoring and alerting files and folders based on cryptographic hashes, to verify files/folder locations as listed in the documentation.</S>
      <S N="Check">If a security and data integrity tool is not used for monitoring and alerting files and folders based on cryptographic hashes, this is a finding._x000A__x000A_If the tool does not verify files/folder locations as listed in the documentation, this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="426">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2012</S>
      <S N="VulnID">V-40949</S>
      <S N="RuleID">SV-53303r2_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL2-00-015300</S>
      <S N="Title">SQL Server must monitor for security-relevant configuration settings to discover unauthorized changes.</S>
      <S N="Description">When dealing with change control issues, it should be noted, any changes to security-relevant configuration settings of SQL Server can potentially have significant effects on the overall security of the system._x000A__x000A_If SQL Server were to allow any user to make changes to configuration settings, then those changes might be implemented without undergoing the appropriate testing and approvals that are part of a robust change management process. This requirement is contingent upon the configuration of SQL Server's hosted application and the security-relevant configuration settings of SQL Server._x000A__x000A_Accordingly, only qualified and authorized individuals shall be allowed to obtain access to these security-relevant configuration settings for purposes of initiating changes, including upgrades and modifications._x000A__x000A_Unmanaged changes that occur to SQL Server software libraries or configuration can lead to unauthorized or compromised installations.</S>
      <S N="FixText">Document the monitoring of security-relevant configuration settings to discover unauthorized changes within the system documentation._x000A__x000A_Document the specific users or types of security personnel that are able to monitor security-relevant configuration settings to discover unauthorized changes._x000A__x000A_Deploy and implement a third-party tool or some other SQL Server method of monitoring security-relevant configuration settings to discover unauthorized changes.</S>
      <S N="Check">Verify within the system documentation that SQL Server is monitoring for security-relevant configuration settings to discover unauthorized changes._x000A__x000A_This can be done by a third-party tool or a SQL script that does baselining and then comparisons. _x000A__x000A_If the monitoring of security-relevant configuration settings to discover unauthorized changes is not implemented on SQL Server, this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="427">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2012</S>
      <S N="VulnID">V-40950</S>
      <S N="RuleID">SV-53304r3_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL2-00-014700</S>
      <S N="Title">SQL Server must support the employment of automated mechanisms supporting the auditing of the enforcement actions.</S>
      <S N="Description">Any changes to the hardware, software, and/or firmware components of the information system and/or application can potentially have significant effects on the overall security of the system. _x000A__x000A_Accordingly, only qualified and authorized individuals are allowed to obtain access to information system components for purposes of initiating changes, including upgrades and modifications. _x000A__x000A_Access restrictions for change also include software libraries. _x000A__x000A_Examples of access restrictions include: physical access controls (such as locks and access cards), logical access controls (such as ACLs), automated auditing (logging) of logical access, workflow automation, media libraries, abstract layers (e.g., changes are implemented into a third-party interface rather than directly into the information system component), and change windows (e.g., changes occur only during specified times, making unauthorized changes outside the window easy to discover).  _x000A__x000A_This requirement focuses on the auditing aspect of the protections.tru</S>
      <S N="FixText">Navigate to Advanced Security Settings by selecting Properties &gt; Security &gt; Advanced &gt; Auditing &gt; Continue._x000A__x000A_Where "Everyone" is missing from the "Name" column, click the Add button; type "Everyone" in the object names box; click the OK button.  The Auditing Entry dialog opens._x000A__x000A_Where "Everyone" is in the "Name" column, select that row and click on the Edit button.  The Auditing Entry dialog opens._x000A__x000A_In the Auditing Entry dialog, set "Apply onto" to "This folder, subfolders and files"._x000A__x000A_In the Auditing Entry dialog, select both the Successful and the Failed checkbox for each of the following access types, where not already selected:_x000A_    Traverse folder/execute file _x000A_    List folder/read data_x000A_    Read attributes_x000A_    Read extended attributes_x000A_    Create files/write data_x000A_    Create folders/append data_x000A_    Write attributes_x000A_    Write extended attributes_x000A_    Delete_x000A_    Read permissions_x000A__x000A_Click OK, OK, OK, OK to save the new settings and exit the dialog boxes.</S>
      <S N="Check">Verify that Files and Folders that are part of the SQL Server 2012 Installation have auditing enabled._x000A__x000A_Right click the root folder of the SQL Server installation.  Typically, this is at &lt;drive&gt;:\Program Files\Microsoft SQL Server\.  Select Properties. _x000A__x000A_Click on the Security tab_x000A__x000A_Click on the Advanced button_x000A__x000A_Click on the Auditing tab_x000A__x000A_If "Everyone" is not listed in the "Name" column, this is a finding._x000A__x000A_If "This folder, subfolders and files" is not listed in the "Apply To" column, this is a finding._x000A__x000A_When "Everyone" ... " is listed, select the "Everyone" row and click on the Edit button._x000A__x000A_If either the Successful or Failed checkbox is not selected for any of the following access types, this is a finding:_x000A_    Traverse folder/execute file _x000A_    List folder/read data_x000A_    Read attributes_x000A_    Read extended attributes_x000A_    Create files/write data_x000A_    Create folders/append data_x000A_    Write attributes_x000A_    Write extended attributes_x000A_    Delete_x000A_    Read permissions</S>
    </MS>
  </Obj>
  <Obj RefId="428">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2012</S>
      <S N="VulnID">V-40951</S>
      <S N="RuleID">SV-53305r2_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL2-00-014600</S>
      <S N="Title">SQL Server must support the organizational requirement to employ automated mechanisms for enforcing access restrictions.</S>
      <S N="Description">When dealing with access restrictions pertaining to change control, it should be noted, any changes to the hardware, software, and/or firmware components of the information system and/or application can potentially have significant effects on the overall security of the system._x000A__x000A_Only qualified and authorized individuals are allowed to obtain access to information system components for the purposes of initiating changes, upgrades, and modifications._x000A__x000A_Access restrictions for change also include application software libraries._x000A__x000A_Examples of access restrictions include: physical and logical access controls, workflow automation, media libraries, abstract layers (i.e., changes are implemented into a third-party interface rather than directly into the information system component), and change windows (i.e., changes occur only during specified times, making unauthorized changes outside the window easy to discover)._x000A__x000A_Multiple applications can provide a cumulative negative effect. A vulnerability and subsequent exploit of one application can lead to an exploit of other applications sharing the same security context. For example, an exploit of a web server process that leads to unauthorized administrative access to host system directories can most likely lead to a compromise of all applications hosted by the same system. Database software not installed using dedicated directories both threatens, and is threatened by, other hosted applications. Access controls defined for one application may, by default, provide access to other applications’ database objects or directories. Any method that provides any level of separation of security context assists in the protection between applications.</S>
      <S N="FixText">Install SQL Server software using directories separate from the OS and other application software library directories._x000A__x000A_Relocate any directories or reinstall other application software that currently shares the DBMS software library directory to separate directories._x000A__x000A_Recommend dedicating a separate partition for the SQL software libraries.</S>
      <S N="Check">Obtain the SQL Server software library installation directory location._x000A__x000A_From a command prompt, type regedit.exe, and press [ENTER]._x000A__x000A_Navigate to HKEY_LOCAL_MACHINE &gt;&gt; SOFTWARE &gt;&gt; Microsoft &gt;&gt; Microsoft SQL Server &gt;&gt; Instance Names. Each instance installed on the server possesses a key inside a folder under this registry entry._x000A__x000A_Analysis Services Instances are registered in the OLAP subfolder._x000A_Reporting Services Instances are registered in the RS subfolder._x000A_Standard SQL Server Instances are registered in the SQL subfolder._x000A__x000A_Inside each one of these folders, a single key is used to reference an instance's specific Windows Registry tree. Each key will have its own registry tree at the following registry location: HKEY_LOCAL_MACHINE &gt;&gt; SOFTWARE &gt;&gt; Microsoft &gt;&gt; Microsoft SQL Server &gt;&gt; [INSTANCE NAME]._x000A__x000A_An [INSTANCE NAME] is listed as the data component of a key found in one of the above OLAP, RS, or SQL folders.  _x000A__x000A_To find the installation location of a particular instance, navigate to the following location in the Windows Registry:_x000A_ HKEY_LOCAL_MACHINE &gt;&gt; SOFTWARE &gt;&gt; Microsoft &gt;&gt; Microsoft SQL Server &gt;&gt; [INSTANCE NAME] &gt;&gt; Setup.  Examine the value of the 'SqlProgramDir' key. The value of the 'SqlProgramDir' key is the SQL Server installation directory for that SQL Server Instance._x000A__x000A_Navigate to that folder location using a command prompt or Windows Explorer. Note any custom subdirectories within the SQL Server software library directory. Only applications that are required for the functioning and administration of SQL Server should be located in the same disk directory as the SQL Server software libraries._x000A__x000A_If any directories or files not installed with the SQL Server software exist within the SQL Server software library directory, this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="429">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2012</S>
      <S N="VulnID">V-40952</S>
      <S N="RuleID">SV-53306r4_rule</S>
      <S N="Severity">low</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL2-00-013800</S>
      <S N="Title">SQL Server must protect audit information from unauthorized deletion.</S>
      <S N="Description">If audit data were to become compromised, competent forensic analysis and discovery of the true source of potentially malicious system activity would be impossible to achieve._x000A__x000A_To ensure the veracity of audit data, the information system and/or the application must protect audit information from unauthorized deletion. This requirement can be achieved through multiple methods, which will depend upon system architecture and design._x000A__x000A_Some commonly employed methods include ensuring log files enjoy the proper file system permissions utilizing file system protections, restricting access, and backing up log data to ensure log data is retained._x000A__x000A_Applications providing a user interface to audit data will leverage user permissions and roles identifying the user accessing the data and the corresponding rights the user enjoys in order to make decisions regarding the deletion of audit data._x000A__x000A_Audit information includes all information (e.g., audit records, audit settings, and audit reports) needed to successfully audit information system activity._x000A__x000A_Deletion of database audit data could mask the theft or unauthorized modification of sensitive data stored in the database.tru</S>
      <S N="FixText">Modify audit file permissions to meet the requirement to protect against unauthorized deletion._x000A__x000A_Navigate to audit folder location(s) using a command prompt or Windows Explorer.  Right-click on the file, click Properties._x000A_On the Security tab, modify the security permissions to: _x000A_Administrator(read)_x000A_Users (none)_x000A_Audit Administrator(Full Control)_x000A_Auditors group (Read)_x000A_SQL Server Service SID OR Service Account (Full Control)  [Notes 1, 2]  _x000A_SQL Server SQL Agent Service SID OR Service Account, if SQL Server Agent is in use. (Read, Execute, Write)  [Notes 1, 2]  _x000A__x000A_-----_x000A__x000A_Note 1:  It is highly advisable to use a separate account for each service.  When installing SQL Server in single-server mode, you can opt to have these provisioned for you.  These automatically-generated accounts are referred to as virtual accounts.  Each virtual account has an equivalent Service SID, with the same name.  The installer also creates an equivalent SQL Server login, also with the same name.  Applying folder and file permissions to Service SIDs, rather than to domain accounts or local computer accounts, provides tighter control, because these permissions are available only to the specific service when it is running, and not in any other context.  (However, when using failover clustering, a domain account must be specified at installation, rather than a virtual account.)  For more on this topic, see http://msdn.microsoft.com/en-us/library/ms143504(v=sql.110).aspx._x000A__x000A__x000A_Note 2:  Tips for adding a service SID/virtual account to a folder's permission list._x000A_1) In Windows Explorer, right-click on the folder and select "Properties."_x000A_2) Select the "Security" tab_x000A_3) Click "Edit"_x000A_4) Click "Add"_x000A_5) Click "Locations"_x000A_6) Select the computer name_x000A_7) Search for the name_x000A_7.a) SQL Server Service_x000A_7.a.i) Type "NT SERVICE\MSSQL" and click "Check Names".  (What you have just typed in is the first 16 characters of the name.  At least one character must follow "NT SERVICE\"; you will be presented with a list of all matches.  If you have typed in the full, correct name, step 7.a.ii is bypassed.)_x000A_7.a.ii) Select the "MSSQL$&lt;instance name&gt;" user and click OK_x000A_7.b) SQL Agent Service_x000A_7.b.i) Type "NT SERVICE\SQL" and click "Check Names"_x000A_7.b.ii) Select the "SQLAgent$&lt;instance name&gt;" user and click OK_x000A_8) Click OK_x000A_9) Permission like a normal user from here</S>
      <S N="Check">Obtain the SQL Server audit file location(s) by running the following SQL script:_x000A_SELECT DISTINCT _x000A_LEFT(path, (LEN(path) - CHARINDEX('\',REVERSE(path)) + 1)) AS "Audit Path"_x000A_FROM sys.traces_x000A_UNION_x000A_SELECT log_file_path AS "Audit Path"_x000A_FROM sys.server_file_audits_x000A__x000A_For each audit, the path column will give the location of the file._x000A__x000A_Verify that all audit files have the correct permissions by doing the following for each audit file: Navigate to audit folder location(s) using a command prompt or Windows Explorer._x000A__x000A_Right-click the file/folder, click Properties.  On the Security tab, verify that at most the following permissions are applied:_x000A_Administrator(read)_x000A_Users (none)_x000A_Audit Administrator (Full Control)_x000A_Auditors group (Read)_x000A_SQL Server Service SID OR Service Account (Full Control)  [Notes 1, 2]  _x000A_SQL Server SQL Agent Service SID OR Service Account, if SQL Server Agent is in use. (Read, Execute, Write)  [Notes 1, 2]_x000A__x000A_If any less restrictive permissions are present and not specifically justified and approved in the system security plan, this is a finding. _x000A__x000A_If less restrictive permissions are present and specifically justified and approved in the system security plan, this is not a finding_x000A_-----_x000A__x000A_Note 1: It is highly advisable to use a separate account for each service. When installing SQL Server in single-server mode, you can opt to have these provisioned for you. These automatically-generated accounts are referred to as virtual accounts. Each virtual account has an equivalent Service SID, with the same name. The installer also creates an equivalent SQL Server login, also with the same name. Applying folder and file permissions to Service SIDs, rather than to domain accounts or local computer accounts, provides tighter control, because these permissions are available only to the specific service when it is running, and not in any other context. (However, when using failover clustering, a domain account must be specified at installation, rather than a virtual account.) For more on this topic, see http://msdn.microsoft.com/en-us/library/ms143504(v=sql.120).aspx._x000A__x000A_Note 2: Tips for adding a service SID/virtual account to a folder's permission list._x000A_1) In Windows Explorer, right-click on the folder and select "Properties."_x000A_2) Select the "Security" tab_x000A_3) Click "Edit"_x000A_4) Click "Add"_x000A_5) Click "Locations"_x000A_6) Select the computer name_x000A_7) Search for the name_x000A_7.a) SQL Server Service_x000A_7.a.i) Type "NT SERVICE\MSSQL" and click "Check Names". (What you have just typed in is the first 16 characters of the name. At least one character must follow "NT SERVICE\"; you will be presented with a list of all matches. If you have typed in the full, correct name, step 7.a.ii is bypassed.)_x000A_7.a.ii) Select the "MSSQL$&lt;instance name&gt;" user and click OK_x000A_7.b) SQL Agent Service_x000A_7.b.i) Type "NT SERVICE\SQL" and click "Check Names"_x000A_7.b.ii) Select the "SQLAgent$&lt;instance name&gt;" user and click OK_x000A_8) Click OK_x000A_9) Permission like a normal user from here</S>
    </MS>
  </Obj>
  <Obj RefId="430">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2012</S>
      <S N="VulnID">V-40953</S>
      <S N="RuleID">SV-53307r5_rule</S>
      <S N="Severity">low</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL2-00-013700</S>
      <S N="Title">SQL Server must protect audit information from unauthorized modification.</S>
      <S N="Description">If audit data were to become compromised, competent forensic analysis and discovery of the true source of potentially malicious system activity would be impossible to achieve._x000A__x000A_To ensure the veracity of audit data, the information system and/or the application must protect audit information from unauthorized modification._x000A__x000A_This requirement can be achieved through multiple methods, which will depend upon system architecture and design. Some commonly employed methods include ensuring log files enjoy the proper file system permissions, and limiting log data locations._x000A__x000A_Applications providing a user interface to audit data will leverage user permissions and roles identifying the user accessing the data and the corresponding rights that the user enjoys in order to make decisions regarding the modification of audit data._x000A__x000A_Audit information includes all information (e.g., audit records, audit settings, and audit reports) needed to successfully audit information system activity._x000A__x000A_Modification of database audit data could mask the theft or unauthorized modification of sensitive data stored in the database.tru</S>
      <S N="FixText">Edit the system security plan to include justification and authorization for any less restrictive permissions that are present and needed.  (An example might be where Auditors need "Read &amp; Execute" rather than "Read" alone.)_x000A__x000A_Modify audit file permissions to meet the requirement to protect against unauthorized modification._x000A__x000A_Navigate to audit folder location(s) using a command prompt or Windows Explorer.  Right-click on the file, click Properties. On the Security tab, modify the security permissions to: _x000A_Administrator(read)_x000A_Users (none)_x000A_Audit Administrator(Full Control)_x000A_Auditors group (Read)_x000A_SQL Server Service SID OR Service Account (Full Control)  [Notes 1, 2]  _x000A_SQL Server SQL Agent Service SID OR Service Account, if SQL Server Agent is in use. (Read, Execute, Write)  [Notes 1, 2]  _x000A__x000A_-----_x000A__x000A_Note 1:  It is highly advisable to use a separate account for each service.  When installing SQL Server in single-server mode, you can opt to have these provisioned for you.  These automatically-generated accounts are referred to as virtual accounts.  Each virtual account has an equivalent Service SID, with the same name.  The installer also creates an equivalent SQL Server login, also with the same name.  Applying folder and file permissions to Service SIDs, rather than to domain accounts or local computer accounts, provides tighter control, because these permissions are available only to the specific service when it is running, and not in any other context.  (However, when using failover clustering, a domain account must be specified at installation, rather than a virtual account.)  For more on this topic, see http://msdn.microsoft.com/en-us/library/ms143504(v=sql.110).aspx._x000A__x000A__x000A_Note 2:  Tips for adding a service SID/virtual account to a folder's permission list._x000A_1) In Windows Explorer, right-click on the folder and select "Properties."_x000A_2) Select the "Security" tab_x000A_3) Click "Edit"_x000A_4) Click "Add"_x000A_5) Click "Locations"_x000A_6) Select the computer name_x000A_7) Search for the name_x000A_7.a) SQL Server Service_x000A_7.a.i) Type "NT SERVICE\MSSQL" and click "Check Names".  (What you have just typed in is the first 16 characters of the name.  At least one character must follow "NT SERVICE\"; you will be presented with a list of all matches.  If you have typed in the full, correct name, step 7.a.ii is bypassed.)_x000A_7.a.ii) Select the "MSSQL$&lt;instance name&gt;" user and click OK_x000A_7.b) SQL Agent Service_x000A_7.b.i) Type "NT SERVICE\SQL" and click "Check Names"_x000A_7.b.ii) Select the "SQLAgent$&lt;instance name&gt;" user and click OK_x000A_8) Click OK_x000A_9) Permission like a normal user from here</S>
      <S N="Check">Obtain the SQL Server audit file location(s) by running the following SQL script:_x000A_SELECT DISTINCT _x000A_LEFT(path, (LEN(path) - CHARINDEX('\',REVERSE(path)) + 1)) AS "Audit Path"_x000A_FROM sys.traces_x000A_UNION_x000A_SELECT log_file_path AS "Audit Path"_x000A_FROM sys.server_file_audits_x000A__x000A_For each audit, the Audit Path column will give the location of the file._x000A__x000A_Verify that all audit files have the correct permissions by doing the following for each audit file: Navigate to audit folder location(s) using a command prompt or Windows Explorer.  The following instructions assume Windows Explorer is used._x000A__x000A_Right-click the file/folder, click Properties.  On the Security tab, verify that at most the following permissions are applied:_x000A_Administrator(read)_x000A_Users (none)_x000A_Audit Administrator (Full Control)_x000A_Auditors group (Read)_x000A_SQL Server Service SID OR Service Account (Full Control)  [Notes 1, 2]  _x000A_SQL Server SQL Agent Service SID OR Service Account, if SQL Server Agent is in use. (Read, Execute, Write)  [Notes 1, 2]_x000A__x000A_If any less restrictive permissions are present and not specifically justified and approved in the system security plan, this is a finding. _x000A__x000A_If less restrictive permissions are present and specifically justified and approved in the system security plan, this is not a finding._x000A__x000A_If Trace is in use, SQL Server creates each trace file with a standard set of permissions, overriding the folder permissions.  It grants full control to OWNER RIGHTS, Administrators and &lt;SQL Server Instance name&gt;.  Since this is not configurable, this is not a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="431">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2012</S>
      <S N="VulnID">V-41016</S>
      <S N="RuleID">SV-53390r5_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL2-00-013600</S>
      <S N="Title">SQL Server must protect audit information from any type of unauthorized access.</S>
      <S N="Description">If audit data were to become compromised, competent forensic analysis and discovery of the true source of potentially malicious system activity would be difficult, if not impossible, to achieve. In addition, access to audit records provides information an attacker could potentially use to his or her advantage._x000A__x000A_To ensure the veracity of audit data, the information system and/or the application must protect audit information from any and all unauthorized access. This includes read, write, copy, etc._x000A__x000A_SQL Server and third-party tools are examples of applications that are easily able to view and manipulate audit file data. Additionally, applications with user interfaces to audit records should not allow unfettered manipulation of, or access to, those records via any application. If an application provides access to the audit data, the application becomes accountable for ensuring that audit information is protected from unauthorized access._x000A__x000A_This requirement can be achieved through multiple methods, which will depend upon system architecture and design. Some commonly employed methods include ensuring log files enjoy the proper file system permissions utilizing file system protections, and limiting log data location._x000A__x000A_Audit information includes all information (e.g., audit records, audit settings, and audit reports) needed to successfully audit information system activity.tru</S>
      <S N="FixText">Edit the system security plan to include justification and authorization for any less restrictive permissions that are present and needed.  (An example might be where Auditors need "Read &amp; Execute" rather than "Read" alone.)_x000A__x000A_Modify audit file permissions to meet the requirement to protect against unauthorized access._x000A__x000A_Navigate to audit folder location(s) using a command prompt or Windows Explorer.  Right-click on the file, click Properties._x000A_On the Security tab, modify the security permissions to: _x000A_Administrator(read)_x000A_Users (none)_x000A_Audit Administrator(Full Control)_x000A_Auditors group (Read)_x000A_SQL Server Service SID OR Service Account (Full Control)  [Notes 1, 2]_x000A_SQL Server SQL Agent Service SID OR Service Account, if SQL Server Agent is in use. (Read, Execute, Write) [Notes 1, 2]_x000A__x000A__x000A_-----_x000A__x000A_Note 1:  It is highly advisable to use a separate account for each service.  When installing SQL Server in single-server mode, you can opt to have these provisioned for you.  These automatically-generated accounts are referred to as virtual accounts.  Each virtual account has an equivalent Service SID, with the same name.  The installer also creates an equivalent SQL Server login, also with the same name.  Applying folder and file permissions to Service SIDs, rather than to domain accounts or local computer accounts, provides tighter control, because these permissions are available only to the specific service when it is running, and not in any other context.  (However, when using failover clustering, a domain account must be specified at installation, rather than a virtual account.)  For more on this topic, see http://msdn.microsoft.com/en-us/library/ms143504(v=sql.110).aspx._x000A__x000A__x000A_Note 2:  Tips for adding a service SID/virtual account to a folder's permission list._x000A_1) In Windows Explorer, right-click on the folder and select "Properties."_x000A_2) Select the "Security" tab_x000A_3) Click "Edit"_x000A_4) Click "Add"_x000A_5) Click "Locations"_x000A_6) Select the computer name_x000A_7) Search for the name_x000A_7.a) SQL Server Service_x000A_7.a.i) Type "NT SERVICE\MSSQL" and click "Check Names".  (What you have just typed in is the first 16 characters of the name.  At least one character must follow "NT SERVICE\"; you will be presented with a list of all matches.  If you have typed in the full, correct name, step 7.a.ii is bypassed.)_x000A_7.a.ii) Select the "MSSQL$&lt;instance name&gt;" user and click OK_x000A_7.b) SQL Agent Service_x000A_7.b.i) Type "NT SERVICE\SQL" and click "Check Names"_x000A_7.b.ii) Select the "SQLAgent$&lt;instance name&gt;" user and click OK_x000A_8) Click OK_x000A_9) Permission like a normal user from here</S>
      <S N="Check">Obtain the SQL Server audit file location(s) by running the following SQL script:_x000A_SELECT DISTINCT _x000A_LEFT(path, (LEN(path) - CHARINDEX('\',REVERSE(path)) + 1)) AS "Audit Path"_x000A_FROM sys.traces_x000A_UNION_x000A_SELECT log_file_path AS "Audit Path"_x000A_FROM sys.server_file_audits_x000A__x000A_For each audit, the path column will give the location of the file._x000A__x000A_Verify that all audit files have the correct permissions by doing the following for each audit file: Navigate to audit folder location(s) using a command prompt or Windows Explorer._x000A__x000A_Right-click the file/folder, click Properties.  On the Security tab, verify that at most the following permissions are applied:_x000A_Administrator(read)_x000A_Users (none)_x000A_Audit Administrator (Full Control)_x000A_Auditors group (Read)_x000A_SQL Server Service SID OR Service Account (Full Control)  [Notes 1, 2]  _x000A_SQL Server SQL Agent Service SID OR Service Account, if SQL Server Agent is in use. (Read, Execute, Write) [Notes 1, 2]_x000A__x000A__x000A_If any less restrictive permissions are present and not specifically justified and approved in the system security plan, this is a finding. _x000A__x000A_If less restrictive permissions are present and specifically justified and approved in the system security plan, this is not a finding._x000A__x000A_-----_x000A__x000A_Note 1: It is highly advisable to use a separate account for each service. When installing SQL Server in single-server mode, you can opt to have these provisioned for you. These automatically-generated accounts are referred to as virtual accounts. Each virtual account has an equivalent Service SID, with the same name. The installer also creates an equivalent SQL Server login, also with the same name. Applying folder and file permissions to Service SIDs, rather than to domain accounts or local computer accounts, provides tighter control, because these permissions are available only to the specific service when it is running, and not in any other context. (However, when using failover clustering, a domain account must be specified at installation, rather than a virtual account.) For more on this topic, see http://msdn.microsoft.com/en-us/library/ms143504(v=sql.120).aspx._x000A__x000A_Note 2: Tips for adding a service SID/virtual account to a folder's permission list._x000A_1) In Windows Explorer, right-click on the folder and select "Properties."_x000A_2) Select the "Security" tab_x000A_3) Click "Edit"_x000A_4) Click "Add"_x000A_5) Click "Locations"_x000A_6) Select the computer name_x000A_7) Search for the name_x000A_7.a) SQL Server Service_x000A_7.a.i) Type "NT SERVICE\MSSQL" and click "Check Names". (What you have just typed in is the first 16 characters of the name. At least one character must follow "NT SERVICE\"; you will be presented with a list of all matches. If you have typed in the full, correct name, step 7.a.ii is bypassed.)_x000A_7.a.ii) Select the "MSSQL$&lt;instance name&gt;" user and click OK_x000A_7.b) SQL Agent Service_x000A_7.b.i) Type "NT SERVICE\SQL" and click "Check Names"_x000A_7.b.ii) Select the "SQLAgent$&lt;instance name&gt;" user and click OK_x000A_8) Click OK_x000A_9) Permission like a normal user from here</S>
    </MS>
  </Obj>
  <Obj RefId="432">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2012</S>
      <S N="VulnID">V-41017</S>
      <S N="RuleID">SV-53391r4_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL2-00-014400</S>
      <S N="Title">SQL Server must protect the audit records generated as a result of remote access to privileged accounts and by the execution of privileged functions.</S>
      <S N="Description">Protection of audit records and audit data is of critical importance. Care must be taken to ensure privileged users cannot circumvent audit protections put in place._x000A__x000A_Auditing might not be reliable when performed by an information system that the user being audited has privileged access to._x000A__x000A_The privileged user could inhibit auditing or directly modify audit records. To prevent this from occurring, privileged access shall be further defined between audit-related privileges and other privileges, thus limiting the users with audit-related privileges._x000A__x000A_Reducing the risk of audit compromises by privileged users can also be achieved, for example, by performing audit activity on a separate information system where the user in question has limited access, or by using storage media that cannot be modified (e.g., write-once recording devices)._x000A__x000A_If an attacker were to gain access to audit tools, they could analyze audit logs for system weaknesses or weaknesses in the auditing itself. An attacker could also manipulate logs to hide evidence of malicious activity.tru</S>
      <S N="FixText">Modify audit file permissions to meet the requirement to protect against unauthorized access._x000A__x000A_Navigate to the audit folder location(s) using a command prompt or Windows Explorer.  Right-click on the file, click Properties._x000A_On the Security tab, modify the security permissions to: _x000A_Administrator(read)_x000A_Users (none)_x000A_Audit Administrator(Full Control)_x000A_Auditors group (Read)_x000A_SQL Server Service SID OR Service Account (Full Control)  [Notes 1, 2]_x000A_SQL Server SQL Agent Service SID OR Service Account, if SQL Server Agent is in use. (Read, Execute, Write) [Notes 1, 2]_x000A__x000A_-----_x000A__x000A_Note 1:  It is highly advisable to use a separate account for each service.  When installing SQL Server in single-server mode, you can opt to have these provisioned for you.  These automatically-generated accounts are referred to as virtual accounts.  Each virtual account has an equivalent Service SID, with the same name.  The installer also creates an equivalent SQL Server login, also with the same name.  Applying folder and file permissions to Service SIDs, rather than to domain accounts or local computer accounts, provides tighter control, because these permissions are available only to the specific service when it is running, and not in any other context.  (However, when using failover clustering, a domain account must be specified at installation, rather than a virtual account.)  For more on this topic, see http://msdn.microsoft.com/en-us/library/ms143504(v=sql.110).aspx._x000A__x000A__x000A_Note 2:  Tips for adding a service SID/virtual account to a folder's permission list._x000A_1) In Windows Explorer, right-click on the folder and select "Properties."_x000A_2) Select the "Security" tab_x000A_3) Click "Edit"_x000A_4) Click "Add"_x000A_5) Click "Locations"_x000A_6) Select the computer name_x000A_7) Search for the name_x000A_7.a) SQL Server Service_x000A_7.a.i) Type "NT SERVICE\MSSQL" and click "Check Names".  (What you have just typed in is the first 16 characters of the name.  At least one character must follow "NT SERVICE\"; you will be presented with a list of all matches.  If you have typed in the full, correct name, step 7.a.ii is bypassed.)_x000A_7.a.ii) Select the "MSSQL$&lt;instance name&gt;" user and click OK_x000A_7.b) SQL Agent Service_x000A_7.b.i) Type "NT SERVICE\SQL" and click "Check Names"_x000A_7.b.ii) Select the "SQLAgent$&lt;instance name&gt;" user and click OK_x000A_8) Click OK_x000A_9) Permission like a normal user from here</S>
      <S N="Check">Obtain the SQL Server audit file location(s) by running the following SQL script:_x000A_SELECT DISTINCT _x000A_LEFT(path, (LEN(path) - CHARINDEX('\',REVERSE(path)) + 1)) AS "Audit Path"_x000A_FROM sys.traces_x000A_UNION_x000A_SELECT log_file_path AS "Audit Path"_x000A_FROM sys.server_file_audits_x000A__x000A_For each audit, the path column will give the location of the file._x000A__x000A_Verify that all audit files have the correct permissions by doing the following for each audit file: Navigate to audit folder location(s) using a command prompt or Windows Explorer._x000A__x000A_Right-click the file/folder, click Properties.  On the Security tab, verify that at most the following permissions are applied:_x000A_Administrator(read)_x000A_Users (none)_x000A_Audit Administrator (Full Control)_x000A_Auditors group (Read)_x000A_SQL Server Service SID OR Service Account (Full Control)  [Notes 1, 2]_x000A_SQL Server SQL Agent Service SID OR Service Account, if SQL Server Agent is in use. (Read, Execute, Write) [Notes 1, 2]_x000A_If any less restrictive permissions are present (and not specifically justified and approved), this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="433">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2012</S>
      <S N="VulnID">V-41021</S>
      <S N="RuleID">SV-53396r4_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL2-00-013400</S>
      <S N="Title">SQL Server must audit attempts to bypass access controls.</S>
      <S N="Description">Information system auditing capability is critical for accurate forensic analysis. Audit record content which may be necessary to satisfy the requirement of this control includes:  time stamps, source and destination addresses, user/process identifiers, event descriptions, success/fail indications, file names involved, and access control or flow control rules invoked._x000A__x000A_Detection of suspicious activity, including access attempts and successful access from unexpected places, during unexpected times, or other unusual indicators, can support decisions to apply countermeasures to deter an attack. Without detection, malicious activity may proceed without hindrance. In SQL Server's case, this is a combination of the standard audit trace, as well as the operating system logs. Only the SQL Server logs are validated for this check, as the other part is dependent upon the operating system.</S>
      <S N="FixText">Create a trace that meets all auditing requirements._x000A__x000A_The script provided in the supplemental file, Trace.sql, can be used to do this; edit it as necessary to capture any additional, locally defined events.</S>
      <S N="Check">Check to see that all required events are being audited._x000A_From the query prompt:_x000A_     SELECT DISTINCT traceid FROM sys.fn_trace_getinfo(0);_x000A_All currently defined traces for the SQL server instance will be listed. If no traces are returned, this is a finding._x000A__x000A_Determine the trace(s) being used for the auditing requirement. _x000A_In the following, replace # with a trace ID being used for the auditing requirements._x000A_From the query prompt:_x000A_     SELECT DISTINCT(eventid) FROM sys.fn_trace_geteventinfo(#);_x000A_The following required event IDs should be listed:_x000A_     14, 15, 18, 20, _x000A_     102, 103, 104, 105, 106, 107, 108, 109, 110, _x000A_     111, 112, 113, 115, 116, 117, 118, _x000A_     128, 129, 130, _x000A_     131, 132, 133, 134, 135, _x000A_     152, 153, _x000A_     170, 171, 172, 173, 175, 176, 177, 178._x000A_If any of the audit event IDs required above is not listed, this is a finding._x000A__x000A_Notes:_x000A_1. It is acceptable to have the required event IDs spread across multiple traces, provided all of the traces are always active, and the event IDs are grouped in a logical manner._x000A_2. It is acceptable, from an auditing point of view, to include the same event IDs in multiple traces.  However, the effect of this redundancy on performance, storage, and the consolidation of audit logs into a central repository, should be taken into account._x000A_3. It is acceptable to trace additional event IDs. This is the minimum list._x000A_4. Once this check is satisfied, the DBA may find it useful to disable or modify the default trace that is set up by the SQL Server installation process. (Note that the Fix does NOT include code to do this.)  _x000A_Use the following query to obtain a list of all event IDs, and their meaning:_x000A_     SELECT * FROM sys.trace_events; _x000A_5. Because this check procedure is designed to address multiple requirements/vulnerabilities, it may appear to exceed the needs of some individual requirements.  However, it does represent the aggregate of all such requirements._x000A_6. Microsoft has flagged the trace techniques and tools used in this Check and Fix as deprecated.  They will be removed at some point after SQL Server 2014.  The replacement feature is Extended Events.  If Extended Events are in use, and cover all the required audit events listed above, this is not a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="434">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2012</S>
      <S N="VulnID">V-41022</S>
      <S N="RuleID">SV-53397r3_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL2-00-012800</S>
      <S N="Title">SQL Server must shutdown immediately in the event of an audit failure, unless an alternative audit capability exists.</S>
      <S N="Description">It is critical that, when SQL Server is at risk of failing to process audit logs as required, it takes action to mitigate the failure. If the system were to continue processing without auditing enabled, actions could be taken on the system that could not be tracked and recorded for later forensic analysis._x000A__x000A_In many system configurations, the disk space allocated to the auditing system is separate from the disks allocated for the operating system; therefore, this may not result in a system outage. This places the onus on the DBMS to detect and take actions._x000A__x000A_A failure of SQL Server auditing will result in either the database continuing to function without auditing, or the halting of SQL Server operations. In this case, the database must cease processing immediately in order to not allow unlogged transaction to occur._x000A__x000A_Note that trace file rollover does not count as an audit failure, provided that the system is also configured to shut down when it runs out of space.  Trace file rollover can be a useful technique for breaking the log into manageable pieces, for archiving, or for transfer to a log management system.tru</S>
      <S N="FixText">If a trace does not exist, create a trace specification that complies with requirements._x000A__x000A_If a trace exists, but is not set to SHUTDOWN_ON_ERROR, modify the SQL Server audit setting to immediately shutdown the database in the event of an audit failure by setting property 1 to a value of 4 or 6 for the audit._x000A__x000A_(See the SQL Server Help page for sys.sp_trace_create for implementation details.)</S>
      <S N="Check">From the query prompt:_x000A__x000A_SELECT DISTINCT traceid FROM sys.fn_trace_getinfo(0);_x000A__x000A_All currently defined traces for the SQL Server instance will be listed. If no traces are returned, this is a finding._x000A__x000A_Determine the trace being used for the auditing requirement. Replace # in the following code with a traceid being used for the auditing requirements._x000A__x000A_From the query prompt, determine whether the trace options include the value 4, which means SHUTDOWN_ON_ERROR:_x000A_SELECT CAST(value AS INT) _x000A_FROM sys.fn_trace_getinfo(#)_x000A_where property = 1;_x000A__x000A_If the query does not return a value, this is a finding._x000A_If a value is returned but is not 4 or 6, this is a finding._x000A_(6 represents the combination of values 2 and 4.  2 means TRACE_FILE_ROLLOVER.)_x000A__x000A__x000A_NOTE:  Microsoft has flagged the trace techniques and tools used in this STIG as deprecated. They will be removed at some point after SQL Server 2014. The replacement feature is Extended Events. If Extended Events are in use and configured to satisfy this requirement, this is not a finding.  The following code can be used to check Extended Events settings._x000A_/********************************** _x000A_Check to verify shutdown on failure is set._x000A_The following settings are what should be returned: _x000A_name = &lt;name of audit&gt; _x000A_on_failure = 1 _x000A_on_failure_desc = SHUTDOWN SERVER INSTANCE _x000A_**********************************/ _x000A_SELECT name, on_failure, on_failure_desc _x000A_FROM sys.server_audits _x000A_</S>
    </MS>
  </Obj>
  <Obj RefId="435">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2012</S>
      <S N="VulnID">V-41023</S>
      <S N="RuleID">SV-53398r2_rule</S>
      <S N="Severity">low</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL2-00-012600</S>
      <S N="Title">SQL Server itself, or the logging or alerting mechanism the application utilizes, must provide a warning when allocated audit record storage volume reaches an organization-defined percentage of maximum audit record storage capacity.</S>
      <S N="Description">It is critical for the appropriate personnel to be aware if a system is at risk of failing to process audit logs as required. Audit processing failures include:  software/hardware errors, failures in the audit capturing mechanisms, and audit storage capacity being reached or exceeded._x000A__x000A_If audit log capacity were to be exceeded, then events subsequently occurring will not be recorded. Organizations shall define a maximum allowable percentage of storage capacity serving as an alarming threshold (e.g., application has exceeded 80% of log storage capacity allocated) at which time the application or the logging mechanism the application utilizes will provide a warning to the appropriate personnel._x000A__x000A_A failure of database auditing will result in either the database continuing to function without auditing, or in a complete halt to database operations. When audit processing fails, appropriate personnel must be alerted immediately to avoid further downtime or unaudited transactions. This can be an alert provided by a log repository or the OS when a designated log directory is nearing capacity.</S>
      <S N="FixText">From File Server Resource Manager:  Choose the From Server Selection, Select a server from the server pool, and select the server from the lower menu. Expand the File and Storage Services Role. Then Expand the File and iSCSI Services subtree. Select File Server Resource Manager. Click Add Features. Return to Add Roles and Features Wizard. Click Next. On the Features Tab, Click Next. Click Install to install and enable the FSRM.msc Microsoft Management Console Snap-in tool._x000A_From a Command Prompt, open fsrm.msc. Enable File and Folder Quota Management. _x000A_Create Quotas for previously identified Audit storage locations based on organizationally defined requirements._x000A__x000A_Right click the appropriate quota or quotas, and click Edit Quota Properties. From the Notification thresholds pane, create a Notification threshold for this Quota utilizing a generate email alert, or a generated Event Log entry.</S>
      <S N="Check">Since SQL Server does not support the monitoring of the available audit log file space, utilize Windows File Server Resource Manager or a third-party application to perform this activity._x000A__x000A_From a Command Prompt, open fsrm.msc._x000A_If fsrm.msc is not installed, the File Server Resource Manager is not installed, File and Folder Quota Management is not enabled. If File Server Resource Manager or a third-party tool capable of sending alert notifications based on audit log store requirements is not installed, this is a finding._x000A__x000A_If fsrm.msc is installed, expand File Server Resource Manager in the left pane._x000A_Expand Quota Management._x000A_Select Quotas._x000A_If Quotas have not been created for defined Audit Log storage locations that meet organizationally defined requirements, this is a finding._x000A__x000A_In the center pane, select each quota to determine its Path, Limit, Type, and Description. _x000A__x000A_Right click the appropriate quota or quotas, and click Edit Quota Properties._x000A_Examine the Notification thresholds panel. If there are no Notification thresholds applied to this Quota, this is a finding._x000A_If a Notification Threshold is applied, and it does not send an email alert, or provide an Event Log entry which is handled by an automated Log Alert reporting application, this is a finding._x000A__x000A_If a third-party application is utilized to fulfill this requirement, and it is not configured to provide a notification, this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="436">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2012</S>
      <S N="VulnID">V-41024</S>
      <S N="RuleID">SV-53399r2_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL2-00-010500</S>
      <S N="Title">SQL Server auditing configuration maximum number of files must be configured to reduce the likelihood of storage capacity being exceeded, while meeting organization-defined auditing requirements.</S>
      <S N="Description">Configure SQL Server during the installation and/or configuration process to determine if adequate storage capacity has been allocated for audit logs._x000A__x000A_If SQL Server audit logs that are being generated exceed the amount of space reserved for those logs, the system may shutdown or take other measures to stop processing in order to protect transactions from continuing unlogged._x000A__x000A_After the initial setup of SQL Server audit log configuration, it is best to check the available space frequently until the maximum number of files has been reached. Checking the available space can help determine the balance of online audit data with space required.</S>
      <S N="FixText">Configure the maximum number of audit log files that are to be generated, staying within the number of logs the system was sized to support._x000A__x000A_Update the max_files parameter of the audits to ensure the correct number of files is defined.</S>
      <S N="Check">Check the SQL Server audit setting on the maximum number of files of the trace used for the auditing requirement. _x000A__x000A_Select * from sys.traces. Determine the audit being used to fulfill the overall auditing requirement. Examine the max_files and max_size parameters. SQL will overwrite the oldest files when the max_files parameter has been exceeded. Care must be taken to ensure that this does not happen, or data will be lost. _x000A__x000A__x000A_The amount of space determined for logging by SQL Server is calculated by multiplying the maximum number of files by the maximum file size.   _x000A_If auditing will outgrow the space reserved for logging before being overwritten, this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="437">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2012</S>
      <S N="VulnID">V-41025</S>
      <S N="RuleID">SV-53400r2_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL2-00-010400</S>
      <S N="Title">SQL Server auditing configuration maximum file size must be configured to reduce the likelihood of storage capacity being exceeded, while meeting organization-defined auditing requirements.</S>
      <S N="Description">Configure SQL Server during the installation and/or configuration process to determine if adequate storage capacity has been allocated for audit logs._x000A__x000A_If SQL Server audit logs that are being generated exceed the amount of space reserved for those logs, the system may shutdown or take other measures to stop processing in order to protect transactions from continuing unlogged._x000A__x000A_After the initial setup of SQL Server audit log configuration, it is best to check the available space until the maximum number of files has been reached. SQL will overwrite the oldest files when the max_files parameter has been exceeded. Care must be taken to ensure that this does not happen, or data will be lost. Therefore, the combination of max_size and max_files must be monitored to ensure that overwriting does not occur. This must also coincide with the backup process of off-loading the files.</S>
      <S N="FixText">Configure the maximum file size of each audit log file that is to be generated, staying within the file size the system was sized to support. Modify the audit in question to be placed on drives with adequate space or reconfigure to ensure the audit will not fill the space allocated.</S>
      <S N="Check">Check the SQL Server audit setting on the maximum file size of the trace used for the auditing requirement. _x000A__x000A_Select * from sys.traces. Determine the audit being used to fulfill the overall auditing requirement. Examine the max_files and max_size parameters. SQL will overwrite the oldest files when the max_files parameter has been exceeded. Care must be taken to ensure that this does not happen, or data will be lost. _x000A__x000A__x000A_The amount of space determined for logging by SQL Server is calculated by multiplying the maximum number of files by the maximum file size.   _x000A_If auditing will outgrow the space reserved for logging before being overwritten, this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="438">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2012</S>
      <S N="VulnID">V-41026</S>
      <S N="RuleID">SV-53401r2_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL2-00-010600</S>
      <S N="Title">SQL Server must have allocated audit record storage capacity to meet the organization-defined requirements for saving audit record information.</S>
      <S N="Description">SQL Server does not have the ability to be cognizant of potential audit log storage capacity issues. During the installation and/or configuration process, SQL Server should detect and determine if adequate storage capacity has been allocated for audit logs._x000A__x000A_During the installation process, a notification may be provided to the installer indicating, based on the auditing configuration chosen and the amount of storage space allocated for audit logs, the amount of storage capacity available is not sufficient to meet storage requirements. SQL Server is not able to send out notice based on adequate storage capacity allocated for the audit logs.</S>
      <S N="FixText">Use File Server Resource Manager (FSRM.msc) to enable File and Folder Quota Management and create quotas for identified Audit storage locations.</S>
      <S N="Check">From a Command Prompt, open fsrm.msc._x000A_If fsrm.msc is not installed, the File Server Resource Manager is not installed; File and Folder Quota Management is not enabled. If File Server Resource Manager or a third-party tool capable of sending alert notifications based on audit log store requirements is not installed, this is a finding._x000A__x000A_If fsrm.msc is installed, expand File Server Resource Manager in the left pane._x000A_Expand Quota Management._x000A_Expand Quotas._x000A_If Quotas have not been created for defined Audit Log storage locations, this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="439">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2012</S>
      <S N="VulnID">V-41027</S>
      <S N="RuleID">SV-53402r4_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL2-00-012400</S>
      <S N="Title">SQL Server must include organization-defined additional, more detailed information in the audit records for audit events identified by type, location, or subject.</S>
      <S N="Description">SQL Server auditing capability is critical for accurate forensic analysis. Audit record content which may be necessary to satisfy the requirement of this control includes:  time stamps, source and destination addresses, user/process identifiers, event descriptions, success/fail indications, file names involved, and access control or flow control rules invoked._x000A__x000A_SQL Server does have a means available to add organizationally defined additional, more detailed information in the audit event records. These events may be identified by type, location, or subject. An example of more detailed information the organization may require in audit records could be the name of the application where the request is coming from._x000A__x000A_Some organizations may determine that more detailed information is required for specific database event types. If this information is not available, it could negatively impact forensic investigations into user actions or other malicious events.</S>
      <S N="FixText">Create a trace that meets all auditing requirements._x000A__x000A_The script provided in the supplemental file, Trace.sql, can be used to do this; edit it as necessary to capture any additional, locally defined events.</S>
      <S N="Check">Check to see that all required events are being audited._x000A_From the query prompt:_x000A_     SELECT DISTINCT traceid FROM sys.fn_trace_getinfo(0);_x000A_All currently defined traces for the SQL server instance will be listed. If no traces are returned, this is a finding._x000A__x000A_Determine the trace(s) being used for the auditing requirement. _x000A_In the following, replace # with a trace ID being used for the auditing requirements._x000A_From the query prompt:_x000A_     SELECT DISTINCT(eventid) FROM sys.fn_trace_geteventinfo(#);_x000A_The following required event IDs should be listed:_x000A_     14, 15, 18, 20, _x000A_     102, 103, 104, 105, 106, 107, 108, 109, 110, _x000A_     111, 112, 113, 115, 116, 117, 118, _x000A_     128, 129, 130, _x000A_     131, 132, 133, 134, 135, _x000A_     152, 153, _x000A_     170, 171, 172, 173, 175, 176, 177, 178._x000A_If any of the audit event IDs required above is not listed, this is a finding._x000A__x000A_Notes:_x000A_1. It is acceptable to have the required event IDs spread across multiple traces, provided all of the traces are always active, and the event IDs are grouped in a logical manner._x000A_2. It is acceptable, from an auditing point of view, to include the same event IDs in multiple traces.  However, the effect of this redundancy on performance, storage, and the consolidation of audit logs into a central repository, should be taken into account._x000A_3. It is acceptable to trace additional event IDs. This is the minimum list._x000A_4. Once this check is satisfied, the DBA may find it useful to disable or modify the default trace that is set up by the SQL Server installation process. (Note that the Fix does NOT include code to do this.)  _x000A_Use the following query to obtain a list of all event IDs, and their meaning:_x000A_     SELECT * FROM sys.trace_events; _x000A_5. Because this check procedure is designed to address multiple requirements/vulnerabilities, it may appear to exceed the needs of some individual requirements.  However, it does represent the aggregate of all such requirements._x000A_6. Microsoft has flagged the trace techniques and tools used in this Check and Fix as deprecated.  They will be removed at some point after SQL Server 2014.  The replacement feature is Extended Events.  If Extended Events are in use, and cover all the required audit events listed above, this is not a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="440">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2012</S>
      <S N="VulnID">V-41028</S>
      <S N="RuleID">SV-53403r4_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL2-00-012300</S>
      <S N="Title">SQL Server must produce audit records containing sufficient information to establish the identity of any user/subject associated with the event.</S>
      <S N="Description">Information system auditing capability is critical for accurate forensic analysis. Audit record content which may be necessary to satisfy the requirement of this control includes:  time stamps, source and destination addresses, user/process identifiers, event descriptions, success/fail indications, file names involved, and access control or flow control rules invoked. _x000A__x000A_Database software is capable of a range of actions on data stored within the database. It is important, for accurate forensic analysis, to know exactly who performed a given action. If user identification information is not recorded and stored with the audit record, the record itself is of very limited use.</S>
      <S N="FixText">Create a trace that meets all auditing requirements._x000A__x000A_The script provided in the supplemental file, Trace.sql, can be used to do this; edit it as necessary to capture any additional, locally defined events.</S>
      <S N="Check">Check to see that all required events are being audited._x000A_From the query prompt:_x000A_     SELECT DISTINCT traceid FROM sys.fn_trace_getinfo(0);_x000A_All currently defined traces for the SQL server instance will be listed. If no traces are returned, this is a finding._x000A__x000A_Determine the trace(s) being used for the auditing requirement. _x000A_In the following, replace # with a trace ID being used for the auditing requirements._x000A_From the query prompt:_x000A_     SELECT DISTINCT(eventid) FROM sys.fn_trace_geteventinfo(#);_x000A_The following required event IDs should be listed:_x000A_     14, 15, 18, 20, _x000A_     102, 103, 104, 105, 106, 107, 108, 109, 110, _x000A_     111, 112, 113, 115, 116, 117, 118, _x000A_     128, 129, 130, _x000A_     131, 132, 133, 134, 135, _x000A_     152, 153, _x000A_     170, 171, 172, 173, 175, 176, 177, 178._x000A_If any of the audit event IDs required above is not listed, this is a finding._x000A__x000A_Notes:_x000A_1. It is acceptable to have the required event IDs spread across multiple traces, provided all of the traces are always active, and the event IDs are grouped in a logical manner._x000A_2. It is acceptable, from an auditing point of view, to include the same event IDs in multiple traces.  However, the effect of this redundancy on performance, storage, and the consolidation of audit logs into a central repository, should be taken into account._x000A_3. It is acceptable to trace additional event IDs. This is the minimum list._x000A_4. Once this check is satisfied, the DBA may find it useful to disable or modify the default trace that is set up by the SQL Server installation process. (Note that the Fix does NOT include code to do this.)  _x000A_Use the following query to obtain a list of all event IDs, and their meaning:_x000A_     SELECT * FROM sys.trace_events; _x000A_5. Because this check procedure is designed to address multiple requirements/vulnerabilities, it may appear to exceed the needs of some individual requirements.  However, it does represent the aggregate of all such requirements._x000A_6. Microsoft has flagged the trace techniques and tools used in this Check and Fix as deprecated.  They will be removed at some point after SQL Server 2014.  The replacement feature is Extended Events.  If Extended Events are in use, and cover all the required audit events listed above, this is not a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="441">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2012</S>
      <S N="VulnID">V-41029</S>
      <S N="RuleID">SV-53404r4_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL2-00-012200</S>
      <S N="Title">SQL Server must produce audit records containing sufficient information to establish the outcome (success or failure) of the events.</S>
      <S N="Description">Information system auditing capability is critical for accurate forensic analysis. Audit record content which may be necessary to satisfy the requirement of this control includes, but is not limited to:  time stamps, source and destination addresses, user/process identifiers, event descriptions, success/fail indications, file names involved, and access control or flow control rules invoked. _x000A__x000A_SQL Server is capable of a range of actions on data stored within the database. It is important, for accurate forensic analysis, to know the outcome of attempted actions. This requires specific information regarding the outcome of the action or event that the audit record is referring to. If outcome status information is not recorded and stored with the audit record, the record itself is of very limited use._x000A__x000A_Success and failure indicators ascertain the outcome of a particular event. As such, they also provide a means to measure the impact of an event and help authorized personnel to determine the appropriate response. Without knowing the outcome of audit events, it is very difficult to accurately recreate the series of events during forensic analysis._x000A__x000A_If auditing is enabled, SQL Server does capture the outcome status-specific information in all audit records.</S>
      <S N="FixText">Create a trace that meets all auditing requirements._x000A__x000A_The script provided in the supplemental file, Trace.sql, can be used to do this; edit it as necessary to capture any additional, locally defined events.</S>
      <S N="Check">Check to see that all required events are being audited._x000A_From the query prompt:_x000A_     SELECT DISTINCT traceid FROM sys.fn_trace_getinfo(0);_x000A_All currently defined traces for the SQL server instance will be listed. If no traces are returned, this is a finding._x000A__x000A_Determine the trace(s) being used for the auditing requirement. _x000A_In the following, replace # with a trace ID being used for the auditing requirements._x000A_From the query prompt:_x000A_     SELECT DISTINCT(eventid) FROM sys.fn_trace_geteventinfo(#);_x000A_The following required event IDs should be listed:_x000A_     14, 15, 18, 20, _x000A_     102, 103, 104, 105, 106, 107, 108, 109, 110, _x000A_     111, 112, 113, 115, 116, 117, 118, _x000A_     128, 129, 130, _x000A_     131, 132, 133, 134, 135, _x000A_     152, 153, _x000A_     170, 171, 172, 173, 175, 176, 177, 178._x000A_If any of the audit event IDs required above is not listed, this is a finding._x000A__x000A_Notes:_x000A_1. It is acceptable to have the required event IDs spread across multiple traces, provided all of the traces are always active, and the event IDs are grouped in a logical manner._x000A_2. It is acceptable, from an auditing point of view, to include the same event IDs in multiple traces.  However, the effect of this redundancy on performance, storage, and the consolidation of audit logs into a central repository, should be taken into account._x000A_3. It is acceptable to trace additional event IDs. This is the minimum list._x000A_4. Once this check is satisfied, the DBA may find it useful to disable or modify the default trace that is set up by the SQL Server installation process. (Note that the Fix does NOT include code to do this.)  _x000A_Use the following query to obtain a list of all event IDs, and their meaning:_x000A_     SELECT * FROM sys.trace_events; _x000A_5. Because this check procedure is designed to address multiple requirements/vulnerabilities, it may appear to exceed the needs of some individual requirements.  However, it does represent the aggregate of all such requirements._x000A_6. Microsoft has flagged the trace techniques and tools used in this Check and Fix as deprecated.  They will be removed at some point after SQL Server 2014.  The replacement feature is Extended Events.  If Extended Events are in use, and cover all the required audit events listed above, this is not a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="442">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2012</S>
      <S N="VulnID">V-41030</S>
      <S N="RuleID">SV-53405r4_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL2-00-012100</S>
      <S N="Title">SQL Server must produce audit records containing sufficient information to establish the sources (origins) of the events.</S>
      <S N="Description">Information system auditing capability is critical for accurate forensic analysis. Audit record content which may be necessary to satisfy the requirement of this control includes, but is not limited to:  time stamps, source and destination addresses, user/process identifiers, event descriptions, success/fail indications, file names involved, and access control or flow control rules invoked. _x000A__x000A_SQL Server is capable of a range of actions on data stored within the database. It is important, for accurate forensic analysis, to know exactly who performed what actions. This requires specific information regarding the source of the event an audit record is referring to. If the source of the event information is not recorded and stored with the audit record, the record itself is of very limited use._x000A__x000A_The source of the event can be a user account and sometimes a system account when timed jobs are run. Without information establishing the source of activity, the value of audit records from a forensics perspective is questionable. If auditing is enabled, SQL Server does capture the source of the event-specific information in all audit records.</S>
      <S N="FixText">Create a trace that meets all auditing requirements._x000A__x000A_The script provided in the supplemental file, Trace.sql, can be used to do this; edit it as necessary to capture any additional, locally defined events.</S>
      <S N="Check">Check to see that all required events are being audited._x000A_From the query prompt:_x000A_     SELECT DISTINCT traceid FROM sys.fn_trace_getinfo(0);_x000A_All currently defined traces for the SQL server instance will be listed. If no traces are returned, this is a finding._x000A__x000A_Determine the trace(s) being used for the auditing requirement. _x000A_In the following, replace # with a trace ID being used for the auditing requirements._x000A_From the query prompt:_x000A_     SELECT DISTINCT(eventid) FROM sys.fn_trace_geteventinfo(#);_x000A_The following required event IDs should be listed:_x000A_     14, 15, 18, 20, _x000A_     102, 103, 104, 105, 106, 107, 108, 109, 110, _x000A_     111, 112, 113, 115, 116, 117, 118, _x000A_     128, 129, 130, _x000A_     131, 132, 133, 134, 135, _x000A_     152, 153, _x000A_     170, 171, 172, 173, 175, 176, 177, 178._x000A_If any of the audit event IDs required above is not listed, this is a finding._x000A__x000A_Notes:_x000A_1. It is acceptable to have the required event IDs spread across multiple traces, provided all of the traces are always active, and the event IDs are grouped in a logical manner._x000A_2. It is acceptable, from an auditing point of view, to include the same event IDs in multiple traces.  However, the effect of this redundancy on performance, storage, and the consolidation of audit logs into a central repository, should be taken into account._x000A_3. It is acceptable to trace additional event IDs. This is the minimum list._x000A_4. Once this check is satisfied, the DBA may find it useful to disable or modify the default trace that is set up by the SQL Server installation process. (Note that the Fix does NOT include code to do this.)  _x000A_Use the following query to obtain a list of all event IDs, and their meaning:_x000A_     SELECT * FROM sys.trace_events; _x000A_5. Because this check procedure is designed to address multiple requirements/vulnerabilities, it may appear to exceed the needs of some individual requirements.  However, it does represent the aggregate of all such requirements._x000A_6. Microsoft has flagged the trace techniques and tools used in this Check and Fix as deprecated.  They will be removed at some point after SQL Server 2014.  The replacement feature is Extended Events.  If Extended Events are in use, and cover all the required audit events listed above, this is not a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="443">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2012</S>
      <S N="VulnID">V-41031</S>
      <S N="RuleID">SV-53406r4_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL2-00-012000</S>
      <S N="Title">SQL Server must produce audit records containing sufficient information to establish where the events occurred.</S>
      <S N="Description">Information system auditing capability is critical for accurate forensic analysis. Audit record content which may be necessary to satisfy the requirement of this control includes, but is not limited to:  time stamps, source and destination addresses, user/process identifiers, event descriptions, success/fail indications, file names involved, and access control or flow control rules invoked. _x000A__x000A_SQL Server is capable of a range of actions on data stored within the database. It is important, for accurate forensic analysis, to know exactly where actions were performed. This requires specific information regarding the event location an audit record is referring to. If event location information is not recorded and stored with the audit record, the record itself is of very limited use._x000A__x000A_An event location can be a database instance, table, column, row, etc. Without sufficient information establishing where the audit events occurred, investigation into the cause of events is severely hindered. If auditing is enabled, SQL Server does capture the event location-specific information in all audit records.</S>
      <S N="FixText">Create a trace that meets all auditing requirements._x000A__x000A_The script provided in the supplemental file, Trace.sql, can be used to do this; edit it as necessary to capture any additional, locally defined events.</S>
      <S N="Check">Check to see that all required events are being audited._x000A_From the query prompt:_x000A_     SELECT DISTINCT traceid FROM sys.fn_trace_getinfo(0);_x000A_All currently defined traces for the SQL server instance will be listed. If no traces are returned, this is a finding._x000A__x000A_Determine the trace(s) being used for the auditing requirement. _x000A_In the following, replace # with a trace ID being used for the auditing requirements._x000A_From the query prompt:_x000A_     SELECT DISTINCT(eventid) FROM sys.fn_trace_geteventinfo(#);_x000A_The following required event IDs should be listed:_x000A_     14, 15, 18, 20, _x000A_     102, 103, 104, 105, 106, 107, 108, 109, 110, _x000A_     111, 112, 113, 115, 116, 117, 118, _x000A_     128, 129, 130, _x000A_     131, 132, 133, 134, 135, _x000A_     152, 153, _x000A_     170, 171, 172, 173, 175, 176, 177, 178._x000A_If any of the audit event IDs required above is not listed, this is a finding._x000A__x000A_Notes:_x000A_1. It is acceptable to have the required event IDs spread across multiple traces, provided all of the traces are always active, and the event IDs are grouped in a logical manner._x000A_2. It is acceptable, from an auditing point of view, to include the same event IDs in multiple traces.  However, the effect of this redundancy on performance, storage, and the consolidation of audit logs into a central repository, should be taken into account._x000A_3. It is acceptable to trace additional event IDs. This is the minimum list._x000A_4. Once this check is satisfied, the DBA may find it useful to disable or modify the default trace that is set up by the SQL Server installation process. (Note that the Fix does NOT include code to do this.)  _x000A_Use the following query to obtain a list of all event IDs, and their meaning:_x000A_     SELECT * FROM sys.trace_events; _x000A_5. Because this check procedure is designed to address multiple requirements/vulnerabilities, it may appear to exceed the needs of some individual requirements.  However, it does represent the aggregate of all such requirements._x000A_6. Microsoft has flagged the trace techniques and tools used in this Check and Fix as deprecated.  They will be removed at some point after SQL Server 2014.  The replacement feature is Extended Events.  If Extended Events are in use, and cover all the required audit events listed above, this is not a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="444">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2012</S>
      <S N="VulnID">V-41032</S>
      <S N="RuleID">SV-53407r4_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL2-00-011900</S>
      <S N="Title">SQL Server must produce audit records containing sufficient information to establish when (date and time) the events occurred.</S>
      <S N="Description">Information system auditing capability is critical for accurate forensic analysis. Audit record content which may be necessary to satisfy the requirement of this control includes, but is not limited to:  time stamps, source and destination addresses, user/process identifiers, event descriptions, success/fail indications, file names involved, and access control or flow control rules invoked. _x000A__x000A_SQL Server is capable of a range of actions on data stored within the database. It is important, for accurate forensic analysis, to know exactly when actions were performed. This requires specific information regarding the date and time an audit record is referring to. If date and time information is not recorded and stored with the audit record, the record itself is of very limited use._x000A__x000A_If auditing is enabled, SQL Server does capture the date and time-specific information in all audit records.</S>
      <S N="FixText">Create a trace that meets all auditing requirements._x000A__x000A_The script provided in the supplemental file, Trace.sql, can be used to do this; edit it as necessary to capture any additional, locally defined events.</S>
      <S N="Check">Check to see that all required events are being audited._x000A_From the query prompt:_x000A_     SELECT DISTINCT traceid FROM sys.fn_trace_getinfo(0);_x000A_All currently defined traces for the SQL server instance will be listed. If no traces are returned, this is a finding._x000A__x000A_Determine the trace(s) being used for the auditing requirement. _x000A_In the following, replace # with a trace ID being used for the auditing requirements._x000A_From the query prompt:_x000A_     SELECT DISTINCT(eventid) FROM sys.fn_trace_geteventinfo(#);_x000A_The following required event IDs should be listed:_x000A_     14, 15, 18, 20, _x000A_     102, 103, 104, 105, 106, 107, 108, 109, 110, _x000A_     111, 112, 113, 115, 116, 117, 118, _x000A_     128, 129, 130, _x000A_     131, 132, 133, 134, 135, _x000A_     152, 153, _x000A_     170, 171, 172, 173, 175, 176, 177, 178._x000A_If any of the audit event IDs required above is not listed, this is a finding._x000A__x000A_Notes:_x000A_1. It is acceptable to have the required event IDs spread across multiple traces, provided all of the traces are always active, and the event IDs are grouped in a logical manner._x000A_2. It is acceptable, from an auditing point of view, to include the same event IDs in multiple traces.  However, the effect of this redundancy on performance, storage, and the consolidation of audit logs into a central repository, should be taken into account._x000A_3. It is acceptable to trace additional event IDs. This is the minimum list._x000A_4. Once this check is satisfied, the DBA may find it useful to disable or modify the default trace that is set up by the SQL Server installation process. (Note that the Fix does NOT include code to do this.)  _x000A_Use the following query to obtain a list of all event IDs, and their meaning:_x000A_     SELECT * FROM sys.trace_events; _x000A_5. Because this check procedure is designed to address multiple requirements/vulnerabilities, it may appear to exceed the needs of some individual requirements.  However, it does represent the aggregate of all such requirements._x000A_6. Microsoft has flagged the trace techniques and tools used in this Check and Fix as deprecated.  They will be removed at some point after SQL Server 2014.  The replacement feature is Extended Events.  If Extended Events are in use, and cover all the required audit events listed above, this is not a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="445">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2012</S>
      <S N="VulnID">V-41033</S>
      <S N="RuleID">SV-53408r4_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL2-00-011800</S>
      <S N="Title">SQL Server must produce audit records containing sufficient information to establish what type of events occurred.</S>
      <S N="Description">Information system auditing capability is critical for accurate forensic analysis. Audit record content which may be necessary to satisfy the requirement of this control includes, but is not limited to:  time stamps, source and destination addresses, user/process identifiers, event descriptions, success/fail indications, file names involved, and access control or flow control rules invoked. _x000A__x000A_SQL Server is capable of a range of actions on data stored within the database. It is important, for accurate forensic analysis, to know exactly what actions were performed. This requires specific information regarding the event type an audit record is referring to. If event type information is not recorded and stored with the audit record, the record itself is of very limited use._x000A__x000A_If auditing is enabled, SQL Server does capture the event type-specific information in all audit records.</S>
      <S N="FixText">Create a trace that meets all auditing requirements._x000A__x000A_The script provided in the supplemental file, Trace.sql, can be used to do this; edit it as necessary to capture any additional, locally defined events.</S>
      <S N="Check">Check to see that all required events are being audited._x000A_From the query prompt:_x000A_     SELECT DISTINCT traceid FROM sys.fn_trace_getinfo(0);_x000A_All currently defined traces for the SQL server instance will be listed. If no traces are returned, this is a finding._x000A__x000A_Determine the trace(s) being used for the auditing requirement. _x000A_In the following, replace # with a trace ID being used for the auditing requirements._x000A_From the query prompt:_x000A_     SELECT DISTINCT(eventid) FROM sys.fn_trace_geteventinfo(#);_x000A_The following required event IDs should be listed:_x000A_     14, 15, 18, 20, _x000A_     102, 103, 104, 105, 106, 107, 108, 109, 110, _x000A_     111, 112, 113, 115, 116, 117, 118, _x000A_     128, 129, 130, _x000A_     131, 132, 133, 134, 135, _x000A_     152, 153, _x000A_     170, 171, 172, 173, 175, 176, 177, 178._x000A_If any of the audit event IDs required above is not listed, this is a finding._x000A__x000A_Notes:_x000A_1. It is acceptable to have the required event IDs spread across multiple traces, provided all of the traces are always active, and the event IDs are grouped in a logical manner._x000A_2. It is acceptable, from an auditing point of view, to include the same event IDs in multiple traces.  However, the effect of this redundancy on performance, storage, and the consolidation of audit logs into a central repository, should be taken into account._x000A_3. It is acceptable to trace additional event IDs. This is the minimum list._x000A_4. Once this check is satisfied, the DBA may find it useful to disable or modify the default trace that is set up by the SQL Server installation process. (Note that the Fix does NOT include code to do this.)  _x000A_Use the following query to obtain a list of all event IDs, and their meaning:_x000A_     SELECT * FROM sys.trace_events; _x000A_5. Because this check procedure is designed to address multiple requirements/vulnerabilities, it may appear to exceed the needs of some individual requirements.  However, it does represent the aggregate of all such requirements._x000A_6. Microsoft has flagged the trace techniques and tools used in this Check and Fix as deprecated.  They will be removed at some point after SQL Server 2014.  The replacement feature is Extended Events.  If Extended Events are in use, and cover all the required audit events listed above, this is not a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="446">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2012</S>
      <S N="VulnID">V-41034</S>
      <S N="RuleID">SV-53409r4_rule</S>
      <S N="Severity">low</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL2-00-023700</S>
      <S N="Title">SQL Server must protect against an individual using a shared account from falsely denying having performed a particular action.</S>
      <S N="Description">Non-repudiation of actions taken is required in order to maintain application integrity. Examples of particular actions taken by individuals include creating information, sending a message, approving information (e.g., indicating concurrence or signing a contract), and receiving a message._x000A__x000A_Non-repudiation protects individuals against later claims by an author of not having authored a particular document, a sender of not having transmitted a message, a receiver of not having received a message, or a signatory of not having signed a document._x000A__x000A_Use of shared accounts does not provide individual accountability for actions taken on the DBMS or data. Whenever a single database account is used to connect to the database, a secondary authentication method that provides individual accountability is required. This scenario most frequently occurs when an externally hosted application authenticates individual users to the application and the application uses a single account to retrieve or update database information on behalf of the individual users (as in connection pooling)._x000A__x000A_When shared accounts are utilized without another means of identifying individual users, users may deny having performed a particular action._x000A__x000A_(Shared accounts should not be confused with Windows groups, which are used in role-based access control.)tru</S>
      <S N="FixText">Remove user-accessible shared accounts and use individual userids._x000A__x000A_Build/configure applications to ensure successful individual authentication prior to shared account access._x000A__x000A_Ensure each user's identity is received and used in audit data in all relevant circumstances._x000A__x000A_Design, develop, and implement a method to log use of any account to which more than one person has access. Restrict interactive access to shared accounts to the fewest persons possible.</S>
      <S N="Check">Obtain the list of authorized SQL Server accounts in the system documentation._x000A__x000A_If accounts are determined to be shared, determine if individuals are first individually authenticated. If individuals are not individually authenticated before using the shared account (e.g., by the operating system or possibly by an application making calls to the database), this is a finding. (The key is individual accountability. If this can be traced, this is not a finding.) _x000A__x000A_If accounts are determined to be shared, determine if they are directly accessible to end users.  If so, this is a finding. _x000A__x000A_Review contents of audit logs, traces and data tables to confirm that the identity of the individual user performing the action is captured.  If shared identifiers are found, and not accompanied by individual identifiers, this is a finding._x000A__x000A_Note:  Privileged installation accounts may be required to be accessed by the DBA or other administrators for system maintenance. In these cases, each use of the account must be logged in some manner to assign accountability for any actions taken during the use of the account.</S>
    </MS>
  </Obj>
  <Obj RefId="447">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2012</S>
      <S N="VulnID">V-41035</S>
      <S N="RuleID">SV-53410r4_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL2-00-011400</S>
      <S N="Title">SQL Server must generate audit records for the DoD-selected list of auditable events.</S>
      <S N="Description">Audit records can be generated from various components within the information system, such as network interfaces, hard disks, modems, etc. From an application perspective, certain specific application functionalities may be audited, as well._x000A__x000A_The list of audited events is the set of events for which audits are to be generated. This set of events is typically a subset of the list of all events for which the system is capable of generating audit records (i.e., auditable events, time stamps, source and destination addresses, user/process identifiers, event descriptions, success/fail indications, file names involved, and access control or flow control rules invoked)._x000A__x000A_Organizations may define the organizational personnel accountable for determining which application components shall provide auditable events._x000A__x000A_Auditing provides accountability for changes made to the SQL Server configuration or its objects and data. It provides a means to discover suspicious activity and unauthorized changes. Without auditing, a compromise may go undetected and without a means to determine accountability.</S>
      <S N="FixText">Create a trace that meets all auditing requirements._x000A__x000A_The script provided in the supplemental file, Trace.sql, can be used to do this; edit it as necessary to capture any additional, locally defined events.</S>
      <S N="Check">Check to see that all required events are being audited._x000A_From the query prompt:_x000A_     SELECT DISTINCT traceid FROM sys.fn_trace_getinfo(0);_x000A_All currently defined traces for the SQL server instance will be listed. If no traces are returned, this is a finding._x000A__x000A_Determine the trace(s) being used for the auditing requirement. _x000A_In the following, replace # with a trace ID being used for the auditing requirements._x000A_From the query prompt:_x000A_     SELECT DISTINCT(eventid) FROM sys.fn_trace_geteventinfo(#);_x000A_The following required event IDs should be listed:_x000A_     14, 15, 18, 20, _x000A_     102, 103, 104, 105, 106, 107, 108, 109, 110, _x000A_     111, 112, 113, 115, 116, 117, 118, _x000A_     128, 129, 130, _x000A_     131, 132, 133, 134, 135, _x000A_     152, 153, _x000A_     170, 171, 172, 173, 175, 176, 177, 178._x000A_If any of the audit event IDs required above is not listed, this is a finding._x000A__x000A_Notes:_x000A_1. It is acceptable to have the required event IDs spread across multiple traces, provided all of the traces are always active, and the event IDs are grouped in a logical manner._x000A_2. It is acceptable, from an auditing point of view, to include the same event IDs in multiple traces.  However, the effect of this redundancy on performance, storage, and the consolidation of audit logs into a central repository, should be taken into account._x000A_3. It is acceptable to trace additional event IDs. This is the minimum list._x000A_4. Once this check is satisfied, the DBA may find it useful to disable or modify the default trace that is set up by the SQL Server installation process. (Note that the Fix does NOT include code to do this.)  _x000A_Use the following query to obtain a list of all event IDs, and their meaning:_x000A_     SELECT * FROM sys.trace_events; _x000A_5. Because this check procedure is designed to address multiple requirements/vulnerabilities, it may appear to exceed the needs of some individual requirements.  However, it does represent the aggregate of all such requirements._x000A_6. Microsoft has flagged the trace techniques and tools used in this Check and Fix as deprecated.  They will be removed at some point after SQL Server 2014.  The replacement feature is Extended Events.  If Extended Events are in use, and cover all the required audit events listed above, this is not a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="448">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2012</S>
      <S N="VulnID">V-41036</S>
      <S N="RuleID">SV-53411r4_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL2-00-023600</S>
      <S N="Title">SQL Server must be configured to use Windows Integrated Security.</S>
      <S N="Description">SQL Server Authentication does not provide for many of the authentication requirements of the DoD. In some cases workarounds are present, but the authentication is not as robust and does not provide needed functionality. Without that functionality, SQL Server is vulnerable to authentication attacks.  Consideration must be given to the placement of SQL server inside a forest to ensure evaluation of risk within the environment is considered.  Risk includes introduction of risk to SQL Server from other applications or workstations as well as risk from introduction of SQL server itself into an established environment.tru</S>
      <S N="FixText">From SQL Server Management Studio, right-click the server, and then click Properties._x000A__x000A_Select the Security page. Under Server authentication, select Windows Authentication Mode, and then click OK.</S>
      <S N="Check">To determine the Server Authentication Mode, execute the following:_x000A__x000A_EXEC XP_LOGINCONFIG 'login mode'_x000A__x000A_If the config_value does not equal "Windows NT Authentication", this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="449">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2012</S>
      <S N="VulnID">V-41037</S>
      <S N="RuleID">SV-53412r2_rule</S>
      <S N="Severity">low</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL2-00-010200</S>
      <S N="Title">SQL Server default account sa must have its name changed.</S>
      <S N="Description">SQL Server's 'sa' account has special privileges required to administer the database. The 'sa' account is a well-known SQL Server account name and is likely to be targeted by attackers, and is thus more prone to providing unauthorized access to the database._x000A__x000A_Since the SQL Server 'sa' is administrative in nature, the compromise of a default account can have catastrophic consequences, including the complete loss of control over SQL Server. Since SQL Server needs for this account to exist and it should not be removed, one way to mitigate this risk is to change the 'sa' account name.</S>
      <S N="FixText">Navigate to SQL Server Management Studio &gt;&gt; Object Explorer &gt;&gt; &lt;'SQL Server name'&gt; &gt;&gt; Security &gt;&gt; Logins &gt;&gt; click 'sa' account name._x000A__x000A_Hit &lt;F2&gt; while the name is highlighted in order to edit the name._x000A__x000A_Rename the 'sa' account.</S>
      <S N="Check">Verify the SQL Server default 'sa' account name has been changed._x000A__x000A_Navigate to SQL Server Management Studio &gt;&gt; Object Explorer &gt;&gt; &lt;'SQL Server name'&gt; &gt;&gt; Security &gt;&gt; Logins._x000A__x000A_If SQL Server default 'sa' account name is in the 'Logins' list, this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="450">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2012</S>
      <S N="VulnID">V-41038</S>
      <S N="RuleID">SV-53413r2_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL2-00-010100</S>
      <S N="Title">Use of the SQL Server software installation account must be restricted to SQL Server software installation.</S>
      <S N="Description">This requirement is intended to limit exposure due to operating from within a privileged account. SQL Server does support the organizational requirement that users of information system accounts with access to an organization-defined list of security functions or security-relevant information use non-privileged accounts and roles, when accessing other (non-security) system functions._x000A__x000A_Use of privileged accounts for non-administrative purposes puts data at risk of unintended or unauthorized loss, modification, or exposure. In particular, DBA accounts if used for non-administration application development or application maintenance can lead to miss-assignment of privileges where privileges are inherited by object owners. It may also lead to loss or compromise of application data where the elevated privileges bypass controls designed in, and provided by, applications._x000A__x000A_The SQL Server installation account requires privileges not required for SQL Server administration or other functions. Use of accounts configured with excess privileges may result in the loss or compromise of data or system settings due to elevated privileges that bypass controls designed to protect them.</S>
      <S N="FixText">Restrict usage of the SQL Server installation account to SQL Server installation, upgrade, and maintenance actions only._x000A__x000A_Disable installation accounts when authorized actions are not being performed.</S>
      <S N="Check">Review system documentation to identify the installation account. Verify whether the account is used for anything beyond SQL Server software installation, upgrade, and maintenance actions._x000A__x000A_If the account is used for anything beyond SQL Server installation, upgrade, and maintenance actions, this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="451">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2012</S>
      <S N="VulnID">V-41039</S>
      <S N="RuleID">SV-53414r4_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL2-00-010000</S>
      <S N="Title">DBA OS or domain accounts must be granted only those host system privileges necessary for the administration of SQL Server.</S>
      <S N="Description">SQL Server DBAs, if assigned excessive OS privileges, could perform actions that could endanger the information system or hide evidence of malicious activity._x000A__x000A_This requirement is intended to limit exposure due to operating from within a privileged account or role. The check and fix are based on the assumption that Role-Based Access Control (RBAC) is in effect, as mandated by other STIG requirements.  They further assume that, as mandated elsewhere, the privileged accounts discussed here are distinct from the accounts used by the same people when not performing privileged functions.tru</S>
      <S N="FixText">_x000A_Remove any unnecessary privileges and any unauthorized members from the Group(s) representing DBAs._x000A__x000A_Remove any unnecessary Group memberships from the user accounts representing DBAs.</S>
      <S N="Check">From the system security documentation, obtain the list of SQL Server DBA accounts, the OS/domain Group(s) representing those DBAs' job role(s), and the OS permissions required by that/those role(s)._x000A__x000A__x000A_To review local accounts and groups:_x000A__x000A_Log on to the Windows server hosting SQL Server, using an account with administrator privileges._x000A__x000A_From a command prompt opened as administrator, type gpedit.msc, and press [ENTER].  In Group Policy Editor, navigate to Local Computer Policy &gt; Computer Configuration &gt; Windows Settings &gt; Security Settings &gt; Local Policies &gt; User Rights Assignment.  Scan the list to determine which privileges are assigned to the Group(s) representing the SQL Server DBA job role(s).  If any privileges are assigned that are not required by these roles, this is a finding._x000A__x000A_From the command prompt, type lusrmgr.msc, and press [ENTER].  In the Local Users and Groups console, navigate to Users.  Right-click each DBA user. Click Properties. Click the 'Member of' tab.  If any parent groups are listed that are not specific to DBA roles, this is a finding._x000A__x000A_In the Local Users and Groups console, navigate to Groups.  Right-click each DBA Group.  Click Properties.  Review the list of group members.  If any account that does not represent a DBA is listed, this is a finding._x000A__x000A__x000A_To review domain-level accounts and groups:_x000A__x000A_Log on to a domain controller with the necessary privileges._x000A__x000A_Open Active Directory Users and Computers (available from menus or run dsa.msc)_x000A__x000A_Determine the location of the accounts or groups to be reviewed.  The default is the Users container, but they could have been created or moved to an Organizational Unit (OU) that is domain specific._x000A__x000A_Right-click each DBA user. Click Properties. Click the 'Member of' tab.  If any parent groups are listed that are not specific to DBA roles, this is a finding._x000A__x000A_Right-click each DBA Group.  Click Properties.  Select the 'Members' tab. Review the list of group members.  If any account that does not represent a DBA is listed, this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="452">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2012</S>
      <S N="VulnID">V-41040</S>
      <S N="RuleID">SV-53415r3_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL2-00-009900</S>
      <S N="Title">OS and domain accounts utilized to run external procedures called by SQL Server must have limited privileges.</S>
      <S N="Description">This requirement is intended to limit exposure due to operating from within a privileged account or role. The inclusion of role is intended to address those situations where an access control policy, such as Role-Based Access Control (RBAC), is being implemented and where a change of role provides the same degree of assurance in the change of access authorizations for both the user and all processes acting on behalf of the user as would be provided by a change between a privileged and non-privileged account._x000A__x000A_To limit exposure when operating from within a privileged account or role, the application must support organizational requirements that users of information system accounts, or roles, with access to an organization-defined list of security functions or security-relevant information, use non-privileged accounts, or roles, when accessing other (non-security) system functions._x000A__x000A_Use of privileged accounts for non-administrative purposes puts data at risk of unintended or unauthorized loss, modification, or exposure. In particular, DBA accounts, if used for non-administration application development or application maintenance, can lead to misassignment of privileges where privileges are inherited by object owners. It may also lead to loss or compromise of application data where the elevated privileges bypass controls designed in, and provided by, applications._x000A__x000A_External applications called by SQL Server may be executed under OS or domain accounts with unnecessary privileges. This can lead to unauthorized access to OS resources and compromise of the OS, SQL Server, or any other services provided by the host platform.</S>
      <S N="FixText">Limit privileges to SQL Server-related OS and domain accounts to those required privileges needed to perform their SQL Server-specific functionality.</S>
      <S N="Check">Determine which OS or domain accounts are used by SQL Server to run external procedures. Validate that these accounts have only the privileges necessary to perform the required functionality._x000A__x000A_If any OS or domain accounts utilized by SQL Server are running external procedures and have privileges beyond those required for running the external procedures, this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="453">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2012</S>
      <S N="VulnID">V-41041</S>
      <S N="RuleID">SV-53416r2_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL2-00-009800</S>
      <S N="Title">SQL Server DBA roles must not be assigned excessive or unauthorized privileges.</S>
      <S N="Description">This requirement is intended to limit exposure due to operating from within a privileged account or role. The inclusion of role is intended to address those situations where an access control policy, such as Role-Based Access Control (RBAC), is being implemented and where a change of role provides the same degree of assurance in the change of access authorizations for both the user and all processes acting on behalf of the user as would be provided by a change between a privileged and non-privileged account._x000A__x000A_Audit of privileged activity may require physical separation, employing information systems on which the user does not have privileged access._x000A__x000A_To limit exposure and provide forensic history of activity when operating from within a privileged account or role, SQL Server does support organizational requirements that users of information system accounts, or roles, with access to an organization-defined list of security functions or security-relevant information, use non-privileged accounts, or roles, when accessing other (non-security) system functions._x000A__x000A_SQL Server provides access logging that ensures users who are granted a privileged role (or roles) have their privileged activity logged. DBAs, if assigned excessive privileges, could perform actions that endanger the information system or hide evidence of malicious activity.</S>
      <S N="FixText">Remove permissions from DBAs and other administrative users beyond those required for administrative functions._x000A__x000A_Navigate to SQL Server Management Studio &gt;&gt; Object Explorer &gt;&gt; &lt;'SQL Server name'&gt; &gt;&gt; Security &gt;&gt; Logins &gt;&gt; right click &lt;'administrator account name'&gt; &gt;&gt; Properties &gt;&gt; User &gt;&gt; Securables._x000A__x000A_Remove 'Securables' permissions from DBAs and other administrative users that are beyond what is required._x000A__x000A_Navigate from 'Securables' to 'Server Roles'._x000A__x000A_Remove 'Server Roles' permissions from DBAs and other administrative users that are beyond what is required._x000A__x000A_Navigate from 'Server Roles' to 'Users mapped to the login'._x000A__x000A_Remove 'Users mapped to the login' permissions from DBAs and other administrative users that are beyond what is required.</S>
      <S N="Check">Obtain the list of all DBAs._x000A_Obtain documented role assignments for each DBA._x000A_Obtain from system documentation or use SQL Server to determine privilege assignment of user-defined roles._x000A__x000A_Navigate to SQL Server Management Studio &gt;&gt; Object Explorer &gt;&gt; &lt;'SQL Server name'&gt; &gt;&gt; Security &gt;&gt; Logins &gt;&gt; right click &lt;'administrator account name'&gt; &gt;&gt; Properties &gt;&gt; User &gt;&gt; Securables._x000A__x000A_If any item in the 'Permission' listing, for each highlighted item that exists in the 'Securables' listing, has excessive privileges, this is a finding._x000A__x000A_Navigate from 'Securables' to 'Server Roles'._x000A__x000A_If any checked 'Server roles' are determined to be excessive privileges, this is a finding._x000A__x000A_Navigate from 'Server Roles' to 'Users mapped to the login'._x000A__x000A_If any checked 'Database role membership' of each highlighted and checked 'Database' are determined to be excessive privileges, this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="454">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2012</S>
      <S N="VulnID">V-41042</S>
      <S N="RuleID">SV-53417r5_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL2-00-009700</S>
      <S N="Title">All use of privileged accounts must be audited.</S>
      <S N="Description">This is intended to limit exposure, by making it possible to trace any unauthorized access to other data or functionality by a privileged user account or role that has permissions on security functions or security-relevant information.</S>
      <S N="FixText">Create a trace that meets all auditing requirements._x000A__x000A_The script provided in the supplemental file, Trace.sql, can be used to do this; edit it as necessary to capture any additional, locally defined events.</S>
      <S N="Check">Check to see that all required events are being audited._x000A_From the query prompt:_x000A__x000A_SELECT DISTINCT traceid FROM sys.fn_trace_getinfo(0);_x000A__x000A_All currently defined traces for the SQL server instance will be listed. If no traces are returned, this is a finding._x000A__x000A_Determine the trace(s) being used for the auditing requirement._x000A_In the following, replace # with a trace ID being used for the auditing requirements._x000A_From the query prompt:_x000A__x000A_SELECT DISTINCT(eventid) FROM sys.fn_trace_geteventinfo(#);_x000A_The following required event IDs should be listed:_x000A_14, 15, 18, 20,_x000A_102, 103, 104, 105, 106, 107, 108, 109, 110,_x000A_111, 112, 113, 115, 116, 117, 118,_x000A_128, 129, 130,_x000A_131, 132, 133, 134, 135,_x000A_152, 153,_x000A_170, 171, 172, 173, 175, 176, 177, 178._x000A__x000A_If any of the audit event IDs required above is not listed, this is a finding._x000A__x000A_Notes:_x000A_1. It is acceptable to have the required event IDs spread across multiple traces, provided all of the traces are always active, and the event IDs are grouped in a logical manner._x000A_2. It is acceptable, from an auditing point of view, to include the same event IDs in multiple traces. However, the effect of this redundancy on performance, storage, and the consolidation of audit logs into a central repository, should be taken into account._x000A_3. It is acceptable to trace additional event IDs. This is the minimum list._x000A_4. Once this check is satisfied, the DBA may find it useful to disable or modify the default trace that is set up by the SQL Server installation process. (Note that the Fix does NOT include code to do this.)_x000A_Use the following query to obtain a list of all event IDs, and their meaning:_x000A_SELECT * FROM sys.trace_events;_x000A_5. Because this check procedure is designed to address multiple requirements/vulnerabilities, it may appear to exceed the needs of some individual requirements. However, it does represent the aggregate of all such requirements._x000A_6. Microsoft has flagged the trace techniques and tools used in this Check and Fix as deprecated. They will be removed at some point after SQL Server 2014. The replacement feature is Extended Events. If Extended Events are in use, and cover all the required audit events listed above, this is not a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="455">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2012</S>
      <S N="VulnID">V-41043</S>
      <S N="RuleID">SV-53418r2_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL2-00-009600</S>
      <S N="Title">Administrators must utilize a separate, distinct administrative account when performing administrative activities, accessing database security functions, or accessing security-relevant information within SQL Server.</S>
      <S N="Description">This requirement is intended to limit exposure due to operating from within a privileged account or role. The inclusion of role is intended to address those situations where an access control policy, such as Role-Based Access Control (RBAC), is being implemented and where a change of role provides the same degree of assurance in the change of access authorizations for both the user and all processes acting on behalf of the user as would be provided by a change between a privileged and non-privileged account._x000A__x000A_To limit exposure when operating from within a privileged account or role, SQL Server does support organizational requirements that users of information system accounts, or roles, with access to an organization-defined list of security functions or security-relevant information, use non-privileged accounts, or roles, when accessing other (non-security) system functions._x000A__x000A_When privileged activities are not separated from non-privileged activities, SQL Server could be subject to unauthorized changes of settings or data, which a standard user would not normally have access to outside of an authorized maintenance session. Often, administrator accounts have a unique prefix to help with identification. These accounts are located within SQL Server and may only provide access to one database instance or a limited number of database objects.</S>
      <S N="FixText">Remove DBA privileges and privileges to administer owned objects that are assigned to the administrator's non-DBA account._x000A_Remove the permission access from the account that has direct access by running the following script:_x000A_USE master_x000A_REVOKE &lt;'server privilege name'&gt; TO &lt;'account name'&gt;_x000A_GO_x000A__x000A_Remove the user account from the role's Member list where the account is not authorized for specified permission by running the following script:_x000A_USE master_x000A_ALTER SERVER ROLE [&lt;'server role name'&gt;] DROP MEMBER &lt;'user name'&gt;_x000A_GO_x000A__x000A_Provide administrators with separate accounts for administration and regular accounts for non-administrator activity.</S>
      <S N="Check">Obtain a list of SQL Server DBAs or other administrative accounts. Run the following SQL script to check all users’ permissions:_x000A__x000A_SELECT SP1.[name] AS 'Login', 'Role: ' + SP2.[name] COLLATE DATABASE_DEFAULT AS 'ServerPermission'_x000A_FROM sys.server_principals SP1_x000A_  JOIN sys.server_role_members SRM_x000A_    ON SP1.principal_id = SRM.member_principal_id_x000A_  JOIN sys.server_principals SP2_x000A_    ON SRM.role_principal_id = SP2.principal_id_x000A_UNION ALL_x000A_SELECT SP.[name] AS 'Login' , SPerm.state_desc + ' ' + SPerm.permission_name COLLATE DATABASE_DEFAULT AS 'ServerPermission'_x000A_  FROM sys.server_principals SP_x000A_  JOIN sys.server_permissions SPerm_x000A_    ON SP.principal_id = SPerm.grantee_principal_id_x000A_ORDER BY [Login], [ServerPermission]_x000A__x000A_If any DBA or administrative objects are owned by non-DBA or non-administrative accounts, this is a finding._x000A__x000A_If any DBA or administrator has authorization for non- administrative access to the system for which they are the administrator and they do not have a non-administrator account, this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="456">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2012</S>
      <S N="VulnID">V-41044</S>
      <S N="RuleID">SV-53419r5_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL2-00-009400</S>
      <S N="Title">SQL Server must restrict access to system tables, other configuration information, and metadata to DBAs and other authorized users.</S>
      <S N="Description">The principle of Least Privilege must be applied to the ability of users to access system tables, system management information, other configuration information, and metadata.  Unauthorized access to this data could result in unauthorized changes to database objects, access controls, or SQL Server configuration.  Only database administrators and other authorized users must be allowed such access._x000A__x000A_To aid in tracking and administering such permissions, individual logins must not be directly granted permissions or built-in server roles.  Instead, user-defined server roles must be created, with the permissions and built-in server roles granted to them; the individual logins must be assigned to the appropriate user-defined server roles._x000A__x000A_The built-in server role "sysadmin" is a partial exception.  This cannot be granted to a user-defined role, only to a login account.  Most (not necessarily all) database administrators will need to be members of sysadmin.  Without this, most DBCC commands and the system stored procedures/functions listed below are unavailable.  The users who require such access must be documented and approved.  _x000A__x000A_In addition, if the site uses backup-restore software that connects to SQL Server via the Virtual Device Interface (VDI), the account used by that software must have the sysadmin role.  (See Microsoft Knowledge Base article 2926557, http://support.microsoft.com/kb/2926557).  If this applies, it must be documented and approved._x000A__x000A_Stored procedures/functions available only to the sysadmin role:_x000A_fn_yukonsecuritymodelrequired_x000A_sp_add_agent_parameter_x000A_sp_add_agent_profile_x000A_sp_adddatatype_x000A_sp_adddistributiondb_x000A_sp_adddistributor_x000A_sp_addqreader_agent_x000A_sp_addsubscriber_x000A_sp_addsubscriber_schedule_x000A_sp_addtabletocontents_x000A_sp_attachsubscription_x000A_sp_cdc_cleanup_change_table_x000A_sp_cdc_disable_db_x000A_sp_cdc_disable_table_x000A_sp_cdc_drop_job_x000A_sp_cdc_enable_db_x000A_sp_cdc_enable_table_x000A_sp_cdc_restoredb_x000A_sp_cdc_vupgrade_x000A_sp_certify_removable_x000A_sp_change_agent_parameter_x000A_sp_change_agent_profile_x000A_sp_change_subscription_properties_x000A_sp_change_users_login_x000A_sp_changedistpublisher_x000A_sp_changedistributiondb_x000A_sp_changedistributor_password_x000A_sp_changedistributor_property_x000A_sp_changemergesubscription_x000A_sp_changeqreader_agent_x000A_sp_changereplicationserverpasswords_x000A_sp_changesubscriptiondtsinfo_x000A_sp_checkinvalidivarticle_x000A_sp_copysubscription_x000A_sp_create_removable_x000A_sp_cycle_errorlog_x000A_sp_dbcmptlevel_x000A_sp_dbmmonitoraddmonitoring_x000A_sp_dbmmonitorchangealert_x000A_sp_dbmmonitordropalert_x000A_sp_dbmmonitordropmonitoring_x000A_sp_dbmmonitorhelpalert_x000A_sp_dbmmonitorhelpmonitoring_x000A_sp_dbmmonitorresults_x000A_sp_dbmmonitorupdate_x000A_sp_dbremove_x000A_sp_drop_agent_parameter_x000A_sp_drop_agent_profile_x000A_sp_dropdatatypemapping_x000A_sp_dropdistpublisher_x000A_sp_dropdistributiondb_x000A_sp_dropdistributor_x000A_sp_dropmergepullsubscription_x000A_sp_droppullsubscription_x000A_sp_dropsubscriber_x000A_sp_dsninfo_x000A_sp_enumdsn_x000A_sp_flush_commit_table_on_demand_x000A_sp_generate_agent_parameter_x000A_sp_get_distributor_x000A_sp_get_Oracle_publisher_metadata_x000A_sp_getagentparameterlist_x000A_sp_getdefaultdatatypemapping_x000A_sp_grant_publication_access_x000A_sp_help_agent_default_x000A_sp_help_agent_parameter_x000A_sp_help_agent_profile_x000A_sp_helpdistpublisher_x000A_sp_helpdistributor_x000A_sp_helpmergesubscription_x000A_sp_helpqreader_agent_x000A_sp_helpreplicationdboption_x000A_sp_identitycolumnforreplication_x000A_sp_IHValidateRowFilter_x000A_sp_IHXactSetJob_x000A_sp_link_publication_x000A_sp_monitor_x000A_sp_MSadd_distribution_agent_x000A_sp_MSadd_logreader_agent_x000A_sp_MSadd_merge_agent_x000A_sp_MSadd_snapshot_agent_x000A_sp_MSadd_subscriber_schedule_x000A_sp_MSadd_tracer_history_x000A_sp_MSadd_tracer_token_x000A_sp_MScdc_cleanup_job_x000A_sp_MScdc_db_ddl_event_x000A_sp_MScdc_ddl_event_x000A_sp_MSchange_distribution_agent_properties_x000A_sp_MSchange_logreader_agent_properties_x000A_sp_MSchange_merge_agent_properties_x000A_sp_MSchange_snapshot_agent_properties_x000A_sp_MSchangedynamicsnapshotjobatdistributor_x000A_sp_MSchangedynsnaplocationatdistributor_x000A_sp_MScheck_pull_access_x000A_sp_MScleanupmergepublisher_internal_x000A_sp_MSclear_dynamic_snapshot_location_x000A_sp_MScreate_dist_tables_x000A_sp_MSdbuserpriv_x000A_sp_MSdeletefoldercontents_x000A_sp_MSdrop_6x_replication_agent_x000A_sp_MSdrop_merge_agent_x000A_sp_MSdrop_snapshot_dirs_x000A_sp_MSdropmergedynamicsnapshotjob_x000A_sp_MSdynamicsnapshotjobexistsatdistributor_x000A_sp_MSenumallpublications_x000A_sp_MSfetchAdjustidentityrange_x000A_sp_MSfix_6x_tasks_x000A_sp_MSforce_drop_distribution_jobs_x000A_sp_MSget_agent_names_x000A_sp_MSget_jobstate_x000A_sp_MSget_oledbinfo_x000A_sp_MSget_publication_from_taskname_x000A_sp_MSgetdbversion_x000A_sp_MSgetmaxsnapshottimestamp_x000A_sp_MShelp_repl_agent_x000A_sp_MShelp_replication_status_x000A_sp_MShelp_snapshot_agent_x000A_sp_MShelpconflictpublications_x000A_sp_MShelpdynamicsnapshotjobatdistributor_x000A_sp_MShelplogreader_agent_x000A_sp_MShelpsnapshot_agent_x000A_sp_MShelptranconflictcounts_x000A_sp_MSinit_publication_access_x000A_sp_MSreinit_failed_subscriptions_x000A_sp_MSremoveoffloadparameter_x000A_sp_MSrepl_backup_complete_x000A_sp_MSrepl_backup_start_x000A_sp_MSrepl_createdatatypemappings_x000A_sp_MSrepl_dropdatatypemappings_x000A_sp_MSrepl_enumarticlecolumninfo_x000A_sp_MSrepl_enumpublications_x000A_sp_MSrepl_enumpublishertables_x000A_sp_MSrepl_enumsubscriptions_x000A_sp_MSrepl_enumtablecolumninfo_x000A_sp_MSrepl_getdistributorinfo_x000A_sp_MSrepl_startup_internal_x000A_sp_MSreplagentjobexists_x000A_sp_MSreplcheck_permission_x000A_sp_MSreplcheck_pull_x000A_sp_MSreplcheck_subscribe_x000A_sp_MSreplcheck_subscribe_withddladmin_x000A_sp_MSreplcopyscriptfile_x000A_sp_MSreplremoveuncdir_x000A_sp_MSsetalertinfo_x000A_sp_MSSetServerProperties_x000A_sp_MSsetupnosyncsubwithlsnatdist_x000A_sp_MSsetupnosyncsubwithlsnatdist_cleanup_x000A_sp_MSsetupnosyncsubwithlsnatdist_helper_x000A_sp_MSstartdistribution_agent_x000A_sp_MSstartmerge_agent_x000A_sp_MSstartsnapshot_agent_x000A_sp_MSstopdistribution_agent_x000A_sp_MSstopmerge_agent_x000A_sp_MSstopsnapshot_agent_x000A_sp_MSupdate_agenttype_default_x000A_sp_oledbinfo_x000A_sp_procoption_x000A_sp_removedbreplication_x000A_sp_removesrvreplication_x000A_sp_replication_agent_checkup_x000A_sp_replicationdboption_x000A_sp_resetstatus_x000A_sp_restoredbreplication_x000A_sp_SetAutoSAPasswordAndDisable_x000A_sp_setdefaultdatatypemapping_x000A_sp_updatestats_x000A_sp_validatelogins_x000A_sp_vupgrade_mergeobjects_x000A_sp_vupgrade_replication_x000A_sp_vupgrade_replsecurity_metadata_x000A_xp_repl_convert_encrypt_sysadmin_wrapper_x000A_tru</S>
      <S N="FixText">If necessary memberships in the sysadmin role are not documented or not approved, document them and obtain approval._x000A__x000A_If unnecessary memberships in the sysadmin role are documented, remove them from the documentation._x000A__x000A_Remove all direct access permissions and unauthorized permissions as required using the below instructions:_x000A__x000A_In SQL Server Management Studio, Object Explorer, expand  &lt;SQL Server instance&gt; &gt;&gt; Security &gt;&gt; Logins &gt;&gt; Right-click &lt;user account name&gt; &gt;&gt; Properties &gt;&gt; User &gt;&gt; Securables._x000A__x000A_Remove Securables permissions from user account._x000A__x000A_Navigate from Securables to Server Roles._x000A__x000A_Remove Server Roles permissions from user account._x000A__x000A_Navigate from Server Roles to Users Mapping._x000A__x000A_Remove direct permissions on db_accessadmin, db_backupoperator, db_datareader, db_datawriter, db_ddladmin, db_denydatareader, db_denydatawriter, db_owner, and db_securityadmin from user account.</S>
      <S N="Check">Use SQL Server and system documentation to determine privilege assignment of user-defined roles._x000A__x000A_Determine which user-defined roles grant privileges to system tables and configuration data stored in SQL Server._x000A__x000A_For each Login:_x000A__x000A_In SQL Server Management Studio, Object Explorer, expand &lt;SQL Server instance&gt; &gt;&gt; Security &gt;&gt; Logins &gt;&gt; Right-click &lt;login account name&gt; &gt;&gt; Properties &gt;&gt; User &gt;&gt; Securables._x000A__x000A_If any item in the Explicit Permissions listing, for each highlighted item that exists in the Securables listing, indicates direct permission access, and that permission is anything other than Connect SQL, this is a finding._x000A__x000A_Navigate from Securables to Server Roles._x000A__x000A_If any Server Roles are checked from the following list, indicating direct permission access, this is a finding:_x000A_bulkadmin_x000A_dbcreator_x000A_diskadmin_x000A_processadmin_x000A_securityadmin_x000A_serveradmin_x000A_setupadmin_x000A__x000A_If the sysadmin server role is checked, review system documentation to determine whether this login's need for the sysadmin role is documented and approved. If it is not, this is a finding._x000A__x000A_If any user-defined server roles with system table or configuration data privileges are checked, review system documentation to determine whether this login's need for the role is documented and approved. If it is not, this is a finding._x000A__x000A_Navigate from Server Roles to User Mapping. Select in turn each entry where the User column is non-blank. If any Database Roles are checked from the following list, indicating direct permission access, this is a finding:_x000A_db_accessadmin_x000A_db_backupoperator_x000A_db_datareader_x000A_db_datawriter_x000A_db_ddladmin_x000A_db_denydatareader_x000A_db_denydatawriter_x000A_db_owner_x000A_db_securityadmin</S>
    </MS>
  </Obj>
  <Obj RefId="457">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2012</S>
      <S N="VulnID">V-41045</S>
      <S N="RuleID">SV-53420r2_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL2-00-009100</S>
      <S N="Title">A single SQL Server database connection configuration file (or a single set of credentials) must not be used to configure all database clients.</S>
      <S N="Description">Applications employ the concept of least privilege for specific duties and information systems (including specific functions, ports, protocols, and services). The concept of least privilege is also applied to information system processes, ensuring that the processes operate at privilege levels no higher than necessary to accomplish required organizational missions and/or functions. Organizations consider the creation of additional processes, roles, and information system accounts as necessary to achieve least privilege. Organizations also apply least privilege concepts to the design, development, implementation, and operations of information systems._x000A__x000A_Many sites distribute a single SQL Server connection configuration file to all site database users that contains network access information for all databases on the site. Such a file provides information to access SQL Server databases not required by all users that may assist in unauthorized access attempts.</S>
      <S N="FixText">Implement procedures to supply SQL Server database connection information to only those databases authorized for the user.</S>
      <S N="Check">Check procedures for providing SQL Server database connection information to users/applications. If procedures do not indicate or implement restrictions to connections required by the particular user/application which indicate process of least privilege and specific authorization was employed, this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="458">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2012</S>
      <S N="VulnID">V-41046</S>
      <S N="RuleID">SV-53421r2_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL2-00-009000</S>
      <S N="Title">SQL Server must restrict access to sensitive information to authorized user roles.</S>
      <S N="Description">Applications employ the concept of least privilege for specific duties and information systems (including specific functions, ports, protocols, and services). The concept of least privilege is also applied to information system processes, ensuring that the processes operate at privilege levels no higher than necessary to accomplish required organizational missions and/or functions. Organizations consider the creation of additional processes, roles, and information system accounts as necessary to achieve least privilege. Organizations also apply least privilege concepts to the design, development, implementation, and operations of information systems._x000A__x000A_Unauthorized access to sensitive data may compromise the confidentiality of personnel privacy, threaten national security or compromise a variety of other sensitive operations. Access controls are best managed by defining requirements based on distinct job functions and assigning access based on the job function assigned to the individual user.</S>
      <S N="FixText">Add the user-defined server role to the system documentation._x000A__x000A_Add the assigned privileges of the user-defined server role to the system documentation._x000A__x000A_Remove the user from direct access to server permission by running the following script:_x000A_USE master_x000A_REVOKE &lt;'server permission name'&gt; TO &lt;'account name'&gt; CASCADE_x000A__x000A_Remove server role permission from the user-defined server role by running the following script:_x000A_USE master_x000A_REVOKE &lt;'server role name'&gt; TO [&lt;'server role name'&gt;]_x000A__x000A_Rename the user-defined role by running the following script:_x000A_USE master_x000A_ALTER SERVER ROLE [&lt;'old role name'&gt;] WITH NAME = [&lt;'new role name'&gt;]</S>
      <S N="Check">Obtain the list of available user-defined server roles from system documentation._x000A__x000A_Obtain the list of available user-defined server roles from the SQL Server system by running the following script:_x000A_/**********************************************************************************_x000A_ LIST ALL INDIRECT (via ROLES) ACCESS TO THE SERVER PERMISSION._x000A_ ***********************************************************************************/_x000A_DECLARE @admin_Account_name sysname_x000A_SET @admin_Account_name = 'NO admin ACCOUNT found'_x000A_DECLARE @server_name sysname_x000A_SET @server_name = 'NO Server found'_x000A__x000A_SELECT @server_name = name FROM sys.servers_x000A_ WHERE server_id = 0_x000A_SET @admin_Account_name = @server_name  + '\Administrator'_x000A__x000A_SELECT pe.grantee_principal_id_x000A_     , pr.type AS 'Grantee_Type'_x000A_     , pr.name AS 'Grantee_Name'_x000A_     , pe.type_x000A_     , pe.permission_name_x000A_     , pe.state_x000A_     , pe.state_desc_x000A_  FROM sys.server_permissions pe_x000A_  JOIN sys.server_principals pr_x000A_    ON pe.grantee_principal_id = pr.principal_id_x000A_  JOIN sys.server_principals ps_x000A_    ON pe.grantor_principal_id = ps.principal_id_x000A_  LEFT JOIN sys.server_principals us_x000A_    ON us.principal_id = pe.major_id_x000A_ WHERE pr.type IN ('R')_x000A_   AND pe.grantee_principal_id &gt; 10_x000A_   AND NOT pr.name IN ('##MS_PolicyEventProcessingLogin##', '##MS_PolicyTsqlExecutionLogin##',_x000A_                       'NT AUTHORITY\NETWORK SERVICE', 'NT AUTHORITY\SYSTEM', 'NT SERVICE\MSSQLSERVER',_x000A_                       'NT SERVICE\SQLSERVERAGENT', 'NT SERVICE\SQLWriter', 'NT SERVICE\Winmgmt')_x000A_   AND NOT pr.name = @admin_Account_name_x000A_ ORDER BY CASE pe.state_x000A_             WHEN 'D' THEN 1_x000A_             WHEN 'W' THEN 2_x000A_             WHEN 'G' THEN 3_x000A_             ELSE 4_x000A_          END_x000A__x000A_If any listed user-defined roles are not found in the system documentation, this is a finding._x000A__x000A_Obtain the list assigned privileges for all user-defined roles in the system documentation._x000A__x000A_Check all SQL Server user-defined server roles for access rights as it relates to the separation of duties. Repeat steps for each user-defined server role._x000A_Navigate to SQL Server Management Studio &gt;&gt; Object Explorer &gt;&gt; &lt;'SQL Server name'&gt; &gt;&gt; Security &gt;&gt; Server Roles &gt;&gt; right click &lt;'user-defined server role name'&gt; &gt;&gt; Properties &gt;&gt; General &gt;&gt; Securables. If any user-defined role is assigned privileges that are not documented in the system documentation, this is a finding._x000A__x000A_If any user-defined role contains permissions that are inconsistent with separation sensitive information assignment, this is a finding._x000A__x000A_If system access requires more than one level of sensitive information access and the user-defined role names do not clearly differentiate between the different levels of sensitive information, this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="459">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2012</S>
      <S N="VulnID">V-41047</S>
      <S N="RuleID">SV-53422r4_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL2-00-008900</S>
      <S N="Title">SQL Server processes or services must run under custom, dedicated OS or domain accounts.</S>
      <S N="Description">Separation of duties is a prevalent Information Technology control that is implemented at different layers of the information system, including the operating system and in applications. It serves to eliminate or reduce the possibility that a single user may carry out a prohibited action. Separation of duties requires that the person accountable for approving an action is not the same person who is tasked with implementing or carrying out that action. _x000A__x000A_The concept of separation of duties extends to processes.  The DBMS must run under a custom, dedicated OS or domain account.  When the DBMS is running under a shared account, users with access to that account could inadvertently or maliciously make changes to the DBMS’s settings, files, or permissions.  Similarly, related services must run under dedicated accounts where this is possible.  The SQL Server Browser and Writer services are exceptions: see http://msdn.microsoft.com/en-us/library/hh510203(v=sql.110).aspx  and  http://msdn.microsoft.com/en-us/library/ms175536(v=sql.110).aspx.tru</S>
      <S N="FixText">Configure the SQL Server services to use a custom, dedicated OS or domain account.</S>
      <S N="Check">Check OS settings to determine whether SQL Server processes are running under a dedicated OS or domain account. If the SQL Server processes are running under shared accounts, this is a finding._x000A__x000A_From a Command Prompt, type services.msc, and press [ENTER]. Scroll down to the SQL Server Services. SQL Server Services begin with SQL.  The following services, when present, should be listed as follows:_x000A__x000A_Service Name:_x0009__x0009__x0009__x0009__x0009_Log On As:_x000A_SQL Full-text Filter Daemon Launcher:_x0009__x0009_NT Service\UNIQUE CUSTOM ACCOUNT_x000A_SQL Server [stand-alone]:_x0009__x0009__x0009_NT Service\UNIQUE CUSTOM ACCOUNT_x000A_SQL Server [cluster]:_x0009__x0009__x0009__x0009_&lt;domain&gt;\&lt;CustomServiceAccount&gt;_x000A_SQL Server Agent:_x0009__x0009__x0009__x0009_NT Service\UNIQUE CUSTOM ACCOUNT_x000A_SQL Server Analysis Services:_x0009__x0009__x0009_NT Service\UNIQUE CUSTOM ACCOUNT_x000A_SQL Server Browser:_x0009__x0009__x0009__x0009_Local Service_x000A_SQL Server Distributed Replay Client:_x0009__x0009_NT Service\UNIQUE CUSTOM ACCOUNT_x000A_SQL Server Distributed Replay Controller:_x0009_NT Service\UNIQUE CUSTOM ACCOUNT_x000A_SQL Server Integration Services 11.0:_x0009__x0009_NT Service\UNIQUE CUSTOM ACCOUNT_x000A_SQL Server Reporting Services:_x0009__x0009__x0009_NT Service\UNIQUE CUSTOM ACCOUNT_x000A_SQL Server VSS Writer:_x0009__x0009__x0009__x0009_Local System_x000A__x000A_UNIQUE CUSTOM ACCOUNT refers to an account with which no other service listed in the services.msc window is assigned. If any account requiring a unique custom account uses an account that any other service utilizes (regardless of service status), this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="460">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2012</S>
      <S N="VulnID">V-41202</S>
      <S N="RuleID">SV-53669r3_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL2-00-008800</S>
      <S N="Title">SQL Server must enforce separation of duties through assigned information access authorizations.</S>
      <S N="Description">Separation of duties is a prevalent Information Technology control that is implemented at different layers of the information system, including the operating system and in applications. It serves to eliminate or reduce the possibility that a single user may carry out a prohibited action. Separation of duties requires that the person accountable for approving an action is not the same person who is tasked with implementing or carrying out that action._x000A__x000A_Additionally, the person or entity accountable for monitoring the activity must be separate as well. To meet this requirement, applications, when applicable, shall be divided where functionality is based on roles and duties. Examples of separation of duties include: (i) mission functions and distinct information system support functions are divided among different individuals/roles; (ii) different individuals perform information system support functions (e.g., system management, systems programming, configuration management, quality assurance and testing, network security); (iii) security personnel who administer access control functions do not administer audit functions; and (iv) different administrator accounts for different roles._x000A__x000A_Privileges granted outside the role of the application user job function are more likely to go unmanaged or without oversight for authorization. Maintenance of privileges using roles defined for discrete job functions offers improved oversight of application user privilege assignments and helps to protect against unauthorized privilege assignment.</S>
      <S N="FixText">Add the user-defined server role to the system documentation._x000A__x000A_Add the assigned privileges of the user-defined server role to the system documentation._x000A__x000A_Remove the user from direct access to server permission by running the following script:_x000A_USE master_x000A_REVOKE &lt;'server permission name'&gt; TO &lt;'account name'&gt; CASCADE_x000A__x000A_Remove server role permission from the user-defined server role by running the following script:_x000A_USE master_x000A_REVOKE &lt;'server role name'&gt; TO [&lt;'server role name'&gt;]</S>
      <S N="Check">Check for direct user assignment to server permissions by running the following script:_x000A_/**********************************************************************************_x000A_ LIST ALL DIRECT SERVER PERMISSIONS TO ANY ACCOUNT EXCEPT_x000A_  SYSTEM ADMINISTRATOR accounts.  DO NOT LIST ROLES._x000A_***********************************************************************************/_x000A_DECLARE @admin_Account_name sysname_x000A_SET @admin_Account_name = 'NO administrator account found'_x000A_DECLARE @server_name sysname_x000A_SET @server_name = 'NO Server found'_x000A__x000A_SELECT @server_name = name FROM sys.servers_x000A_ WHERE server_id = 0_x000A_SET @admin_Account_name = @server_name  + '\Administrator'_x000A__x000A_SELECT pe.grantee_principal_id_x000A_     , pr.type AS 'Grantee_Type'_x000A_     , pr.name AS 'Grantee_Name'_x000A_     , pe.type_x000A_     , pe.permission_name_x000A_     , pe.state_x000A_     , pe.state_desc_x000A_  FROM sys.server_permissions pe_x000A_  JOIN sys.server_principals pr_x000A_    ON pe.grantee_principal_id = pr.principal_id_x000A_  JOIN sys.server_principals ps_x000A_    ON pe.grantor_principal_id = ps.principal_id_x000A_  LEFT JOIN sys.server_principals us_x000A_    ON us.principal_id = pe.major_id_x000A_ WHERE pr.type IN ('K', 'S', 'U')_x000A_   AND pe.grantee_principal_id &gt; 10_x000A_   AND NOT pr.name IN ('##MS_PolicyEventProcessingLogin##', '##MS_PolicyTsqlExecutionLogin##',_x000A_                       'NT AUTHORITY\NETWORK SERVICE', 'NT AUTHORITY\SYSTEM', 'NT SERVICE\MSSQLSERVER',_x000A_                       'NT SERVICE\SQLSERVERAGENT', 'NT SERVICE\SQLWriter', 'NT SERVICE\Winmgmt')_x000A_   AND NOT pr.name = @admin_Account_name_x000A_ ORDER BY CASE pr.type_x000A_             WHEN 'K' THEN 1_x000A_             WHEN 'S' THEN 2_x000A_             WHEN 'U' THEN 3_x000A_             ELSE 4_x000A_          END_x000A__x000A_If any user account list indicates direct access to any server permission, this is a finding._x000A__x000A_Obtain the list of available user-defined server roles from system documentation._x000A__x000A_Obtain the list of available user-defined server roles from the SQL Server system by running the following script:_x000A_/**********************************************************************************_x000A_ LIST ALL INDIRECT (via ROLES) ACCESS TO THE SERVER PERMISSION._x000A_ ***********************************************************************************/_x000A_DECLARE @admin_Account_name sysname_x000A_SET @admin_Account_name = 'NO admin ACCOUNT found'_x000A_DECLARE @server_name sysname_x000A_SET @server_name = 'NO Server found'_x000A__x000A_SELECT @server_name = name FROM sys.servers_x000A_ WHERE server_id = 0_x000A_SET @admin_Account_name = @server_name  + '\Administrator'_x000A__x000A_SELECT pe.grantee_principal_id_x000A_     , pr.type AS 'Grantee_Type'_x000A_     , pr.name AS 'Grantee_Name'_x000A_     , pe.type_x000A_     , pe.permission_name_x000A_     , pe.state_x000A_     , pe.state_desc_x000A_  FROM sys.server_permissions pe_x000A_  JOIN sys.server_principals pr_x000A_    ON pe.grantee_principal_id = pr.principal_id_x000A_  JOIN sys.server_principals ps_x000A_    ON pe.grantor_principal_id = ps.principal_id_x000A_  LEFT JOIN sys.server_principals us_x000A_    ON us.principal_id = pe.major_id_x000A_ WHERE pr.type IN ('R')_x000A_   AND pe.grantee_principal_id &gt; 10_x000A_   AND NOT pr.name IN ('##MS_PolicyEventProcessingLogin##', '##MS_PolicyTsqlExecutionLogin##',_x000A_                       'NT AUTHORITY\NETWORK SERVICE', 'NT AUTHORITY\SYSTEM', 'NT SERVICE\MSSQLSERVER',_x000A_                       'NT SERVICE\SQLSERVERAGENT', 'NT SERVICE\SQLWriter', 'NT SERVICE\Winmgmt')_x000A_   AND NOT pr.name = @admin_Account_name_x000A_ ORDER BY CASE pe.state_x000A_             WHEN 'D' THEN 1_x000A_             WHEN 'W' THEN 2_x000A_             WHEN 'G' THEN 3_x000A_             ELSE 4_x000A_          END_x000A__x000A_If any listed user-defined roles are not found in the system documentation, this is a finding._x000A__x000A_Obtain the list of assigned privileges for all user-defined roles in the system documentation._x000A__x000A_Check all SQL Server user-defined server roles for access rights as it relates to the separation of duties. Repeat steps for each user-defined server role._x000A_Navigate to SQL Server Management Studio &gt;&gt; Object Explorer &gt;&gt; &lt;'SQL Server name'&gt; &gt;&gt; Security &gt;&gt; Server Roles &gt;&gt; right click &lt;'user-defined server role name'&gt; &gt;&gt; Properties &gt;&gt; General &gt;&gt; Securables.  If any roles are found that do not enforce separation of duties, this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="461">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2012</S>
      <S N="VulnID">V-41204</S>
      <S N="RuleID">SV-53671r4_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL2-00-011000</S>
      <S N="Title">SQL Server utilizing Discretionary Access Control (DAC) must enforce a policy that limits propagation of access rights.</S>
      <S N="Description">Discretionary Access Control (DAC) is based on the premise that individual users are "owners" of objects and therefore have discretion over who should be authorized to access the object and in which mode (e.g., read or write)._x000A__x000A_These DAC concepts extend to the server level.  Server instances have the potential for the access controls to propagate without limit, resulting in unauthorized access._x000A__x000A_The DBMS must ensure the recipient of server permissions possesses only the access intended. The DBMS must enforce the ability to limit unauthorized rights propagation. If propagation is not prevented, users can continue to grant rights to other users without limit.tru</S>
      <S N="FixText">Document and obtain approval for each GRANT_WITH_GRANT_OPTION that is required._x000A__x000A_Correct each unapproved GRANT_WITH_GRANT_OPTION with REVOKE and GRANT statements of the form (replacing "ALTER ANY DATABASE" with the actual server permission at issue):_x000A__x000A_REVOKE ALTER ANY DATABASE FROM SampleLoginOrServerRole CASCADE;_x000A_GRANT ALTER ANY DATABASE TO SampleServerRole;  -- Note, no WITH GRANT OPTION clause here.</S>
      <S N="Check">Check for rights propagation assignment to DBMS server permissions by running the following query:_x000A__x000A_USE master;_x000A_SELECT * _x000A_FROM sys.server_permissions_x000A_WHERE state_desc = 'GRANT_WITH_GRANT_OPTION';_x000A__x000A_If any of the permissions listed have not been documented and approved as requiring GRANT_WITH_GRANT_OPTION, this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="462">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2012</S>
      <S N="VulnID">V-41205</S>
      <S N="RuleID">SV-53672r3_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL2-00-008500</S>
      <S N="Title">SQL Server must enforce DAC policy allowing users to specify and control sharing by named individuals, groups of individuals, or by both; limiting propagation of access rights; and including or excluding access to the granularity of a single user.</S>
      <S N="Description">Access control policies (e.g., identity-based policies, role-based policies, attribute-based policies) and access enforcement mechanisms (e.g., access control lists, access control matrices, cryptography) are employed by organizations to control access between users (or processes acting on behalf of users) and objects (e.g., devices, files, records, processes, programs, domains)._x000A__x000A_DAC is a type of access control methodology serving as a means of restricting access to objects and data based on the identity of subjects and/or groups to which they belong. It is discretionary in the sense that application users with the appropriate permissions to access an application resource or data have the discretion to pass that permission on to another user either directly or indirectly._x000A__x000A_Data protection requirements may result in a DAC policy being specified as part of the application design. Discretionary access controls would be employed at the application level to restrict and control access to application objects and data, thereby providing increased information security for the organization._x000A__x000A_When DAC controls are employed, those controls must limit sharing to named application users, groups of users, or both. The application DAC controls must also limit the propagation of access rights and have the ability to exclude access to data down to the granularity of a single user._x000A__x000A_Databases using DAC must have the ability for the owner of an object or information to assign or revoke rights to view or modify the object or information. If the owner of an object or information does not have rights to exclude access to an object or information at a user level, users may gain access to objects and information they are not authorized to view/modify.</S>
      <S N="FixText">Add the user-defined server role to the system documentation._x000A__x000A_Add the user as a member of the user-defined server role within the system documentation._x000A__x000A_Remove the user from direct access to server permission by running the following script:_x000A_USE master_x000A_REVOKE &lt;'server permission name'&gt; TO &lt;'account name'&gt; CASCADE_x000A__x000A_Remove the user from user-defined role access by running the following script:_x000A_USE master_x000A_ALTER SERVER ROLE [&lt;'server role name'&gt;] DROP MEMBER &lt;'user name'&gt;_x000A__x000A_Add the user-defined role access to the user by running the following script:_x000A_USE master_x000A_ALTER SERVER ROLE [&lt;'server role name'&gt;] ADD  MEMBER &lt;'user name'&gt;</S>
      <S N="Check">Check for direct user assignment to server permissions by running the following script:_x000A_/**********************************************************************************_x000A_ LIST ALL DIRECT SERVER PERMISSIONS TO ANY ACCOUNT EXCEPT_x000A_  SYSTEM ADMINISTRATOR accounts.  DO NOT LIST ROLES._x000A_***********************************************************************************/_x000A_DECLARE @admin_Account_name sysname_x000A_SET @admin_Account_name = 'NO Administrator account found'_x000A_DECLARE @server_name sysname_x000A_SET @server_name = 'NO Server found'_x000A__x000A_SELECT @server_name = name FROM sys.servers_x000A_ WHERE server_id = 0_x000A_SET @admin_Account_name = @server_name  + '\Administrator'_x000A__x000A_SELECT pe.grantee_principal_id_x000A_     , pr.type AS 'Grantee_Type'_x000A_     , pr.name AS 'Grantee_Name'_x000A_     , pe.type_x000A_     , pe.permission_name_x000A_     , pe.state_x000A_     , pe.state_desc_x000A_  FROM sys.server_permissions pe_x000A_  JOIN sys.server_principals pr_x000A_    ON pe.grantee_principal_id = pr.principal_id_x000A_  JOIN sys.server_principals ps_x000A_    ON pe.grantor_principal_id = ps.principal_id_x000A_  LEFT JOIN sys.server_principals us_x000A_    ON us.principal_id = pe.major_id_x000A_ WHERE pr.type IN ('K', 'S', 'U')_x000A_   AND pe.grantee_principal_id &gt; 10_x000A_   AND NOT pr.name IN ('##MS_PolicyEventProcessingLogin##', '##MS_PolicyTsqlExecutionLogin##',_x000A_                       'NT AUTHORITY\NETWORK SERVICE', 'NT AUTHORITY\SYSTEM', 'NT SERVICE\MSSQLSERVER',_x000A_                       'NT SERVICE\SQLSERVERAGENT', 'NT SERVICE\SQLWriter', 'NT SERVICE\Winmgmt')_x000A_   AND NOT pr.name = @admin_Account_name_x000A_ ORDER BY CASE pr.type_x000A_             WHEN 'K' THEN 1_x000A_             WHEN 'S' THEN 2_x000A_             WHEN 'U' THEN 3_x000A_             ELSE 4_x000A_          END_x000A__x000A_If any user account list indicates direct access to any server permission, this is a finding._x000A__x000A_Obtain the list of available user-defined server roles from system documentation._x000A__x000A_Obtain the list of available user-defined server roles from the SQL Server system by running the following script:_x000A_/**********************************************************************************_x000A_ LIST ALL INDIRECT (via ROLES) ACCESS TO THE SERVER PERMISSION._x000A_ ***********************************************************************************/_x000A_DECLARE @admin_Account_name sysname_x000A_SET @admin_Account_name = 'NO admin ACCOUNT found'_x000A_DECLARE @server_name sysname_x000A_SET @server_name = 'NO Server found'_x000A__x000A_SELECT @server_name = name FROM sys.servers_x000A_ WHERE server_id = 0_x000A_SET @admin_Account_name = @server_name  + '\Administrator'_x000A__x000A_SELECT pe.grantee_principal_id_x000A_     , pr.type AS 'Grantee_Type'_x000A_     , pr.name AS 'Grantee_Name'_x000A_     , pe.type_x000A_     , pe.permission_name_x000A_     , pe.state_x000A_     , pe.state_desc_x000A_  FROM sys.server_permissions pe_x000A_  JOIN sys.server_principals pr_x000A_    ON pe.grantee_principal_id = pr.principal_id_x000A_  JOIN sys.server_principals ps_x000A_    ON pe.grantor_principal_id = ps.principal_id_x000A_  LEFT JOIN sys.server_principals us_x000A_    ON us.principal_id = pe.major_id_x000A_ WHERE pr.type IN ('R')_x000A_   AND pe.grantee_principal_id &gt; 10_x000A_   AND NOT pr.name IN ('##MS_PolicyEventProcessingLogin##', '##MS_PolicyTsqlExecutionLogin##',_x000A_                       'NT AUTHORITY\NETWORK SERVICE', 'NT AUTHORITY\SYSTEM', 'NT SERVICE\MSSQLSERVER',_x000A_                       'NT SERVICE\SQLSERVERAGENT', 'NT SERVICE\SQLWriter', 'NT SERVICE\Winmgmt')_x000A_   AND NOT pr.name = @admin_Account_name_x000A_ ORDER BY CASE pe.state_x000A_             WHEN 'D' THEN 1_x000A_             WHEN 'W' THEN 2_x000A_             WHEN 'G' THEN 3_x000A_             ELSE 4_x000A_          END_x000A__x000A_If any listed user-defined roles are not found in the system documentation, this is a finding._x000A__x000A_Obtain the list of user role assignments in the system documentation._x000A__x000A_Check all SQL Server user-defined server roles for authorized and documented permission assignments. Repeat steps for each user-defined server role._x000A_Navigate to SQL Server Management Studio &gt;&gt; Object Explorer &gt;&gt; &lt;'SQL Server name'&gt; &gt;&gt; Security &gt;&gt; Server Roles &gt;&gt; right click &lt;'user-defined server role name'&gt; &gt;&gt; Properties &gt;&gt; Members.  If any roles are found that are not authorized and documented, this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="463">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2012</S>
      <S N="VulnID">V-41206</S>
      <S N="RuleID">SV-53673r4_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL2-00-008400</S>
      <S N="Title">SQL Server must enforce access control policies to restrict the Unsafe assembly permission to only authorized roles.</S>
      <S N="Description">The concept of least privilege must be applied to SQL Server processes, ensuring that the processes operate at privilege levels no higher than necessary to accomplish required organizational missions and/or functions. Organizations consider the creation of additional processes, roles, and SQL Server accounts as necessary to achieve least privilege. Organizations also apply least privilege concepts to the design, development, implementation, and operations of SQL Server and the OS._x000A__x000A_Unauthorized access to sensitive data or SQL Server control may compromise the confidentiality of personnel privacy, threaten national security, compromise a variety of other sensitive operations or lead to a loss of system control. Access controls are best managed by defining requirements based on distinct job functions and assigning access based on the job function assigned to the individual user._x000A__x000A_SQL Server's 'Unsafe assembly' permission is a high server-level privilege that must only be granted to individual administration accounts through roles, and users who have access must require this privilege to accomplish the organizational missions and/or functions. If the 'Unsafe assembly' permission is granted to roles that are unauthorized to have this privilege, then this access must be removed._x000A__x000A_Additionally, the permission must not be denied to a role, because that could disable a user's legitimate access via another role._x000A__x000A_The fix for this vulnerability specifies the use of REVOKE.  Be aware that revoking a permission that is currently denied to a role or user does not necessarily disable the permission.  If the user or role can inherent the permission from another role, revoking the denied permission from the user or the first role can effectively enable the inherited permission.tru</S>
      <S N="FixText">Remove the 'Unsafe assembly' permission access from the role that is not authorized by executing the following query:_x000A__x000A__x000A_REVOKE Unsafe assembly TO &lt;'role name'&gt;</S>
      <S N="Check">Obtain the list of roles that are authorized for the SQL Server 'Unsafe assembly' permission and what 'Grant', 'Grant With', and/or 'Deny' privilege is authorized. Obtain the list of roles with that permission by running the following query:_x000A__x000A_SELECT _x000A_       who.name AS [Principal Name],_x000A_       who.type_desc AS [Principal Type],_x000A_       who.is_disabled AS [Principal Is Disabled],_x000A_       what.state_desc AS [Permission State],_x000A_       what.permission_name AS [Permission Name]_x000A_FROM _x000A_       sys.server_permissions what _x000A_       INNER JOIN sys.server_principals who_x000A_              ON who.principal_id = what.grantee_principal_id_x000A_WHERE_x000A_       what.permission_name = 'Unsafe assembly' _x000A_AND    who.type_desc = 'SERVER_ROLE'_x000A_ORDER BY_x000A_       who.name_x000A_;_x000A_GO_x000A__x000A_If any role has 'Grant', 'With Grant' or 'Deny' privileges to the 'Unsafe assembly' permission and the role is not authorized to have the permission, this is a finding._x000A__x000A_Alternatively, to provide a combined list for all requirements of this type:_x000A_SELECT _x000A__x0009_what.permission_name AS [Permission Name],_x000A__x0009_what.state_desc AS [Permission State],_x000A__x0009_who.name AS [Principal Name],_x000A__x0009_who.type_desc AS [Principal Type],_x000A__x0009_who.is_disabled AS [Principal Is Disabled]_x000A_FROM _x000A__x0009_sys.server_permissions what _x000A__x0009_INNER JOIN sys.server_principals who_x000A__x0009__x0009_ON who.principal_id = what.grantee_principal_id_x000A_WHERE_x000A__x0009_what.permission_name IN_x000A__x0009_(_x000A__x0009_'Administer bulk operations',_x000A__x0009_'Alter any availability group',_x000A__x0009_'Alter any connection',_x000A__x0009_'Alter any credential',_x000A__x0009_'Alter any database',_x000A__x0009_'Alter any endpoint ',_x000A__x0009_'Alter any event notification ',_x000A__x0009_'Alter any event session ',_x000A__x0009_'Alter any linked server',_x000A__x0009_'Alter any login',_x000A__x0009_'Alter any server audit',_x000A__x0009_'Alter any server role',_x000A__x0009_'Alter resources',_x000A__x0009_'Alter server state ',_x000A__x0009_'Alter Settings ',_x000A__x0009_'Alter trace',_x000A__x0009_'Authenticate server ',_x000A__x0009_'Control server',_x000A__x0009_'Create any database ',_x000A__x0009_'Create availability group',_x000A__x0009_'Create DDL event notification',_x000A__x0009_'Create endpoint',_x000A__x0009_'Create server role',_x000A__x0009_'Create trace event notification',_x000A__x0009_'External access assembly',_x000A__x0009_'Shutdown',_x000A__x0009_'Unsafe Assembly',_x000A__x0009_'View any database',_x000A__x0009_'View any definition',_x000A__x0009_'View server state'_x000A__x0009_)_x000A_AND_x0009_who.type_desc = 'SERVER_ROLE'_x000A_ORDER BY_x000A__x0009_what.permission_name,_x000A__x0009_who.name_x000A_;_x000A_GO</S>
    </MS>
  </Obj>
  <Obj RefId="464">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2012</S>
      <S N="VulnID">V-41207</S>
      <S N="RuleID">SV-53674r4_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL2-00-008300</S>
      <S N="Title">SQL Server must not grant users direct access to the Alter any endpoint permission.</S>
      <S N="Description">The concept of least privilege must be applied to SQL Server processes, ensuring that the processes operate at privilege levels no higher than necessary to accomplish required organizational missions and/or functions. Organizations consider the creation of additional processes, roles, and SQL Server accounts as necessary to achieve least privilege. Organizations also apply least privilege concepts to the design, development, implementation, and operations of SQL Server and the OS._x000A__x000A_Unauthorized access to sensitive data or SQL Server control may compromise the confidentiality of personnel privacy, threaten national security, compromise a variety of other sensitive operations or lead to a loss of system control. Access controls are best managed by defining requirements based on distinct job functions and assigning access based on the job function assigned to the individual user._x000A__x000A_Privileges granted outside of SQL Server's role-based account assignments are more likely to go unmanaged and without oversight of granted access. Maintenance of privileges using roles defined for discrete job functions offers improved oversight of application user privilege assignments and helps to protect against unauthorized privilege assignment._x000A__x000A_SQL Server's 'Alter any endpoint' permission is a high server-level privilege that must only be granted to individual administration accounts through roles. This administrative privilege must not be assigned directly to administrative user accounts. If administrative user accounts have direct access to administrative privileges, this access must be removed._x000A__x000A_Note that this does not apply to logins with names of the form '##MS...##'. These accounts are internal-use system principals provisioned by the DBMS, and required by it for specific purposes.tru</S>
      <S N="FixText">Remove the 'Alter any endpoint' permission access from the account that has direct access by running the following script:_x000A__x000A__x000A_USE master_x000A__x000A_REVOKE ALTER ANY ENDPOINT TO &lt;'account name'&gt;_x000A__x000A_GO</S>
      <S N="Check">Obtain the list of accounts that have direct access to the server-level permission 'Alter any endpoint' by running the following query:_x000A__x000A_SELECT _x000A_       who.name AS [Principal Name],_x000A_       who.type_desc AS [Principal Type],_x000A_       who.is_disabled AS [Principal Is Disabled],_x000A_       what.state_desc AS [Permission State],_x000A_       what.permission_name AS [Permission Name]_x000A_FROM _x000A_       sys.server_permissions what _x000A_       INNER JOIN sys.server_principals who_x000A_              ON who.principal_id = what.grantee_principal_id_x000A_WHERE_x000A_       what.permission_name = 'Alter any endpoint' _x000A_AND    who.name NOT LIKE '##MS%##'_x000A_AND    who.type_desc &lt;&gt; 'SERVER_ROLE'_x000A_ORDER BY_x000A_       who.name_x000A_;_x000A_GO_x000A__x000A_If any user accounts have direct access to the 'Alter any endpoint' permission, this is a finding._x000A__x000A_Alternatively, to provide a combined list for all requirements of this type:_x000A_SELECT _x000A__x0009_what.permission_name AS [Permission Name],_x000A__x0009_what.state_desc AS [Permission State],_x000A__x0009_who.name AS [Principal Name],_x000A__x0009_who.type_desc AS [Principal Type],_x000A__x0009_who.is_disabled AS [Principal Is Disabled]_x000A_FROM _x000A__x0009_sys.server_permissions what _x000A__x0009_INNER JOIN sys.server_principals who_x000A__x0009__x0009_ON who.principal_id = what.grantee_principal_id_x000A_WHERE_x000A__x0009_what.permission_name IN_x000A__x0009_(_x000A__x0009_'Administer bulk operations',_x000A__x0009_'Alter any availability group',_x000A__x0009_'Alter any connection',_x000A__x0009_'Alter any credential',_x000A__x0009_'Alter any database',_x000A__x0009_'Alter any endpoint ',_x000A__x0009_'Alter any event notification ',_x000A__x0009_'Alter any event session ',_x000A__x0009_'Alter any linked server',_x000A__x0009_'Alter any login',_x000A__x0009_'Alter any server audit',_x000A__x0009_'Alter any server role',_x000A__x0009_'Alter resources',_x000A__x0009_'Alter server state ',_x000A__x0009_'Alter Settings ',_x000A__x0009_'Alter trace',_x000A__x0009_'Authenticate server ',_x000A__x0009_'Control server',_x000A__x0009_'Create any database ',_x000A__x0009_'Create availability group',_x000A__x0009_'Create DDL event notification',_x000A__x0009_'Create endpoint',_x000A__x0009_'Create server role',_x000A__x0009_'Create trace event notification',_x000A__x0009_'External access assembly',_x000A__x0009_'Shutdown',_x000A__x0009_'Unsafe Assembly',_x000A__x0009_'View any database',_x000A__x0009_'View any definition',_x000A__x0009_'View server state'_x000A__x0009_)_x000A_AND    who.name NOT LIKE '##MS%##'_x000A_AND    who.type_desc &lt;&gt; 'SERVER_ROLE'_x000A_ORDER BY_x000A__x0009_what.permission_name,_x000A__x0009_who.name_x000A_;_x000A_GO</S>
    </MS>
  </Obj>
  <Obj RefId="465">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2012</S>
      <S N="VulnID">V-41208</S>
      <S N="RuleID">SV-53675r4_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL2-00-008200</S>
      <S N="Title">SQL Server must not grant users direct access to the Alter any database permission.</S>
      <S N="Description">The concept of least privilege must be applied to SQL Server processes, ensuring that the processes operate at privilege levels no higher than necessary to accomplish required organizational missions and/or functions. Organizations consider the creation of additional processes, roles, and SQL Server accounts as necessary to achieve least privilege. Organizations also apply least privilege concepts to the design, development, implementation, and operations of SQL Server and the OS._x000A__x000A_Unauthorized access to sensitive data or SQL Server control may compromise the confidentiality of personnel privacy, threaten national security, compromise a variety of other sensitive operations or lead to a loss of system control. Access controls are best managed by defining requirements based on distinct job functions and assigning access based on the job function assigned to the individual user._x000A__x000A_Privileges granted outside of SQL Server's role-based account assignments are more likely to go unmanaged and without oversight of granted access. Maintenance of privileges using roles defined for discrete job functions offers improved oversight of application user privilege assignments and helps to protect against unauthorized privilege assignment._x000A__x000A_SQL Server's 'Alter any database' permission is a high server-level privilege that must only be granted to individual administration accounts through roles. This administrative privilege must not be assigned directly to administrative user accounts (or any other user accounts). If any user accounts have direct access to administrative privileges, this access must be removed._x000A__x000A_Note that this does not apply to logins with names of the form '##MS...##'. These accounts are internal-use system principals provisioned by the DBMS, and required by it for specific purposes.tru</S>
      <S N="FixText">Remove the 'Alter any database' permission access from the account that has direct access by running the following script:_x000A__x000A__x000A_USE master_x000A__x000A_REVOKE ALTER ANY DATABASE TO &lt;'account name'&gt;_x000A__x000A_GO</S>
      <S N="Check">Obtain the list of accounts that have direct access to the server-level permission 'Alter any database' by running the following query:_x000A__x000A_SELECT _x000A_       who.name AS [Principal Name],_x000A_       who.type_desc AS [Principal Type],_x000A_       who.is_disabled AS [Principal Is Disabled],_x000A_       what.state_desc AS [Permission State],_x000A_       what.permission_name AS [Permission Name]_x000A_FROM _x000A_       sys.server_permissions what _x000A_       INNER JOIN sys.server_principals who_x000A_              ON who.principal_id = what.grantee_principal_id_x000A_WHERE_x000A_       what.permission_name = 'Alter any database' _x000A_AND    who.name NOT LIKE '##MS%##'_x000A_AND    who.type_desc &lt;&gt; 'SERVER_ROLE'_x000A_ORDER BY_x000A_       who.name_x000A_;_x000A_GO_x000A__x000A_If any user accounts have direct access to the 'Alter any database' permission, this is a finding._x000A__x000A_Alternatively, to provide a combined list for all requirements of this type:_x000A_SELECT _x000A__x0009_what.permission_name AS [Permission Name],_x000A__x0009_what.state_desc AS [Permission State],_x000A__x0009_who.name AS [Principal Name],_x000A__x0009_who.type_desc AS [Principal Type],_x000A__x0009_who.is_disabled AS [Principal Is Disabled]_x000A_FROM _x000A__x0009_sys.server_permissions what _x000A__x0009_INNER JOIN sys.server_principals who_x000A__x0009__x0009_ON who.principal_id = what.grantee_principal_id_x000A_WHERE_x000A__x0009_what.permission_name IN_x000A__x0009_(_x000A__x0009_'Administer bulk operations',_x000A__x0009_'Alter any availability group',_x000A__x0009_'Alter any connection',_x000A__x0009_'Alter any credential',_x000A__x0009_'Alter any database',_x000A__x0009_'Alter any endpoint ',_x000A__x0009_'Alter any event notification ',_x000A__x0009_'Alter any event session ',_x000A__x0009_'Alter any linked server',_x000A__x0009_'Alter any login',_x000A__x0009_'Alter any server audit',_x000A__x0009_'Alter any server role',_x000A__x0009_'Alter resources',_x000A__x0009_'Alter server state ',_x000A__x0009_'Alter Settings ',_x000A__x0009_'Alter trace',_x000A__x0009_'Authenticate server ',_x000A__x0009_'Control server',_x000A__x0009_'Create any database ',_x000A__x0009_'Create availability group',_x000A__x0009_'Create DDL event notification',_x000A__x0009_'Create endpoint',_x000A__x0009_'Create server role',_x000A__x0009_'Create trace event notification',_x000A__x0009_'External access assembly',_x000A__x0009_'Shutdown',_x000A__x0009_'Unsafe Assembly',_x000A__x0009_'View any database',_x000A__x0009_'View any definition',_x000A__x0009_'View server state'_x000A__x0009_)_x000A_AND    who.name NOT LIKE '##MS%##'_x000A_AND    who.type_desc &lt;&gt; 'SERVER_ROLE'_x000A_ORDER BY_x000A__x0009_what.permission_name,_x000A__x0009_who.name_x000A_;_x000A_GO</S>
    </MS>
  </Obj>
  <Obj RefId="466">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2012</S>
      <S N="VulnID">V-41209</S>
      <S N="RuleID">SV-53677r4_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL2-00-008100</S>
      <S N="Title">SQL Server must not grant users direct access to the Alter Any Credential permission.</S>
      <S N="Description">The concept of least privilege must be applied to SQL Server processes, ensuring that the processes operate at privilege levels no higher than necessary to accomplish required organizational missions and/or functions. Organizations consider the creation of additional processes, roles, and SQL Server accounts as necessary to achieve least privilege. Organizations also apply least privilege concepts to the design, development, implementation, and operations of SQL Server and the OS._x000A__x000A_Unauthorized access to sensitive data or SQL Server control may compromise the confidentiality of personnel privacy, threaten national security, compromise a variety of other sensitive operations or lead to a loss of system control. Access controls are best managed by defining requirements based on distinct job functions and assigning access based on the job function assigned to the individual user._x000A__x000A_Privileges granted outside of SQL Server's role-based account assignments are more likely to go unmanaged and without oversight of granted access. Maintenance of privileges using roles defined for discrete job functions offers improved oversight of application user privilege assignments and helps to protect against unauthorized privilege assignment._x000A__x000A_SQL Server's 'Alter any credential' permission is a high server-level privilege that must only be granted to individual administration accounts through roles. This administrative privilege must not be assigned directly to administrative user accounts (or any other user accounts). If any user accounts have direct access to administrative privileges, this access must be removed._x000A__x000A_Note that this does not apply to logins with names of the form '##MS...##'.  These accounts are internal-use system principals provisioned by the DBMS, and required by it for specific purposes.tru</S>
      <S N="FixText">Remove the 'Alter any credential' permission access from the account that has direct access by running the following script:_x000A__x000A__x000A_USE master_x000A__x000A_REVOKE ALTER ANY CREDENTIAL TO &lt;'account name'&gt;_x000A__x000A_GO</S>
      <S N="Check">Obtain the list of accounts that have direct access to the server-level permission 'Alter any credential' by running the following query:_x000A__x000A_SELECT _x000A_       who.name AS [Principal Name],_x000A_       who.type_desc AS [Principal Type],_x000A_       who.is_disabled AS [Principal Is Disabled],_x000A_       what.state_desc AS [Permission State],_x000A_       what.permission_name AS [Permission Name]_x000A_FROM _x000A_       sys.server_permissions what _x000A_       INNER JOIN sys.server_principals who_x000A_              ON who.principal_id = what.grantee_principal_id_x000A_WHERE_x000A_       what.permission_name = 'Alter any credential' _x000A_AND    who.name NOT LIKE '##MS%##'_x000A_AND    who.type_desc &lt;&gt; 'SERVER_ROLE'_x000A_ORDER BY_x000A_       who.name_x000A_;_x000A_GO_x000A__x000A_If any user accounts have direct access to the 'Alter any credential' permission, this is a finding._x000A__x000A_Alternatively, to provide a combined list for all requirements of this type:_x000A_SELECT _x000A__x0009_what.permission_name AS [Permission Name],_x000A__x0009_what.state_desc AS [Permission State],_x000A__x0009_who.name AS [Principal Name],_x000A__x0009_who.type_desc AS [Principal Type],_x000A__x0009_who.is_disabled AS [Principal Is Disabled]_x000A_FROM _x000A__x0009_sys.server_permissions what _x000A__x0009_INNER JOIN sys.server_principals who_x000A__x0009__x0009_ON who.principal_id = what.grantee_principal_id_x000A_WHERE_x000A__x0009_what.permission_name IN_x000A__x0009_(_x000A__x0009_'Administer bulk operations',_x000A__x0009_'Alter any availability group',_x000A__x0009_'Alter any connection',_x000A__x0009_'Alter any credential',_x000A__x0009_'Alter any database',_x000A__x0009_'Alter any endpoint ',_x000A__x0009_'Alter any event notification ',_x000A__x0009_'Alter any event session ',_x000A__x0009_'Alter any linked server',_x000A__x0009_'Alter any login',_x000A__x0009_'Alter any server audit',_x000A__x0009_'Alter any server role',_x000A__x0009_'Alter resources',_x000A__x0009_'Alter server state ',_x000A__x0009_'Alter Settings ',_x000A__x0009_'Alter trace',_x000A__x0009_'Authenticate server ',_x000A__x0009_'Control server',_x000A__x0009_'Create any database ',_x000A__x0009_'Create availability group',_x000A__x0009_'Create DDL event notification',_x000A__x0009_'Create endpoint',_x000A__x0009_'Create server role',_x000A__x0009_'Create trace event notification',_x000A__x0009_'External access assembly',_x000A__x0009_'Shutdown',_x000A__x0009_'Unsafe Assembly',_x000A__x0009_'View any database',_x000A__x0009_'View any definition',_x000A__x0009_'View server state'_x000A__x0009_)_x000A_AND    who.name NOT LIKE '##MS%##'_x000A_AND    who.type_desc &lt;&gt; 'SERVER_ROLE'_x000A_ORDER BY_x000A__x0009_what.permission_name,_x000A__x0009_who.name_x000A_;_x000A_GO</S>
    </MS>
  </Obj>
  <Obj RefId="467">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2012</S>
      <S N="VulnID">V-41246</S>
      <S N="RuleID">SV-53727r4_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL2-00-008000</S>
      <S N="Title">SQL Server must not grant users direct access to the Alter any connection permission.</S>
      <S N="Description">The concept of least privilege must be applied to SQL Server processes, ensuring that the processes operate at privilege levels no higher than necessary to accomplish required organizational missions and/or functions. Organizations consider the creation of additional processes, roles, and SQL Server accounts as necessary to achieve least privilege. Organizations also apply least privilege concepts to the design, development, implementation, and operations of SQL Server and the OS._x000A__x000A_Unauthorized access to sensitive data or SQL Server control may compromise the confidentiality of personnel privacy, threaten national security, compromise a variety of other sensitive operations or lead to a loss of system control. Access controls are best managed by defining requirements based on distinct job functions and assigning access based on the job function assigned to the individual user._x000A__x000A_Privileges granted outside of SQL Server's role-based account assignments are more likely to go unmanaged and without oversight of granted access. Maintenance of privileges using roles defined for discrete job functions offers improved oversight of application user privilege assignments and helps to protect against unauthorized privilege assignment._x000A__x000A_SQL Server's 'Alter any connection' permission is a high server-level privilege that must only be granted to individual administration accounts through roles. This administrative privilege must not be assigned directly to administrative user accounts (or any other user accounts). If any user accounts have direct access to administrative privileges, this access must be removed._x000A__x000A_Note that this does not apply to logins with names of the form '##MS...##'. These accounts are internal-use system principals provisioned by the DBMS, and required by it for specific purposes.tru</S>
      <S N="FixText">Remove the 'Alter any connection' permission access from the account that has direct access by running the following script:_x000A__x000A__x000A_USE master_x000A__x000A_REVOKE ALTER ANY CONNECTION TO &lt;'account name'&gt;_x000A__x000A_GO</S>
      <S N="Check">Obtain the list of accounts that have direct access to the server-level permission 'Alter any connection' by running the following query:_x000A__x000A_SELECT _x000A_       who.name AS [Principal Name],_x000A_       who.type_desc AS [Principal Type],_x000A_       who.is_disabled AS [Principal Is Disabled],_x000A_       what.state_desc AS [Permission State],_x000A_       what.permission_name AS [Permission Name]_x000A_FROM _x000A_       sys.server_permissions what _x000A_       INNER JOIN sys.server_principals who_x000A_              ON who.principal_id = what.grantee_principal_id_x000A_WHERE_x000A_       what.permission_name = 'Alter any connection' _x000A_AND    who.name NOT LIKE '##MS%##'_x000A_AND    who.type_desc &lt;&gt; 'SERVER_ROLE'_x000A_ORDER BY_x000A_       who.name_x000A_;_x000A_GO_x000A__x000A_If any user accounts have direct access to the 'Alter any connection' permission, this is a finding._x000A__x000A_Alternatively, to provide a combined list for all requirements of this type:_x000A_SELECT _x000A__x0009_what.permission_name AS [Permission Name],_x000A__x0009_what.state_desc AS [Permission State],_x000A__x0009_who.name AS [Principal Name],_x000A__x0009_who.type_desc AS [Principal Type],_x000A__x0009_who.is_disabled AS [Principal Is Disabled]_x000A_FROM _x000A__x0009_sys.server_permissions what _x000A__x0009_INNER JOIN sys.server_principals who_x000A__x0009__x0009_ON who.principal_id = what.grantee_principal_id_x000A_WHERE_x000A__x0009_what.permission_name IN_x000A__x0009_(_x000A__x0009_'Administer bulk operations',_x000A__x0009_'Alter any availability group',_x000A__x0009_'Alter any connection',_x000A__x0009_'Alter any credential',_x000A__x0009_'Alter any database',_x000A__x0009_'Alter any endpoint ',_x000A__x0009_'Alter any event notification ',_x000A__x0009_'Alter any event session ',_x000A__x0009_'Alter any linked server',_x000A__x0009_'Alter any login',_x000A__x0009_'Alter any server audit',_x000A__x0009_'Alter any server role',_x000A__x0009_'Alter resources',_x000A__x0009_'Alter server state ',_x000A__x0009_'Alter Settings ',_x000A__x0009_'Alter trace',_x000A__x0009_'Authenticate server ',_x000A__x0009_'Control server',_x000A__x0009_'Create any database ',_x000A__x0009_'Create availability group',_x000A__x0009_'Create DDL event notification',_x000A__x0009_'Create endpoint',_x000A__x0009_'Create server role',_x000A__x0009_'Create trace event notification',_x000A__x0009_'External access assembly',_x000A__x0009_'Shutdown',_x000A__x0009_'Unsafe Assembly',_x000A__x0009_'View any database',_x000A__x0009_'View any definition',_x000A__x0009_'View server state'_x000A__x0009_)_x000A_AND    who.name NOT LIKE '##MS%##'_x000A_AND    who.type_desc &lt;&gt; 'SERVER_ROLE'_x000A_ORDER BY_x000A__x0009_what.permission_name,_x000A__x0009_who.name_x000A_;_x000A_GO</S>
    </MS>
  </Obj>
  <Obj RefId="468">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2012</S>
      <S N="VulnID">V-41247</S>
      <S N="RuleID">SV-53728r5_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL2-00-007900</S>
      <S N="Title">SQL Server must not grant users direct access control to the Alter Any Availability Group permission.</S>
      <S N="Description">The concept of least privilege must be applied to SQL Server processes, ensuring that the processes operate at privilege levels no higher than necessary to accomplish required organizational missions and/or functions. _x000A__x000A_Unauthorized access to sensitive data or SQL Server control may compromise the confidentiality of personnel privacy, threaten national security, compromise a variety of other sensitive operations or lead to a loss of system control. Access controls are best managed by defining requirements based on distinct job functions and assigning access based on the job function assigned to the individual user._x000A__x000A_Privileges granted outside of SQL Server's role-based account assignments are more likely to go unmanaged and without oversight of granted access. Maintenance of privileges using roles defined for discrete job functions offers improved oversight of application user privilege assignments and helps to protect against unauthorized privilege assignment._x000A__x000A_SQL Server's 'Alter any availability group' permission is a high server-level privilege that must only be granted to individual administration accounts through roles. This administrative privilege must not be assigned directly to administrative user accounts. If administrative user accounts have direct access to administrative roles, this access must be removed._x000A__x000A_(The SQL Server installer gives this privilege to the system account "NT AUTHORITY\SYSTEM", so this account is excluded from the Check.  See article KB2847723 in the Microsoft knowledge base.)_x000A__x000A_Note that this does not apply to logins with names of the form '##MS...##'. These accounts are internal-use system principals provisioned by the DBMS, and required by it for specific purposes.tru</S>
      <S N="FixText">Remove the 'Alter Any Availability Group' permission access from the account that has direct access by using the following code.  Substitute the relevant names for the text in angle brackets._x000A__x000A_-- For each login identified in the Check:_x000A_USE master;_x000A_REVOKE ALTER ANY AVAILABILITY GROUP FROM &lt;login name&gt;;_x000A_GO_x000A__x000A_-- If the necessary server role does not already exist,_x000A_-- and any user identified in the Check needs this permission:_x000A_USE master;_x000A_CREATE SERVER ROLE &lt;role name&gt; AUTHORIZATION &lt;appropriate principal name&gt;;_x000A_GO_x000A_GRANT ALTER ANY AVAILABILITY GROUP TO &lt;role name&gt;;_x000A_GO_x000A__x000A_-- For each user identified in the Check who needs this permission:_x000A_USE master;_x000A_ALTER SERVER ROLE &lt;role name&gt; ADD MEMBER &lt;login name&gt;;_x000A_GO</S>
      <S N="Check">Obtain the list of accounts that have direct access to the server-level permission 'Alter any availability group' by running the following query:_x000A__x000A_SELECT _x000A_       who.name AS [Principal Name],_x000A_       who.type_desc AS [Principal Type],_x000A_       who.is_disabled AS [Principal Is Disabled],_x000A_       what.state_desc AS [Permission State],_x000A_       what.permission_name AS [Permission Name]_x000A_FROM _x000A_       sys.server_permissions what _x000A_       INNER JOIN sys.server_principals who_x000A_              ON who.principal_id = what.grantee_principal_id_x000A_WHERE_x000A_       what.permission_name = 'Alter any availability group' _x000A_AND    who.name NOT LIKE '##MS%##'_x000A_AND    who.type_desc &lt;&gt; 'SERVER_ROLE'_x000A_ORDER BY_x000A_       who.name_x000A_;_x000A_GO_x000A__x000A_If any user accounts have direct access to the 'Alter any availability group' permission, this is a finding._x000A__x000A_Alternatively, to provide a combined list for all requirements of this type:_x000A_SELECT _x000A__x0009_what.permission_name AS [Permission Name],_x000A__x0009_what.state_desc AS [Permission State],_x000A__x0009_who.name AS [Principal Name],_x000A__x0009_who.type_desc AS [Principal Type],_x000A__x0009_who.is_disabled AS [Principal Is Disabled]_x000A_FROM _x000A__x0009_sys.server_permissions what _x000A__x0009_INNER JOIN sys.server_principals who_x000A__x0009__x0009_ON who.principal_id = what.grantee_principal_id_x000A_WHERE_x000A__x0009_what.permission_name IN_x000A__x0009_(_x000A__x0009_'Administer bulk operations',_x000A__x0009_'Alter any availability group',_x000A__x0009_'Alter any connection',_x000A__x0009_'Alter any credential',_x000A__x0009_'Alter any database',_x000A__x0009_'Alter any endpoint ',_x000A__x0009_'Alter any event notification ',_x000A__x0009_'Alter any event session ',_x000A__x0009_'Alter any linked server',_x000A__x0009_'Alter any login',_x000A__x0009_'Alter any server audit',_x000A__x0009_'Alter any server role',_x000A__x0009_'Alter resources',_x000A__x0009_'Alter server state ',_x000A__x0009_'Alter Settings ',_x000A__x0009_'Alter trace',_x000A__x0009_'Authenticate server ',_x000A__x0009_'Control server',_x000A__x0009_'Create any database ',_x000A__x0009_'Create availability group',_x000A__x0009_'Create DDL event notification',_x000A__x0009_'Create endpoint',_x000A__x0009_'Create server role',_x000A__x0009_'Create trace event notification',_x000A__x0009_'External access assembly',_x000A__x0009_'Shutdown',_x000A__x0009_'Unsafe Assembly',_x000A__x0009_'View any database',_x000A__x0009_'View any definition',_x000A__x0009_'View server state'_x000A__x0009_)_x000A_AND    who.name NOT LIKE '##MS%##'_x000A_AND    who.type_desc &lt;&gt; 'SERVER_ROLE'_x000A_ORDER BY_x000A__x0009_what.permission_name,_x000A__x0009_who.name_x000A_;_x000A_GO</S>
    </MS>
  </Obj>
  <Obj RefId="469">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2012</S>
      <S N="VulnID">V-41248</S>
      <S N="RuleID">SV-53729r4_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL2-00-007800</S>
      <S N="Title">SQL Server must not grant users direct access to the Alter server state permission.</S>
      <S N="Description">The concept of least privilege must be applied to SQL Server processes, ensuring that the processes operate at privilege levels no higher than necessary to accomplish required organizational missions and/or functions. Organizations consider the creation of additional processes, roles, and SQL Server accounts as necessary to achieve least privilege. Organizations also apply least privilege concepts to the design, development, implementation, and operations of SQL Server and the OS._x000A__x000A_Unauthorized access to sensitive data or SQL Server control may compromise the confidentiality of personnel privacy, threaten national security, compromise a variety of other sensitive operations or lead to a loss of system control. Access controls are best managed by defining requirements based on distinct job functions and assigning access based on the job function assigned to the individual user._x000A__x000A_Privileges granted outside of SQL Server's role-based account assignments are more likely to go unmanaged and without oversight of granted access. Maintenance of privileges using roles defined for discrete job functions offers improved oversight of application user privilege assignments and helps to protect against unauthorized privilege assignment._x000A__x000A_SQL Server's 'Alter server state' permission is a high server-level privilege that must only be granted to individual administration accounts through roles. This administrative privilege must not be assigned directly to administrative user accounts (or any other user accounts). If any user accounts have direct access to administrative privileges, this access must be removed._x000A__x000A_Note that this does not apply to logins with names of the form '##MS...##'.  These accounts are internal-use system principals provisioned by the DBMS, and required by it for specific purposes.tru</S>
      <S N="FixText">Remove the 'Alter server state' permission access from the account that has direct access by running the following script:_x000A__x000A__x000A_USE master_x000A__x000A_REVOKE ALTER SERVER STATE TO &lt;'account name'&gt;_x000A__x000A_GO</S>
      <S N="Check">Obtain the list of accounts that have direct access to the server-level permission 'Alter server state' by running the following query:_x000A__x000A_SELECT _x000A_       who.name AS [Principal Name],_x000A_       who.type_desc AS [Principal Type],_x000A_       who.is_disabled AS [Principal Is Disabled],_x000A_       what.state_desc AS [Permission State],_x000A_       what.permission_name AS [Permission Name]_x000A_FROM _x000A_       sys.server_permissions what _x000A_       INNER JOIN sys.server_principals who_x000A_              ON who.principal_id = what.grantee_principal_id_x000A_WHERE_x000A_       what.permission_name = 'Alter server state'_x000A_AND    who.name NOT LIKE '##MS%##'_x000A_AND    who.type_desc &lt;&gt; 'SERVER_ROLE'_x000A_ORDER BY_x000A_       who.name_x000A_;_x000A_GO_x000A__x000A_If any user accounts have direct access to the 'Alter server state' permission, this is a finding._x000A__x000A_Alternatively, to provide a combined list for all requirements of this type:_x000A_SELECT _x000A__x0009_what.permission_name AS [Permission Name],_x000A__x0009_what.state_desc AS [Permission State],_x000A__x0009_who.name AS [Principal Name],_x000A__x0009_who.type_desc AS [Principal Type],_x000A__x0009_who.is_disabled AS [Principal Is Disabled]_x000A_FROM _x000A__x0009_sys.server_permissions what _x000A__x0009_INNER JOIN sys.server_principals who_x000A__x0009__x0009_ON who.principal_id = what.grantee_principal_id_x000A_WHERE_x000A__x0009_what.permission_name IN_x000A__x0009_(_x000A__x0009_'Administer bulk operations',_x000A__x0009_'Alter any availability group',_x000A__x0009_'Alter any connection',_x000A__x0009_'Alter any credential',_x000A__x0009_'Alter any database',_x000A__x0009_'Alter any endpoint ',_x000A__x0009_'Alter any event notification ',_x000A__x0009_'Alter any event session ',_x000A__x0009_'Alter any linked server',_x000A__x0009_'Alter any login',_x000A__x0009_'Alter any server audit',_x000A__x0009_'Alter any server role',_x000A__x0009_'Alter resources',_x000A__x0009_'Alter server state ',_x000A__x0009_'Alter Settings ',_x000A__x0009_'Alter trace',_x000A__x0009_'Authenticate server ',_x000A__x0009_'Control server',_x000A__x0009_'Create any database ',_x000A__x0009_'Create availability group',_x000A__x0009_'Create DDL event notification',_x000A__x0009_'Create endpoint',_x000A__x0009_'Create server role',_x000A__x0009_'Create trace event notification',_x000A__x0009_'External access assembly',_x000A__x0009_'Shutdown',_x000A__x0009_'Unsafe Assembly',_x000A__x0009_'View any database',_x000A__x0009_'View any definition',_x000A__x0009_'View server state'_x000A__x0009_)_x000A_AND    who.name NOT LIKE '##MS%##'_x000A_AND    who.type_desc &lt;&gt; 'SERVER_ROLE'_x000A_ORDER BY_x000A__x0009_what.permission_name,_x000A__x0009_who.name_x000A_;_x000A_GO</S>
    </MS>
  </Obj>
  <Obj RefId="470">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2012</S>
      <S N="VulnID">V-41250</S>
      <S N="RuleID">SV-53732r4_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL2-00-007600</S>
      <S N="Title">SQL Server must not grant users direct access to the Alter any event notification permission.</S>
      <S N="Description">The concept of least privilege must be applied to SQL Server processes, ensuring that the processes operate at privilege levels no higher than necessary to accomplish required organizational missions and/or functions. Organizations consider the creation of additional processes, roles, and SQL Server accounts as necessary to achieve least privilege. Organizations also apply least privilege concepts to the design, development, implementation, and operations of SQL Server and the OS._x000A__x000A_Unauthorized access to sensitive data or SQL Server control may compromise the confidentiality of personnel privacy, threaten national security, compromise a variety of other sensitive operations or lead to a loss of system control. Access controls are best managed by defining requirements based on distinct job functions and assigning access based on the job function assigned to the individual user._x000A__x000A_Privileges granted outside of SQL Server's role-based account assignments are more likely to go unmanaged and without oversight of granted access. Maintenance of privileges using roles defined for discrete job functions offers improved oversight of application user privilege assignments and helps to protect against unauthorized privilege assignment._x000A__x000A_SQL Server's 'Alter any event notification' permission is a high server-level privilege that must only be granted to individual administration accounts through roles. This administrative privilege must not be assigned directly to administrative user accounts (or any other user accounts). If any user accounts have direct access to administrative privileges, this access must be removed._x000A__x000A_Note that this does not apply to logins with names of the form '##MS...##'.  These accounts are internal-use system principals provisioned by the DBMS, and required by it for specific purposes.tru</S>
      <S N="FixText">Remove the 'Alter any event notification' permission access from the account that has direct access by running the following script:_x000A__x000A__x000A_USE master_x000A__x000A_REVOKE ALTER ANY EVENT NOTIFICATION TO &lt;'account name'&gt;_x000A__x000A_GO</S>
      <S N="Check">Obtain the list of accounts that have direct access to the server-level permission 'Alter any event notification' by running the following query:_x000A__x000A_SELECT _x000A_       who.name AS [Principal Name],_x000A_       who.type_desc AS [Principal Type],_x000A_       who.is_disabled AS [Principal Is Disabled],_x000A_       what.state_desc AS [Permission State],_x000A_       what.permission_name AS [Permission Name]_x000A_FROM _x000A_       sys.server_permissions what _x000A_       INNER JOIN sys.server_principals who_x000A_              ON who.principal_id = what.grantee_principal_id_x000A_WHERE_x000A_       what.permission_name = 'Alter any event notification'_x000A_AND    who.name NOT LIKE '##MS%##'_x000A_AND    who.type_desc &lt;&gt; 'SERVER_ROLE'_x000A_ORDER BY_x000A_       who.name_x000A_;_x000A_GO_x000A__x000A_If any user accounts have direct access to the 'Alter any event notification' permission, this is a finding._x000A__x000A_Alternatively, to provide a combined list for all requirements of this type:_x000A_SELECT _x000A__x0009_what.permission_name AS [Permission Name],_x000A__x0009_what.state_desc AS [Permission State],_x000A__x0009_who.name AS [Principal Name],_x000A__x0009_who.type_desc AS [Principal Type],_x000A__x0009_who.is_disabled AS [Principal Is Disabled]_x000A_FROM _x000A__x0009_sys.server_permissions what _x000A__x0009_INNER JOIN sys.server_principals who_x000A__x0009__x0009_ON who.principal_id = what.grantee_principal_id_x000A_WHERE_x000A__x0009_what.permission_name IN_x000A__x0009_(_x000A__x0009_'Administer bulk operations',_x000A__x0009_'Alter any availability group',_x000A__x0009_'Alter any connection',_x000A__x0009_'Alter any credential',_x000A__x0009_'Alter any database',_x000A__x0009_'Alter any endpoint ',_x000A__x0009_'Alter any event notification ',_x000A__x0009_'Alter any event session ',_x000A__x0009_'Alter any linked server',_x000A__x0009_'Alter any login',_x000A__x0009_'Alter any server audit',_x000A__x0009_'Alter any server role',_x000A__x0009_'Alter resources',_x000A__x0009_'Alter server state ',_x000A__x0009_'Alter Settings ',_x000A__x0009_'Alter trace',_x000A__x0009_'Authenticate server ',_x000A__x0009_'Control server',_x000A__x0009_'Create any database ',_x000A__x0009_'Create availability group',_x000A__x0009_'Create DDL event notification',_x000A__x0009_'Create endpoint',_x000A__x0009_'Create server role',_x000A__x0009_'Create trace event notification',_x000A__x0009_'External access assembly',_x000A__x0009_'Shutdown',_x000A__x0009_'Unsafe Assembly',_x000A__x0009_'View any database',_x000A__x0009_'View any definition',_x000A__x0009_'View server state'_x000A__x0009_)_x000A_AND    who.name NOT LIKE '##MS%##'_x000A_AND    who.type_desc &lt;&gt; 'SERVER_ROLE'_x000A_ORDER BY_x000A__x0009_what.permission_name,_x000A__x0009_who.name_x000A_;_x000A_GO</S>
    </MS>
  </Obj>
  <Obj RefId="471">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2012</S>
      <S N="VulnID">V-41251</S>
      <S N="RuleID">SV-53733r4_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL2-00-007500</S>
      <S N="Title">SQL Server must enforce access control policies to restrict the View any database permission to only authorized roles.</S>
      <S N="Description">The concept of least privilege must be applied to SQL Server processes, ensuring that the processes operate at privilege levels no higher than necessary to accomplish required organizational missions and/or functions. Organizations consider the creation of additional processes, roles, and SQL Server accounts as necessary to achieve least privilege. Organizations also apply least privilege concepts to the design, development, implementation, and operations of SQL Server and the OS._x000A__x000A_Unauthorized access to sensitive data or SQL Server control may compromise the confidentiality of personnel privacy, threaten national security, compromise a variety of other sensitive operations or lead to a loss of system control. Access controls are best managed by defining requirements based on distinct job functions and assigning access based on the job function assigned to the individual user._x000A__x000A_SQL Server's 'View any database' permission is a high server-level privilege that must only be granted to individual administration accounts through roles, and users who have access must require this privilege to accomplish the organizational missions and/or functions. If the 'View any database' permission is granted to roles that are unauthorized to have this privilege, then this access must be removed._x000A__x000A_Additionally, the permission must not be denied to a role, because that could disable a user's legitimate access via another role._x000A__x000A_The fix for this vulnerability specifies the use of REVOKE.  Be aware that revoking a permission that is currently denied to a role or user does not necessarily disable the permission.  If the user or role can inherent the permission from another role, revoking the denied permission from the user or the first role can effectively enable the inherited permission.tru</S>
      <S N="FixText">Remove the "View any database" permission access from the role that is not authorized by executing the following query:_x000A__x000A_REVOKE View any database TO &lt;'role name'&gt;</S>
      <S N="Check">Obtain the list of roles that are authorized for the SQL Server 'View any database' permission and what 'Grant', 'Grant With', and/or 'Deny' privilege is authorized. Obtain the list of roles with that permission by running the following query:_x000A__x000A_SELECT _x000A_       who.name AS [Principal Name],_x000A_       who.type_desc AS [Principal Type],_x000A_       who.is_disabled AS [Principal Is Disabled],_x000A_       what.state_desc AS [Permission State],_x000A_       what.permission_name AS [Permission Name]_x000A_FROM _x000A_       sys.server_permissions what _x000A_       INNER JOIN sys.server_principals who_x000A_              ON who.principal_id = what.grantee_principal_id_x000A_WHERE_x000A_       what.permission_name = 'View any database' _x000A_AND    who.type_desc = 'SERVER_ROLE'_x000A_ORDER BY_x000A_       who.name_x000A_;_x000A_GO _x000A__x000A_If any role has 'Grant', 'With Grant' or 'Deny' privileges on this permission and users with that role are not authorized to have the permission, this is a finding._x000A__x000A_Alternatively, to provide a combined list for all requirements of this type:_x000A_SELECT _x000A__x0009_what.permission_name AS [Permission Name],_x000A__x0009_what.state_desc AS [Permission State],_x000A__x0009_who.name AS [Principal Name],_x000A__x0009_who.type_desc AS [Principal Type],_x000A__x0009_who.is_disabled AS [Principal Is Disabled]_x000A_FROM _x000A__x0009_sys.server_permissions what _x000A__x0009_INNER JOIN sys.server_principals who_x000A__x0009__x0009_ON who.principal_id = what.grantee_principal_id_x000A_WHERE_x000A__x0009_what.permission_name IN_x000A__x0009_(_x000A__x0009_'Administer bulk operations',_x000A__x0009_'Alter any availability group',_x000A__x0009_'Alter any connection',_x000A__x0009_'Alter any credential',_x000A__x0009_'Alter any database',_x000A__x0009_'Alter any endpoint ',_x000A__x0009_'Alter any event notification ',_x000A__x0009_'Alter any event session ',_x000A__x0009_'Alter any linked server',_x000A__x0009_'Alter any login',_x000A__x0009_'Alter any server audit',_x000A__x0009_'Alter any server role',_x000A__x0009_'Alter resources',_x000A__x0009_'Alter server state ',_x000A__x0009_'Alter Settings ',_x000A__x0009_'Alter trace',_x000A__x0009_'Authenticate server ',_x000A__x0009_'Control server',_x000A__x0009_'Create any database ',_x000A__x0009_'Create availability group',_x000A__x0009_'Create DDL event notification',_x000A__x0009_'Create endpoint',_x000A__x0009_'Create server role',_x000A__x0009_'Create trace event notification',_x000A__x0009_'External access assembly',_x000A__x0009_'Shutdown',_x000A__x0009_'Unsafe Assembly',_x000A__x0009_'View any database',_x000A__x0009_'View any definition',_x000A__x0009_'View server state'_x000A__x0009_)_x000A_AND_x0009_who.type_desc = 'SERVER_ROLE'_x000A_ORDER BY_x000A__x0009_what.permission_name,_x000A__x0009_who.name_x000A_;_x000A_GO</S>
    </MS>
  </Obj>
  <Obj RefId="472">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2012</S>
      <S N="VulnID">V-41252</S>
      <S N="RuleID">SV-53734r4_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL2-00-007400</S>
      <S N="Title">SQL Server must not grant users direct access to the Alter any server audit permission.</S>
      <S N="Description">The concept of least privilege must be applied to SQL Server processes, ensuring that the processes operate at privilege levels no higher than necessary to accomplish required organizational missions and/or functions. Organizations consider the creation of additional processes, roles, and SQL Server accounts as necessary to achieve least privilege. Organizations also apply least privilege concepts to the design, development, implementation, and operations of SQL Server and the OS._x000A__x000A_Unauthorized access to sensitive data or SQL Server control may compromise the confidentiality of personnel privacy, threaten national security, compromise a variety of other sensitive operations or lead to a loss of system control. Access controls are best managed by defining requirements based on distinct job functions and assigning access based on the job function assigned to the individual user._x000A__x000A_Privileges granted outside of SQL Server's role-based account assignments are more likely to go unmanaged and without oversight of granted access. Maintenance of privileges using roles defined for discrete job functions offers improved oversight of application user privilege assignments and helps to protect against unauthorized privilege assignment._x000A__x000A_SQL Server's 'Alter any server audit' permission is a high server-level privilege that must only be granted to individual administration accounts through roles. This administrative privilege must not be assigned directly to administrative user accounts (or any other user accounts). If any user accounts have direct access to administrative privileges, this access must be removed._x000A__x000A_Note that this does not apply to logins with names of the form '##MS...##'.  These accounts are internal-use system principals provisioned by the DBMS, and required by it for specific purposes.tru</S>
      <S N="FixText">Remove the 'Alter any server audit' permission access from the account that has direct access by running the following script:_x000A__x000A__x000A_USE master_x000A__x000A_REVOKE ALTER ANY SERVER AUDIT TO &lt;'account name'&gt;_x000A__x000A_GO</S>
      <S N="Check">Obtain the list of accounts that have direct access to the server-level permission 'Alter any server audit' by running the following query:_x000A__x000A_SELECT _x000A_       who.name AS [Principal Name],_x000A_       who.type_desc AS [Principal Type],_x000A_       who.is_disabled AS [Principal Is Disabled],_x000A_       what.state_desc AS [Permission State],_x000A_       what.permission_name AS [Permission Name]_x000A_FROM _x000A_       sys.server_permissions what _x000A_       INNER JOIN sys.server_principals who_x000A_              ON who.principal_id = what.grantee_principal_id_x000A_WHERE_x000A_       what.permission_name = 'Alter any server audit' _x000A_AND    who.name NOT LIKE '##MS%##'_x000A_AND    who.type_desc &lt;&gt; 'SERVER_ROLE'_x000A_ORDER BY_x000A_       who.name_x000A_;_x000A_GO_x000A__x000A_If any user accounts have direct access to the 'Alter any server audit' permission, this is a finding._x000A__x000A_Alternatively, to provide a combined list for all requirements of this type:_x000A_SELECT _x000A__x0009_what.permission_name AS [Permission Name],_x000A__x0009_what.state_desc AS [Permission State],_x000A__x0009_who.name AS [Principal Name],_x000A__x0009_who.type_desc AS [Principal Type],_x000A__x0009_who.is_disabled AS [Principal Is Disabled]_x000A_FROM _x000A__x0009_sys.server_permissions what _x000A__x0009_INNER JOIN sys.server_principals who_x000A__x0009__x0009_ON who.principal_id = what.grantee_principal_id_x000A_WHERE_x000A__x0009_what.permission_name IN_x000A__x0009_(_x000A__x0009_'Administer bulk operations',_x000A__x0009_'Alter any availability group',_x000A__x0009_'Alter any connection',_x000A__x0009_'Alter any credential',_x000A__x0009_'Alter any database',_x000A__x0009_'Alter any endpoint ',_x000A__x0009_'Alter any event notification ',_x000A__x0009_'Alter any event session ',_x000A__x0009_'Alter any linked server',_x000A__x0009_'Alter any login',_x000A__x0009_'Alter any server audit',_x000A__x0009_'Alter any server role',_x000A__x0009_'Alter resources',_x000A__x0009_'Alter server state ',_x000A__x0009_'Alter Settings ',_x000A__x0009_'Alter trace',_x000A__x0009_'Authenticate server ',_x000A__x0009_'Control server',_x000A__x0009_'Create any database ',_x000A__x0009_'Create availability group',_x000A__x0009_'Create DDL event notification',_x000A__x0009_'Create endpoint',_x000A__x0009_'Create server role',_x000A__x0009_'Create trace event notification',_x000A__x0009_'External access assembly',_x000A__x0009_'Shutdown',_x000A__x0009_'Unsafe Assembly',_x000A__x0009_'View any database',_x000A__x0009_'View any definition',_x000A__x0009_'View server state'_x000A__x0009_)_x000A_AND    who.name NOT LIKE '##MS%##'_x000A_AND    who.type_desc &lt;&gt; 'SERVER_ROLE'_x000A_ORDER BY_x000A__x0009_what.permission_name,_x000A__x0009_who.name_x000A_;_x000A_GO</S>
    </MS>
  </Obj>
  <Obj RefId="473">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2012</S>
      <S N="VulnID">V-41253</S>
      <S N="RuleID">SV-53735r4_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL2-00-007300</S>
      <S N="Title">SQL Server must enforce access control policies to restrict the Shutdown permission to only authorized roles.</S>
      <S N="Description">The concept of least privilege must be applied to SQL Server processes, ensuring that the processes operate at privilege levels no higher than necessary to accomplish required organizational missions and/or functions. Organizations consider the creation of additional processes, roles, and SQL Server accounts as necessary to achieve least privilege. Organizations also apply least privilege concepts to the design, development, implementation, and operations of SQL Server and the OS._x000A__x000A_Unauthorized access to sensitive data or SQL Server control may compromise the confidentiality of personnel privacy, threaten national security, compromise a variety of other sensitive operations or lead to a loss of system control. Access controls are best managed by defining requirements based on distinct job functions and assigning access based on the job function assigned to the individual user._x000A__x000A_SQL Server's 'Shutdown' permission is a high server-level privilege that must only be granted to individual administration accounts through roles, and users who have access must require this privilege to accomplish the organizational missions and/or functions. , If the 'Shutdown' permission is granted to roles that are unauthorized to have this privilege, then this access must be removed._x000A__x000A_Additionally, the permission must not be denied to a role, because that could disable a user's legitimate access via another role._x000A__x000A_The fix for this vulnerability specifies the use of REVOKE.  Be aware that revoking a permission that is currently denied to a role or user does not necessarily disable the permission.  If the user or role can inherent the permission from another role, revoking the denied permission from the user or the first role can effectively enable the inherited permission.tru</S>
      <S N="FixText">Remove the' 'Shutdown' permission access from the role that is not authorized by executing the following query:_x000A__x000A__x000A_REVOKE Shutdown TO &lt;'role name'&gt;</S>
      <S N="Check">Obtain the list of roles that are authorized for the 'Shutdown' permission and what 'Grant', 'Grant With', and/or 'Deny' privilege is authorized. Obtain the list of roles with that permission by running the following query:_x000A__x000A_SELECT _x000A_       who.name AS [Principal Name],_x000A_       who.type_desc AS [Principal Type],_x000A_       who.is_disabled AS [Principal Is Disabled],_x000A_       what.state_desc AS [Permission State],_x000A_       what.permission_name AS [Permission Name]_x000A_FROM _x000A_       sys.server_permissions what _x000A_       INNER JOIN sys.server_principals who_x000A_              ON who.principal_id = what.grantee_principal_id_x000A_WHERE_x000A_       what.permission_name = 'Shutdown'_x000A_AND    who.type_desc = 'SERVER_ROLE'_x000A_ORDER BY_x000A_       who.name_x000A_;_x000A_GO _x000A__x000A_If any role has 'Grant', 'With Grant' or 'Deny' privileges on this permission and users with that role are not authorized to have the permission, this is a finding._x000A__x000A_Alternatively, to provide a combined list for all requirements of this type:_x000A_SELECT _x000A__x0009_what.permission_name AS [Permission Name],_x000A__x0009_what.state_desc AS [Permission State],_x000A__x0009_who.name AS [Principal Name],_x000A__x0009_who.type_desc AS [Principal Type],_x000A__x0009_who.is_disabled AS [Principal Is Disabled]_x000A_FROM _x000A__x0009_sys.server_permissions what _x000A__x0009_INNER JOIN sys.server_principals who_x000A__x0009__x0009_ON who.principal_id = what.grantee_principal_id_x000A_WHERE_x000A__x0009_what.permission_name IN_x000A__x0009_(_x000A__x0009_'Administer bulk operations',_x000A__x0009_'Alter any availability group',_x000A__x0009_'Alter any connection',_x000A__x0009_'Alter any credential',_x000A__x0009_'Alter any database',_x000A__x0009_'Alter any endpoint ',_x000A__x0009_'Alter any event notification ',_x000A__x0009_'Alter any event session ',_x000A__x0009_'Alter any linked server',_x000A__x0009_'Alter any login',_x000A__x0009_'Alter any server audit',_x000A__x0009_'Alter any server role',_x000A__x0009_'Alter resources',_x000A__x0009_'Alter server state ',_x000A__x0009_'Alter Settings ',_x000A__x0009_'Alter trace',_x000A__x0009_'Authenticate server ',_x000A__x0009_'Control server',_x000A__x0009_'Create any database ',_x000A__x0009_'Create availability group',_x000A__x0009_'Create DDL event notification',_x000A__x0009_'Create endpoint',_x000A__x0009_'Create server role',_x000A__x0009_'Create trace event notification',_x000A__x0009_'External access assembly',_x000A__x0009_'Shutdown',_x000A__x0009_'Unsafe Assembly',_x000A__x0009_'View any database',_x000A__x0009_'View any definition',_x000A__x0009_'View server state'_x000A__x0009_)_x000A_AND_x0009_who.type_desc = 'SERVER_ROLE'_x000A_ORDER BY_x000A__x0009_what.permission_name,_x000A__x0009_who.name_x000A_;_x000A_GO</S>
    </MS>
  </Obj>
  <Obj RefId="474">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2012</S>
      <S N="VulnID">V-41254</S>
      <S N="RuleID">SV-53736r4_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL2-00-007200</S>
      <S N="Title">SQL Server must enforce access control policies to restrict the External access assembly permission to only authorized roles.</S>
      <S N="Description">The concept of least privilege must be applied to SQL Server processes, ensuring that the processes operate at privilege levels no higher than necessary to accomplish required organizational missions and/or functions. Organizations consider the creation of additional processes, roles, and SQL Server accounts as necessary to achieve least privilege. Organizations also apply least privilege concepts to the design, development, implementation, and operations of SQL Server and the OS._x000A__x000A_Unauthorized access to sensitive data or SQL Server control may compromise the confidentiality of personnel privacy, threaten national security, compromise a variety of other sensitive operations or lead to a loss of system control. Access controls are best managed by defining requirements based on distinct job functions and assigning access based on the job function assigned to the individual user._x000A__x000A_SQL Server's 'External access assembly' permission is a high server-level privilege that must only be granted to individual administration accounts through roles, and users who have access must require this privilege to accomplish the organizational missions and/or functions. If the 'External access assembly' permission is granted to roles that are unauthorized to have this privilege, then this access must be removed._x000A__x000A_Additionally, the permission must not be denied to a role, because that could disable a user's legitimate access via another role._x000A__x000A_The fix for this vulnerability specifies the use of REVOKE.  Be aware that revoking a permission that is currently denied to a role or user does not necessarily disable the permission.  If the user or role can inherent the permission from another role, revoking the denied permission from the user or the first role can effectively enable the inherited permission.tru</S>
      <S N="FixText">Remove the 'External access assembly' permission access from the role that is not authorized by executing the following query:_x000A__x000A__x000A_REVOKE External access assembly TO &lt;'role name'&gt;</S>
      <S N="Check">Obtain the list of roles that are authorized for the SQL Server 'External access assembly' permission and what 'Grant', 'Grant With', and/or 'Deny' privilege is authorized. Obtain the list of roles with that permission by running the following query:_x000A__x000A_SELECT _x000A_       who.name AS [Principal Name],_x000A_       who.type_desc AS [Principal Type],_x000A_       who.is_disabled AS [Principal Is Disabled],_x000A_       what.state_desc AS [Permission State],_x000A_       what.permission_name AS [Permission Name]_x000A_FROM _x000A_       sys.server_permissions what _x000A_       INNER JOIN sys.server_principals who_x000A_              ON who.principal_id = what.grantee_principal_id_x000A_WHERE_x000A_       what.permission_name = 'External access assembly' _x000A_AND    who.type_desc = 'SERVER_ROLE'_x000A_ORDER BY_x000A_       who.name_x000A_;_x000A_GO _x000A__x000A_If any role has 'Grant', 'With Grant' or 'Deny' privileges on this permission and users with that role are not authorized to have the permission, this is a finding._x000A__x000A_Alternatively, to provide a combined list for all requirements of this type:_x000A_SELECT _x000A__x0009_what.permission_name AS [Permission Name],_x000A__x0009_what.state_desc AS [Permission State],_x000A__x0009_who.name AS [Principal Name],_x000A__x0009_who.type_desc AS [Principal Type],_x000A__x0009_who.is_disabled AS [Principal Is Disabled]_x000A_FROM _x000A__x0009_sys.server_permissions what _x000A__x0009_INNER JOIN sys.server_principals who_x000A__x0009__x0009_ON who.principal_id = what.grantee_principal_id_x000A_WHERE_x000A__x0009_what.permission_name IN_x000A__x0009_(_x000A__x0009_'Administer bulk operations',_x000A__x0009_'Alter any availability group',_x000A__x0009_'Alter any connection',_x000A__x0009_'Alter any credential',_x000A__x0009_'Alter any database',_x000A__x0009_'Alter any endpoint ',_x000A__x0009_'Alter any event notification ',_x000A__x0009_'Alter any event session ',_x000A__x0009_'Alter any linked server',_x000A__x0009_'Alter any login',_x000A__x0009_'Alter any server audit',_x000A__x0009_'Alter any server role',_x000A__x0009_'Alter resources',_x000A__x0009_'Alter server state ',_x000A__x0009_'Alter Settings ',_x000A__x0009_'Alter trace',_x000A__x0009_'Authenticate server ',_x000A__x0009_'Control server',_x000A__x0009_'Create any database ',_x000A__x0009_'Create availability group',_x000A__x0009_'Create DDL event notification',_x000A__x0009_'Create endpoint',_x000A__x0009_'Create server role',_x000A__x0009_'Create trace event notification',_x000A__x0009_'External access assembly',_x000A__x0009_'Shutdown',_x000A__x0009_'Unsafe Assembly',_x000A__x0009_'View any database',_x000A__x0009_'View any definition',_x000A__x0009_'View server state'_x000A__x0009_)_x000A_AND_x0009_who.type_desc = 'SERVER_ROLE'_x000A_ORDER BY_x000A__x0009_what.permission_name,_x000A__x0009_who.name_x000A_;_x000A_GO</S>
    </MS>
  </Obj>
  <Obj RefId="475">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2012</S>
      <S N="VulnID">V-41255</S>
      <S N="RuleID">SV-53737r4_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL2-00-007100</S>
      <S N="Title">SQL Server must enforce access control policies to restrict the Create trace event notification permission to only authorized roles.</S>
      <S N="Description">The concept of least privilege must be applied to SQL Server processes, ensuring that the processes operate at privilege levels no higher than necessary to accomplish required organizational missions and/or functions. Organizations consider the creation of additional processes, roles, and SQL Server accounts as necessary to achieve least privilege. Organizations also apply least privilege concepts to the design, development, implementation, and operations of SQL Server and the OS._x000A__x000A_Unauthorized access to sensitive data or SQL Server control may compromise the confidentiality of personnel privacy, threaten national security, compromise a variety of other sensitive operations or lead to a loss of system control. Access controls are best managed by defining requirements based on distinct job functions and assigning access based on the job function assigned to the individual user._x000A__x000A_SQL Server's 'Create trace event notification' permission is a high server-level privilege that must only be granted to individual administration accounts through roles, and users who have access must require this privilege to accomplish the organizational missions and/or functions. If the 'Create trace event notification' permission is granted to roles that are unauthorized to have this privilege, then this access must be removed._x000A__x000A_Additionally, the permission must not be denied to a role, because that could disable a user's legitimate access via another role._x000A__x000A_The fix for this vulnerability specifies the use of REVOKE.  Be aware that revoking a permission that is currently denied to a role or user does not necessarily disable the permission.  If the user or role can inherent the permission from another role, revoking the denied permission from the user or the first role can effectively enable the inherited permission.tru</S>
      <S N="FixText">Remove the 'Create trace event notification' permission access from the role that is not authorized by executing the following query:_x000A__x000A__x000A_REVOKE Create trace event notification TO &lt;'role name'&gt;</S>
      <S N="Check">Obtain the list of roles that are authorized for the SQL Server 'Create trace event notification' permission and what 'Grant', 'Grant With', and/or 'Deny' privilege is authorized. Obtain the list of roles with that permission by running the following query:_x000A__x000A_SELECT _x000A_       who.name AS [Principal Name],_x000A_       who.type_desc AS [Principal Type],_x000A_       who.is_disabled AS [Principal Is Disabled],_x000A_       what.state_desc AS [Permission State],_x000A_       what.permission_name AS [Permission Name]_x000A_FROM _x000A_       sys.server_permissions what _x000A_       INNER JOIN sys.server_principals who_x000A_              ON who.principal_id = what.grantee_principal_id_x000A_WHERE_x000A_       what.permission_name = 'Create trace event notification'_x000A_AND    who.type_desc = 'SERVER_ROLE'_x000A_ORDER BY_x000A_       who.name_x000A_;_x000A_GO _x000A__x000A_If any role has 'Grant', 'With Grant' or 'Deny' privileges on this permission and users with that role are not authorized to have the permission, this is a finding._x000A__x000A_Alternatively, to provide a combined list for all requirements of this type:_x000A_SELECT _x000A__x0009_what.permission_name AS [Permission Name],_x000A__x0009_what.state_desc AS [Permission State],_x000A__x0009_who.name AS [Principal Name],_x000A__x0009_who.type_desc AS [Principal Type],_x000A__x0009_who.is_disabled AS [Principal Is Disabled]_x000A_FROM _x000A__x0009_sys.server_permissions what _x000A__x0009_INNER JOIN sys.server_principals who_x000A__x0009__x0009_ON who.principal_id = what.grantee_principal_id_x000A_WHERE_x000A__x0009_what.permission_name IN_x000A__x0009_(_x000A__x0009_'Administer bulk operations',_x000A__x0009_'Alter any availability group',_x000A__x0009_'Alter any connection',_x000A__x0009_'Alter any credential',_x000A__x0009_'Alter any database',_x000A__x0009_'Alter any endpoint ',_x000A__x0009_'Alter any event notification ',_x000A__x0009_'Alter any event session ',_x000A__x0009_'Alter any linked server',_x000A__x0009_'Alter any login',_x000A__x0009_'Alter any server audit',_x000A__x0009_'Alter any server role',_x000A__x0009_'Alter resources',_x000A__x0009_'Alter server state ',_x000A__x0009_'Alter Settings ',_x000A__x0009_'Alter trace',_x000A__x0009_'Authenticate server ',_x000A__x0009_'Control server',_x000A__x0009_'Create any database ',_x000A__x0009_'Create availability group',_x000A__x0009_'Create DDL event notification',_x000A__x0009_'Create endpoint',_x000A__x0009_'Create server role',_x000A__x0009_'Create trace event notification',_x000A__x0009_'External access assembly',_x000A__x0009_'Shutdown',_x000A__x0009_'Unsafe Assembly',_x000A__x0009_'View any database',_x000A__x0009_'View any definition',_x000A__x0009_'View server state'_x000A__x0009_)_x000A_AND_x0009_who.type_desc = 'SERVER_ROLE'_x000A_ORDER BY_x000A__x0009_what.permission_name,_x000A__x0009_who.name_x000A_;_x000A_GO</S>
    </MS>
  </Obj>
  <Obj RefId="476">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2012</S>
      <S N="VulnID">V-41256</S>
      <S N="RuleID">SV-53738r4_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL2-00-007000</S>
      <S N="Title">SQL Server must enforce access control policies to restrict the Create server role permission to only authorized roles.</S>
      <S N="Description">The concept of least privilege must be applied to SQL Server processes, ensuring that the processes operate at privilege levels no higher than necessary to accomplish required organizational missions and/or functions. Organizations consider the creation of additional processes, roles, and SQL Server accounts as necessary to achieve least privilege. Organizations also apply least privilege concepts to the design, development, implementation, and operations of SQL Server and the OS._x000A__x000A_Unauthorized access to sensitive data or SQL Server control may compromise the confidentiality of personnel privacy, threaten national security, compromise a variety of other sensitive operations or lead to a loss of system control. Access controls are best managed by defining requirements based on distinct job functions and assigning access based on the job function assigned to the individual user._x000A__x000A_SQL Server's 'Create server role' permission is a high server-level privilege that must only be granted to individual administration accounts through roles, and users who have access must require this privilege to accomplish the organizational missions and/or functions. , If the 'Create server role' permission is granted to roles that are unauthorized to have this privilege, then this access must be removed._x000A__x000A_Additionally, the permission must not be denied to a role, because that could disable a user's legitimate access via another role._x000A__x000A_The fix for this vulnerability specifies the use of REVOKE.  Be aware that revoking a permission that is currently denied to a role or user does not necessarily disable the permission.  If the user or role can inherent the permission from another role, revoking the denied permission from the user or the first role can effectively enable the inherited permission.tru</S>
      <S N="FixText">Remove the 'Create server role' permission access from the role that is not authorized by executing the following query:_x000A__x000A__x000A_REVOKE Create server role TO &lt;'role name'&gt;</S>
      <S N="Check">Obtain the list of roles that are authorized for the SQL Server 'Create server role' permission and what 'Grant', 'Grant With', and/or 'Deny' privilege is authorized. Obtain the list of roles with that permission by running the following query:_x000A__x000A_SELECT _x000A_       who.name AS [Principal Name],_x000A_       who.type_desc AS [Principal Type],_x000A_       who.is_disabled AS [Principal Is Disabled],_x000A_       what.state_desc AS [Permission State],_x000A_       what.permission_name AS [Permission Name]_x000A_FROM _x000A_       sys.server_permissions what _x000A_       INNER JOIN sys.server_principals who_x000A_              ON who.principal_id = what.grantee_principal_id_x000A_WHERE_x000A_       what.permission_name = 'Create server role'_x000A_AND    who.type_desc = 'SERVER_ROLE'_x000A_ORDER BY_x000A_       who.name_x000A_;_x000A_GO _x000A__x000A_If any role has 'Grant', 'With Grant' or 'Deny' privileges on this permission and users with that role are not authorized to have the permission, this is a finding._x000A__x000A_Alternatively, to provide a combined list for all requirements of this type:_x000A_SELECT _x000A__x0009_what.permission_name AS [Permission Name],_x000A__x0009_what.state_desc AS [Permission State],_x000A__x0009_who.name AS [Principal Name],_x000A__x0009_who.type_desc AS [Principal Type],_x000A__x0009_who.is_disabled AS [Principal Is Disabled]_x000A_FROM _x000A__x0009_sys.server_permissions what _x000A__x0009_INNER JOIN sys.server_principals who_x000A__x0009__x0009_ON who.principal_id = what.grantee_principal_id_x000A_WHERE_x000A__x0009_what.permission_name IN_x000A__x0009_(_x000A__x0009_'Administer bulk operations',_x000A__x0009_'Alter any availability group',_x000A__x0009_'Alter any connection',_x000A__x0009_'Alter any credential',_x000A__x0009_'Alter any database',_x000A__x0009_'Alter any endpoint ',_x000A__x0009_'Alter any event notification ',_x000A__x0009_'Alter any event session ',_x000A__x0009_'Alter any linked server',_x000A__x0009_'Alter any login',_x000A__x0009_'Alter any server audit',_x000A__x0009_'Alter any server role',_x000A__x0009_'Alter resources',_x000A__x0009_'Alter server state ',_x000A__x0009_'Alter Settings ',_x000A__x0009_'Alter trace',_x000A__x0009_'Authenticate server ',_x000A__x0009_'Control server',_x000A__x0009_'Create any database ',_x000A__x0009_'Create availability group',_x000A__x0009_'Create DDL event notification',_x000A__x0009_'Create endpoint',_x000A__x0009_'Create server role',_x000A__x0009_'Create trace event notification',_x000A__x0009_'External access assembly',_x000A__x0009_'Shutdown',_x000A__x0009_'Unsafe Assembly',_x000A__x0009_'View any database',_x000A__x0009_'View any definition',_x000A__x0009_'View server state'_x000A__x0009_)_x000A_AND_x0009_who.type_desc = 'SERVER_ROLE'_x000A_ORDER BY_x000A__x0009_what.permission_name,_x000A__x0009_who.name_x000A_;_x000A_GO</S>
    </MS>
  </Obj>
  <Obj RefId="477">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2012</S>
      <S N="VulnID">V-41257</S>
      <S N="RuleID">SV-53739r4_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL2-00-006900</S>
      <S N="Title">SQL Server must enforce access control policies to restrict the Create endpoint permission to only authorized roles.</S>
      <S N="Description">The concept of least privilege must be applied to SQL Server processes, ensuring that the processes operate at privilege levels no higher than necessary to accomplish required organizational missions and/or functions. Organizations consider the creation of additional processes, roles, and SQL Server accounts as necessary to achieve least privilege. Organizations also apply least privilege concepts to the design, development, implementation, and operations of SQL Server and the OS._x000A__x000A_Unauthorized access to sensitive data or SQL Server control may compromise the confidentiality of personnel privacy, threaten national security, compromise a variety of other sensitive operations or lead to a loss of system control. Access controls are best managed by defining requirements based on distinct job functions and assigning access based on the job function assigned to the individual user._x000A__x000A_SQL Server's 'Create endpoint' permission is a high server-level privilege that must only be granted to individual administration accounts through roles, and users who have access must require this privilege to accomplish the organizational missions and/or functions. If the 'Create endpoint' permissions are granted to roles that are unauthorized to have this privilege, then this access must be removed._x000A__x000A_Additionally, the permission must not be denied to a role, because that could disable a user's legitimate access via another role._x000A__x000A_The fix for this vulnerability specifies the use of REVOKE.  Be aware that revoking a permission that is currently denied to a role or user does not necessarily disable the permission.  If the user or role can inherent the permission from another role, revoking the denied permission from the user or the first role can effectively enable the inherited permission.tru</S>
      <S N="FixText">Remove the 'Create endpoint' permission access from the role that is not authorized by executing the following query:_x000A__x000A__x000A_REVOKE Create endpoint TO &lt;'role name'&gt;</S>
      <S N="Check">Obtain the list of roles that are authorized for the SQL Server 'Create endpoint' permission and what 'Grant', 'Grant With', and/or 'Deny' privilege is authorized._x000A__x000A_Obtain the list of roles with that permission by running the following query:_x000A__x000A_SELECT _x000A_       who.name AS [Principal Name],_x000A_       who.type_desc AS [Principal Type],_x000A_       who.is_disabled AS [Principal Is Disabled],_x000A_       what.state_desc AS [Permission State],_x000A_       what.permission_name AS [Permission Name]_x000A_FROM _x000A_       sys.server_permissions what _x000A_       INNER JOIN sys.server_principals who_x000A_              ON who.principal_id = what.grantee_principal_id_x000A_WHERE_x000A_       what.permission_name = 'Create endpoint' _x000A_AND    who.type_desc = 'SERVER_ROLE'_x000A_ORDER BY_x000A_       who.name_x000A_;_x000A_GO _x000A__x000A_If any role has 'Grant', 'With Grant' or 'Deny' privileges on this permission and users with that role are not authorized to have the permission, this is a finding._x000A__x000A_Alternatively, to provide a combined list for all requirements of this type:_x000A_SELECT _x000A__x0009_what.permission_name AS [Permission Name],_x000A__x0009_what.state_desc AS [Permission State],_x000A__x0009_who.name AS [Principal Name],_x000A__x0009_who.type_desc AS [Principal Type],_x000A__x0009_who.is_disabled AS [Principal Is Disabled]_x000A_FROM _x000A__x0009_sys.server_permissions what _x000A__x0009_INNER JOIN sys.server_principals who_x000A__x0009__x0009_ON who.principal_id = what.grantee_principal_id_x000A_WHERE_x000A__x0009_what.permission_name IN_x000A__x0009_(_x000A__x0009_'Administer bulk operations',_x000A__x0009_'Alter any availability group',_x000A__x0009_'Alter any connection',_x000A__x0009_'Alter any credential',_x000A__x0009_'Alter any database',_x000A__x0009_'Alter any endpoint ',_x000A__x0009_'Alter any event notification ',_x000A__x0009_'Alter any event session ',_x000A__x0009_'Alter any linked server',_x000A__x0009_'Alter any login',_x000A__x0009_'Alter any server audit',_x000A__x0009_'Alter any server role',_x000A__x0009_'Alter resources',_x000A__x0009_'Alter server state ',_x000A__x0009_'Alter Settings ',_x000A__x0009_'Alter trace',_x000A__x0009_'Authenticate server ',_x000A__x0009_'Control server',_x000A__x0009_'Create any database ',_x000A__x0009_'Create availability group',_x000A__x0009_'Create DDL event notification',_x000A__x0009_'Create endpoint',_x000A__x0009_'Create server role',_x000A__x0009_'Create trace event notification',_x000A__x0009_'External access assembly',_x000A__x0009_'Shutdown',_x000A__x0009_'Unsafe Assembly',_x000A__x0009_'View any database',_x000A__x0009_'View any definition',_x000A__x0009_'View server state'_x000A__x0009_)_x000A_AND_x0009_who.type_desc = 'SERVER_ROLE'_x000A_ORDER BY_x000A__x0009_what.permission_name,_x000A__x0009_who.name_x000A_;_x000A_GO</S>
    </MS>
  </Obj>
  <Obj RefId="478">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2012</S>
      <S N="VulnID">V-41258</S>
      <S N="RuleID">SV-53740r4_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL2-00-006800</S>
      <S N="Title">SQL Server must enforce access control policies to restrict the Create DDL event notification permission to only authorized roles.</S>
      <S N="Description">The concept of least privilege must be applied to SQL Server processes, ensuring that the processes operate at privilege levels no higher than necessary to accomplish required organizational missions and/or functions. Organizations consider the creation of additional processes, roles, and SQL Server accounts as necessary to achieve least privilege. Organizations also apply least privilege concepts to the design, development, implementation, and operations of SQL Server and the OS._x000A__x000A_Unauthorized access to sensitive data or SQL Server control may compromise the confidentiality of personnel privacy, threaten national security, compromise a variety of other sensitive operations or lead to a loss of system control. Access controls are best managed by defining requirements based on distinct job functions and assigning access based on the job function assigned to the individual user._x000A__x000A_SQL Server's 'Create DDL event notification' permission is a high server-level privilege that must only be granted to individual administration accounts through roles, and users who have access must require this privilege to accomplish the organizational missions and/or functions. If the 'Create DDL event notification' permission is granted to roles that are unauthorized to have this privilege, then this access must be removed._x000A__x000A_Additionally, the permission must not be denied to a role, because that could disable a user's legitimate access via another role._x000A__x000A_The fix for this vulnerability specifies the use of REVOKE.  Be aware that revoking a permission that is currently denied to a role or user does not necessarily disable the permission.  If the user or role can inherent the permission from another role, revoking the denied permission from the user or the first role can effectively enable the inherited permission.tru</S>
      <S N="FixText">Remove the 'Create DDL event notification' permission access from the role that is not authorized by executing the following query:_x000A__x000A__x000A_REVOKE Create DDL event notification TO &lt;'role name'&gt;</S>
      <S N="Check">Obtain the list of roles that are authorized for the SQL Server 'Create DDL event notification' permission and what 'Grant', 'Grant With', and/or 'Deny' privilege is authorized. Obtain the list of roles with that permission by running the following query:_x000A__x000A_SELECT _x000A_       who.name AS [Principal Name],_x000A_       who.type_desc AS [Principal Type],_x000A_       who.is_disabled AS [Principal Is Disabled],_x000A_       what.state_desc AS [Permission State],_x000A_       what.permission_name AS [Permission Name]_x000A_FROM _x000A_       sys.server_permissions what _x000A_       INNER JOIN sys.server_principals who_x000A_              ON who.principal_id = what.grantee_principal_id_x000A_WHERE_x000A_       what.permission_name = 'Create DDL event notification' _x000A_AND    who.type_desc = 'SERVER_ROLE'_x000A_ORDER BY_x000A_       who.name_x000A_;_x000A_GO _x000A__x000A_If any role has 'Grant', 'With Grant' or 'Deny' privileges on this permission and users with that role are not authorized to have the permission, this is a finding._x000A__x000A_Alternatively, to provide a combined list for all requirements of this type:_x000A_SELECT _x000A__x0009_what.permission_name AS [Permission Name],_x000A__x0009_what.state_desc AS [Permission State],_x000A__x0009_who.name AS [Principal Name],_x000A__x0009_who.type_desc AS [Principal Type],_x000A__x0009_who.is_disabled AS [Principal Is Disabled]_x000A_FROM _x000A__x0009_sys.server_permissions what _x000A__x0009_INNER JOIN sys.server_principals who_x000A__x0009__x0009_ON who.principal_id = what.grantee_principal_id_x000A_WHERE_x000A__x0009_what.permission_name IN_x000A__x0009_(_x000A__x0009_'Administer bulk operations',_x000A__x0009_'Alter any availability group',_x000A__x0009_'Alter any connection',_x000A__x0009_'Alter any credential',_x000A__x0009_'Alter any database',_x000A__x0009_'Alter any endpoint ',_x000A__x0009_'Alter any event notification ',_x000A__x0009_'Alter any event session ',_x000A__x0009_'Alter any linked server',_x000A__x0009_'Alter any login',_x000A__x0009_'Alter any server audit',_x000A__x0009_'Alter any server role',_x000A__x0009_'Alter resources',_x000A__x0009_'Alter server state ',_x000A__x0009_'Alter Settings ',_x000A__x0009_'Alter trace',_x000A__x0009_'Authenticate server ',_x000A__x0009_'Control server',_x000A__x0009_'Create any database ',_x000A__x0009_'Create availability group',_x000A__x0009_'Create DDL event notification',_x000A__x0009_'Create endpoint',_x000A__x0009_'Create server role',_x000A__x0009_'Create trace event notification',_x000A__x0009_'External access assembly',_x000A__x0009_'Shutdown',_x000A__x0009_'Unsafe Assembly',_x000A__x0009_'View any database',_x000A__x0009_'View any definition',_x000A__x0009_'View server state'_x000A__x0009_)_x000A_AND_x0009_who.type_desc = 'SERVER_ROLE'_x000A_ORDER BY_x000A__x0009_what.permission_name,_x000A__x0009_who.name_x000A_;_x000A_GO</S>
    </MS>
  </Obj>
  <Obj RefId="479">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2012</S>
      <S N="VulnID">V-41259</S>
      <S N="RuleID">SV-53741r4_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL2-00-006700</S>
      <S N="Title">SQL Server must enforce access control policies to restrict the Create availability group permission to only authorized roles.</S>
      <S N="Description">The concept of least privilege must be applied to SQL Server processes, ensuring that the processes operate at privilege levels no higher than necessary to accomplish required organizational missions and/or functions. Organizations consider the creation of additional processes, roles, and SQL Server accounts as necessary to achieve least privilege. Organizations also apply least privilege concepts to the design, development, implementation, and operations of SQL Server and the OS._x000A__x000A_Unauthorized access to sensitive data or SQL Server control may compromise the confidentiality of personnel privacy, threaten national security, compromise a variety of other sensitive operations or lead to a loss of system control. Access controls are best managed by defining requirements based on distinct job functions and assigning access based on the job function assigned to the individual user._x000A__x000A_SQL Server's 'Create availability group' permission is a high server-level privilege that must only be granted to individual administration accounts through roles, and users who have access must require this privilege to accomplish the organizational missions and/or functions. If the 'Create availability group' permission is granted to roles that are unauthorized to have this privilege, then this access must be removed._x000A__x000A_Additionally, the permission must not be denied to a role, because that could disable a user's legitimate access via another role._x000A__x000A_The fix for this vulnerability specifies the use of REVOKE.  Be aware that revoking a permission that is currently denied to a role or user does not necessarily disable the permission.  If the user or role can inherent the permission from another role, revoking the denied permission from the user or the first role can effectively enable the inherited permission.tru</S>
      <S N="FixText">Remove the 'Create availability group' permission access from the role that is not authorized by executing the following query:_x000A__x000A__x000A_REVOKE Create availability group TO &lt;'role name'&gt;</S>
      <S N="Check">Obtain the list of roles that are authorized for the SQL Server 'Create availability group' permission and what 'Grant', 'Grant With', and/or 'Deny' privilege is authorized. Obtain the list of roles with that permission by running the following query:_x000A__x000A_SELECT _x000A_       who.name AS [Principal Name],_x000A_       who.type_desc AS [Principal Type],_x000A_       who.is_disabled AS [Principal Is Disabled],_x000A_       what.state_desc AS [Permission State],_x000A_       what.permission_name AS [Permission Name]_x000A_FROM _x000A_       sys.server_permissions what _x000A_       INNER JOIN sys.server_principals who_x000A_              ON who.principal_id = what.grantee_principal_id_x000A_WHERE_x000A_       what.permission_name = 'Create availability group' _x000A_AND    who.type_desc = 'SERVER_ROLE'_x000A_ORDER BY_x000A_       who.name_x000A_;_x000A_GO _x000A__x000A_If any role has 'Grant', 'With Grant' or 'Deny' privileges on this permission and users with that role are not authorized to have the permission, this is a finding._x000A__x000A_Alternatively, to provide a combined list for all requirements of this type:_x000A_SELECT _x000A__x0009_what.permission_name AS [Permission Name],_x000A__x0009_what.state_desc AS [Permission State],_x000A__x0009_who.name AS [Principal Name],_x000A__x0009_who.type_desc AS [Principal Type],_x000A__x0009_who.is_disabled AS [Principal Is Disabled]_x000A_FROM _x000A__x0009_sys.server_permissions what _x000A__x0009_INNER JOIN sys.server_principals who_x000A__x0009__x0009_ON who.principal_id = what.grantee_principal_id_x000A_WHERE_x000A__x0009_what.permission_name IN_x000A__x0009_(_x000A__x0009_'Administer bulk operations',_x000A__x0009_'Alter any availability group',_x000A__x0009_'Alter any connection',_x000A__x0009_'Alter any credential',_x000A__x0009_'Alter any database',_x000A__x0009_'Alter any endpoint ',_x000A__x0009_'Alter any event notification ',_x000A__x0009_'Alter any event session ',_x000A__x0009_'Alter any linked server',_x000A__x0009_'Alter any login',_x000A__x0009_'Alter any server audit',_x000A__x0009_'Alter any server role',_x000A__x0009_'Alter resources',_x000A__x0009_'Alter server state ',_x000A__x0009_'Alter Settings ',_x000A__x0009_'Alter trace',_x000A__x0009_'Authenticate server ',_x000A__x0009_'Control server',_x000A__x0009_'Create any database ',_x000A__x0009_'Create availability group',_x000A__x0009_'Create DDL event notification',_x000A__x0009_'Create endpoint',_x000A__x0009_'Create server role',_x000A__x0009_'Create trace event notification',_x000A__x0009_'External access assembly',_x000A__x0009_'Shutdown',_x000A__x0009_'Unsafe Assembly',_x000A__x0009_'View any database',_x000A__x0009_'View any definition',_x000A__x0009_'View server state'_x000A__x0009_)_x000A_AND_x0009_who.type_desc = 'SERVER_ROLE'_x000A_ORDER BY_x000A__x0009_what.permission_name,_x000A__x0009_who.name_x000A_;_x000A_GO</S>
    </MS>
  </Obj>
  <Obj RefId="480">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2012</S>
      <S N="VulnID">V-41260</S>
      <S N="RuleID">SV-53742r3_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL2-00-006600</S>
      <S N="Title">SQL Server must enforce access control policies to restrict the Alter any server audit permission to only authorized roles.</S>
      <S N="Description">The concept of least privilege must be applied to SQL Server processes, ensuring that the processes operate at privilege levels no higher than necessary to accomplish required organizational missions and/or functions. Organizations consider the creation of additional processes, roles, and SQL Server accounts as necessary to achieve least privilege. Organizations also apply least privilege concepts to the design, development, implementation, and operations of SQL Server and the OS._x000A__x000A_Unauthorized access to sensitive data or SQL Server control may compromise the confidentiality of personnel privacy, threaten national security, compromise a variety of other sensitive operations, or lead to a loss of system control. Access controls are best managed by defining requirements based on distinct job functions and assigning access based on the job function assigned to the individual user._x000A__x000A_SQL Server's 'Alter any server audit' permission is a high server-level privilege that must only be granted to individual administration accounts through roles. If the 'Alter any server audit' permission is granted to roles that are unauthorized to have this privilege, then this access must be removed._x000A__x000A_Additionally, the permission must not be denied to a role, because that could disable a user's legitimate access via another role._x000A__x000A_The fix for this vulnerability specifies the use of REVOKE.  Be aware that revoking a permission that is currently denied to a role or user does not necessarily disable the permission.  If the user or role can inherent the permission from another role, revoking the denied permission from the user or the first role can effectively enable the inherited permission.tru</S>
      <S N="FixText">Remove the 'Alter any server audit' permission access from the role that is not authorized  by executing the following query:_x000A__x000A__x000A_REVOKE Alter any server audit TO &lt;'role name'&gt;</S>
      <S N="Check">Obtain the list of roles that are authorized for the SQL Server 'Alter any server audit' permission and what 'Grant', 'Grant With', and/or 'Deny' privilege is authorized. Obtain the list of roles with that permission by running the following query:_x000A__x000A_SELECT _x000A_       who.name AS [Principal Name],_x000A_       who.type_desc AS [Principal Type],_x000A_       who.is_disabled AS [Principal Is Disabled],_x000A_       what.state_desc AS [Permission State],_x000A_       what.permission_name AS [Permission Name]_x000A_FROM _x000A_       sys.server_permissions what _x000A_       INNER JOIN sys.server_principals who_x000A_              ON who.principal_id = what.grantee_principal_id_x000A_WHERE_x000A_       what.permission_name = 'Alter any server audit' _x000A_AND    who.type_desc = 'SERVER_ROLE'_x000A_ORDER BY_x000A_       who.name_x000A_;_x000A_GO _x000A__x000A_If any role has 'Grant', 'With Grant' or 'Deny' privileges on this permission and users with that role are not authorized to have the permission, this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="481">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2012</S>
      <S N="VulnID">V-41261</S>
      <S N="RuleID">SV-53743r4_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL2-00-006500</S>
      <S N="Title">SQL Server must enforce access control policies to restrict the View any definition permission to only authorized roles.</S>
      <S N="Description">The concept of least privilege must be applied to SQL Server processes, ensuring that the processes operate at privilege levels no higher than necessary to accomplish required organizational missions and/or functions. Organizations consider the creation of additional processes, roles, and SQL Server accounts as necessary to achieve least privilege. Organizations also apply least privilege concepts to the design, development, implementation, and operations of SQL Server and the OS._x000A__x000A_Unauthorized access to sensitive data or SQL Server control may compromise the confidentiality of personnel privacy, threaten national security, compromise a variety of other sensitive operations or lead to a loss of system control. Access controls are best managed by defining requirements based on distinct job functions and assigning access based on the job function assigned to the individual user._x000A__x000A_SQL Server's 'View any definition' permission is a high server-level privilege that must only be granted to individual administration accounts through roles, and users who have access must require this privilege to accomplish the organizational missions and/or functions. If the 'View any definition' permission is granted to roles that are unauthorized to have this privilege, then this access must be removed._x000A__x000A_Additionally, the permission must not be denied to a role, because that could disable a user's legitimate access via another role._x000A__x000A_The fix for this vulnerability specifies the use of REVOKE.  Be aware that revoking a permission that is currently denied to a role or user does not necessarily disable the permission.  If the user or role can inherent the permission from another role, revoking the denied permission from the user or the first role can effectively enable the inherited permission.tru</S>
      <S N="FixText">Remove the 'View any definition' permission access from the role that is not authorized by executing the following query:_x000A__x000A__x000A_REVOKE View any definition TO &lt;'role name'&gt;</S>
      <S N="Check">Obtain the list of roles that are authorized for the SQL Server 'View any definition' permission and what 'Grant', 'Grant With', and/or 'Deny' privilege is authorized. Obtain the list of roles with that permission by running the following query:_x000A__x000A_SELECT _x000A_       who.name AS [Principal Name],_x000A_       who.type_desc AS [Principal Type],_x000A_       who.is_disabled AS [Principal Is Disabled],_x000A_       what.state_desc AS [Permission State],_x000A_       what.permission_name AS [Permission Name]_x000A_FROM _x000A_       sys.server_permissions what _x000A_       INNER JOIN sys.server_principals who_x000A_              ON who.principal_id = what.grantee_principal_id_x000A_WHERE_x000A_       what.permission_name = 'View any definition' _x000A_AND    who.type_desc = 'SERVER_ROLE'_x000A_ORDER BY_x000A_       who.name_x000A_;_x000A_GO _x000A__x000A_If any role has 'Grant', 'With Grant' or 'Deny' privileges on this permission and users with that role are not authorized to have the permission, this is a finding._x000A__x000A_Alternatively, to provide a combined list for all requirements of this type:_x000A_SELECT _x000A__x0009_what.permission_name AS [Permission Name],_x000A__x0009_what.state_desc AS [Permission State],_x000A__x0009_who.name AS [Principal Name],_x000A__x0009_who.type_desc AS [Principal Type],_x000A__x0009_who.is_disabled AS [Principal Is Disabled]_x000A_FROM _x000A__x0009_sys.server_permissions what _x000A__x0009_INNER JOIN sys.server_principals who_x000A__x0009__x0009_ON who.principal_id = what.grantee_principal_id_x000A_WHERE_x000A__x0009_what.permission_name IN_x000A__x0009_(_x000A__x0009_'Administer bulk operations',_x000A__x0009_'Alter any availability group',_x000A__x0009_'Alter any connection',_x000A__x0009_'Alter any credential',_x000A__x0009_'Alter any database',_x000A__x0009_'Alter any endpoint ',_x000A__x0009_'Alter any event notification ',_x000A__x0009_'Alter any event session ',_x000A__x0009_'Alter any linked server',_x000A__x0009_'Alter any login',_x000A__x0009_'Alter any server audit',_x000A__x0009_'Alter any server role',_x000A__x0009_'Alter resources',_x000A__x0009_'Alter server state ',_x000A__x0009_'Alter Settings ',_x000A__x0009_'Alter trace',_x000A__x0009_'Authenticate server ',_x000A__x0009_'Control server',_x000A__x0009_'Create any database ',_x000A__x0009_'Create availability group',_x000A__x0009_'Create DDL event notification',_x000A__x0009_'Create endpoint',_x000A__x0009_'Create server role',_x000A__x0009_'Create trace event notification',_x000A__x0009_'External access assembly',_x000A__x0009_'Shutdown',_x000A__x0009_'Unsafe Assembly',_x000A__x0009_'View any database',_x000A__x0009_'View any definition',_x000A__x0009_'View server state'_x000A__x0009_)_x000A_AND_x0009_who.type_desc = 'SERVER_ROLE'_x000A_ORDER BY_x000A__x0009_what.permission_name,_x000A__x0009_who.name_x000A_;_x000A_GO</S>
    </MS>
  </Obj>
  <Obj RefId="482">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2012</S>
      <S N="VulnID">V-41262</S>
      <S N="RuleID">SV-53744r4_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL2-00-006400</S>
      <S N="Title">SQL Server must not grant users direct access to the Authenticate server permission.</S>
      <S N="Description">The concept of least privilege must be applied to SQL Server processes, ensuring that the processes operate at privilege levels no higher than necessary to accomplish required organizational missions and/or functions. Organizations consider the creation of additional processes, roles, and SQL Server accounts as necessary to achieve least privilege. Organizations also apply least privilege concepts to the design, development, implementation, and operations of SQL Server and the OS._x000A__x000A_Unauthorized access to sensitive data or SQL Server control may compromise the confidentiality of personnel privacy, threaten national security, compromise a variety of other sensitive operations or lead to a loss of system control. Access controls are best managed by defining requirements based on distinct job functions and assigning access based on the job function assigned to the individual user._x000A__x000A_Privileges granted outside of SQL Server's role-based account assignments are more likely to go unmanaged and without oversight of granted access. Maintenance of privileges using roles defined for discrete job functions offers improved oversight of application user privilege assignments and helps to protect against unauthorized privilege assignment._x000A__x000A_SQL Server's 'Authenticate Server' permission is a high server-level privilege that must only be granted to individual administration accounts through roles. This administrative privilege must not be assigned directly to administrative user accounts (or any other user accounts). If any user accounts have direct access to administrative privileges, this access must be removed._x000A__x000A_Note that this does not apply to logins with names of the form '##MS...##'.  These accounts are internal-use system principals provisioned by the DBMS, and required by it for specific purposes.tru</S>
      <S N="FixText">Remove the 'Authenticate Server' permission access from the account that has direct access by running the following script:_x000A__x000A_USE master;_x000A_REVOKE AUTHENTICATE SERVER FROM &lt;account name&gt;;_x000A_GO</S>
      <S N="Check">Obtain the list of accounts that have direct access to the server-level permission 'Authenticate Server' by running the following query:_x000A__x000A_SELECT _x000A_       who.name AS [Principal Name],_x000A_       who.type_desc AS [Principal Type],_x000A_       who.is_disabled AS [Principal Is Disabled],_x000A_       what.state_desc AS [Permission State],_x000A_       what.permission_name AS [Permission Name]_x000A_FROM _x000A_       sys.server_permissions what _x000A_       INNER JOIN sys.server_principals who_x000A_              ON who.principal_id = what.grantee_principal_id_x000A_WHERE_x000A_       what.permission_name = 'AUTHENTICATE SERVER'_x000A_AND    who.name NOT LIKE '##MS%##'_x000A_AND    who.type_desc &lt;&gt; 'SERVER_ROLE'_x000A_ORDER BY_x000A_       who.name_x000A_;_x000A_GO_x000A__x000A_If any user accounts have direct access to the 'Authenticate Server' permission, this is a finding._x000A__x000A_Alternatively, to provide a combined list for all requirements of this type:_x000A_SELECT _x000A__x0009_what.permission_name AS [Permission Name],_x000A__x0009_what.state_desc AS [Permission State],_x000A__x0009_who.name AS [Principal Name],_x000A__x0009_who.type_desc AS [Principal Type],_x000A__x0009_who.is_disabled AS [Principal Is Disabled]_x000A_FROM _x000A__x0009_sys.server_permissions what _x000A__x0009_INNER JOIN sys.server_principals who_x000A__x0009__x0009_ON who.principal_id = what.grantee_principal_id_x000A_WHERE_x000A__x0009_what.permission_name IN_x000A__x0009_(_x000A__x0009_'Administer bulk operations',_x000A__x0009_'Alter any availability group',_x000A__x0009_'Alter any connection',_x000A__x0009_'Alter any credential',_x000A__x0009_'Alter any database',_x000A__x0009_'Alter any endpoint ',_x000A__x0009_'Alter any event notification ',_x000A__x0009_'Alter any event session ',_x000A__x0009_'Alter any linked server',_x000A__x0009_'Alter any login',_x000A__x0009_'Alter any server audit',_x000A__x0009_'Alter any server role',_x000A__x0009_'Alter resources',_x000A__x0009_'Alter server state ',_x000A__x0009_'Alter Settings ',_x000A__x0009_'Alter trace',_x000A__x0009_'Authenticate server ',_x000A__x0009_'Control server',_x000A__x0009_'Create any database ',_x000A__x0009_'Create availability group',_x000A__x0009_'Create DDL event notification',_x000A__x0009_'Create endpoint',_x000A__x0009_'Create server role',_x000A__x0009_'Create trace event notification',_x000A__x0009_'External access assembly',_x000A__x0009_'Shutdown',_x000A__x0009_'Unsafe Assembly',_x000A__x0009_'View any database',_x000A__x0009_'View any definition',_x000A__x0009_'View server state'_x000A__x0009_)_x000A_AND    who.name NOT LIKE '##MS%##'_x000A_AND    who.type_desc &lt;&gt; 'SERVER_ROLE'_x000A_ORDER BY_x000A__x0009_what.permission_name,_x000A__x0009_who.name_x000A_;_x000A_GO</S>
    </MS>
  </Obj>
  <Obj RefId="483">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2012</S>
      <S N="VulnID">V-41263</S>
      <S N="RuleID">SV-53745r4_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL2-00-006300</S>
      <S N="Title">SQL Server must not grant users direct access to the Administer bulk operations permission.</S>
      <S N="Description">The concept of least privilege must be applied to SQL Server processes, ensuring that the processes operate at privilege levels no higher than necessary to accomplish required organizational missions and/or functions. Organizations consider the creation of additional processes, roles, and SQL Server accounts as necessary to achieve least privilege. Organizations also apply least privilege concepts to the design, development, implementation, and operations of SQL Server and the OS._x000A__x000A_Unauthorized access to sensitive data or SQL Server control may compromise the confidentiality of personnel privacy, threaten national security, compromise a variety of other sensitive operations or lead to a loss of system control. Access controls are best managed by defining requirements based on distinct job functions and assigning access based on the job function assigned to the individual user._x000A__x000A_Privileges granted outside of SQL Server's role-based account assignments are more likely to go unmanaged and without oversight of granted access. Maintenance of privileges using roles defined for discrete job functions offers improved oversight of application user privilege assignments and helps to protect against unauthorized privilege assignment._x000A__x000A_SQL Server's 'Administer bulk operations' permission is a high server-level privilege that must only be granted to individual administration accounts through roles. This administrative privilege must not be assigned directly to administrative user accounts (or any other user accounts). If any user accounts have direct access to administrative privileges, this access must be removed._x000A__x000A_Note that this does not apply to logins with names of the form '##MS...##'.  These accounts are internal-use system principals provisioned by the DBMS, and required by it for specific purposes.tru</S>
      <S N="FixText">Remove the 'Administer bulk operations' permission access from the account that has direct access by running the following script:_x000A__x000A__x000A_USE master_x000A__x000A_REVOKE ADMINISTER BULK OPERATIONS TO &lt;'account name'&gt;_x000A__x000A_GO</S>
      <S N="Check">Obtain the list of accounts that have direct access to the server-level permission 'Administer bulk operations' by running the following query:_x000A__x000A_SELECT _x000A_       who.name AS [Principal Name],_x000A_       who.type_desc AS [Principal Type],_x000A_       who.is_disabled AS [Principal Is Disabled],_x000A_       what.state_desc AS [Permission State],_x000A_       what.permission_name AS [Permission Name]_x000A_FROM _x000A_       sys.server_permissions what _x000A_       INNER JOIN sys.server_principals who_x000A_              ON who.principal_id = what.grantee_principal_id_x000A_WHERE_x000A_       what.permission_name = 'Administer bulk operations'_x000A_AND    who.name NOT LIKE '##MS%##'_x000A_AND    who.type_desc &lt;&gt; 'SERVER_ROLE'_x000A_ORDER BY_x000A_       who.name_x000A_;_x000A_GO_x000A__x000A_If any user accounts have direct access to the 'Administer bulk operations' permission, this is a finding._x000A__x000A_Alternatively, to provide a combined list for all requirements of this type:_x000A_SELECT _x000A__x0009_what.permission_name AS [Permission Name],_x000A__x0009_what.state_desc AS [Permission State],_x000A__x0009_who.name AS [Principal Name],_x000A__x0009_who.type_desc AS [Principal Type],_x000A__x0009_who.is_disabled AS [Principal Is Disabled]_x000A_FROM _x000A__x0009_sys.server_permissions what _x000A__x0009_INNER JOIN sys.server_principals who_x000A__x0009__x0009_ON who.principal_id = what.grantee_principal_id_x000A_WHERE_x000A__x0009_what.permission_name IN_x000A__x0009_(_x000A__x0009_'Administer bulk operations',_x000A__x0009_'Alter any availability group',_x000A__x0009_'Alter any connection',_x000A__x0009_'Alter any credential',_x000A__x0009_'Alter any database',_x000A__x0009_'Alter any endpoint ',_x000A__x0009_'Alter any event notification ',_x000A__x0009_'Alter any event session ',_x000A__x0009_'Alter any linked server',_x000A__x0009_'Alter any login',_x000A__x0009_'Alter any server audit',_x000A__x0009_'Alter any server role',_x000A__x0009_'Alter resources',_x000A__x0009_'Alter server state ',_x000A__x0009_'Alter Settings ',_x000A__x0009_'Alter trace',_x000A__x0009_'Authenticate server ',_x000A__x0009_'Control server',_x000A__x0009_'Create any database ',_x000A__x0009_'Create availability group',_x000A__x0009_'Create DDL event notification',_x000A__x0009_'Create endpoint',_x000A__x0009_'Create server role',_x000A__x0009_'Create trace event notification',_x000A__x0009_'External access assembly',_x000A__x0009_'Shutdown',_x000A__x0009_'Unsafe Assembly',_x000A__x0009_'View any database',_x000A__x0009_'View any definition',_x000A__x0009_'View server state'_x000A__x0009_)_x000A_AND    who.name NOT LIKE '##MS%##'_x000A_AND    who.type_desc &lt;&gt; 'SERVER_ROLE'_x000A_ORDER BY_x000A__x0009_what.permission_name,_x000A__x0009_who.name_x000A_;_x000A_GO</S>
    </MS>
  </Obj>
  <Obj RefId="484">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2012</S>
      <S N="VulnID">V-41264</S>
      <S N="RuleID">SV-53746r4_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL2-00-006200</S>
      <S N="Title">SQL Server must not grant users direct access to the Create endpoint permission.</S>
      <S N="Description">The concept of least privilege must be applied to SQL Server processes, ensuring that the processes operate at privilege levels no higher than necessary to accomplish required organizational missions and/or functions. Organizations consider the creation of additional processes, roles, and SQL Server accounts as necessary to achieve least privilege. Organizations also apply least privilege concepts to the design, development, implementation, and operations of SQL Server and the OS._x000A__x000A_Unauthorized access to sensitive data or SQL Server control may compromise the confidentiality of personnel privacy, threaten national security, compromise a variety of other sensitive operations or lead to a loss of system control. Access controls are best managed by defining requirements based on distinct job functions and assigning access based on the job function assigned to the individual user._x000A__x000A_Privileges granted outside of SQL Server's role-based account assignments are more likely to go unmanaged and without oversight of granted access. Maintenance of privileges using roles defined for discrete job functions offers improved oversight of application user privilege assignments and helps to protect against unauthorized privilege assignment._x000A__x000A_SQL Server's 'Create endpoint' permission is a high server-level privilege that must only be granted to individual administration accounts through roles. This administrative privilege must not be assigned directly to administrative user accounts (or any other user accounts). If any user accounts have direct access to administrative privileges, this access must be removed._x000A__x000A_Note that this does not apply to logins with names of the form '##MS...##'.  These accounts are internal-use system principals provisioned by the DBMS, and required by it for specific purposes.tru</S>
      <S N="FixText">Remove the 'Create endpoint' permission access from the account that has direct access by running the following script:_x000A__x000A__x000A_USE master_x000A__x000A_REVOKE CREATE ENDPOINT TO &lt;'account name'&gt;_x000A__x000A_GO</S>
      <S N="Check">Obtain the list of accounts that have direct access to the server-level permission 'Create endpoint' by running the following query:_x000A__x000A_SELECT _x000A_       who.name AS [Principal Name],_x000A_       who.type_desc AS [Principal Type],_x000A_       who.is_disabled AS [Principal Is Disabled],_x000A_       what.state_desc AS [Permission State],_x000A_       what.permission_name AS [Permission Name]_x000A_FROM _x000A_       sys.server_permissions what _x000A_       INNER JOIN sys.server_principals who_x000A_              ON who.principal_id = what.grantee_principal_id_x000A_WHERE_x000A_       what.permission_name = 'Create endpoint'_x000A_AND    who.name NOT LIKE '##MS%##'_x000A_AND    who.type_desc &lt;&gt; 'SERVER_ROLE'_x000A_ORDER BY_x000A_       who.name_x000A_;_x000A_GO_x000A__x000A_If any user accounts have direct access to the 'Create endpoint' permission, this is a finding._x000A__x000A_Alternatively, to provide a combined list for all requirements of this type:_x000A_SELECT _x000A__x0009_what.permission_name AS [Permission Name],_x000A__x0009_what.state_desc AS [Permission State],_x000A__x0009_who.name AS [Principal Name],_x000A__x0009_who.type_desc AS [Principal Type],_x000A__x0009_who.is_disabled AS [Principal Is Disabled]_x000A_FROM _x000A__x0009_sys.server_permissions what _x000A__x0009_INNER JOIN sys.server_principals who_x000A__x0009__x0009_ON who.principal_id = what.grantee_principal_id_x000A_WHERE_x000A__x0009_what.permission_name IN_x000A__x0009_(_x000A__x0009_'Administer bulk operations',_x000A__x0009_'Alter any availability group',_x000A__x0009_'Alter any connection',_x000A__x0009_'Alter any credential',_x000A__x0009_'Alter any database',_x000A__x0009_'Alter any endpoint ',_x000A__x0009_'Alter any event notification ',_x000A__x0009_'Alter any event session ',_x000A__x0009_'Alter any linked server',_x000A__x0009_'Alter any login',_x000A__x0009_'Alter any server audit',_x000A__x0009_'Alter any server role',_x000A__x0009_'Alter resources',_x000A__x0009_'Alter server state ',_x000A__x0009_'Alter Settings ',_x000A__x0009_'Alter trace',_x000A__x0009_'Authenticate server ',_x000A__x0009_'Control server',_x000A__x0009_'Create any database ',_x000A__x0009_'Create availability group',_x000A__x0009_'Create DDL event notification',_x000A__x0009_'Create endpoint',_x000A__x0009_'Create server role',_x000A__x0009_'Create trace event notification',_x000A__x0009_'External access assembly',_x000A__x0009_'Shutdown',_x000A__x0009_'Unsafe Assembly',_x000A__x0009_'View any database',_x000A__x0009_'View any definition',_x000A__x0009_'View server state'_x000A__x0009_)_x000A_AND    who.name NOT LIKE '##MS%##'_x000A_AND    who.type_desc &lt;&gt; 'SERVER_ROLE'_x000A_ORDER BY_x000A__x0009_what.permission_name,_x000A__x0009_who.name_x000A_;_x000A_GO</S>
    </MS>
  </Obj>
  <Obj RefId="485">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2012</S>
      <S N="VulnID">V-41265</S>
      <S N="RuleID">SV-53747r4_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL2-00-006100</S>
      <S N="Title">SQL Server must not grant users direct access to the Create DDL event notification permission.</S>
      <S N="Description">The concept of least privilege must be applied to SQL Server processes, ensuring that the processes operate at privilege levels no higher than necessary to accomplish required organizational missions and/or functions. Organizations consider the creation of additional processes, roles, and SQL Server accounts as necessary to achieve least privilege. Organizations also apply least privilege concepts to the design, development, implementation, and operations of SQL Server and the OS._x000A__x000A_Unauthorized access to sensitive data or SQL Server control may compromise the confidentiality of personnel privacy, threaten national security, compromise a variety of other sensitive operations or lead to a loss of system control. Access controls are best managed by defining requirements based on distinct job functions and assigning access based on the job function assigned to the individual user._x000A__x000A_Privileges granted outside of SQL Server's role-based account assignments are more likely to go unmanaged and without oversight of granted access. Maintenance of privileges using roles defined for discrete job functions offers improved oversight of application user privilege assignments and helps to protect against unauthorized privilege assignment._x000A__x000A_SQL Server's 'Create DDL event notification' permission is a high server-level privilege that must only be granted to individual administration accounts through roles. This administrative privilege must not be assigned directly to administrative user accounts (or any other user accounts). If any user accounts have direct access to administrative privileges, this access must be removed._x000A__x000A_Note that this does not apply to logins with names of the form '##MS...##'. These accounts are internal-use system principals provisioned by the DBMS, and required by it for specific purposes.tru</S>
      <S N="FixText">Remove the 'Create DDL event notification' permission access from the account that has direct access by running the following script:_x000A__x000A__x000A_USE master_x000A__x000A_REVOKE CREATE DDL EVENT NOTIFICATION TO &lt;'account name'&gt;_x000A__x000A_GO</S>
      <S N="Check">Obtain the list of accounts that have direct access to the server-level permission 'Create DDL Event Notification' by running the following query:_x000A__x000A_SELECT_x000A_who.name AS [Principal Name],_x000A_who.type_desc AS [Principal Type],_x000A_who.is_disabled AS [Principal Is Disabled],_x000A_what.state_desc AS [Permission State],_x000A_what.permission_name AS [Permission Name]_x000A_FROM_x000A_sys.server_permissions what_x000A_INNER JOIN sys.server_principals who_x000A_ON who.principal_id = what.grantee_principal_id_x000A_WHERE_x000A_what.permission_name = 'Create DDL Event Notification' _x000A_AND who.name NOT LIKE '##MS%##'_x000A_AND who.type_desc &lt;&gt; 'SERVER_ROLE'_x000A_ORDER BY_x000A_who.name_x000A_;_x000A_GO_x000A__x000A_If any user accounts have direct access to the 'Create DDL Event Notification' permission, this is a finding._x000A__x000A_Alternatively, to provide a combined list for all requirements of this type:_x000A_SELECT _x000A__x0009_what.permission_name AS [Permission Name],_x000A__x0009_what.state_desc AS [Permission State],_x000A__x0009_who.name AS [Principal Name],_x000A__x0009_who.type_desc AS [Principal Type],_x000A__x0009_who.is_disabled AS [Principal Is Disabled]_x000A_FROM _x000A__x0009_sys.server_permissions what _x000A__x0009_INNER JOIN sys.server_principals who_x000A__x0009__x0009_ON who.principal_id = what.grantee_principal_id_x000A_WHERE_x000A__x0009_what.permission_name IN_x000A__x0009_(_x000A__x0009_'Administer bulk operations',_x000A__x0009_'Alter any availability group',_x000A__x0009_'Alter any connection',_x000A__x0009_'Alter any credential',_x000A__x0009_'Alter any database',_x000A__x0009_'Alter any endpoint ',_x000A__x0009_'Alter any event notification ',_x000A__x0009_'Alter any event session ',_x000A__x0009_'Alter any linked server',_x000A__x0009_'Alter any login',_x000A__x0009_'Alter any server audit',_x000A__x0009_'Alter any server role',_x000A__x0009_'Alter resources',_x000A__x0009_'Alter server state ',_x000A__x0009_'Alter Settings ',_x000A__x0009_'Alter trace',_x000A__x0009_'Authenticate server ',_x000A__x0009_'Control server',_x000A__x0009_'Create any database ',_x000A__x0009_'Create availability group',_x000A__x0009_'Create DDL event notification',_x000A__x0009_'Create endpoint',_x000A__x0009_'Create server role',_x000A__x0009_'Create trace event notification',_x000A__x0009_'External access assembly',_x000A__x0009_'Shutdown',_x000A__x0009_'Unsafe Assembly',_x000A__x0009_'View any database',_x000A__x0009_'View any definition',_x000A__x0009_'View server state'_x000A__x0009_)_x000A_AND    who.name NOT LIKE '##MS%##'_x000A_AND    who.type_desc &lt;&gt; 'SERVER_ROLE'_x000A_ORDER BY_x000A__x0009_what.permission_name,_x000A__x0009_who.name_x000A_;_x000A_GO</S>
    </MS>
  </Obj>
  <Obj RefId="486">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2012</S>
      <S N="VulnID">V-41266</S>
      <S N="RuleID">SV-53748r4_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL2-00-006000</S>
      <S N="Title">SQL Server must not grant users direct access to the Create availability group permission.</S>
      <S N="Description">The concept of least privilege must be applied to SQL Server processes, ensuring that the processes operate at privilege levels no higher than necessary to accomplish required organizational missions and/or functions. Organizations consider the creation of additional processes, roles, and SQL Server accounts as necessary to achieve least privilege. Organizations also apply least privilege concepts to the design, development, implementation, and operations of SQL Server and the OS._x000A__x000A_Unauthorized access to sensitive data or SQL Server control may compromise the confidentiality of personnel privacy, threaten national security, compromise a variety of other sensitive operations or lead to a loss of system control. Access controls are best managed by defining requirements based on distinct job functions and assigning access based on the job function assigned to the individual user._x000A__x000A_Privileges granted outside of SQL Server's role-based account assignments are more likely to go unmanaged and without oversight of granted access. Maintenance of privileges using roles defined for discrete job functions offers improved oversight of application user privilege assignments and helps to protect against unauthorized privilege assignment._x000A__x000A_SQL Server's 'Create availability group' permission is a high server-level privilege that must only be granted to individual administration accounts through roles. This administrative privilege must not be assigned directly to administrative user accounts (or any other user accounts). If any user accounts have direct access to administrative privileges, this access must be removed._x000A__x000A_Note that this does not apply to logins with names of the form '##MS...##'.  These accounts are internal-use system principals provisioned by the DBMS, and required by it for specific purposes._x000A_tru</S>
      <S N="FixText">Remove the 'Create availability group' permission access from the account that has direct access by running the following script:_x000A__x000A__x000A_USE master_x000A__x000A_REVOKE CREATE AVAILABILITY GROUP TO &lt;'account name'&gt;_x000A__x000A_GO</S>
      <S N="Check">Obtain the list of accounts that have direct access to the server-level permission 'Create availability group' by running the following query:_x000A__x000A_SELECT _x000A_       who.name AS [Principal Name],_x000A_       who.type_desc AS [Principal Type],_x000A_       who.is_disabled AS [Principal Is Disabled],_x000A_       what.state_desc AS [Permission State],_x000A_       what.permission_name AS [Permission Name]_x000A_FROM _x000A_       sys.server_permissions what _x000A_       INNER JOIN sys.server_principals who_x000A_              ON who.principal_id = what.grantee_principal_id_x000A_WHERE_x000A_       what.permission_name = 'Create availability group'_x000A_AND    who.name NOT LIKE '##MS%##'_x000A_AND    who.type_desc &lt;&gt; 'SERVER_ROLE'_x000A_ORDER BY_x000A_       who.name_x000A_;_x000A_GO_x000A__x000A_If any user accounts have direct access to the 'Create availability group' permission, this is a finding._x000A__x000A_Alternatively, to provide a combined list for all requirements of this type:_x000A_SELECT _x000A__x0009_what.permission_name AS [Permission Name],_x000A__x0009_what.state_desc AS [Permission State],_x000A__x0009_who.name AS [Principal Name],_x000A__x0009_who.type_desc AS [Principal Type],_x000A__x0009_who.is_disabled AS [Principal Is Disabled]_x000A_FROM _x000A__x0009_sys.server_permissions what _x000A__x0009_INNER JOIN sys.server_principals who_x000A__x0009__x0009_ON who.principal_id = what.grantee_principal_id_x000A_WHERE_x000A__x0009_what.permission_name IN_x000A__x0009_(_x000A__x0009_'Administer bulk operations',_x000A__x0009_'Alter any availability group',_x000A__x0009_'Alter any connection',_x000A__x0009_'Alter any credential',_x000A__x0009_'Alter any database',_x000A__x0009_'Alter any endpoint ',_x000A__x0009_'Alter any event notification ',_x000A__x0009_'Alter any event session ',_x000A__x0009_'Alter any linked server',_x000A__x0009_'Alter any login',_x000A__x0009_'Alter any server audit',_x000A__x0009_'Alter any server role',_x000A__x0009_'Alter resources',_x000A__x0009_'Alter server state ',_x000A__x0009_'Alter Settings ',_x000A__x0009_'Alter trace',_x000A__x0009_'Authenticate server ',_x000A__x0009_'Control server',_x000A__x0009_'Create any database ',_x000A__x0009_'Create availability group',_x000A__x0009_'Create DDL event notification',_x000A__x0009_'Create endpoint',_x000A__x0009_'Create server role',_x000A__x0009_'Create trace event notification',_x000A__x0009_'External access assembly',_x000A__x0009_'Shutdown',_x000A__x0009_'Unsafe Assembly',_x000A__x0009_'View any database',_x000A__x0009_'View any definition',_x000A__x0009_'View server state'_x000A__x0009_)_x000A_AND    who.name NOT LIKE '##MS%##'_x000A_AND    who.type_desc &lt;&gt; 'SERVER_ROLE'_x000A_ORDER BY_x000A__x0009_what.permission_name,_x000A__x0009_who.name_x000A_;_x000A_GO</S>
    </MS>
  </Obj>
  <Obj RefId="487">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2012</S>
      <S N="VulnID">V-41267</S>
      <S N="RuleID">SV-53749r4_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL2-00-005900</S>
      <S N="Title">SQL Server must not grant users direct access to the Create any database permission.</S>
      <S N="Description">The concept of least privilege must be applied to SQL Server processes, ensuring that the processes operate at privilege levels no higher than necessary to accomplish required organizational missions and/or functions. Organizations consider the creation of additional processes, roles, and SQL Server accounts as necessary to achieve least privilege. Organizations also apply least privilege concepts to the design, development, implementation, and operations of SQL Server and the OS._x000A__x000A_Unauthorized access to sensitive data or SQL Server control may compromise the confidentiality of personnel privacy, threaten national security, compromise a variety of other sensitive operations or lead to a loss of system control. Access controls are best managed by defining requirements based on distinct job functions and assigning access based on the job function assigned to the individual user._x000A__x000A_Privileges granted outside of SQL Server's role-based account assignments are more likely to go unmanaged and without oversight of granted access. Maintenance of privileges using roles defined for discrete job functions offers improved oversight of application user privilege assignments and helps to protect against unauthorized privilege assignment._x000A__x000A_SQL Server's 'Create any database' permission is a high server-level privilege that must only be granted to individual administration accounts through roles. This administrative privilege must not be assigned directly to administrative user accounts (or any other user accounts). If any user accounts have direct access to administrative privileges, this access must be removed._x000A__x000A_Note that this does not apply to logins with names of the form '##MS...##'.  These accounts are internal-use system principals provisioned by the DBMS, and required by it for specific purposes.tru</S>
      <S N="FixText">Remove the 'Create any database'" permission access from the account that has direct access by running the following script:_x000A__x000A__x000A_USE master_x000A__x000A_REVOKE CREATE ANY DATABASE TO &lt;'account name'&gt;_x000A__x000A_GO</S>
      <S N="Check">Obtain the list of accounts that have direct access to the server-level permission 'Create any database' by running the following query:_x000A__x000A_SELECT _x000A_       who.name AS [Principal Name],_x000A_       who.type_desc AS [Principal Type],_x000A_       who.is_disabled AS [Principal Is Disabled],_x000A_       what.state_desc AS [Permission State],_x000A_       what.permission_name AS [Permission Name]_x000A_FROM _x000A_       sys.server_permissions what _x000A_       INNER JOIN sys.server_principals who_x000A_              ON who.principal_id = what.grantee_principal_id_x000A_WHERE_x000A_       what.permission_name = 'Create any database'_x000A_AND    who.name NOT LIKE '##MS%##'_x000A_AND    who.type_desc &lt;&gt; 'SERVER_ROLE'_x000A_ORDER BY_x000A_       who.name_x000A_;_x000A_GO_x000A__x000A_If any user accounts have direct access to the 'Create any database' permission, this is a finding._x000A__x000A_Alternatively, to provide a combined list for all requirements of this type:_x000A_SELECT _x000A__x0009_what.permission_name AS [Permission Name],_x000A__x0009_what.state_desc AS [Permission State],_x000A__x0009_who.name AS [Principal Name],_x000A__x0009_who.type_desc AS [Principal Type],_x000A__x0009_who.is_disabled AS [Principal Is Disabled]_x000A_FROM _x000A__x0009_sys.server_permissions what _x000A__x0009_INNER JOIN sys.server_principals who_x000A__x0009__x0009_ON who.principal_id = what.grantee_principal_id_x000A_WHERE_x000A__x0009_what.permission_name IN_x000A__x0009_(_x000A__x0009_'Administer bulk operations',_x000A__x0009_'Alter any availability group',_x000A__x0009_'Alter any connection',_x000A__x0009_'Alter any credential',_x000A__x0009_'Alter any database',_x000A__x0009_'Alter any endpoint ',_x000A__x0009_'Alter any event notification ',_x000A__x0009_'Alter any event session ',_x000A__x0009_'Alter any linked server',_x000A__x0009_'Alter any login',_x000A__x0009_'Alter any server audit',_x000A__x0009_'Alter any server role',_x000A__x0009_'Alter resources',_x000A__x0009_'Alter server state ',_x000A__x0009_'Alter Settings ',_x000A__x0009_'Alter trace',_x000A__x0009_'Authenticate server ',_x000A__x0009_'Control server',_x000A__x0009_'Create any database ',_x000A__x0009_'Create availability group',_x000A__x0009_'Create DDL event notification',_x000A__x0009_'Create endpoint',_x000A__x0009_'Create server role',_x000A__x0009_'Create trace event notification',_x000A__x0009_'External access assembly',_x000A__x0009_'Shutdown',_x000A__x0009_'Unsafe Assembly',_x000A__x0009_'View any database',_x000A__x0009_'View any definition',_x000A__x0009_'View server state'_x000A__x0009_)_x000A_AND    who.name NOT LIKE '##MS%##'_x000A_AND    who.type_desc &lt;&gt; 'SERVER_ROLE'_x000A_ORDER BY_x000A__x0009_what.permission_name,_x000A__x0009_who.name_x000A_;_x000A_GO</S>
    </MS>
  </Obj>
  <Obj RefId="488">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2012</S>
      <S N="VulnID">V-41268</S>
      <S N="RuleID">SV-53750r4_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL2-00-005800</S>
      <S N="Title">SQL Server must not grant users direct access to the Control server permission.</S>
      <S N="Description">The concept of least privilege must be applied to SQL Server processes, ensuring that the processes operate at privilege levels no higher than necessary to accomplish required organizational missions and/or functions. Organizations consider the creation of additional processes, roles, and SQL Server accounts as necessary to achieve least privilege. Organizations also apply least privilege concepts to the design, development, implementation, and operations of SQL Server and the OS._x000A__x000A_Unauthorized access to sensitive data or SQL Server control may compromise the confidentiality of personnel privacy, threaten national security, compromise a variety of other sensitive operations or lead to a loss of system control. Access controls are best managed by defining requirements based on distinct job functions and assigning access based on the job function assigned to the individual user._x000A__x000A_Privileges granted outside of SQL Server's role-based account assignments are more likely to go unmanaged and without oversight of granted access. Maintenance of privileges using roles defined for discrete job functions offers improved oversight of application user privilege assignments and helps to protect against unauthorized privilege assignment._x000A__x000A_SQL Server's 'Control server' permission is a high server-level privilege that must only be granted to individual administration accounts through roles. This administrative privilege must not be assigned directly to administrative user accounts (or any other user accounts). If any user accounts have direct access to administrative privileges, this access must be removed._x000A__x000A_Note that this does not apply to logins with names of the form '##MS...##'.  These accounts are internal-use system principals provisioned by the DBMS, and required by it for specific purposes.tru</S>
      <S N="FixText">Remove the 'Control server' permission access from the account that has direct access by running the following script:_x000A__x000A__x000A_USE master_x000A__x000A_REVOKE CONTROL SERVER TO &lt;'account name'&gt;_x000A__x000A_GO</S>
      <S N="Check">Obtain the list of accounts that have direct access to the server-level permission 'Control server' by running the following query:_x000A__x000A_SELECT _x000A_       who.name AS [Principal Name],_x000A_       who.type_desc AS [Principal Type],_x000A_       who.is_disabled AS [Principal Is Disabled],_x000A_       what.state_desc AS [Permission State],_x000A_       what.permission_name AS [Permission Name]_x000A_FROM _x000A_       sys.server_permissions what _x000A_       INNER JOIN sys.server_principals who_x000A_              ON who.principal_id = what.grantee_principal_id_x000A_WHERE_x000A_       what.permission_name = 'Control server'_x000A_AND    who.name NOT LIKE '##MS%##'_x000A_AND    who.type_desc &lt;&gt; 'SERVER_ROLE'_x000A_ORDER BY_x000A_       who.name_x000A_;_x000A_GO_x000A__x000A_If any user accounts have direct access to the 'Control server' permission, this is a finding._x000A__x000A_Alternatively, to provide a combined list for all requirements of this type:_x000A_SELECT _x000A__x0009_what.permission_name AS [Permission Name],_x000A__x0009_what.state_desc AS [Permission State],_x000A__x0009_who.name AS [Principal Name],_x000A__x0009_who.type_desc AS [Principal Type],_x000A__x0009_who.is_disabled AS [Principal Is Disabled]_x000A_FROM _x000A__x0009_sys.server_permissions what _x000A__x0009_INNER JOIN sys.server_principals who_x000A__x0009__x0009_ON who.principal_id = what.grantee_principal_id_x000A_WHERE_x000A__x0009_what.permission_name IN_x000A__x0009_(_x000A__x0009_'Administer bulk operations',_x000A__x0009_'Alter any availability group',_x000A__x0009_'Alter any connection',_x000A__x0009_'Alter any credential',_x000A__x0009_'Alter any database',_x000A__x0009_'Alter any endpoint ',_x000A__x0009_'Alter any event notification ',_x000A__x0009_'Alter any event session ',_x000A__x0009_'Alter any linked server',_x000A__x0009_'Alter any login',_x000A__x0009_'Alter any server audit',_x000A__x0009_'Alter any server role',_x000A__x0009_'Alter resources',_x000A__x0009_'Alter server state ',_x000A__x0009_'Alter Settings ',_x000A__x0009_'Alter trace',_x000A__x0009_'Authenticate server ',_x000A__x0009_'Control server',_x000A__x0009_'Create any database ',_x000A__x0009_'Create availability group',_x000A__x0009_'Create DDL event notification',_x000A__x0009_'Create endpoint',_x000A__x0009_'Create server role',_x000A__x0009_'Create trace event notification',_x000A__x0009_'External access assembly',_x000A__x0009_'Shutdown',_x000A__x0009_'Unsafe Assembly',_x000A__x0009_'View any database',_x000A__x0009_'View any definition',_x000A__x0009_'View server state'_x000A__x0009_)_x000A_AND    who.name NOT LIKE '##MS%##'_x000A_AND    who.type_desc &lt;&gt; 'SERVER_ROLE'_x000A_ORDER BY_x000A__x0009_what.permission_name,_x000A__x0009_who.name_x000A_;_x000A_GO</S>
    </MS>
  </Obj>
  <Obj RefId="489">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2012</S>
      <S N="VulnID">V-41269</S>
      <S N="RuleID">SV-53751r4_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL2-00-005700</S>
      <S N="Title">SQL Server must enforce access control policies to restrict the Administer bulk operations permission to only authorized roles.</S>
      <S N="Description">The concept of least privilege must be applied to SQL Server processes, ensuring that the processes operate at privilege levels no higher than necessary to accomplish required organizational missions and/or functions. Organizations consider the creation of additional processes, roles, and SQL Server accounts as necessary to achieve least privilege. Organizations also apply least privilege concepts to the design, development, implementation, and operations of SQL Server and the OS._x000A__x000A_Unauthorized access to sensitive data or SQL Server control may compromise the confidentiality of personnel privacy, threaten national security, compromise a variety of other sensitive operations or lead to a loss of system control. Access controls are best managed by defining requirements based on distinct job functions and assigning access based on the job function assigned to the individual user._x000A__x000A_SQL Server's 'Administer bulk operations' permission is a high server-level privilege that must only be granted to individual administration accounts through roles, and users who have access must require this privilege to accomplish the organizational missions and/or functions. If the 'Administer bulk operations' permission is granted to roles that are unauthorized to have this privilege, then this access must be removed._x000A__x000A_Additionally, the permission must not be denied to a role, because that could disable a user's legitimate access via another role._x000A__x000A_The fix for this vulnerability specifies the use of REVOKE.  Be aware that revoking a permission that is currently denied to a role or user does not necessarily disable the permission.  If the user or role can inherent the permission from another role, revoking the denied permission from the user or the first role can effectively enable the inherited permission.tru</S>
      <S N="FixText">Remove the 'Administer bulk operations' permission access from the role that is not authorized by executing the following query:_x000A__x000A__x000A_REVOKE Administer bulk operations TO &lt;'role name'&gt;</S>
      <S N="Check">Obtain the list of roles that are authorized for the SQL Server 'Administer bulk operations' permission and what 'Grant', 'Grant With', and/or 'Deny' privilege is authorized._x000A__x000A_Obtain the list of roles with that permission by running the following query:_x000A__x000A_SELECT _x000A_       who.name AS [Principal Name],_x000A_       who.type_desc AS [Principal Type],_x000A_       who.is_disabled AS [Principal Is Disabled],_x000A_       what.state_desc AS [Permission State],_x000A_       what.permission_name AS [Permission Name]_x000A_FROM _x000A_       sys.server_permissions what _x000A_       INNER JOIN sys.server_principals who_x000A_              ON who.principal_id = what.grantee_principal_id_x000A_WHERE_x000A_       what.permission_name = 'Administer bulk operations'_x000A_AND    who.type_desc = 'SERVER_ROLE'_x000A_ORDER BY_x000A_       who.name_x000A_;_x000A_GO _x000A__x000A_If any role has 'Grant', 'With Grant' or 'Deny' privileges on this permission and users with that role are not authorized to have the permission, this is a finding._x000A__x000A_Alternatively, to provide a combined list for all requirements of this type:_x000A_SELECT _x000A__x0009_what.permission_name AS [Permission Name],_x000A__x0009_what.state_desc AS [Permission State],_x000A__x0009_who.name AS [Principal Name],_x000A__x0009_who.type_desc AS [Principal Type],_x000A__x0009_who.is_disabled AS [Principal Is Disabled]_x000A_FROM _x000A__x0009_sys.server_permissions what _x000A__x0009_INNER JOIN sys.server_principals who_x000A__x0009__x0009_ON who.principal_id = what.grantee_principal_id_x000A_WHERE_x000A__x0009_what.permission_name IN_x000A__x0009_(_x000A__x0009_'Administer bulk operations',_x000A__x0009_'Alter any availability group',_x000A__x0009_'Alter any connection',_x000A__x0009_'Alter any credential',_x000A__x0009_'Alter any database',_x000A__x0009_'Alter any endpoint ',_x000A__x0009_'Alter any event notification ',_x000A__x0009_'Alter any event session ',_x000A__x0009_'Alter any linked server',_x000A__x0009_'Alter any login',_x000A__x0009_'Alter any server audit',_x000A__x0009_'Alter any server role',_x000A__x0009_'Alter resources',_x000A__x0009_'Alter server state ',_x000A__x0009_'Alter Settings ',_x000A__x0009_'Alter trace',_x000A__x0009_'Authenticate server ',_x000A__x0009_'Control server',_x000A__x0009_'Create any database ',_x000A__x0009_'Create availability group',_x000A__x0009_'Create DDL event notification',_x000A__x0009_'Create endpoint',_x000A__x0009_'Create server role',_x000A__x0009_'Create trace event notification',_x000A__x0009_'External access assembly',_x000A__x0009_'Shutdown',_x000A__x0009_'Unsafe Assembly',_x000A__x0009_'View any database',_x000A__x0009_'View any definition',_x000A__x0009_'View server state'_x000A__x0009_)_x000A_AND_x0009_who.type_desc = 'SERVER_ROLE'_x000A_ORDER BY_x000A__x0009_what.permission_name,_x000A__x0009_who.name_x000A_;_x000A_GO</S>
    </MS>
  </Obj>
  <Obj RefId="490">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2012</S>
      <S N="VulnID">V-41270</S>
      <S N="RuleID">SV-53752r4_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL2-00-005600</S>
      <S N="Title">SQL Server must enforce access control policies to restrict the Alter resources permission to only authorized roles.</S>
      <S N="Description">The concept of least privilege must be applied to SQL Server processes, ensuring that the processes operate at privilege levels no higher than necessary to accomplish required organizational missions and/or functions. Organizations consider the creation of additional processes, roles, and SQL Server accounts as necessary to achieve least privilege. Organizations also apply least privilege concepts to the design, development, implementation, and operations of SQL Server and the OS._x000A__x000A_Unauthorized access to sensitive data or SQL Server control may compromise the confidentiality of personnel privacy, threaten national security, compromise a variety of other sensitive operations or lead to a loss of system control. Access controls are best managed by defining requirements based on distinct job functions and assigning access based on the job function assigned to the individual user._x000A__x000A_SQL Server's 'Alter resources' permission is a high server-level privilege that must only be granted to individual administration accounts through roles, and users who have access must require this privilege to accomplish the organizational missions and/or functions. If the 'Alter resources' permission is granted to roles that are unauthorized to have this privilege, then this access must be removed._x000A__x000A_Additionally, the permission must not be denied to a role, because that could disable a user's legitimate access via another role._x000A__x000A_The fix for this vulnerability specifies the use of REVOKE.  Be aware that revoking a permission that is currently denied to a role or user does not necessarily disable the permission.  If the user or role can inherent the permission from another role, revoking the denied permission from the user or the first role can effectively enable the inherited permission.tru</S>
      <S N="FixText">Remove the 'Alter resources' permission access from the role that is not authorized by executing the following query:_x000A__x000A__x000A_REVOKE Alter resources TO &lt;'role name'&gt;</S>
      <S N="Check">Obtain the list of roles that are authorized for the SQL Server 'Alter resources' permission and what 'Grant', 'Grant With', and/or 'Deny' privilege is authorized. Obtain the list of roles with that permission by running the following query:_x000A__x000A_SELECT _x000A_       who.name AS [Principal Name],_x000A_       who.type_desc AS [Principal Type],_x000A_       who.is_disabled AS [Principal Is Disabled],_x000A_       what.state_desc AS [Permission State],_x000A_       what.permission_name AS [Permission Name]_x000A_FROM _x000A_       sys.server_permissions what _x000A_       INNER JOIN sys.server_principals who_x000A_              ON who.principal_id = what.grantee_principal_id_x000A_WHERE_x000A_       what.permission_name = 'Alter resources' _x000A_AND    who.type_desc = 'SERVER_ROLE'_x000A_ORDER BY_x000A_       who.name_x000A_;_x000A_GO _x000A__x000A_If any role has 'Grant', 'With Grant' or 'Deny' privileges on this permission and users with that role are not authorized to have the permission, this is a finding._x000A__x000A_Alternatively, to provide a combined list for all requirements of this type:_x000A_SELECT _x000A__x0009_what.permission_name AS [Permission Name],_x000A__x0009_what.state_desc AS [Permission State],_x000A__x0009_who.name AS [Principal Name],_x000A__x0009_who.type_desc AS [Principal Type],_x000A__x0009_who.is_disabled AS [Principal Is Disabled]_x000A_FROM _x000A__x0009_sys.server_permissions what _x000A__x0009_INNER JOIN sys.server_principals who_x000A__x0009__x0009_ON who.principal_id = what.grantee_principal_id_x000A_WHERE_x000A__x0009_what.permission_name IN_x000A__x0009_(_x000A__x0009_'Administer bulk operations',_x000A__x0009_'Alter any availability group',_x000A__x0009_'Alter any connection',_x000A__x0009_'Alter any credential',_x000A__x0009_'Alter any database',_x000A__x0009_'Alter any endpoint ',_x000A__x0009_'Alter any event notification ',_x000A__x0009_'Alter any event session ',_x000A__x0009_'Alter any linked server',_x000A__x0009_'Alter any login',_x000A__x0009_'Alter any server audit',_x000A__x0009_'Alter any server role',_x000A__x0009_'Alter resources',_x000A__x0009_'Alter server state ',_x000A__x0009_'Alter Settings ',_x000A__x0009_'Alter trace',_x000A__x0009_'Authenticate server ',_x000A__x0009_'Control server',_x000A__x0009_'Create any database ',_x000A__x0009_'Create availability group',_x000A__x0009_'Create DDL event notification',_x000A__x0009_'Create endpoint',_x000A__x0009_'Create server role',_x000A__x0009_'Create trace event notification',_x000A__x0009_'External access assembly',_x000A__x0009_'Shutdown',_x000A__x0009_'Unsafe Assembly',_x000A__x0009_'View any database',_x000A__x0009_'View any definition',_x000A__x0009_'View server state'_x000A__x0009_)_x000A_AND_x0009_who.type_desc = 'SERVER_ROLE'_x000A_ORDER BY_x000A__x0009_what.permission_name,_x000A__x0009_who.name_x000A_;_x000A_GO</S>
    </MS>
  </Obj>
  <Obj RefId="491">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2012</S>
      <S N="VulnID">V-41271</S>
      <S N="RuleID">SV-53753r4_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL2-00-005500</S>
      <S N="Title">SQL Server must not grant users direct access to the Alter any linked server permission.</S>
      <S N="Description">The concept of least privilege must be applied to SQL Server processes, ensuring that the processes operate at privilege levels no higher than necessary to accomplish required organizational missions and/or functions. Organizations consider the creation of additional processes, roles, and SQL Server accounts as necessary to achieve least privilege. Organizations also apply least privilege concepts to the design, development, implementation, and operations of SQL Server and the OS._x000A__x000A_Unauthorized access to sensitive data or SQL Server control may compromise the confidentiality of personnel privacy, threaten national security, compromise a variety of other sensitive operations or lead to a loss of system control. Access controls are best managed by defining requirements based on distinct job functions and assigning access based on the job function assigned to the individual user._x000A__x000A_Privileges granted outside of SQL Server's role-based account assignments are more likely to go unmanaged and without oversight of granted access. Maintenance of privileges using roles defined for discrete job functions offers improved oversight of application user privilege assignments and helps to protect against unauthorized privilege assignment._x000A__x000A_SQL Server's 'Alter any linked server' permission is a high server-level privilege that must only be granted to individual administration accounts through roles. This administrative privilege must not be assigned directly to administrative user accounts (or any other user accounts). If any user accounts have direct access to administrative privileges, this access must be removed._x000A__x000A_Note that this does not apply to logins with names of the form '##MS...##'.  These accounts are internal-use system principals provisioned by the DBMS, and required by it for specific purposes.tru</S>
      <S N="FixText">Remove the 'Alter any linked server' permission access from the account that has direct access by running the following script:_x000A__x000A__x000A_USE master_x000A__x000A_REVOKE ALTER ANY LINKED SERVER TO &lt;'account name'&gt;_x000A__x000A_GO</S>
      <S N="Check">Obtain the list of accounts that have direct access to the server-level permission 'Alter any linked server' by running the following query:_x000A__x000A_SELECT _x000A_       who.name AS [Principal Name],_x000A_       who.type_desc AS [Principal Type],_x000A_       who.is_disabled AS [Principal Is Disabled],_x000A_       what.state_desc AS [Permission State],_x000A_       what.permission_name AS [Permission Name]_x000A_FROM _x000A_       sys.server_permissions what _x000A_       INNER JOIN sys.server_principals who_x000A_              ON who.principal_id = what.grantee_principal_id_x000A_WHERE_x000A_       what.permission_name = 'Alter any linked server'_x000A_AND    who.name NOT LIKE '##MS%##'_x000A_AND    who.type_desc &lt;&gt; 'SERVER_ROLE'_x000A_ORDER BY_x000A_       who.name_x000A_;_x000A_GO_x000A__x000A_If any user accounts have direct access to the 'Alter any linked server' permission, this is a finding._x000A__x000A_Alternatively, to provide a combined list for all requirements of this type:_x000A_SELECT _x000A__x0009_what.permission_name AS [Permission Name],_x000A__x0009_what.state_desc AS [Permission State],_x000A__x0009_who.name AS [Principal Name],_x000A__x0009_who.type_desc AS [Principal Type],_x000A__x0009_who.is_disabled AS [Principal Is Disabled]_x000A_FROM _x000A__x0009_sys.server_permissions what _x000A__x0009_INNER JOIN sys.server_principals who_x000A__x0009__x0009_ON who.principal_id = what.grantee_principal_id_x000A_WHERE_x000A__x0009_what.permission_name IN_x000A__x0009_(_x000A__x0009_'Administer bulk operations',_x000A__x0009_'Alter any availability group',_x000A__x0009_'Alter any connection',_x000A__x0009_'Alter any credential',_x000A__x0009_'Alter any database',_x000A__x0009_'Alter any endpoint ',_x000A__x0009_'Alter any event notification ',_x000A__x0009_'Alter any event session ',_x000A__x0009_'Alter any linked server',_x000A__x0009_'Alter any login',_x000A__x0009_'Alter any server audit',_x000A__x0009_'Alter any server role',_x000A__x0009_'Alter resources',_x000A__x0009_'Alter server state ',_x000A__x0009_'Alter Settings ',_x000A__x0009_'Alter trace',_x000A__x0009_'Authenticate server ',_x000A__x0009_'Control server',_x000A__x0009_'Create any database ',_x000A__x0009_'Create availability group',_x000A__x0009_'Create DDL event notification',_x000A__x0009_'Create endpoint',_x000A__x0009_'Create server role',_x000A__x0009_'Create trace event notification',_x000A__x0009_'External access assembly',_x000A__x0009_'Shutdown',_x000A__x0009_'Unsafe Assembly',_x000A__x0009_'View any database',_x000A__x0009_'View any definition',_x000A__x0009_'View server state'_x000A__x0009_)_x000A_AND    who.name NOT LIKE '##MS%##'_x000A_AND    who.type_desc &lt;&gt; 'SERVER_ROLE'_x000A_ORDER BY_x000A__x0009_what.permission_name,_x000A__x0009_who.name_x000A_;_x000A_GO</S>
    </MS>
  </Obj>
  <Obj RefId="492">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2012</S>
      <S N="VulnID">V-41273</S>
      <S N="RuleID">SV-53755r4_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL2-00-005300</S>
      <S N="Title">SQL Server must not grant users direct control to the Alter any event session permission.</S>
      <S N="Description">The concept of least privilege must be applied to SQL Server processes, ensuring that the processes operate at privilege levels no higher than necessary to accomplish required organizational missions and/or functions. Organizations consider the creation of additional processes, roles, and SQL Server accounts as necessary to achieve least privilege. Organizations also apply least privilege concepts to the design, development, implementation, and operations of SQL Server and the OS._x000A__x000A_Unauthorized access to sensitive data or SQL Server control may compromise the confidentiality of personnel privacy, threaten national security, compromise a variety of other sensitive operations or lead to a loss of system control. Access controls are best managed by defining requirements based on distinct job functions and assigning access based on the job function assigned to the individual user._x000A__x000A_Privileges granted outside of SQL Server's role-based account assignments are more likely to go unmanaged and without oversight of granted access. Maintenance of privileges using roles defined for discrete job functions offers improved oversight of application user privilege assignments and helps to protect against unauthorized privilege assignment._x000A__x000A_SQL Server's 'Alter any event session' permission is a high server-level privilege that must only be granted to individual administration accounts through roles. This administrative privilege must not be assigned directly to administrative user accounts (or any other user accounts). If any user accounts have direct access to administrative privileges, this access must be removed._x000A__x000A_Note that this does not apply to logins with names of the form '##MS...##'.  These accounts are internal-use system principals provisioned by the DBMS, and required by it for specific purposes.tru</S>
      <S N="FixText">Remove the 'Alter any event session' permission access from the account that has direct access by running the following script:_x000A__x000A__x000A_USE master_x000A__x000A_REVOKE ALTER ANY EVENT SESSION TO &lt;'account name'&gt;_x000A__x000A_GO</S>
      <S N="Check">Obtain the list of accounts that have direct access to the server-level permission 'Alter any event session' by running the following query:_x000A__x000A_SELECT _x000A_       who.name AS [Principal Name],_x000A_       who.type_desc AS [Principal Type],_x000A_       who.is_disabled AS [Principal Is Disabled],_x000A_       what.state_desc AS [Permission State],_x000A_       what.permission_name AS [Permission Name]_x000A_FROM _x000A_       sys.server_permissions what _x000A_       INNER JOIN sys.server_principals who_x000A_              ON who.principal_id = what.grantee_principal_id_x000A_WHERE_x000A_       what.permission_name = 'Alter any event session'_x000A_AND    who.name NOT LIKE '##MS%##'_x000A_AND    who.type_desc &lt;&gt; 'SERVER_ROLE'_x000A_ORDER BY_x000A_       who.name_x000A_;_x000A_GO_x000A__x000A_If any user accounts have direct access to the 'Alter any event session' permission, this is a finding._x000A__x000A_Alternatively, to provide a combined list for all requirements of this type:_x000A_SELECT _x000A__x0009_what.permission_name AS [Permission Name],_x000A__x0009_what.state_desc AS [Permission State],_x000A__x0009_who.name AS [Principal Name],_x000A__x0009_who.type_desc AS [Principal Type],_x000A__x0009_who.is_disabled AS [Principal Is Disabled]_x000A_FROM _x000A__x0009_sys.server_permissions what _x000A__x0009_INNER JOIN sys.server_principals who_x000A__x0009__x0009_ON who.principal_id = what.grantee_principal_id_x000A_WHERE_x000A__x0009_what.permission_name IN_x000A__x0009_(_x000A__x0009_'Administer bulk operations',_x000A__x0009_'Alter any availability group',_x000A__x0009_'Alter any connection',_x000A__x0009_'Alter any credential',_x000A__x0009_'Alter any database',_x000A__x0009_'Alter any endpoint ',_x000A__x0009_'Alter any event notification ',_x000A__x0009_'Alter any event session ',_x000A__x0009_'Alter any linked server',_x000A__x0009_'Alter any login',_x000A__x0009_'Alter any server audit',_x000A__x0009_'Alter any server role',_x000A__x0009_'Alter resources',_x000A__x0009_'Alter server state ',_x000A__x0009_'Alter Settings ',_x000A__x0009_'Alter trace',_x000A__x0009_'Authenticate server ',_x000A__x0009_'Control server',_x000A__x0009_'Create any database ',_x000A__x0009_'Create availability group',_x000A__x0009_'Create DDL event notification',_x000A__x0009_'Create endpoint',_x000A__x0009_'Create server role',_x000A__x0009_'Create trace event notification',_x000A__x0009_'External access assembly',_x000A__x0009_'Shutdown',_x000A__x0009_'Unsafe Assembly',_x000A__x0009_'View any database',_x000A__x0009_'View any definition',_x000A__x0009_'View server state'_x000A__x0009_)_x000A_AND    who.name NOT LIKE '##MS%##'_x000A_AND    who.type_desc &lt;&gt; 'SERVER_ROLE'_x000A_ORDER BY_x000A__x0009_what.permission_name,_x000A__x0009_who.name_x000A_;_x000A_GO</S>
    </MS>
  </Obj>
  <Obj RefId="493">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2012</S>
      <S N="VulnID">V-41274</S>
      <S N="RuleID">SV-53756r4_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL2-00-005200</S>
      <S N="Title">SQL Server must not grant users direct access to the Alter trace permission.</S>
      <S N="Description">The concept of least privilege must be applied to SQL Server processes, ensuring that the processes operate at privilege levels no higher than necessary to accomplish required organizational missions and/or functions. Organizations consider the creation of additional processes, roles, and SQL Server accounts as necessary to achieve least privilege. Organizations also apply least privilege concepts to the design, development, implementation, and operations of SQL Server and the OS._x000A__x000A_Unauthorized access to sensitive data or SQL Server control may compromise the confidentiality of personnel privacy, threaten national security, compromise a variety of other sensitive operations or lead to a loss of system control. Access controls are best managed by defining requirements based on distinct job functions and assigning access based on the job function assigned to the individual user._x000A__x000A_Privileges granted outside of SQL Server's role-based account assignments are more likely to go unmanaged and without oversight of granted access. Maintenance of privileges using roles defined for discrete job functions offers improved oversight of application user privilege assignments and helps to protect against unauthorized privilege assignment._x000A__x000A_SQL Server's 'Alter trace' permission is a high server-level privilege that must only be granted to individual administration accounts through roles. This administrative privilege must not be assigned directly to administrative user accounts (or any other user accounts). If any user accounts have direct access to administrative privileges, this access must be removed._x000A__x000A_Note that this does not apply to logins with names of the form '##MS...##'.  These accounts are internal-use system principals provisioned by the DBMS, and required by it for specific purposes.tru</S>
      <S N="FixText">Remove the 'Alter trace' permission access from the account that has direct access by running the following script:_x000A__x000A__x000A_USE master_x000A__x000A_REVOKE ALTER TRACE TO &lt;'account name'&gt;_x000A__x000A_GO</S>
      <S N="Check">Obtain the list of accounts that have direct access to the server-level permission 'Alter trace' by running the following query:_x000A__x000A_SELECT _x000A_       who.name AS [Principal Name],_x000A_       who.type_desc AS [Principal Type],_x000A_       who.is_disabled AS [Principal Is Disabled],_x000A_       what.state_desc AS [Permission State],_x000A_       what.permission_name AS [Permission Name]_x000A_FROM _x000A_       sys.server_permissions what _x000A_       INNER JOIN sys.server_principals who_x000A_              ON who.principal_id = what.grantee_principal_id_x000A_WHERE_x000A_       what.permission_name = 'Alter trace'_x000A_AND    who.name NOT LIKE '##MS%##'_x000A_AND    who.type_desc &lt;&gt; 'SERVER_ROLE'_x000A_ORDER BY_x000A_       who.name_x000A_;_x000A_GO_x000A__x000A_If any user accounts have direct access to the 'Alter trace' permission, this is a finding._x000A__x000A_Alternatively, to provide a combined list for all requirements of this type:_x000A_SELECT _x000A__x0009_what.permission_name AS [Permission Name],_x000A__x0009_what.state_desc AS [Permission State],_x000A__x0009_who.name AS [Principal Name],_x000A__x0009_who.type_desc AS [Principal Type],_x000A__x0009_who.is_disabled AS [Principal Is Disabled]_x000A_FROM _x000A__x0009_sys.server_permissions what _x000A__x0009_INNER JOIN sys.server_principals who_x000A__x0009__x0009_ON who.principal_id = what.grantee_principal_id_x000A_WHERE_x000A__x0009_what.permission_name IN_x000A__x0009_(_x000A__x0009_'Administer bulk operations',_x000A__x0009_'Alter any availability group',_x000A__x0009_'Alter any connection',_x000A__x0009_'Alter any credential',_x000A__x0009_'Alter any database',_x000A__x0009_'Alter any endpoint ',_x000A__x0009_'Alter any event notification ',_x000A__x0009_'Alter any event session ',_x000A__x0009_'Alter any linked server',_x000A__x0009_'Alter any login',_x000A__x0009_'Alter any server audit',_x000A__x0009_'Alter any server role',_x000A__x0009_'Alter resources',_x000A__x0009_'Alter server state ',_x000A__x0009_'Alter Settings ',_x000A__x0009_'Alter trace',_x000A__x0009_'Authenticate server ',_x000A__x0009_'Control server',_x000A__x0009_'Create any database ',_x000A__x0009_'Create availability group',_x000A__x0009_'Create DDL event notification',_x000A__x0009_'Create endpoint',_x000A__x0009_'Create server role',_x000A__x0009_'Create trace event notification',_x000A__x0009_'External access assembly',_x000A__x0009_'Shutdown',_x000A__x0009_'Unsafe Assembly',_x000A__x0009_'View any database',_x000A__x0009_'View any definition',_x000A__x0009_'View server state'_x000A__x0009_)_x000A_AND    who.name NOT LIKE '##MS%##'_x000A_AND    who.type_desc &lt;&gt; 'SERVER_ROLE'_x000A_ORDER BY_x000A__x0009_what.permission_name,_x000A__x0009_who.name_x000A_;_x000A_GO</S>
    </MS>
  </Obj>
  <Obj RefId="494">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2012</S>
      <S N="VulnID">V-41275</S>
      <S N="RuleID">SV-53757r4_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL2-00-005100</S>
      <S N="Title">SQL Server must not grant users direct access to the Alter Settings permission.</S>
      <S N="Description">The concept of least privilege must be applied to SQL Server processes, ensuring that the processes operate at privilege levels no higher than necessary to accomplish required organizational missions and/or functions. Organizations consider the creation of additional processes, roles, and SQL Server accounts as necessary to achieve least privilege. Organizations also apply least privilege concepts to the design, development, implementation, and operations of SQL Server and the OS._x000A__x000A_Unauthorized access to sensitive data or SQL Server control may compromise the confidentiality of personnel privacy, threaten national security, compromise a variety of other sensitive operations or lead to a loss of system control. Access controls are best managed by defining requirements based on distinct job functions and assigning access based on the job function assigned to the individual user._x000A__x000A_Privileges granted outside of SQL Server's role-based account assignments are more likely to go unmanaged and without oversight of granted access. Maintenance of privileges using roles defined for discrete job functions offers improved oversight of application user privilege assignments and helps to protect against unauthorized privilege assignment._x000A__x000A_SQL Server's 'Alter Settings' permission is a high server-level privilege that must only be granted to individual administration accounts through roles. This administrative privilege must not be assigned directly to administrative user accounts (or any other user accounts). If any user accounts have direct access to administrative privileges, this access must be removed._x000A__x000A_Note that this does not apply to logins with names of the form '##MS...##'.  These accounts are internal-use system principals provisioned by the DBMS, and required by it for specific purposes.tru</S>
      <S N="FixText">Remove the 'Alter Settings' permission access from the account that has direct access by running the following script:_x000A__x000A__x000A_USE master_x000A__x000A_REVOKE ALTER SETTINGS TO &lt;'account name'&gt;_x000A__x000A_GO</S>
      <S N="Check">Obtain the list of accounts that have direct access to the server-level permission 'Alter Settings' by running the following query:_x000A__x000A_SELECT _x000A_       who.name AS [Principal Name],_x000A_       who.type_desc AS [Principal Type],_x000A_       who.is_disabled AS [Principal Is Disabled],_x000A_       what.state_desc AS [Permission State],_x000A_       what.permission_name AS [Permission Name]_x000A_FROM _x000A_       sys.server_permissions what _x000A_       INNER JOIN sys.server_principals who_x000A_              ON who.principal_id = what.grantee_principal_id_x000A_WHERE_x000A_       what.permission_name = 'Alter Settings'_x000A_AND    who.name NOT LIKE '##MS%##'_x000A_AND    who.type_desc &lt;&gt; 'SERVER_ROLE'_x000A_ORDER BY_x000A_       who.name_x000A_;_x000A_GO_x000A__x000A_If any user accounts have direct access to the 'Alter Settings' permission, this is a finding._x000A__x000A_Alternatively, to provide a combined list for all requirements of this type:_x000A_SELECT _x000A__x0009_what.permission_name AS [Permission Name],_x000A__x0009_what.state_desc AS [Permission State],_x000A__x0009_who.name AS [Principal Name],_x000A__x0009_who.type_desc AS [Principal Type],_x000A__x0009_who.is_disabled AS [Principal Is Disabled]_x000A_FROM _x000A__x0009_sys.server_permissions what _x000A__x0009_INNER JOIN sys.server_principals who_x000A__x0009__x0009_ON who.principal_id = what.grantee_principal_id_x000A_WHERE_x000A__x0009_what.permission_name IN_x000A__x0009_(_x000A__x0009_'Administer bulk operations',_x000A__x0009_'Alter any availability group',_x000A__x0009_'Alter any connection',_x000A__x0009_'Alter any credential',_x000A__x0009_'Alter any database',_x000A__x0009_'Alter any endpoint ',_x000A__x0009_'Alter any event notification ',_x000A__x0009_'Alter any event session ',_x000A__x0009_'Alter any linked server',_x000A__x0009_'Alter any login',_x000A__x0009_'Alter any server audit',_x000A__x0009_'Alter any server role',_x000A__x0009_'Alter resources',_x000A__x0009_'Alter server state ',_x000A__x0009_'Alter Settings ',_x000A__x0009_'Alter trace',_x000A__x0009_'Authenticate server ',_x000A__x0009_'Control server',_x000A__x0009_'Create any database ',_x000A__x0009_'Create availability group',_x000A__x0009_'Create DDL event notification',_x000A__x0009_'Create endpoint',_x000A__x0009_'Create server role',_x000A__x0009_'Create trace event notification',_x000A__x0009_'External access assembly',_x000A__x0009_'Shutdown',_x000A__x0009_'Unsafe Assembly',_x000A__x0009_'View any database',_x000A__x0009_'View any definition',_x000A__x0009_'View server state'_x000A__x0009_)_x000A_AND    who.name NOT LIKE '##MS%##'_x000A_AND    who.type_desc &lt;&gt; 'SERVER_ROLE'_x000A_ORDER BY_x000A__x0009_what.permission_name,_x000A__x0009_who.name_x000A_;_x000A_GO</S>
    </MS>
  </Obj>
  <Obj RefId="495">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2012</S>
      <S N="VulnID">V-41276</S>
      <S N="RuleID">SV-53758r4_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL2-00-005000</S>
      <S N="Title">SQL Server must not grant users direct access to the Create trace event notification permission.</S>
      <S N="Description">The concept of least privilege must be applied to SQL Server processes, ensuring that the processes operate at privilege levels no higher than necessary to accomplish required organizational missions and/or functions. Organizations consider the creation of additional processes, roles, and SQL Server accounts as necessary to achieve least privilege. Organizations also apply least privilege concepts to the design, development, implementation, and operations of SQL Server and the OS._x000A__x000A_Unauthorized access to sensitive data or SQL Server control may compromise the confidentiality of personnel privacy, threaten national security, compromise a variety of other sensitive operations or lead to a loss of system control. Access controls are best managed by defining requirements based on distinct job functions and assigning access based on the job function assigned to the individual user._x000A__x000A_Privileges granted outside of SQL Server's role-based account assignments are more likely to go unmanaged and without oversight of granted access. Maintenance of privileges using roles defined for discrete job functions offers improved oversight of application user privilege assignments and helps to protect against unauthorized privilege assignment._x000A__x000A_SQL Server's 'Create trace event notification' permission is a high server-level privilege that must only be granted to individual administration accounts through roles. This administrative privilege must not be assigned directly to administrative user accounts (or any other user accounts). If any user accounts have direct access to administrative privileges, this access must be removed._x000A__x000A_Note that this does not apply to logins with names of the form '##MS...##'.  These accounts are internal-use system principals provisioned by the DBMS, and required by it for specific purposes.tru</S>
      <S N="FixText">Remove the 'Create trace event notification' permission access from the account that has direct access by running the following script:_x000A__x000A__x000A_USE master_x000A__x000A_REVOKE CREATE TRACE EVENT NOTIFICATION TO &lt;'account name'&gt;_x000A__x000A_GO</S>
      <S N="Check">Obtain the list of accounts that have direct access to the server-level permission 'Create trace event notification' by running the following query:_x000A__x000A_SELECT _x000A_       who.name AS [Principal Name],_x000A_       who.type_desc AS [Principal Type],_x000A_       who.is_disabled AS [Principal Is Disabled],_x000A_       what.state_desc AS [Permission State],_x000A_       what.permission_name AS [Permission Name]_x000A_FROM _x000A_       sys.server_permissions what _x000A_       INNER JOIN sys.server_principals who_x000A_              ON who.principal_id = what.grantee_principal_id_x000A_WHERE_x000A_       what.permission_name = 'Create trace event notification' _x000A_AND    who.name NOT LIKE '##MS%##'_x000A_AND    who.type_desc &lt;&gt; 'SERVER_ROLE'_x000A_ORDER BY_x000A_       who.name_x000A_;_x000A_GO_x000A__x000A_If any user accounts have direct access to the 'Create trace event notification' permission, this is a finding._x000A__x000A_Alternatively, to provide a combined list for all requirements of this type:_x000A_SELECT _x000A__x0009_what.permission_name AS [Permission Name],_x000A__x0009_what.state_desc AS [Permission State],_x000A__x0009_who.name AS [Principal Name],_x000A__x0009_who.type_desc AS [Principal Type],_x000A__x0009_who.is_disabled AS [Principal Is Disabled]_x000A_FROM _x000A__x0009_sys.server_permissions what _x000A__x0009_INNER JOIN sys.server_principals who_x000A__x0009__x0009_ON who.principal_id = what.grantee_principal_id_x000A_WHERE_x000A__x0009_what.permission_name IN_x000A__x0009_(_x000A__x0009_'Administer bulk operations',_x000A__x0009_'Alter any availability group',_x000A__x0009_'Alter any connection',_x000A__x0009_'Alter any credential',_x000A__x0009_'Alter any database',_x000A__x0009_'Alter any endpoint ',_x000A__x0009_'Alter any event notification ',_x000A__x0009_'Alter any event session ',_x000A__x0009_'Alter any linked server',_x000A__x0009_'Alter any login',_x000A__x0009_'Alter any server audit',_x000A__x0009_'Alter any server role',_x000A__x0009_'Alter resources',_x000A__x0009_'Alter server state ',_x000A__x0009_'Alter Settings ',_x000A__x0009_'Alter trace',_x000A__x0009_'Authenticate server ',_x000A__x0009_'Control server',_x000A__x0009_'Create any database ',_x000A__x0009_'Create availability group',_x000A__x0009_'Create DDL event notification',_x000A__x0009_'Create endpoint',_x000A__x0009_'Create server role',_x000A__x0009_'Create trace event notification',_x000A__x0009_'External access assembly',_x000A__x0009_'Shutdown',_x000A__x0009_'Unsafe Assembly',_x000A__x0009_'View any database',_x000A__x0009_'View any definition',_x000A__x0009_'View server state'_x000A__x0009_)_x000A_AND    who.name NOT LIKE '##MS%##'_x000A_AND    who.type_desc &lt;&gt; 'SERVER_ROLE'_x000A_ORDER BY_x000A__x0009_what.permission_name,_x000A__x0009_who.name_x000A_;_x000A_GO</S>
    </MS>
  </Obj>
  <Obj RefId="496">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2012</S>
      <S N="VulnID">V-41277</S>
      <S N="RuleID">SV-53759r4_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL2-00-004900</S>
      <S N="Title">SQL Server must not grant users direct access to the Alter resources permission.</S>
      <S N="Description">The concept of least privilege must be applied to SQL Server processes, ensuring that the processes operate at privilege levels no higher than necessary to accomplish required organizational missions and/or functions. Organizations consider the creation of additional processes, roles, and SQL Server accounts as necessary to achieve least privilege. Organizations also apply least privilege concepts to the design, development, implementation, and operations of SQL Server and the OS._x000A__x000A_Unauthorized access to sensitive data or SQL Server control may compromise the confidentiality of personnel privacy, threaten national security, compromise a variety of other sensitive operations or lead to a loss of system control. Access controls are best managed by defining requirements based on distinct job functions and assigning access based on the job function assigned to the individual user._x000A__x000A_Privileges granted outside of SQL Server's role-based account assignments are more likely to go unmanaged and without oversight of granted access. Maintenance of privileges using roles defined for discrete job functions offers improved oversight of application user privilege assignments and helps to protect against unauthorized privilege assignment._x000A__x000A_SQL Server's 'Alter resources' permission is a high server-level privilege that must only be granted to individual administration accounts through roles. This administrative privilege must not be assigned directly to administrative user accounts (or any other user accounts). If any user accounts have direct access to administrative privileges, this access must be removed._x000A__x000A_Note that this does not apply to logins with names of the form '##MS...##'.  These accounts are internal-use system principals provisioned by the DBMS, and required by it for specific purposes.tru</S>
      <S N="FixText">Remove the 'Alter resources' permission access from the account that has direct access by running the following script:_x000A__x000A__x000A_USE master_x000A__x000A_REVOKE ALTER RESOURCES TO &lt;'account name'&gt;_x000A__x000A_GO</S>
      <S N="Check">Obtain the list of accounts that have direct access to the server-level permission 'Alter resources' by running the following query:_x000A__x000A_SELECT _x000A_       who.name AS [Principal Name],_x000A_       who.type_desc AS [Principal Type],_x000A_       who.is_disabled AS [Principal Is Disabled],_x000A_       what.state_desc AS [Permission State],_x000A_       what.permission_name AS [Permission Name]_x000A_FROM _x000A_       sys.server_permissions what _x000A_       INNER JOIN sys.server_principals who_x000A_              ON who.principal_id = what.grantee_principal_id_x000A_WHERE_x000A_       what.permission_name = 'Alter resources'_x000A_AND    who.name NOT LIKE '##MS%##'_x000A_AND    who.type_desc &lt;&gt; 'SERVER_ROLE'_x000A_ORDER BY_x000A_       who.name_x000A_;_x000A_GO_x000A__x000A_If any user accounts have direct access to the 'Alter resources' permission, this is a finding._x000A__x000A_Alternatively, to provide a combined list for all requirements of this type:_x000A_SELECT _x000A__x0009_what.permission_name AS [Permission Name],_x000A__x0009_what.state_desc AS [Permission State],_x000A__x0009_who.name AS [Principal Name],_x000A__x0009_who.type_desc AS [Principal Type],_x000A__x0009_who.is_disabled AS [Principal Is Disabled]_x000A_FROM _x000A__x0009_sys.server_permissions what _x000A__x0009_INNER JOIN sys.server_principals who_x000A__x0009__x0009_ON who.principal_id = what.grantee_principal_id_x000A_WHERE_x000A__x0009_what.permission_name IN_x000A__x0009_(_x000A__x0009_'Administer bulk operations',_x000A__x0009_'Alter any availability group',_x000A__x0009_'Alter any connection',_x000A__x0009_'Alter any credential',_x000A__x0009_'Alter any database',_x000A__x0009_'Alter any endpoint ',_x000A__x0009_'Alter any event notification ',_x000A__x0009_'Alter any event session ',_x000A__x0009_'Alter any linked server',_x000A__x0009_'Alter any login',_x000A__x0009_'Alter any server audit',_x000A__x0009_'Alter any server role',_x000A__x0009_'Alter resources',_x000A__x0009_'Alter server state ',_x000A__x0009_'Alter Settings ',_x000A__x0009_'Alter trace',_x000A__x0009_'Authenticate server ',_x000A__x0009_'Control server',_x000A__x0009_'Create any database ',_x000A__x0009_'Create availability group',_x000A__x0009_'Create DDL event notification',_x000A__x0009_'Create endpoint',_x000A__x0009_'Create server role',_x000A__x0009_'Create trace event notification',_x000A__x0009_'External access assembly',_x000A__x0009_'Shutdown',_x000A__x0009_'Unsafe Assembly',_x000A__x0009_'View any database',_x000A__x0009_'View any definition',_x000A__x0009_'View server state'_x000A__x0009_)_x000A_AND    who.name NOT LIKE '##MS%##'_x000A_AND    who.type_desc &lt;&gt; 'SERVER_ROLE'_x000A_ORDER BY_x000A__x0009_what.permission_name,_x000A__x0009_who.name_x000A_;_x000A_GO</S>
    </MS>
  </Obj>
  <Obj RefId="497">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2012</S>
      <S N="VulnID">V-41278</S>
      <S N="RuleID">SV-53760r4_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL2-00-004800</S>
      <S N="Title">SQL Server must not grant users direct access to the External access assembly permission.</S>
      <S N="Description">The concept of least privilege must be applied to SQL Server processes, ensuring that the processes operate at privilege levels no higher than necessary to accomplish required organizational missions and/or functions. Organizations consider the creation of additional processes, roles, and SQL Server accounts as necessary to achieve least privilege. Organizations also apply least privilege concepts to the design, development, implementation, and operations of SQL Server and the OS._x000A__x000A_Unauthorized access to sensitive data or SQL Server control may compromise the confidentiality of personnel privacy, threaten national security, compromise a variety of other sensitive operations or lead to a loss of system control. Access controls are best managed by defining requirements based on distinct job functions and assigning access based on the job function assigned to the individual user._x000A__x000A_Privileges granted outside of SQL Server's role-based account assignments are more likely to go unmanaged and without oversight of granted access. Maintenance of privileges using roles defined for discrete job functions offers improved oversight of application user privilege assignments and helps to protect against unauthorized privilege assignment._x000A__x000A_SQL Server's 'External access assembly' permission is a high server-level privilege that must only be granted to individual administration accounts through roles. This administrative privilege must not be assigned directly to administrative user accounts (or any other user accounts). If any user accounts have direct access to administrative privileges, this access must be removed._x000A__x000A_Note that this does not apply to logins with names of the form '##MS...##'.  These accounts are internal-use system principals provisioned by the DBMS, and required by it for specific purposes.tru</S>
      <S N="FixText">Remove the 'External access assembly' permission access from the account that has direct access by running the following script:_x000A__x000A__x000A_USE master_x000A__x000A_REVOKE EXTERNAL ACCESS ASSEMBLY TO &lt;'account name'&gt;_x000A__x000A_GO</S>
      <S N="Check">Obtain the list of accounts that have direct access to the server-level permission 'External access assembly' by running the following query:_x000A__x000A_SELECT _x000A_       who.name AS [Principal Name],_x000A_       who.type_desc AS [Principal Type],_x000A_       who.is_disabled AS [Principal Is Disabled],_x000A_       what.state_desc AS [Permission State],_x000A_       what.permission_name AS [Permission Name]_x000A_FROM _x000A_       sys.server_permissions what _x000A_       INNER JOIN sys.server_principals who_x000A_              ON who.principal_id = what.grantee_principal_id_x000A_WHERE_x000A_       what.permission_name = 'External access assembly'_x000A_AND    who.name NOT LIKE '##MS%##'_x000A_AND    who.type_desc &lt;&gt; 'SERVER_ROLE'_x000A_ORDER BY_x000A_       who.name_x000A_;_x000A_GO_x000A__x000A_If any user accounts have direct access to the 'External access assembly' permission, this is a finding._x000A__x000A_Alternatively, to provide a combined list for all requirements of this type:_x000A_SELECT _x000A__x0009_what.permission_name AS [Permission Name],_x000A__x0009_what.state_desc AS [Permission State],_x000A__x0009_who.name AS [Principal Name],_x000A__x0009_who.type_desc AS [Principal Type],_x000A__x0009_who.is_disabled AS [Principal Is Disabled]_x000A_FROM _x000A__x0009_sys.server_permissions what _x000A__x0009_INNER JOIN sys.server_principals who_x000A__x0009__x0009_ON who.principal_id = what.grantee_principal_id_x000A_WHERE_x000A__x0009_what.permission_name IN_x000A__x0009_(_x000A__x0009_'Administer bulk operations',_x000A__x0009_'Alter any availability group',_x000A__x0009_'Alter any connection',_x000A__x0009_'Alter any credential',_x000A__x0009_'Alter any database',_x000A__x0009_'Alter any endpoint ',_x000A__x0009_'Alter any event notification ',_x000A__x0009_'Alter any event session ',_x000A__x0009_'Alter any linked server',_x000A__x0009_'Alter any login',_x000A__x0009_'Alter any server audit',_x000A__x0009_'Alter any server role',_x000A__x0009_'Alter resources',_x000A__x0009_'Alter server state ',_x000A__x0009_'Alter Settings ',_x000A__x0009_'Alter trace',_x000A__x0009_'Authenticate server ',_x000A__x0009_'Control server',_x000A__x0009_'Create any database ',_x000A__x0009_'Create availability group',_x000A__x0009_'Create DDL event notification',_x000A__x0009_'Create endpoint',_x000A__x0009_'Create server role',_x000A__x0009_'Create trace event notification',_x000A__x0009_'External access assembly',_x000A__x0009_'Shutdown',_x000A__x0009_'Unsafe Assembly',_x000A__x0009_'View any database',_x000A__x0009_'View any definition',_x000A__x0009_'View server state'_x000A__x0009_)_x000A_AND    who.name NOT LIKE '##MS%##'_x000A_AND    who.type_desc &lt;&gt; 'SERVER_ROLE'_x000A_ORDER BY_x000A__x0009_what.permission_name,_x000A__x0009_who.name_x000A_;_x000A_GO</S>
    </MS>
  </Obj>
  <Obj RefId="498">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2012</S>
      <S N="VulnID">V-41279</S>
      <S N="RuleID">SV-53761r4_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL2-00-004700</S>
      <S N="Title">SQL Server must not grant users direct access to the Alter any login permission.</S>
      <S N="Description">The concept of least privilege must be applied to SQL Server processes, ensuring that the processes operate at privilege levels no higher than necessary to accomplish required organizational missions and/or functions. Organizations consider the creation of additional processes, roles, and SQL Server accounts as necessary to achieve least privilege. Organizations also apply least privilege concepts to the design, development, implementation, and operations of SQL Server and the OS._x000A__x000A_Unauthorized access to sensitive data or SQL Server control may compromise the confidentiality of personnel privacy, threaten national security, compromise a variety of other sensitive operations or lead to a loss of system control. Access controls are best managed by defining requirements based on distinct job functions and assigning access based on the job function assigned to the individual user._x000A__x000A_Privileges granted outside of SQL Server's role-based account assignments are more likely to go unmanaged and without oversight of granted access. Maintenance of privileges using roles defined for discrete job functions offers improved oversight of application user privilege assignments and helps to protect against unauthorized privilege assignment._x000A__x000A_SQL Server's 'Alter any login' permission is a high server-level privilege that must only be granted to individual administration accounts through roles. This administrative privilege must not be assigned directly to administrative user accounts (or any other user accounts). If any user accounts have direct access to administrative privileges, this access must be removed._x000A__x000A_Note that this does not apply to logins with names of the form '##MS...##'.  These accounts are internal-use system principals provisioned by the DBMS, and required by it for specific purposes.tru</S>
      <S N="FixText">Remove the 'Alter any login' permission access from the account that has direct access by running the following script:_x000A__x000A__x000A_USE master_x000A__x000A_REVOKE ALTER ANY LOGIN TO &lt;'account name'&gt;_x000A__x000A_GO</S>
      <S N="Check">Obtain the list of accounts that have direct access to the server-level permission 'Alter any login' by running the following query:_x000A__x000A_SELECT _x000A_       who.name AS [Principal Name],_x000A_       who.type_desc AS [Principal Type],_x000A_       who.is_disabled AS [Principal Is Disabled],_x000A_       what.state_desc AS [Permission State],_x000A_       what.permission_name AS [Permission Name]_x000A_FROM _x000A_       sys.server_permissions what _x000A_       INNER JOIN sys.server_principals who_x000A_              ON who.principal_id = what.grantee_principal_id_x000A_WHERE_x000A_       what.permission_name = 'Alter any login'_x000A_AND    who.name NOT LIKE '##MS%##'_x000A_AND    who.type_desc &lt;&gt; 'SERVER_ROLE'_x000A_ORDER BY_x000A_       who.name_x000A_;_x000A_GO_x000A__x000A_If any user accounts have direct access to the 'Alter any login' permission, this is a finding._x000A__x000A_Alternatively, to provide a combined list for all requirements of this type:_x000A_SELECT _x000A__x0009_what.permission_name AS [Permission Name],_x000A__x0009_what.state_desc AS [Permission State],_x000A__x0009_who.name AS [Principal Name],_x000A__x0009_who.type_desc AS [Principal Type],_x000A__x0009_who.is_disabled AS [Principal Is Disabled]_x000A_FROM _x000A__x0009_sys.server_permissions what _x000A__x0009_INNER JOIN sys.server_principals who_x000A__x0009__x0009_ON who.principal_id = what.grantee_principal_id_x000A_WHERE_x000A__x0009_what.permission_name IN_x000A__x0009_(_x000A__x0009_'Administer bulk operations',_x000A__x0009_'Alter any availability group',_x000A__x0009_'Alter any connection',_x000A__x0009_'Alter any credential',_x000A__x0009_'Alter any database',_x000A__x0009_'Alter any endpoint ',_x000A__x0009_'Alter any event notification ',_x000A__x0009_'Alter any event session ',_x000A__x0009_'Alter any linked server',_x000A__x0009_'Alter any login',_x000A__x0009_'Alter any server audit',_x000A__x0009_'Alter any server role',_x000A__x0009_'Alter resources',_x000A__x0009_'Alter server state ',_x000A__x0009_'Alter Settings ',_x000A__x0009_'Alter trace',_x000A__x0009_'Authenticate server ',_x000A__x0009_'Control server',_x000A__x0009_'Create any database ',_x000A__x0009_'Create availability group',_x000A__x0009_'Create DDL event notification',_x000A__x0009_'Create endpoint',_x000A__x0009_'Create server role',_x000A__x0009_'Create trace event notification',_x000A__x0009_'External access assembly',_x000A__x0009_'Shutdown',_x000A__x0009_'Unsafe Assembly',_x000A__x0009_'View any database',_x000A__x0009_'View any definition',_x000A__x0009_'View server state'_x000A__x0009_)_x000A_AND    who.name NOT LIKE '##MS%##'_x000A_AND    who.type_desc &lt;&gt; 'SERVER_ROLE'_x000A_ORDER BY_x000A__x0009_what.permission_name,_x000A__x0009_who.name_x000A_;_x000A_GO</S>
    </MS>
  </Obj>
  <Obj RefId="499">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2012</S>
      <S N="VulnID">V-41280</S>
      <S N="RuleID">SV-53762r4_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL2-00-004600</S>
      <S N="Title">SQL Server must enforce access control policies to restrict the Alter any availability group permission to only authorized roles.</S>
      <S N="Description">The concept of least privilege must be applied to SQL Server processes, ensuring that the processes operate at privilege levels no higher than necessary to accomplish required organizational missions and/or functions. Organizations consider the creation of additional processes, roles, and SQL Server accounts as necessary to achieve least privilege. Organizations also apply least privilege concepts to the design, development, implementation, and operations of SQL Server and the OS._x000A__x000A_Unauthorized access to sensitive data or SQL Server control may compromise the confidentiality of personnel privacy, threaten national security, compromise a variety of other sensitive operations, or lead to a loss of system control. Access controls are best managed by defining requirements based on distinct job functions and assigning access based on the job function assigned to the individual user._x000A__x000A_SQL Server's 'Alter any availability group' permission is a high server-level privilege that must only be granted to individual administration accounts through roles and users. If the 'Alter any availability group' permission is granted to roles that are unauthorized to have this privilege, then this access must be removed._x000A__x000A_Additionally, the permission must not be denied to a role, because that could disable a user's legitimate access via another role._x000A__x000A_The fix for this vulnerability specifies the use of REVOKE.  Be aware that revoking a permission that is currently denied to a role or user does not necessarily disable the permission.  If the user or role can inherent the permission from another role, revoking the denied permission from the user or the first role can effectively enable the inherited permission.tru</S>
      <S N="FixText">Remove the 'Alter any availability group' permission access from the role that is not authorized  by executing the following query:_x000A__x000A__x000A_REVOKE Alter any availability group TO &lt;'role name'&gt;</S>
      <S N="Check">Obtain the list of roles that are authorized for the SQL Server 'Alter any availability group' permission and what 'Grant', 'Grant With', and/or 'Deny' privilege is authorized. Obtain the list of roles with that permission by running the following query:_x000A__x000A_SELECT _x000A_       who.name AS [Principal Name],_x000A_       who.type_desc AS [Principal Type],_x000A_       who.is_disabled AS [Principal Is Disabled],_x000A_       what.state_desc AS [Permission State],_x000A_       what.permission_name AS [Permission Name]_x000A_FROM _x000A_       sys.server_permissions what _x000A_       INNER JOIN sys.server_principals who_x000A_              ON who.principal_id = what.grantee_principal_id_x000A_WHERE_x000A_       what.permission_name = 'Alter any availability group' _x000A_AND    who.type_desc = 'SERVER_ROLE'_x000A_ORDER BY_x000A_       who.name_x000A_;_x000A_GO _x000A__x000A_If any role has 'Grant', 'With Grant' or 'Deny' privileges on this permission and users with that role are not authorized to have the permission, this is a finding._x000A__x000A_Alternatively, to provide a combined list for all requirements of this type:_x000A_SELECT _x000A__x0009_what.permission_name AS [Permission Name],_x000A__x0009_what.state_desc AS [Permission State],_x000A__x0009_who.name AS [Principal Name],_x000A__x0009_who.type_desc AS [Principal Type],_x000A__x0009_who.is_disabled AS [Principal Is Disabled]_x000A_FROM _x000A__x0009_sys.server_permissions what _x000A__x0009_INNER JOIN sys.server_principals who_x000A__x0009__x0009_ON who.principal_id = what.grantee_principal_id_x000A_WHERE_x000A__x0009_what.permission_name IN_x000A__x0009_(_x000A__x0009_'Administer bulk operations',_x000A__x0009_'Alter any availability group',_x000A__x0009_'Alter any connection',_x000A__x0009_'Alter any credential',_x000A__x0009_'Alter any database',_x000A__x0009_'Alter any endpoint ',_x000A__x0009_'Alter any event notification ',_x000A__x0009_'Alter any event session ',_x000A__x0009_'Alter any linked server',_x000A__x0009_'Alter any login',_x000A__x0009_'Alter any server audit',_x000A__x0009_'Alter any server role',_x000A__x0009_'Alter resources',_x000A__x0009_'Alter server state ',_x000A__x0009_'Alter Settings ',_x000A__x0009_'Alter trace',_x000A__x0009_'Authenticate server ',_x000A__x0009_'Control server',_x000A__x0009_'Create any database ',_x000A__x0009_'Create availability group',_x000A__x0009_'Create DDL event notification',_x000A__x0009_'Create endpoint',_x000A__x0009_'Create server role',_x000A__x0009_'Create trace event notification',_x000A__x0009_'External access assembly',_x000A__x0009_'Shutdown',_x000A__x0009_'Unsafe Assembly',_x000A__x0009_'View any database',_x000A__x0009_'View any definition',_x000A__x0009_'View server state'_x000A__x0009_)_x000A_AND_x0009_who.type_desc = 'SERVER_ROLE'_x000A_ORDER BY_x000A__x0009_what.permission_name,_x000A__x0009_who.name_x000A_;_x000A_GO</S>
    </MS>
  </Obj>
  <Obj RefId="500">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2012</S>
      <S N="VulnID">V-41281</S>
      <S N="RuleID">SV-53763r4_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL2-00-004500</S>
      <S N="Title">SQL Server must enforce access control policies to restrict the Alter any login permission to only authorized roles.</S>
      <S N="Description">The concept of least privilege must be applied to SQL Server processes, ensuring that the processes operate at privilege levels no higher than necessary to accomplish required organizational missions and/or functions. Organizations consider the creation of additional processes, roles, and SQL Server accounts as necessary to achieve least privilege. Organizations also apply least privilege concepts to the design, development, implementation, and operations of SQL Server and the OS._x000A__x000A_Unauthorized access to sensitive data or SQL Server control may compromise the confidentiality of personnel privacy, threaten national security, compromise a variety of other sensitive operations, or lead to a loss of system control. Access controls are best managed by defining requirements based on distinct job functions and assigning access based on the job function assigned to the individual user._x000A__x000A_SQL Server's 'Alter any login' permission is a high server-level privilege that must only be granted to individual administration accounts through roles. If the 'Alter any login' permission is granted to roles that are unauthorized to have this privilege, then this access must be removed._x000A__x000A_Additionally, the permission must not be denied to a role, because that could disable a user's legitimate access via another role._x000A__x000A_The fix for this vulnerability specifies the use of REVOKE.  Be aware that revoking a permission that is currently denied to a role or user does not necessarily disable the permission.  If the user or role can inherent the permission from another role, revoking the denied permission from the user or the first role can effectively enable the inherited permission.tru</S>
      <S N="FixText">Remove the 'Alter any login' permission access from the role that is not authorized  by executing the following query:_x000A__x000A__x000A_REVOKE Alter any login TO &lt;'role name'&gt;</S>
      <S N="Check">Obtain the list of roles that are authorized for the SQL Server 'Alter any login' permission and what 'Grant', 'Grant With', and/or 'Deny' privilege is authorized. Obtain the list of roles with that permission by running the following query:_x000A__x000A_SELECT _x000A_       who.name AS [Principal Name],_x000A_       who.type_desc AS [Principal Type],_x000A_       who.is_disabled AS [Principal Is Disabled],_x000A_       what.state_desc AS [Permission State],_x000A_       what.permission_name AS [Permission Name]_x000A_FROM _x000A_       sys.server_permissions what _x000A_       INNER JOIN sys.server_principals who_x000A_              ON who.principal_id = what.grantee_principal_id_x000A_WHERE_x000A_       what.permission_name = 'Alter any login' _x000A_AND    who.type_desc = 'SERVER_ROLE'_x000A_ORDER BY_x000A_       who.name_x000A_;_x000A_GO _x000A__x000A_If any role has 'Grant', 'With Grant' or 'Deny' privileges on this permission and users with that role are not authorized to have the permission, this is a finding._x000A__x000A_Alternatively, to provide a combined list for all requirements of this type:_x000A_SELECT _x000A__x0009_what.permission_name AS [Permission Name],_x000A__x0009_what.state_desc AS [Permission State],_x000A__x0009_who.name AS [Principal Name],_x000A__x0009_who.type_desc AS [Principal Type],_x000A__x0009_who.is_disabled AS [Principal Is Disabled]_x000A_FROM _x000A__x0009_sys.server_permissions what _x000A__x0009_INNER JOIN sys.server_principals who_x000A__x0009__x0009_ON who.principal_id = what.grantee_principal_id_x000A_WHERE_x000A__x0009_what.permission_name IN_x000A__x0009_(_x000A__x0009_'Administer bulk operations',_x000A__x0009_'Alter any availability group',_x000A__x0009_'Alter any connection',_x000A__x0009_'Alter any credential',_x000A__x0009_'Alter any database',_x000A__x0009_'Alter any endpoint ',_x000A__x0009_'Alter any event notification ',_x000A__x0009_'Alter any event session ',_x000A__x0009_'Alter any linked server',_x000A__x0009_'Alter any login',_x000A__x0009_'Alter any server audit',_x000A__x0009_'Alter any server role',_x000A__x0009_'Alter resources',_x000A__x0009_'Alter server state ',_x000A__x0009_'Alter Settings ',_x000A__x0009_'Alter trace',_x000A__x0009_'Authenticate server ',_x000A__x0009_'Control server',_x000A__x0009_'Create any database ',_x000A__x0009_'Create availability group',_x000A__x0009_'Create DDL event notification',_x000A__x0009_'Create endpoint',_x000A__x0009_'Create server role',_x000A__x0009_'Create trace event notification',_x000A__x0009_'External access assembly',_x000A__x0009_'Shutdown',_x000A__x0009_'Unsafe Assembly',_x000A__x0009_'View any database',_x000A__x0009_'View any definition',_x000A__x0009_'View server state'_x000A__x0009_)_x000A_AND_x0009_who.type_desc = 'SERVER_ROLE'_x000A_ORDER BY_x000A__x0009_what.permission_name,_x000A__x0009_who.name_x000A_;_x000A_GO</S>
    </MS>
  </Obj>
  <Obj RefId="501">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2012</S>
      <S N="VulnID">V-41283</S>
      <S N="RuleID">SV-53765r4_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL2-00-004300</S>
      <S N="Title">SQL Server must enforce access control policies to restrict the Alter any linked server permission to only authorized roles.</S>
      <S N="Description">The concept of least privilege must be applied to SQL Server processes, ensuring that the processes operate at privilege levels no higher than necessary to accomplish required organizational missions and/or functions. Organizations consider the creation of additional processes, roles, and SQL Server accounts as necessary to achieve least privilege. Organizations also apply least privilege concepts to the design, development, implementation, and operations of SQL Server and the OS._x000A__x000A_Unauthorized access to sensitive data or SQL Server control may compromise the confidentiality of personnel privacy, threaten national security, compromise a variety of other sensitive operations, or lead to a loss of system control. Access controls are best managed by defining requirements based on distinct job functions and assigning access based on the job function assigned to the individual user._x000A__x000A_SQL Server's 'Alter any linked server' permission is a high server-level privilege that must only be granted to individual administration accounts through roles. If the 'Alter any linked server' permission is granted to roles that are unauthorized to have this privilege, then this access must be removed._x000A__x000A_Additionally, the permission must not be denied to a role, because that could disable a user's legitimate access via another role._x000A__x000A_The fix for this vulnerability specifies the use of REVOKE.  Be aware that revoking a permission that is currently denied to a role or user does not necessarily disable the permission.  If the user or role can inherent the permission from another role, revoking the denied permission from the user or the first role can effectively enable the inherited permission.tru</S>
      <S N="FixText">Remove the 'Alter any linked server' permission access from the role that is not authorized  by executing the following query:_x000A__x000A__x000A_REVOKE Alter any linked server TO &lt;'role name'&gt;</S>
      <S N="Check">Obtain the list of roles that are authorized for the SQL Server 'Alter any linked server' permission and what 'Grant', 'Grant With', and/or 'Deny' privilege is authorized. Obtain the list of roles with that permission by running the following query:_x000A__x000A_SELECT _x000A_       who.name AS [Principal Name],_x000A_       who.type_desc AS [Principal Type],_x000A_       who.is_disabled AS [Principal Is Disabled],_x000A_       what.state_desc AS [Permission State],_x000A_       what.permission_name AS [Permission Name]_x000A_FROM _x000A_       sys.server_permissions what _x000A_       INNER JOIN sys.server_principals who_x000A_              ON who.principal_id = what.grantee_principal_id_x000A_WHERE_x000A_       what.permission_name = 'Alter any linked server' _x000A_AND    who.type_desc = 'SERVER_ROLE'_x000A_ORDER BY_x000A_       who.name_x000A_;_x000A_GO _x000A__x000A_If any role has 'Grant', 'With Grant' or 'Deny' privileges on this permission and users with that role are not authorized to have the permission, this is a finding._x000A__x000A_Alternatively, to provide a combined list for all requirements of this type:_x000A_SELECT _x000A__x0009_what.permission_name AS [Permission Name],_x000A__x0009_what.state_desc AS [Permission State],_x000A__x0009_who.name AS [Principal Name],_x000A__x0009_who.type_desc AS [Principal Type],_x000A__x0009_who.is_disabled AS [Principal Is Disabled]_x000A_FROM _x000A__x0009_sys.server_permissions what _x000A__x0009_INNER JOIN sys.server_principals who_x000A__x0009__x0009_ON who.principal_id = what.grantee_principal_id_x000A_WHERE_x000A__x0009_what.permission_name IN_x000A__x0009_(_x000A__x0009_'Administer bulk operations',_x000A__x0009_'Alter any availability group',_x000A__x0009_'Alter any connection',_x000A__x0009_'Alter any credential',_x000A__x0009_'Alter any database',_x000A__x0009_'Alter any endpoint ',_x000A__x0009_'Alter any event notification ',_x000A__x0009_'Alter any event session ',_x000A__x0009_'Alter any linked server',_x000A__x0009_'Alter any login',_x000A__x0009_'Alter any server audit',_x000A__x0009_'Alter any server role',_x000A__x0009_'Alter resources',_x000A__x0009_'Alter server state ',_x000A__x0009_'Alter Settings ',_x000A__x0009_'Alter trace',_x000A__x0009_'Authenticate server ',_x000A__x0009_'Control server',_x000A__x0009_'Create any database ',_x000A__x0009_'Create availability group',_x000A__x0009_'Create DDL event notification',_x000A__x0009_'Create endpoint',_x000A__x0009_'Create server role',_x000A__x0009_'Create trace event notification',_x000A__x0009_'External access assembly',_x000A__x0009_'Shutdown',_x000A__x0009_'Unsafe Assembly',_x000A__x0009_'View any database',_x000A__x0009_'View any definition',_x000A__x0009_'View server state'_x000A__x0009_)_x000A_AND_x0009_who.type_desc = 'SERVER_ROLE'_x000A_ORDER BY_x000A__x0009_what.permission_name,_x000A__x0009_who.name_x000A_;_x000A_GO</S>
    </MS>
  </Obj>
  <Obj RefId="502">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2012</S>
      <S N="VulnID">V-41284</S>
      <S N="RuleID">SV-53766r4_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL2-00-004200</S>
      <S N="Title">SQL Server must not grant users direct access control to the Shutdown permission.</S>
      <S N="Description">The concept of least privilege must be applied to SQL Server processes, ensuring that the processes operate at privilege levels no higher than necessary to accomplish required organizational missions and/or functions. Organizations consider the creation of additional processes, roles, and SQL Server accounts as necessary to achieve least privilege. Organizations also apply least privilege concepts to the design, development, implementation, and operations of SQL Server and the OS._x000A__x000A_Unauthorized access to sensitive data or SQL Server control may compromise the confidentiality of personnel privacy, threaten national security, compromise a variety of other sensitive operations or lead to a loss of system control. Access controls are best managed by defining requirements based on distinct job functions and assigning access based on the job function assigned to the individual user._x000A__x000A_Privileges granted outside of SQL Server's role-based account assignments are more likely to go unmanaged and without oversight of granted access. Maintenance of privileges using roles defined for discrete job functions offers improved oversight of application user privilege assignments and helps to protect against unauthorized privilege assignment._x000A__x000A_SQL Server's 'Shutdown' permission is a high server-level privilege that must only be granted to individual administration accounts through roles. This administrative privilege must not be assigned directly to administrative user accounts. If administrative user accounts have direct access to administrative roles, this access must be removed._x000A__x000A_Note that this does not apply to logins with names of the form '##MS...##'. These accounts are internal-use system principals provisioned by the DBMS, and required by it for specific purposes.tru</S>
      <S N="FixText">Remove the 'Shutdown' permission access from the account that has direct access by running the following script:_x000A__x000A__x000A_USE master_x000A__x000A_REVOKE SHUTDOWN TO &lt;'account name'&gt;_x000A__x000A_GO</S>
      <S N="Check">Obtain the list of accounts that have direct access to the server-level permission 'Shutdown' by running the following query:_x000A__x000A_SELECT _x000A_       who.name AS [Principal Name],_x000A_       who.type_desc AS [Principal Type],_x000A_       who.is_disabled AS [Principal Is Disabled],_x000A_       what.state_desc AS [Permission State],_x000A_       what.permission_name AS [Permission Name]_x000A_FROM _x000A_       sys.server_permissions what _x000A_       INNER JOIN sys.server_principals who_x000A_              ON who.principal_id = what.grantee_principal_id_x000A_WHERE_x000A_       what.permission_name = 'Shutdown' _x000A_AND who.name NOT LIKE '##MS%##'_x000A_AND who.type_desc &lt;&gt; 'SERVER_ROLE'_x000A_ORDER BY_x000A_who.name_x000A_;_x000A_GO_x000A__x000A_If any user accounts have direct access to the 'Shutdown' permission, this is a finding._x000A__x000A_Alternatively, to provide a combined list for all requirements of this type:_x000A_SELECT _x000A__x0009_what.permission_name AS [Permission Name],_x000A__x0009_what.state_desc AS [Permission State],_x000A__x0009_who.name AS [Principal Name],_x000A__x0009_who.type_desc AS [Principal Type],_x000A__x0009_who.is_disabled AS [Principal Is Disabled]_x000A_FROM _x000A__x0009_sys.server_permissions what _x000A__x0009_INNER JOIN sys.server_principals who_x000A__x0009__x0009_ON who.principal_id = what.grantee_principal_id_x000A_WHERE_x000A__x0009_what.permission_name IN_x000A__x0009_(_x000A__x0009_'Administer bulk operations',_x000A__x0009_'Alter any availability group',_x000A__x0009_'Alter any connection',_x000A__x0009_'Alter any credential',_x000A__x0009_'Alter any database',_x000A__x0009_'Alter any endpoint ',_x000A__x0009_'Alter any event notification ',_x000A__x0009_'Alter any event session ',_x000A__x0009_'Alter any linked server',_x000A__x0009_'Alter any login',_x000A__x0009_'Alter any server audit',_x000A__x0009_'Alter any server role',_x000A__x0009_'Alter resources',_x000A__x0009_'Alter server state ',_x000A__x0009_'Alter Settings ',_x000A__x0009_'Alter trace',_x000A__x0009_'Authenticate server ',_x000A__x0009_'Control server',_x000A__x0009_'Create any database ',_x000A__x0009_'Create availability group',_x000A__x0009_'Create DDL event notification',_x000A__x0009_'Create endpoint',_x000A__x0009_'Create server role',_x000A__x0009_'Create trace event notification',_x000A__x0009_'External access assembly',_x000A__x0009_'Shutdown',_x000A__x0009_'Unsafe Assembly',_x000A__x0009_'View any database',_x000A__x0009_'View any definition',_x000A__x0009_'View server state'_x000A__x0009_)_x000A_AND    who.name NOT LIKE '##MS%##'_x000A_AND    who.type_desc &lt;&gt; 'SERVER_ROLE'_x000A_ORDER BY_x000A__x0009_what.permission_name,_x000A__x0009_who.name_x000A_;_x000A_GO</S>
    </MS>
  </Obj>
  <Obj RefId="503">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2012</S>
      <S N="VulnID">V-41285</S>
      <S N="RuleID">SV-53767r4_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL2-00-004100</S>
      <S N="Title">SQL Server must enforce access control policies to restrict the View server state permission to only authorized roles.</S>
      <S N="Description">The concept of least privilege must be applied to SQL Server processes, ensuring that the processes operate at privilege levels no higher than necessary to accomplish required organizational missions and/or functions. Organizations consider the creation of additional processes, roles, and SQL Server accounts as necessary to achieve least privilege. Organizations also apply least privilege concepts to the design, development, implementation, and operations of SQL Server and the OS._x000A__x000A_Unauthorized access to sensitive data or SQL Server control may compromise the confidentiality of personnel privacy, threaten national security, compromise a variety of other sensitive operations or lead to a loss of system control. Access controls are best managed by defining requirements based on distinct job functions and assigning access based on the job function assigned to the individual user._x000A__x000A_SQL Server's 'View server state' permission is a high server-level privilege that must only granted to individual administration accounts through roles, and users who have access must require this privilege to accomplish the organizational missions and/or functions. If the 'View server state' permission is granted to roles that are unauthorized to have this privilege, then this access must be removed._x000A__x000A_Additionally, the permission must not be denied to a role, because that could disable a user's legitimate access via another role._x000A__x000A_The fix for this vulnerability specifies the use of REVOKE.  Be aware that revoking a permission that is currently denied to a role or user does not necessarily disable the permission.  If the user or role can inherent the permission from another role, revoking the denied permission from the user or the first role can effectively enable the inherited permission.tru</S>
      <S N="FixText">Remove the 'View server state' permission access from the role that is not authorized by executing the following query:_x000A__x000A__x000A_REVOKE View server state TO &lt;'role name'&gt;</S>
      <S N="Check">Obtain the list of roles that are authorized for the SQL Server 'View server state' permission and what 'Grant', 'Grant With', and/or 'Deny' privilege is authorized. Obtain the list of roles with that permission by running the following query:_x000A__x000A_SELECT _x000A_       who.name AS [Principal Name],_x000A_       who.type_desc AS [Principal Type],_x000A_       who.is_disabled AS [Principal Is Disabled],_x000A_       what.state_desc AS [Permission State],_x000A_       what.permission_name AS [Permission Name]_x000A_FROM _x000A_       sys.server_permissions what _x000A_       INNER JOIN sys.server_principals who_x000A_              ON who.principal_id = what.grantee_principal_id_x000A_WHERE_x000A_       what.permission_name = 'View server state' _x000A_AND    who.type_desc = 'SERVER_ROLE'_x000A_ORDER BY_x000A_       who.name_x000A_;_x000A_GO _x000A__x000A_If any role has 'Grant', 'With Grant' or 'Deny' privileges on this permission and users with that role are not authorized to have the permission, this is a finding._x000A__x000A_Alternatively, to provide a combined list for all requirements of this type:_x000A_SELECT _x000A__x0009_what.permission_name AS [Permission Name],_x000A__x0009_what.state_desc AS [Permission State],_x000A__x0009_who.name AS [Principal Name],_x000A__x0009_who.type_desc AS [Principal Type],_x000A__x0009_who.is_disabled AS [Principal Is Disabled]_x000A_FROM _x000A__x0009_sys.server_permissions what _x000A__x0009_INNER JOIN sys.server_principals who_x000A__x0009__x0009_ON who.principal_id = what.grantee_principal_id_x000A_WHERE_x000A__x0009_what.permission_name IN_x000A__x0009_(_x000A__x0009_'Administer bulk operations',_x000A__x0009_'Alter any availability group',_x000A__x0009_'Alter any connection',_x000A__x0009_'Alter any credential',_x000A__x0009_'Alter any database',_x000A__x0009_'Alter any endpoint ',_x000A__x0009_'Alter any event notification ',_x000A__x0009_'Alter any event session ',_x000A__x0009_'Alter any linked server',_x000A__x0009_'Alter any login',_x000A__x0009_'Alter any server audit',_x000A__x0009_'Alter any server role',_x000A__x0009_'Alter resources',_x000A__x0009_'Alter server state ',_x000A__x0009_'Alter Settings ',_x000A__x0009_'Alter trace',_x000A__x0009_'Authenticate server ',_x000A__x0009_'Control server',_x000A__x0009_'Create any database ',_x000A__x0009_'Create availability group',_x000A__x0009_'Create DDL event notification',_x000A__x0009_'Create endpoint',_x000A__x0009_'Create server role',_x000A__x0009_'Create trace event notification',_x000A__x0009_'External access assembly',_x000A__x0009_'Shutdown',_x000A__x0009_'Unsafe Assembly',_x000A__x0009_'View any database',_x000A__x0009_'View any definition',_x000A__x0009_'View server state'_x000A__x0009_)_x000A_AND_x0009_who.type_desc = 'SERVER_ROLE'_x000A_ORDER BY_x000A__x0009_what.permission_name,_x000A__x0009_who.name_x000A_;_x000A_GO</S>
    </MS>
  </Obj>
  <Obj RefId="504">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2012</S>
      <S N="VulnID">V-41286</S>
      <S N="RuleID">SV-53768r4_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL2-00-004000</S>
      <S N="Title">SQL Server must enforce access control policies to restrict the Alter trace permission to only authorized roles.</S>
      <S N="Description">The concept of least privilege must be applied to SQL Server processes, ensuring that the processes operate at privilege levels no higher than necessary to accomplish required organizational missions and/or functions. Organizations consider the creation of additional processes, roles, and SQL Server accounts as necessary to achieve least privilege. Organizations also apply least privilege concepts to the design, development, implementation, and operations of SQL Server and the OS._x000A__x000A_Unauthorized access to sensitive data or SQL Server control may compromise the confidentiality of personnel privacy, threaten national security, compromise a variety of other sensitive operations or lead to a loss of system control. Access controls are best managed by defining requirements based on distinct job functions and assigning access based on the job function assigned to the individual user._x000A__x000A_SQL Server's 'Alter trace' permission is a high server-level privilege that must only be granted to individual administration accounts through roles, and users who have access must require this privilege to accomplish the organizational missions and/or functions. If the 'Alter trace' permission is granted to roles that are unauthorized to have this privilege, then this access must be removed._x000A__x000A_Additionally, the permission must not be denied to a role, because that could disable a user's legitimate access via another role._x000A__x000A_The fix for this vulnerability specifies the use of REVOKE.  Be aware that revoking a permission that is currently denied to a role or user does not necessarily disable the permission.  If the user or role can inherent the permission from another role, revoking the denied permission from the user or the first role can effectively enable the inherited permission.tru</S>
      <S N="FixText">Remove the 'Alter trace' permission access from the role that is not authorized by executing the following query:_x000A__x000A__x000A_REVOKE Alter trace TO &lt;'role name'&gt;</S>
      <S N="Check">Obtain the list of roles that are authorized for the SQL Server 'Alter trace' permission and what 'Grant', 'Grant With', and/or 'Deny' privilege is authorized. Obtain the list of roles with that permission by running the following query:_x000A__x000A_SELECT _x000A_       who.name AS [Principal Name],_x000A_       who.type_desc AS [Principal Type],_x000A_       who.is_disabled AS [Principal Is Disabled],_x000A_       what.state_desc AS [Permission State],_x000A_       what.permission_name AS [Permission Name]_x000A_FROM _x000A_       sys.server_permissions what _x000A_       INNER JOIN sys.server_principals who_x000A_              ON who.principal_id = what.grantee_principal_id_x000A_WHERE_x000A_       what.permission_name = 'Alter trace' _x000A_AND    who.type_desc = 'SERVER_ROLE'_x000A_ORDER BY_x000A_       who.name_x000A_;_x000A_GO _x000A__x000A_If any role has 'Grant', 'With Grant' or 'Deny' privileges on this permission and users with that role are not authorized to have the permission, this is a finding._x000A__x000A_Alternatively, to provide a combined list for all requirements of this type:_x000A_SELECT _x000A__x0009_what.permission_name AS [Permission Name],_x000A__x0009_what.state_desc AS [Permission State],_x000A__x0009_who.name AS [Principal Name],_x000A__x0009_who.type_desc AS [Principal Type],_x000A__x0009_who.is_disabled AS [Principal Is Disabled]_x000A_FROM _x000A__x0009_sys.server_permissions what _x000A__x0009_INNER JOIN sys.server_principals who_x000A__x0009__x0009_ON who.principal_id = what.grantee_principal_id_x000A_WHERE_x000A__x0009_what.permission_name IN_x000A__x0009_(_x000A__x0009_'Administer bulk operations',_x000A__x0009_'Alter any availability group',_x000A__x0009_'Alter any connection',_x000A__x0009_'Alter any credential',_x000A__x0009_'Alter any database',_x000A__x0009_'Alter any endpoint ',_x000A__x0009_'Alter any event notification ',_x000A__x0009_'Alter any event session ',_x000A__x0009_'Alter any linked server',_x000A__x0009_'Alter any login',_x000A__x0009_'Alter any server audit',_x000A__x0009_'Alter any server role',_x000A__x0009_'Alter resources',_x000A__x0009_'Alter server state ',_x000A__x0009_'Alter Settings ',_x000A__x0009_'Alter trace',_x000A__x0009_'Authenticate server ',_x000A__x0009_'Control server',_x000A__x0009_'Create any database ',_x000A__x0009_'Create availability group',_x000A__x0009_'Create DDL event notification',_x000A__x0009_'Create endpoint',_x000A__x0009_'Create server role',_x000A__x0009_'Create trace event notification',_x000A__x0009_'External access assembly',_x000A__x0009_'Shutdown',_x000A__x0009_'Unsafe Assembly',_x000A__x0009_'View any database',_x000A__x0009_'View any definition',_x000A__x0009_'View server state'_x000A__x0009_)_x000A_AND_x0009_who.type_desc = 'SERVER_ROLE'_x000A_ORDER BY_x000A__x0009_what.permission_name,_x000A__x0009_who.name_x000A_;_x000A_GO</S>
    </MS>
  </Obj>
  <Obj RefId="505">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2012</S>
      <S N="VulnID">V-41287</S>
      <S N="RuleID">SV-53769r4_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL2-00-003900</S>
      <S N="Title">SQL Server must not grant users direct access to the Unsafe assembly permission.</S>
      <S N="Description">The concept of least privilege must be applied to SQL Server processes, ensuring that the processes operate at privilege levels no higher than necessary to accomplish required organizational missions and/or functions. Organizations consider the creation of additional processes, roles, and SQL Server accounts as necessary to achieve least privilege. Organizations also apply least privilege concepts to the design, development, implementation, and operations of SQL Server and the OS._x000A__x000A_Unauthorized access to sensitive data or SQL Server control may compromise the confidentiality of personnel privacy, threaten national security, compromise a variety of other sensitive operations or lead to a loss of system control. Access controls are best managed by defining requirements based on distinct job functions and assigning access based on the job function assigned to the individual user._x000A__x000A_Privileges granted outside of SQL Server's role-based account assignments are more likely to go unmanaged and without oversight of granted access. Maintenance of privileges using roles defined for discrete job functions offers improved oversight of application user privilege assignments and helps to protect against unauthorized privilege assignment._x000A__x000A_SQL Server's 'Unsafe assembly' permission is a high server-level privilege that must only be granted to individual administration accounts through roles. This administrative privilege must not be assigned directly to administrative user accounts (or any other user accounts). If any user accounts have direct access to administrative privileges, this access must be removed._x000A__x000A_Note that this does not apply to logins with names of the form '##MS...##'.  These accounts are internal-use system principals provisioned by the DBMS, and required by it for specific purposes.tru</S>
      <S N="FixText">Remove the 'Unsafe assembly' permission access from the account that has direct access by running the following script:_x000A__x000A__x000A_USE master_x000A__x000A_REVOKE UNSAFE ASSEMBLY TO &lt;'account name'&gt;_x000A__x000A_GO</S>
      <S N="Check">Obtain the list of accounts that have direct access to the server-level permission 'Unsafe assembly' by running the following query:_x000A__x000A_SELECT _x000A_       who.name AS [Principal Name],_x000A_       who.type_desc AS [Principal Type],_x000A_       who.is_disabled AS [Principal Is Disabled],_x000A_       what.state_desc AS [Permission State],_x000A_       what.permission_name AS [Permission Name]_x000A_FROM _x000A_       sys.server_permissions what _x000A_       INNER JOIN sys.server_principals who_x000A_              ON who.principal_id = what.grantee_principal_id_x000A_WHERE_x000A_       what.permission_name = 'Unsafe assembly'_x000A_AND    who.name NOT LIKE '##MS%##'_x000A_AND    who.type_desc &lt;&gt; 'SERVER_ROLE'_x000A_ORDER BY_x000A_       who.name_x000A_;_x000A_GO_x000A__x000A_If any user accounts have direct access to the 'Unsafe assembly' permission, this is a finding._x000A__x000A_Alternatively, to provide a combined list for all requirements of this type:_x000A_SELECT _x000A__x0009_what.permission_name AS [Permission Name],_x000A__x0009_what.state_desc AS [Permission State],_x000A__x0009_who.name AS [Principal Name],_x000A__x0009_who.type_desc AS [Principal Type],_x000A__x0009_who.is_disabled AS [Principal Is Disabled]_x000A_FROM _x000A__x0009_sys.server_permissions what _x000A__x0009_INNER JOIN sys.server_principals who_x000A__x0009__x0009_ON who.principal_id = what.grantee_principal_id_x000A_WHERE_x000A__x0009_what.permission_name IN_x000A__x0009_(_x000A__x0009_'Administer bulk operations',_x000A__x0009_'Alter any availability group',_x000A__x0009_'Alter any connection',_x000A__x0009_'Alter any credential',_x000A__x0009_'Alter any database',_x000A__x0009_'Alter any endpoint ',_x000A__x0009_'Alter any event notification ',_x000A__x0009_'Alter any event session ',_x000A__x0009_'Alter any linked server',_x000A__x0009_'Alter any login',_x000A__x0009_'Alter any server audit',_x000A__x0009_'Alter any server role',_x000A__x0009_'Alter resources',_x000A__x0009_'Alter server state ',_x000A__x0009_'Alter Settings ',_x000A__x0009_'Alter trace',_x000A__x0009_'Authenticate server ',_x000A__x0009_'Control server',_x000A__x0009_'Create any database ',_x000A__x0009_'Create availability group',_x000A__x0009_'Create DDL event notification',_x000A__x0009_'Create endpoint',_x000A__x0009_'Create server role',_x000A__x0009_'Create trace event notification',_x000A__x0009_'External access assembly',_x000A__x0009_'Shutdown',_x000A__x0009_'Unsafe Assembly',_x000A__x0009_'View any database',_x000A__x0009_'View any definition',_x000A__x0009_'View server state'_x000A__x0009_)_x000A_AND    who.name NOT LIKE '##MS%##'_x000A_AND    who.type_desc &lt;&gt; 'SERVER_ROLE'_x000A_ORDER BY_x000A__x0009_what.permission_name,_x000A__x0009_who.name_x000A_;_x000A_GO</S>
    </MS>
  </Obj>
  <Obj RefId="506">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2012</S>
      <S N="VulnID">V-41288</S>
      <S N="RuleID">SV-53770r4_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL2-00-003800</S>
      <S N="Title">SQL Server must enforce access control policies to restrict the Control server permission to only authorized roles.</S>
      <S N="Description">The concept of least privilege must be applied to SQL Server processes, ensuring that the processes operate at privilege levels no higher than necessary to accomplish required organizational missions and/or functions. Organizations consider the creation of additional processes, roles, and SQL Server accounts as necessary to achieve least privilege. Organizations also apply least privilege concepts to the design, development, implementation, and operations of SQL Server and the OS._x000A__x000A_Unauthorized access to sensitive data or SQL Server control may compromise the confidentiality of personnel privacy, threaten national security, compromise a variety of other sensitive operations or lead to a loss of system control. Access controls are best managed by defining requirements based on distinct job functions and assigning access based on the job function assigned to the individual user._x000A__x000A_SQL Server's 'Control server' permission is a high server-level privilege that must only be granted to individual administration accounts through roles, and users who have access must require this privilege to accomplish the organizational missions and/or functions. If the 'Control server' permission is granted to roles that are unauthorized to have this privilege, then this access must be removed._x000A__x000A_Additionally, the permission must not be denied to a role, because that could disable a user's legitimate access via another role._x000A__x000A_The fix for this vulnerability specifies the use of REVOKE.  Be aware that revoking a permission that is currently denied to a role or user does not necessarily disable the permission.  If the user or role can inherent the permission from another role, revoking the denied permission from the user or the first role can effectively enable the inherited permission.tru</S>
      <S N="FixText">Remove the 'Control server' permission access from the role that is not authorized by executing the following query:_x000A__x000A__x000A_REVOKE Control server TO &lt;'role name'&gt;</S>
      <S N="Check">Obtain the list of roles that are authorized for the SQL Server 'Control server' permission and what 'Grant', 'Grant With', and/or 'Deny' privilege is authorized. Obtain the list of roles with that permission by running the following query:_x000A__x000A_SELECT _x000A_       who.name AS [Principal Name],_x000A_       who.type_desc AS [Principal Type],_x000A_       who.is_disabled AS [Principal Is Disabled],_x000A_       what.state_desc AS [Permission State],_x000A_       what.permission_name AS [Permission Name]_x000A_FROM _x000A_       sys.server_permissions what _x000A_       INNER JOIN sys.server_principals who_x000A_              ON who.principal_id = what.grantee_principal_id_x000A_WHERE_x000A_       what.permission_name = 'Control server' _x000A_AND    who.type_desc = 'SERVER_ROLE'_x000A_ORDER BY_x000A_       who.name_x000A_;_x000A_GO _x000A__x000A_If any role has 'Grant', 'With Grant' or 'Deny' privileges on this permission and users with that role are not authorized to have the permission, this is a finding._x000A__x000A_Alternatively, to provide a combined list for all requirements of this type:_x000A_SELECT _x000A__x0009_what.permission_name AS [Permission Name],_x000A__x0009_what.state_desc AS [Permission State],_x000A__x0009_who.name AS [Principal Name],_x000A__x0009_who.type_desc AS [Principal Type],_x000A__x0009_who.is_disabled AS [Principal Is Disabled]_x000A_FROM _x000A__x0009_sys.server_permissions what _x000A__x0009_INNER JOIN sys.server_principals who_x000A__x0009__x0009_ON who.principal_id = what.grantee_principal_id_x000A_WHERE_x000A__x0009_what.permission_name IN_x000A__x0009_(_x000A__x0009_'Administer bulk operations',_x000A__x0009_'Alter any availability group',_x000A__x0009_'Alter any connection',_x000A__x0009_'Alter any credential',_x000A__x0009_'Alter any database',_x000A__x0009_'Alter any endpoint ',_x000A__x0009_'Alter any event notification ',_x000A__x0009_'Alter any event session ',_x000A__x0009_'Alter any linked server',_x000A__x0009_'Alter any login',_x000A__x0009_'Alter any server audit',_x000A__x0009_'Alter any server role',_x000A__x0009_'Alter resources',_x000A__x0009_'Alter server state ',_x000A__x0009_'Alter Settings ',_x000A__x0009_'Alter trace',_x000A__x0009_'Authenticate server ',_x000A__x0009_'Control server',_x000A__x0009_'Create any database ',_x000A__x0009_'Create availability group',_x000A__x0009_'Create DDL event notification',_x000A__x0009_'Create endpoint',_x000A__x0009_'Create server role',_x000A__x0009_'Create trace event notification',_x000A__x0009_'External access assembly',_x000A__x0009_'Shutdown',_x000A__x0009_'Unsafe Assembly',_x000A__x0009_'View any database',_x000A__x0009_'View any definition',_x000A__x0009_'View server state'_x000A__x0009_)_x000A_AND_x0009_who.type_desc = 'SERVER_ROLE'_x000A_ORDER BY_x000A__x0009_what.permission_name,_x000A__x0009_who.name_x000A_;_x000A_GO</S>
    </MS>
  </Obj>
  <Obj RefId="507">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2012</S>
      <S N="VulnID">V-41289</S>
      <S N="RuleID">SV-53771r4_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL2-00-003700</S>
      <S N="Title">SQL Server must not grant users direct access to the Create server role permission.</S>
      <S N="Description">The concept of least privilege must be applied to SQL Server processes, ensuring that the processes operate at privilege levels no higher than necessary to accomplish required organizational missions and/or functions. Organizations consider the creation of additional processes, roles, and SQL Server accounts as necessary to achieve least privilege. Organizations also apply least privilege concepts to the design, development, implementation, and operations of SQL Server and the OS._x000A__x000A_Unauthorized access to sensitive data or SQL Server control may compromise the confidentiality of personnel privacy, threaten national security, compromise a variety of other sensitive operations or lead to a loss of system control. Access controls are best managed by defining requirements based on distinct job functions and assigning access based on the job function assigned to the individual user._x000A__x000A_Privileges granted outside of SQL Server's role-based account assignments are more likely to go unmanaged and without oversight of granted access. Maintenance of privileges using roles defined for discrete job functions offers improved oversight of application user privilege assignments and helps to protect against unauthorized privilege assignment._x000A__x000A_SQL Server's 'Create server role' permission is a high server-level privilege that must only be granted to individual administration accounts through roles.  This administrative privilege must not be assigned directly to administrative user accounts (or any other user accounts). If any user accounts have direct access to administrative privileges, this access must be removed._x000A__x000A_Note that this does not apply to logins with names of the form '##MS...##'. These accounts are internal-use system principals provisioned by the DBMS, and required by it for specific purposes.tru</S>
      <S N="FixText">Remove the 'Create server role' permission access from the account that has direct access by running the following script:_x000A__x000A__x000A_USE master_x000A__x000A_REVOKE CREATE SERVER ROLE TO &lt;'account name'&gt;_x000A__x000A_GO</S>
      <S N="Check">Obtain the list of accounts that have direct access to the server-level permission 'Create server role' by running the following query:_x000A__x000A_SELECT _x000A_       who.name AS [Principal Name],_x000A_       who.type_desc AS [Principal Type],_x000A_       who.is_disabled AS [Principal Is Disabled],_x000A_       what.state_desc AS [Permission State],_x000A_       what.permission_name AS [Permission Name]_x000A_FROM _x000A_       sys.server_permissions what _x000A_       INNER JOIN sys.server_principals who_x000A_              ON who.principal_id = what.grantee_principal_id_x000A_WHERE_x000A_       what.permission_name = 'Create server role'_x000A_AND    who.name NOT LIKE '##MS%##'_x000A_AND    who.type_desc &lt;&gt; 'SERVER_ROLE'_x000A_ORDER BY_x000A_       who.name_x000A_;_x000A_GO_x000A__x000A_If any user accounts have direct access to the 'Create server role' permission, this is a finding._x000A__x000A_Alternatively, to provide a combined list for all requirements of this type:_x000A_SELECT _x000A__x0009_what.permission_name AS [Permission Name],_x000A__x0009_what.state_desc AS [Permission State],_x000A__x0009_who.name AS [Principal Name],_x000A__x0009_who.type_desc AS [Principal Type],_x000A__x0009_who.is_disabled AS [Principal Is Disabled]_x000A_FROM _x000A__x0009_sys.server_permissions what _x000A__x0009_INNER JOIN sys.server_principals who_x000A__x0009__x0009_ON who.principal_id = what.grantee_principal_id_x000A_WHERE_x000A__x0009_what.permission_name IN_x000A__x0009_(_x000A__x0009_'Administer bulk operations',_x000A__x0009_'Alter any availability group',_x000A__x0009_'Alter any connection',_x000A__x0009_'Alter any credential',_x000A__x0009_'Alter any database',_x000A__x0009_'Alter any endpoint ',_x000A__x0009_'Alter any event notification ',_x000A__x0009_'Alter any event session ',_x000A__x0009_'Alter any linked server',_x000A__x0009_'Alter any login',_x000A__x0009_'Alter any server audit',_x000A__x0009_'Alter any server role',_x000A__x0009_'Alter resources',_x000A__x0009_'Alter server state ',_x000A__x0009_'Alter Settings ',_x000A__x0009_'Alter trace',_x000A__x0009_'Authenticate server ',_x000A__x0009_'Control server',_x000A__x0009_'Create any database ',_x000A__x0009_'Create availability group',_x000A__x0009_'Create DDL event notification',_x000A__x0009_'Create endpoint',_x000A__x0009_'Create server role',_x000A__x0009_'Create trace event notification',_x000A__x0009_'External access assembly',_x000A__x0009_'Shutdown',_x000A__x0009_'Unsafe Assembly',_x000A__x0009_'View any database',_x000A__x0009_'View any definition',_x000A__x0009_'View server state'_x000A__x0009_)_x000A_AND    who.name NOT LIKE '##MS%##'_x000A_AND    who.type_desc &lt;&gt; 'SERVER_ROLE'_x000A_ORDER BY_x000A__x0009_what.permission_name,_x000A__x0009_who.name_x000A_;_x000A_GO</S>
    </MS>
  </Obj>
  <Obj RefId="508">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2012</S>
      <S N="VulnID">V-41290</S>
      <S N="RuleID">SV-53772r4_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL2-00-003600</S>
      <S N="Title">SQL Server must enforce access control policies to restrict the Alter any server role permission to only authorized roles.</S>
      <S N="Description">The concept of least privilege must be applied to SQL Server processes, ensuring that the processes operate at privilege levels no higher than necessary to accomplish required organizational missions and/or functions. Organizations consider the creation of additional processes, roles, and SQL Server accounts as necessary to achieve least privilege. Organizations also apply least privilege concepts to the design, development, implementation, and operations of SQL Server and the OS._x000A__x000A_Unauthorized access to sensitive data or SQL Server control may compromise the confidentiality of personnel privacy, threaten national security, compromise a variety of other sensitive operations, or lead to a loss of system control. Access controls are best managed by defining requirements based on distinct job functions and assigning access based on the job function assigned to the individual user._x000A__x000A_SQL Server's 'Alter any server role' permission is a high server-level privilege that must only be granted to individual administration accounts through roles. If the 'Alter any server role' permission is granted to roles that are unauthorized to have this privilege, then this access must be removed._x000A__x000A_Additionally, the permission must not be denied to a role, because that could disable a user's legitimate access via another role._x000A__x000A_The fix for this vulnerability specifies the use of REVOKE.  Be aware that revoking a permission that is currently denied to a role or user does not necessarily disable the permission.  If the user or role can inherent the permission from another role, revoking the denied permission from the user or the first role can effectively enable the inherited permission.tru</S>
      <S N="FixText">Remove the 'Alter any server role' permission access from the role that is not authorized by executing the following query:_x000A__x000A__x000A_REVOKE Alter any server role TO &lt;'role name'&gt;</S>
      <S N="Check">Obtain the list of roles that are authorized for the SQL Server 'Alter any server role' permission and what 'Grant', 'Grant With', and/or 'Deny' privilege is authorized. Obtain the list of roles with that permission by running the following query:_x000A__x000A_SELECT _x000A_       who.name AS [Principal Name],_x000A_       who.type_desc AS [Principal Type],_x000A_       who.is_disabled AS [Principal Is Disabled],_x000A_       what.state_desc AS [Permission State],_x000A_       what.permission_name AS [Permission Name]_x000A_FROM _x000A_       sys.server_permissions what _x000A_       INNER JOIN sys.server_principals who_x000A_              ON who.principal_id = what.grantee_principal_id_x000A_WHERE_x000A_       what.permission_name = 'Alter any server role'_x000A_AND    who.type_desc = 'SERVER_ROLE'_x000A_ORDER BY_x000A_       who.name_x000A_;_x000A_GO _x000A__x000A_If any role has 'Grant', 'With Grant' or 'Deny' privileges on this permission and users with that role are not authorized to have the permission, this is a finding._x000A__x000A_Alternatively, to provide a combined list for all requirements of this type:_x000A_SELECT _x000A__x0009_what.permission_name AS [Permission Name],_x000A__x0009_what.state_desc AS [Permission State],_x000A__x0009_who.name AS [Principal Name],_x000A__x0009_who.type_desc AS [Principal Type],_x000A__x0009_who.is_disabled AS [Principal Is Disabled]_x000A_FROM _x000A__x0009_sys.server_permissions what _x000A__x0009_INNER JOIN sys.server_principals who_x000A__x0009__x0009_ON who.principal_id = what.grantee_principal_id_x000A_WHERE_x000A__x0009_what.permission_name IN_x000A__x0009_(_x000A__x0009_'Administer bulk operations',_x000A__x0009_'Alter any availability group',_x000A__x0009_'Alter any connection',_x000A__x0009_'Alter any credential',_x000A__x0009_'Alter any database',_x000A__x0009_'Alter any endpoint ',_x000A__x0009_'Alter any event notification ',_x000A__x0009_'Alter any event session ',_x000A__x0009_'Alter any linked server',_x000A__x0009_'Alter any login',_x000A__x0009_'Alter any server audit',_x000A__x0009_'Alter any server role',_x000A__x0009_'Alter resources',_x000A__x0009_'Alter server state ',_x000A__x0009_'Alter Settings ',_x000A__x0009_'Alter trace',_x000A__x0009_'Authenticate server ',_x000A__x0009_'Control server',_x000A__x0009_'Create any database ',_x000A__x0009_'Create availability group',_x000A__x0009_'Create DDL event notification',_x000A__x0009_'Create endpoint',_x000A__x0009_'Create server role',_x000A__x0009_'Create trace event notification',_x000A__x0009_'External access assembly',_x000A__x0009_'Shutdown',_x000A__x0009_'Unsafe Assembly',_x000A__x0009_'View any database',_x000A__x0009_'View any definition',_x000A__x0009_'View server state'_x000A__x0009_)_x000A_AND_x0009_who.type_desc = 'SERVER_ROLE'_x000A_ORDER BY_x000A__x0009_what.permission_name,_x000A__x0009_who.name_x000A_;_x000A_GO</S>
    </MS>
  </Obj>
  <Obj RefId="509">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2012</S>
      <S N="VulnID">V-41291</S>
      <S N="RuleID">SV-53773r4_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL2-00-003500</S>
      <S N="Title">SQL Server must enforce access control policies to restrict the Alter Settings permission to only authorized roles.</S>
      <S N="Description">The concept of least privilege must be applied to SQL Server processes, ensuring that the processes operate at privilege levels no higher than necessary to accomplish required organizational missions and/or functions. Organizations consider the creation of additional processes, roles, and SQL Server accounts as necessary to achieve least privilege. Organizations also apply least privilege concepts to the design, development, implementation, and operations of SQL Server and the OS._x000A__x000A_Unauthorized access to sensitive data or SQL Server control may compromise the confidentiality of personnel privacy, threaten national security, compromise a variety of other sensitive operations or lead to a loss of system control. Access controls are best managed by defining requirements based on distinct job functions and assigning access based on the job function assigned to the individual user._x000A__x000A_SQL Server's 'Alter Settings' permission is a high server-level privilege that must only be granted to individual administration accounts through roles, and users who have access must require this privilege to accomplish the organizational missions and/or functions. If the 'Alter Settings' permission is granted to roles that are unauthorized to have this privilege, then this access must be removed._x000A__x000A_Additionally, the permission must not be denied to a role, because that could disable a user's legitimate access via another role._x000A__x000A_The fix for this vulnerability specifies the use of REVOKE.  Be aware that revoking a permission that is currently denied to a role or user does not necessarily disable the permission.  If the user or role can inherent the permission from another role, revoking the denied permission from the user or the first role can effectively enable the inherited permission.tru</S>
      <S N="FixText">Remove the 'Alter Settings' permission access from the role that is not authorized by executing the following query:_x000A__x000A__x000A_REVOKE Alter Settings TO &lt;'role name'&gt;</S>
      <S N="Check">Obtain the list of roles that are authorized for the SQL Server 'Alter Settings' permission and what 'Grant', 'Grant With', and/or 'Deny' privilege is authorized. Obtain the list of roles with that permission by running the following query:_x000A__x000A_SELECT _x000A_       who.name AS [Principal Name],_x000A_       who.type_desc AS [Principal Type],_x000A_       who.is_disabled AS [Principal Is Disabled],_x000A_       what.state_desc AS [Permission State],_x000A_       what.permission_name AS [Permission Name]_x000A_FROM _x000A_       sys.server_permissions what _x000A_       INNER JOIN sys.server_principals who_x000A_              ON who.principal_id = what.grantee_principal_id_x000A_WHERE_x000A_       what.permission_name = 'Alter Settings' _x000A_AND    who.type_desc = 'SERVER_ROLE'_x000A_ORDER BY_x000A_       who.name_x000A_;_x000A_GO _x000A__x000A_If any role has 'Grant', 'With Grant' or 'Deny' privileges on this permission and users with that role are not authorized to have the permission, this is a finding._x000A__x000A_Alternatively, to provide a combined list for all requirements of this type:_x000A_SELECT _x000A__x0009_what.permission_name AS [Permission Name],_x000A__x0009_what.state_desc AS [Permission State],_x000A__x0009_who.name AS [Principal Name],_x000A__x0009_who.type_desc AS [Principal Type],_x000A__x0009_who.is_disabled AS [Principal Is Disabled]_x000A_FROM _x000A__x0009_sys.server_permissions what _x000A__x0009_INNER JOIN sys.server_principals who_x000A__x0009__x0009_ON who.principal_id = what.grantee_principal_id_x000A_WHERE_x000A__x0009_what.permission_name IN_x000A__x0009_(_x000A__x0009_'Administer bulk operations',_x000A__x0009_'Alter any availability group',_x000A__x0009_'Alter any connection',_x000A__x0009_'Alter any credential',_x000A__x0009_'Alter any database',_x000A__x0009_'Alter any endpoint ',_x000A__x0009_'Alter any event notification ',_x000A__x0009_'Alter any event session ',_x000A__x0009_'Alter any linked server',_x000A__x0009_'Alter any login',_x000A__x0009_'Alter any server audit',_x000A__x0009_'Alter any server role',_x000A__x0009_'Alter resources',_x000A__x0009_'Alter server state ',_x000A__x0009_'Alter Settings ',_x000A__x0009_'Alter trace',_x000A__x0009_'Authenticate server ',_x000A__x0009_'Control server',_x000A__x0009_'Create any database ',_x000A__x0009_'Create availability group',_x000A__x0009_'Create DDL event notification',_x000A__x0009_'Create endpoint',_x000A__x0009_'Create server role',_x000A__x0009_'Create trace event notification',_x000A__x0009_'External access assembly',_x000A__x0009_'Shutdown',_x000A__x0009_'Unsafe Assembly',_x000A__x0009_'View any database',_x000A__x0009_'View any definition',_x000A__x0009_'View server state'_x000A__x0009_)_x000A_AND_x0009_who.type_desc = 'SERVER_ROLE'_x000A_ORDER BY_x000A__x0009_what.permission_name,_x000A__x0009_who.name_x000A_;_x000A_GO</S>
    </MS>
  </Obj>
  <Obj RefId="510">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2012</S>
      <S N="VulnID">V-41292</S>
      <S N="RuleID">SV-53774r4_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL2-00-003400</S>
      <S N="Title">SQL Server must enforce access control policies to restrict the Authenticate server permission to only authorized roles.</S>
      <S N="Description">The concept of least privilege must be applied to SQL Server processes, ensuring that the processes operate at privilege levels no higher than necessary to accomplish required organizational missions and/or functions. Organizations consider the creation of additional processes, roles, and SQL Server accounts as necessary to achieve least privilege. Organizations also apply least privilege concepts to the design, development, implementation, and operations of SQL Server and the OS._x000A__x000A_Unauthorized access to sensitive data or SQL Server control may compromise the confidentiality of personnel privacy, threaten national security, compromise a variety of other sensitive operations, or lead to a loss of system control. Access controls are best managed by defining requirements based on distinct job functions and assigning access based on the job function assigned to the individual user._x000A__x000A_SQL Server's 'Authenticate server' permission is a high server-level privilege that must only be granted to individual administration accounts through roles. If the 'Authenticate server' permission is granted to roles that are unauthorized to have this privilege, then this access must be removed._x000A__x000A_Additionally, the permission must not be denied to a role, because that could disable a user's legitimate access via another role._x000A__x000A_The fix for this vulnerability specifies the use of REVOKE.  Be aware that revoking a permission that is currently denied to a role or user does not necessarily disable the permission.  If the user or role can inherent the permission from another role, revoking the denied permission from the user or the first role can effectively enable the inherited permission.tru</S>
      <S N="FixText">Remove the 'Authenticate server' permission access from the role that is not authorized by executing the following query:_x000A__x000A__x000A_REVOKE Authenticate server TO &lt;'role name'&gt;</S>
      <S N="Check">Obtain the list of roles that are authorized for the SQL Server 'Authenticate server' permission and what 'Grant', 'Grant With', and/or 'Deny' privilege is authorized. Obtain the list of roles with that permission by running the following query:_x000A__x000A_SELECT _x000A_       who.name AS [Principal Name],_x000A_       who.type_desc AS [Principal Type],_x000A_       who.is_disabled AS [Principal Is Disabled],_x000A_       what.state_desc AS [Permission State],_x000A_       what.permission_name AS [Permission Name]_x000A_FROM _x000A_       sys.server_permissions what _x000A_       INNER JOIN sys.server_principals who_x000A_              ON who.principal_id = what.grantee_principal_id_x000A_WHERE_x000A_       what.permission_name = 'Authenticate server' _x000A_AND    who.type_desc = 'SERVER_ROLE'_x000A_ORDER BY_x000A_       who.name_x000A_;_x000A_GO _x000A__x000A_If any role has 'Grant', 'With Grant' or 'Deny' privileges on this permission and users with that role are not authorized to have the permission, this is a finding._x000A__x000A_Alternatively, to provide a combined list for all requirements of this type:_x000A_SELECT _x000A__x0009_what.permission_name AS [Permission Name],_x000A__x0009_what.state_desc AS [Permission State],_x000A__x0009_who.name AS [Principal Name],_x000A__x0009_who.type_desc AS [Principal Type],_x000A__x0009_who.is_disabled AS [Principal Is Disabled]_x000A_FROM _x000A__x0009_sys.server_permissions what _x000A__x0009_INNER JOIN sys.server_principals who_x000A__x0009__x0009_ON who.principal_id = what.grantee_principal_id_x000A_WHERE_x000A__x0009_what.permission_name IN_x000A__x0009_(_x000A__x0009_'Administer bulk operations',_x000A__x0009_'Alter any availability group',_x000A__x0009_'Alter any connection',_x000A__x0009_'Alter any credential',_x000A__x0009_'Alter any database',_x000A__x0009_'Alter any endpoint ',_x000A__x0009_'Alter any event notification ',_x000A__x0009_'Alter any event session ',_x000A__x0009_'Alter any linked server',_x000A__x0009_'Alter any login',_x000A__x0009_'Alter any server audit',_x000A__x0009_'Alter any server role',_x000A__x0009_'Alter resources',_x000A__x0009_'Alter server state ',_x000A__x0009_'Alter Settings ',_x000A__x0009_'Alter trace',_x000A__x0009_'Authenticate server ',_x000A__x0009_'Control server',_x000A__x0009_'Create any database ',_x000A__x0009_'Create availability group',_x000A__x0009_'Create DDL event notification',_x000A__x0009_'Create endpoint',_x000A__x0009_'Create server role',_x000A__x0009_'Create trace event notification',_x000A__x0009_'External access assembly',_x000A__x0009_'Shutdown',_x000A__x0009_'Unsafe Assembly',_x000A__x0009_'View any database',_x000A__x0009_'View any definition',_x000A__x0009_'View server state'_x000A__x0009_)_x000A_AND_x0009_who.type_desc = 'SERVER_ROLE'_x000A_ORDER BY_x000A__x0009_what.permission_name,_x000A__x0009_who.name_x000A_;_x000A_GO</S>
    </MS>
  </Obj>
  <Obj RefId="511">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2012</S>
      <S N="VulnID">V-41293</S>
      <S N="RuleID">SV-53775r4_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL2-00-003300</S>
      <S N="Title">SQL Server must enforce access control policies to restrict the Create any database permission to only authorized roles.</S>
      <S N="Description">The concept of least privilege must be applied to SQL Server processes, ensuring that the processes operate at privilege levels no higher than necessary to accomplish required organizational missions and/or functions. Organizations consider the creation of additional processes, roles, and SQL Server accounts as necessary to achieve least privilege. Organizations also apply least privilege concepts to the design, development, implementation, and operations of SQL Server and the OS._x000A__x000A_Unauthorized access to sensitive data or SQL Server control may compromise the confidentiality of personnel privacy, threaten national security, compromise a variety of other sensitive operations or lead to a loss of system control. Access controls are best managed by defining requirements based on distinct job functions and assigning access based on the job function assigned to the individual user._x000A__x000A_SQL Server's 'Create any database' permission is a high server-level privilege that must only be granted to individual administration accounts through roles, and users who have access must require this privilege to accomplish the organizational missions and/or functions. If the 'Create any database' permission is granted to roles that are unauthorized to have this privilege, then this access must be removed._x000A__x000A_Additionally, the permission must not be denied to a role, because that could disable a user's legitimate access via another role._x000A__x000A_The fix for this vulnerability specifies the use of REVOKE.  Be aware that revoking a permission that is currently denied to a role or user does not necessarily disable the permission.  If the user or role can inherent the permission from another role, revoking the denied permission from the user or the first role can effectively enable the inherited permission.tru</S>
      <S N="FixText">Remove the 'Create any database' permission access from the role that is not authorized by executing the following query:_x000A__x000A__x000A_REVOKE Create any database TO &lt;'role name'&gt;</S>
      <S N="Check">Obtain the list of roles that are authorized for the SQL Server 'Create any database' permission and what 'Grant', 'Grant With', and/or 'Deny' privilege is authorized. Obtain the list of roles with that permission by running the following query:_x000A__x000A_SELECT _x000A_       who.name AS [Principal Name],_x000A_       who.type_desc AS [Principal Type],_x000A_       who.is_disabled AS [Principal Is Disabled],_x000A_       what.state_desc AS [Permission State],_x000A_       what.permission_name AS [Permission Name]_x000A_FROM _x000A_       sys.server_permissions what _x000A_       INNER JOIN sys.server_principals who_x000A_              ON who.principal_id = what.grantee_principal_id_x000A_WHERE_x000A_       what.permission_name = 'Create any database' _x000A_AND    who.type_desc = 'SERVER_ROLE'_x000A_ORDER BY_x000A_       who.name_x000A_;_x000A_GO _x000A__x000A_If any role has 'Grant', 'With Grant' or 'Deny' privileges on this permission and users with that role are not authorized to have the permission, this is a finding._x000A__x000A_Alternatively, to provide a combined list for all requirements of this type:_x000A_SELECT _x000A__x0009_what.permission_name AS [Permission Name],_x000A__x0009_what.state_desc AS [Permission State],_x000A__x0009_who.name AS [Principal Name],_x000A__x0009_who.type_desc AS [Principal Type],_x000A__x0009_who.is_disabled AS [Principal Is Disabled]_x000A_FROM _x000A__x0009_sys.server_permissions what _x000A__x0009_INNER JOIN sys.server_principals who_x000A__x0009__x0009_ON who.principal_id = what.grantee_principal_id_x000A_WHERE_x000A__x0009_what.permission_name IN_x000A__x0009_(_x000A__x0009_'Administer bulk operations',_x000A__x0009_'Alter any availability group',_x000A__x0009_'Alter any connection',_x000A__x0009_'Alter any credential',_x000A__x0009_'Alter any database',_x000A__x0009_'Alter any endpoint ',_x000A__x0009_'Alter any event notification ',_x000A__x0009_'Alter any event session ',_x000A__x0009_'Alter any linked server',_x000A__x0009_'Alter any login',_x000A__x0009_'Alter any server audit',_x000A__x0009_'Alter any server role',_x000A__x0009_'Alter resources',_x000A__x0009_'Alter server state ',_x000A__x0009_'Alter Settings ',_x000A__x0009_'Alter trace',_x000A__x0009_'Authenticate server ',_x000A__x0009_'Control server',_x000A__x0009_'Create any database ',_x000A__x0009_'Create availability group',_x000A__x0009_'Create DDL event notification',_x000A__x0009_'Create endpoint',_x000A__x0009_'Create server role',_x000A__x0009_'Create trace event notification',_x000A__x0009_'External access assembly',_x000A__x0009_'Shutdown',_x000A__x0009_'Unsafe Assembly',_x000A__x0009_'View any database',_x000A__x0009_'View any definition',_x000A__x0009_'View server state'_x000A__x0009_)_x000A_AND_x0009_who.type_desc = 'SERVER_ROLE'_x000A_ORDER BY_x000A__x0009_what.permission_name,_x000A__x0009_who.name_x000A_;_x000A_GO</S>
    </MS>
  </Obj>
  <Obj RefId="512">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2012</S>
      <S N="VulnID">V-41294</S>
      <S N="RuleID">SV-53776r6_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL2-00-003200</S>
      <S N="Title">SQL Server must not grant users direct access to the View server state permission.</S>
      <S N="Description">The concept of least privilege must be applied to SQL Server processes, ensuring that the processes operate at privilege levels no higher than necessary to accomplish required organizational missions and/or functions. Organizations consider the creation of additional processes, roles, and SQL Server accounts as necessary to achieve least privilege. Organizations also apply least privilege concepts to the design, development, implementation, and operations of SQL Server and the OS._x000A__x000A_Unauthorized access to sensitive data or SQL Server control may compromise the confidentiality of personnel privacy, threaten national security, compromise a variety of other sensitive operations or lead to a loss of system control. Access controls are best managed by defining requirements based on distinct job functions and assigning access based on the job function assigned to the individual user._x000A__x000A_Privileges granted outside of SQL Server's role-based account assignments are more likely to go unmanaged and without oversight of granted access. Maintenance of privileges using roles defined for discrete job functions offers improved oversight of application user privilege assignments and helps to protect against unauthorized privilege assignment._x000A__x000A_SQL Server's 'View server state' permission is a high server-level privilege that must only be granted to individual administration accounts through roles. This administrative privilege must not be assigned directly to administrative user accounts (or any other user accounts). If any user accounts have direct access to administrative privileges, this access must be removed._x000A__x000A_Note that this does not apply to logins with names of the form '##MS...##'.  These accounts are internal-use system principals provisioned by the DBMS, and required by it for specific purposes.tru</S>
      <S N="FixText">Document any necessary exceptions, and obtain the appropriate approval._x000A__x000A_Remove the 'View server state' permission access from an account that has direct access by running the following script:_x000A__x000A_USE master;_x000A_REVOKE VIEW SERVER STATE TO &lt;'account name'&gt;;_x000A_GO</S>
      <S N="Check">Obtain the list of accounts that have direct access to the server-level permission 'View server state' by running the following query:_x000A__x000A_SELECT _x000A_       who.name AS [Principal Name],_x000A_       who.type_desc AS [Principal Type],_x000A_       who.is_disabled AS [Principal Is Disabled],_x000A_       what.state_desc AS [Permission State],_x000A_       what.permission_name AS [Permission Name]_x000A_FROM _x000A_       sys.server_permissions what _x000A_       INNER JOIN sys.server_principals who_x000A_              ON who.principal_id = what.grantee_principal_id_x000A_WHERE_x000A_       what.permission_name = 'View server state'_x000A_AND    who.name NOT LIKE '##MS%##'_x000A_AND    who.type_desc &lt;&gt; 'SERVER_ROLE'_x000A_ORDER BY_x000A_       who.name_x000A_;_x000A_GO_x000A__x000A_If any user account has direct access to the 'View server state' permission, and the need for this has not been documented and approved, this is a finding._x000A__x000A_Alternatively, to provide a combined list for all requirements of this type:_x000A_SELECT _x000A__x0009_what.permission_name AS [Permission Name],_x000A__x0009_what.state_desc AS [Permission State],_x000A__x0009_who.name AS [Principal Name],_x000A__x0009_who.type_desc AS [Principal Type],_x000A__x0009_who.is_disabled AS [Principal Is Disabled]_x000A_FROM _x000A__x0009_sys.server_permissions what _x000A__x0009_INNER JOIN sys.server_principals who_x000A__x0009__x0009_ON who.principal_id = what.grantee_principal_id_x000A_WHERE_x000A__x0009_what.permission_name IN_x000A__x0009_(_x000A__x0009_'Administer bulk operations',_x000A__x0009_'Alter any availability group',_x000A__x0009_'Alter any connection',_x000A__x0009_'Alter any credential',_x000A__x0009_'Alter any database',_x000A__x0009_'Alter any endpoint ',_x000A__x0009_'Alter any event notification ',_x000A__x0009_'Alter any event session ',_x000A__x0009_'Alter any linked server',_x000A__x0009_'Alter any login',_x000A__x0009_'Alter any server audit',_x000A__x0009_'Alter any server role',_x000A__x0009_'Alter resources',_x000A__x0009_'Alter server state ',_x000A__x0009_'Alter Settings ',_x000A__x0009_'Alter trace',_x000A__x0009_'Authenticate server ',_x000A__x0009_'Control server',_x000A__x0009_'Create any database ',_x000A__x0009_'Create availability group',_x000A__x0009_'Create DDL event notification',_x000A__x0009_'Create endpoint',_x000A__x0009_'Create server role',_x000A__x0009_'Create trace event notification',_x000A__x0009_'External access assembly',_x000A__x0009_'Shutdown',_x000A__x0009_'Unsafe Assembly',_x000A__x0009_'View any database',_x000A__x0009_'View any definition',_x000A__x0009_'View server state'_x000A__x0009_)_x000A_AND    who.name NOT LIKE '##MS%##'_x000A_AND    who.type_desc &lt;&gt; 'SERVER_ROLE'_x000A_ORDER BY_x000A__x0009_what.permission_name,_x000A__x0009_who.name_x000A_;_x000A_GO</S>
    </MS>
  </Obj>
  <Obj RefId="513">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2012</S>
      <S N="VulnID">V-41295</S>
      <S N="RuleID">SV-53777r4_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL2-00-003100</S>
      <S N="Title">SQL Server must not grant users direct access to the Alter any server role permission.</S>
      <S N="Description">The concept of least privilege must be applied to SQL Server processes, ensuring that the processes operate at privilege levels no higher than necessary to accomplish required organizational missions and/or functions. Organizations consider the creation of additional processes, roles, and SQL Server accounts as necessary to achieve least privilege. Organizations also apply least privilege concepts to the design, development, implementation, and operations of SQL Server and the OS._x000A__x000A_Unauthorized access to sensitive data or SQL Server control may compromise the confidentiality of personnel privacy, threaten national security, compromise a variety of other sensitive operations or lead to a loss of system control. Access controls are best managed by defining requirements based on distinct job functions and assigning access based on the job function assigned to the individual user._x000A__x000A_Privileges granted outside of SQL Server's role-based account assignments are more likely to go unmanaged and without oversight of granted access. Maintenance of privileges using roles defined for discrete job functions offers improved oversight of application user privilege assignments and helps to protect against unauthorized privilege assignment._x000A__x000A_SQL Server's 'Alter any server role' permission is a high server-level privilege that must only be granted to individual administration accounts through roles. This administrative privilege must not be assigned directly to administrative user accounts (or any other user accounts). If any user accounts have direct access to administrative privileges, this access must be removed._x000A__x000A_Note that this does not apply to logins with names of the form '##MS...##'.  These accounts are internal-use system principals provisioned by the DBMS, and required by it for specific purposes.tru</S>
      <S N="FixText">Remove the 'Alter any server role' permission access from the account that has direct access by running the following script:_x000A__x000A__x000A_USE master_x000A__x000A_REVOKE ALTER ANY SERVER ROLE TO &lt;'account name'&gt;_x000A__x000A_GO</S>
      <S N="Check">Obtain the list of accounts that have direct access to the server-level permission 'Alter any server role' by running the following query:_x000A__x000A_SELECT _x000A_       who.name AS [Principal Name],_x000A_       who.type_desc AS [Principal Type],_x000A_       who.is_disabled AS [Principal Is Disabled],_x000A_       what.state_desc AS [Permission State],_x000A_       what.permission_name AS [Permission Name]_x000A_FROM _x000A_       sys.server_permissions what _x000A_       INNER JOIN sys.server_principals who_x000A_              ON who.principal_id = what.grantee_principal_id_x000A_WHERE_x000A_       what.permission_name = 'Alter any server role'_x000A_AND    who.name NOT LIKE '##MS%##'_x000A_AND    who.type_desc &lt;&gt; 'SERVER_ROLE'_x000A_ORDER BY_x000A_       who.name_x000A_;_x000A_GO_x000A__x000A_If any user accounts have direct access to the 'Alter any server role' permission, this is a finding._x000A__x000A_Alternatively, to provide a combined list for all requirements of this type:_x000A_SELECT _x000A__x0009_what.permission_name AS [Permission Name],_x000A__x0009_what.state_desc AS [Permission State],_x000A__x0009_who.name AS [Principal Name],_x000A__x0009_who.type_desc AS [Principal Type],_x000A__x0009_who.is_disabled AS [Principal Is Disabled]_x000A_FROM _x000A__x0009_sys.server_permissions what _x000A__x0009_INNER JOIN sys.server_principals who_x000A__x0009__x0009_ON who.principal_id = what.grantee_principal_id_x000A_WHERE_x000A__x0009_what.permission_name IN_x000A__x0009_(_x000A__x0009_'Administer bulk operations',_x000A__x0009_'Alter any availability group',_x000A__x0009_'Alter any connection',_x000A__x0009_'Alter any credential',_x000A__x0009_'Alter any database',_x000A__x0009_'Alter any endpoint ',_x000A__x0009_'Alter any event notification ',_x000A__x0009_'Alter any event session ',_x000A__x0009_'Alter any linked server',_x000A__x0009_'Alter any login',_x000A__x0009_'Alter any server audit',_x000A__x0009_'Alter any server role',_x000A__x0009_'Alter resources',_x000A__x0009_'Alter server state ',_x000A__x0009_'Alter Settings ',_x000A__x0009_'Alter trace',_x000A__x0009_'Authenticate server ',_x000A__x0009_'Control server',_x000A__x0009_'Create any database ',_x000A__x0009_'Create availability group',_x000A__x0009_'Create DDL event notification',_x000A__x0009_'Create endpoint',_x000A__x0009_'Create server role',_x000A__x0009_'Create trace event notification',_x000A__x0009_'External access assembly',_x000A__x0009_'Shutdown',_x000A__x0009_'Unsafe Assembly',_x000A__x0009_'View any database',_x000A__x0009_'View any definition',_x000A__x0009_'View server state'_x000A__x0009_)_x000A_AND    who.name NOT LIKE '##MS%##'_x000A_AND    who.type_desc &lt;&gt; 'SERVER_ROLE'_x000A_ORDER BY_x000A__x0009_what.permission_name,_x000A__x0009_who.name_x000A_;_x000A_GO</S>
    </MS>
  </Obj>
  <Obj RefId="514">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2012</S>
      <S N="VulnID">V-41296</S>
      <S N="RuleID">SV-53778r5_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL2-00-003000</S>
      <S N="Title">SQL Server must not grant users direct access to the View any definition permission.</S>
      <S N="Description">The concept of least privilege must be applied to SQL Server processes, ensuring that the processes operate at privilege levels no higher than necessary to accomplish required organizational missions and/or functions. Organizations consider the creation of additional processes, roles, and SQL Server accounts as necessary to achieve least privilege. Organizations also apply least privilege concepts to the design, development, implementation, and operations of SQL Server and the OS._x000A__x000A_Unauthorized access to sensitive data or SQL Server control may compromise the confidentiality of personnel privacy, threaten national security, compromise a variety of other sensitive operations or lead to a loss of system control. Access controls are best managed by defining requirements based on distinct job functions and assigning access based on the job function assigned to the individual user._x000A__x000A_Privileges granted outside of SQL Server's role-based account assignments are more likely to go unmanaged and without oversight of granted access. Maintenance of privileges using roles defined for discrete job functions offers improved oversight of application user privilege assignments and helps to protect against unauthorized privilege assignment._x000A__x000A_SQL Server's 'View any definition' permission is a high server-level privilege that must only be granted to individual administration accounts through roles. This administrative privilege must not be assigned directly to administrative user accounts (or any other user accounts). If any user accounts have direct access to administrative privileges, this access must be removed._x000A__x000A_Note that this does not apply to logins with names of the form '##MS...##'.  These accounts are internal-use system principals provisioned by the DBMS, and required by it for specific purposes.tru</S>
      <S N="FixText">Remove the 'View any definition' permission access from the account that has direct access by running the following script:_x000A__x000A__x000A_USE master_x000A__x000A_REVOKE VIEW ANY DEFINITION TO &lt;'account name'&gt;_x000A__x000A_GO</S>
      <S N="Check">Obtain the list of accounts that have direct access to the server-level permission 'View any definition' by running the following query:_x000A__x000A_SELECT _x000A_       who.name AS [Principal Name],_x000A_       who.type_desc AS [Principal Type],_x000A_       who.is_disabled AS [Principal Is Disabled],_x000A_       what.state_desc AS [Permission State],_x000A_       what.permission_name AS [Permission Name]_x000A_FROM _x000A_       sys.server_permissions what _x000A_       INNER JOIN sys.server_principals who_x000A_              ON who.principal_id = what.grantee_principal_id_x000A_WHERE_x000A_       what.permission_name = 'View any definition'_x000A_AND    who.name NOT LIKE '##MS%##'_x000A_AND    who.type_desc &lt;&gt; 'SERVER_ROLE'_x000A_ORDER BY_x000A_       who.name_x000A_;_x000A_GO_x000A__x000A_If any user accounts have direct access to the 'View any definition' permission, this is a finding._x000A__x000A_Alternatively, to provide a combined list for all requirements of this type:_x000A_SELECT _x000A__x0009_what.permission_name AS [Permission Name],_x000A__x0009_what.state_desc AS [Permission State],_x000A__x0009_who.name AS [Principal Name],_x000A__x0009_who.type_desc AS [Principal Type],_x000A__x0009_who.is_disabled AS [Principal Is Disabled]_x000A_FROM _x000A__x0009_sys.server_permissions what _x000A__x0009_INNER JOIN sys.server_principals who_x000A__x0009__x0009_ON who.principal_id = what.grantee_principal_id_x000A_WHERE_x000A__x0009_what.permission_name IN_x000A__x0009_(_x000A__x0009_'Administer bulk operations',_x000A__x0009_'Alter any availability group',_x000A__x0009_'Alter any connection',_x000A__x0009_'Alter any credential',_x000A__x0009_'Alter any database',_x000A__x0009_'Alter any endpoint ',_x000A__x0009_'Alter any event notification ',_x000A__x0009_'Alter any event session ',_x000A__x0009_'Alter any linked server',_x000A__x0009_'Alter any login',_x000A__x0009_'Alter any server audit',_x000A__x0009_'Alter any server role',_x000A__x0009_'Alter resources',_x000A__x0009_'Alter server state ',_x000A__x0009_'Alter Settings ',_x000A__x0009_'Alter trace',_x000A__x0009_'Authenticate server ',_x000A__x0009_'Control server',_x000A__x0009_'Create any database ',_x000A__x0009_'Create availability group',_x000A__x0009_'Create DDL event notification',_x000A__x0009_'Create endpoint',_x000A__x0009_'Create server role',_x000A__x0009_'Create trace event notification',_x000A__x0009_'External access assembly',_x000A__x0009_'Shutdown',_x000A__x0009_'Unsafe Assembly',_x000A__x0009_'View any database',_x000A__x0009_'View any definition',_x000A__x0009_'View server state'_x000A__x0009_)_x000A_AND    who.name NOT LIKE '##MS%##'_x000A_AND    who.type_desc &lt;&gt; 'SERVER_ROLE'_x000A_ORDER BY_x000A__x0009_what.permission_name,_x000A__x0009_who.name_x000A_;_x000A_GO</S>
    </MS>
  </Obj>
  <Obj RefId="515">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2012</S>
      <S N="VulnID">V-41297</S>
      <S N="RuleID">SV-53779r3_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL2-00-002900</S>
      <S N="Title">SQL Server must enforce access control policies to restrict the Alter any connection permission to only authorized roles.</S>
      <S N="Description">The concept of least privilege must be applied to SQL Server processes, ensuring that the processes operate at privilege levels no higher than necessary to accomplish required organizational missions and/or functions. Organizations consider the creation of additional processes, roles, and SQL Server accounts as necessary to achieve least privilege. Organizations also apply least privilege concepts to the design, development, implementation, and operations of SQL Server and the OS._x000A__x000A_Unauthorized access to sensitive data or SQL Server control may compromise the confidentiality of personnel privacy, threaten national security, compromise a variety of other sensitive operations, or lead to a loss of system control. Access controls are best managed by defining requirements based on distinct job functions and assigning access based on the job function assigned to the individual user._x000A__x000A_SQL Server's 'Alter any connection' permission is a high server-level privilege that must only be granted to individual administration accounts through roles. If the 'Alter any connection' permission is granted to roles that are unauthorized to have this privilege, then this access must be removed._x000A__x000A_Additionally, the permission must not be denied to a role, because that could disable a user's legitimate access via another role._x000A__x000A_The fix for this vulnerability specifies the use of REVOKE.  Be aware that revoking a permission that is currently denied to a role or user does not necessarily disable the permission.  If the user or role can inherent the permission from another role, revoking the denied permission from the user or the first role can effectively enable the inherited permission.tru</S>
      <S N="FixText">Remove the 'Alter any connection' permission access from the role that is not authorized by executing the following query:_x000A__x000A__x000A_REVOKE Alter any connection  TO &lt;'role name'&gt;</S>
      <S N="Check">Obtain the list of roles that are authorized for the SQL Server 'Alter any connection' permission and what 'Grant', 'Grant With', and/or 'Deny' privilege is authorized. Obtain the list of roles with that permission by running the following query:_x000A__x000A_SELECT _x000A_       who.name AS [Principal Name],_x000A_       who.type_desc AS [Principal Type],_x000A_       who.is_disabled AS [Principal Is Disabled],_x000A_       what.state_desc AS [Permission State],_x000A_       what.permission_name AS [Permission Name]_x000A_FROM _x000A_       sys.server_permissions what _x000A_       INNER JOIN sys.server_principals who_x000A_              ON who.principal_id = what.grantee_principal_id_x000A_WHERE_x000A_       what.permission_name = 'Alter any connection' _x000A_AND    who.type_desc = 'SERVER_ROLE'_x000A_ORDER BY_x000A_       who.name_x000A_;_x000A_GO _x000A__x000A_If any role has 'Grant', 'With Grant' or 'Deny' privileges on this permission and users with that role are not authorized to have the permission, this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="516">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2012</S>
      <S N="VulnID">V-41298</S>
      <S N="RuleID">SV-53780r3_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL2-00-002800</S>
      <S N="Title">SQL Server must enforce access control policies to restrict the Alter any credential permission to only authorized roles.</S>
      <S N="Description">The concept of least privilege must be applied to SQL Server processes, ensuring that the processes operate at privilege levels no higher than necessary to accomplish required organizational missions and/or functions. Organizations consider the creation of additional processes, roles, and SQL Server accounts as necessary to achieve least privilege. Organizations also apply least privilege concepts to the design, development, implementation, and operations of SQL Server and the OS._x000A__x000A_Unauthorized access to sensitive data or SQL Server control may compromise the confidentiality of personnel privacy, threaten national security, compromise a variety of other sensitive operations, or lead to a loss of system control. Access controls are best managed by defining requirements based on distinct job functions and assigning access based on the job function assigned to the individual user._x000A__x000A_SQL Server's 'Alter any credential' permission is a high server-level privilege that must only be granted to individual administration accounts through roles. If the 'Alter any credential' permission is granted to roles that are unauthorized to have this privilege, then this access must be removed._x000A__x000A_Additionally, the permission must not be denied to a role, because that could disable a user's legitimate access via another role._x000A__x000A_The fix for this vulnerability specifies the use of REVOKE.  Be aware that revoking a permission that is currently denied to a role or user does not necessarily disable the permission.  If the user or role can inherent the permission from another role, revoking the denied permission from the user or the first role can effectively enable the inherited permission.tru</S>
      <S N="FixText">Remove the 'Alter any credential' permission access from the role that is not authorized by executing the following query:_x000A__x000A__x000A_REVOKE Alter any credential TO &lt;'role name'&gt;</S>
      <S N="Check">Obtain the list of roles that are authorized for the SQL Server 'Alter any credential' permission and what 'Grant', 'Grant With', and/or 'Deny' privilege is authorized. Obtain the list of roles with that permission by running the following query:_x000A__x000A_SELECT _x000A_       who.name AS [Principal Name],_x000A_       who.type_desc AS [Principal Type],_x000A_       who.is_disabled AS [Principal Is Disabled],_x000A_       what.state_desc AS [Permission State],_x000A_       what.permission_name AS [Permission Name]_x000A_FROM _x000A_       sys.server_permissions what _x000A_       INNER JOIN sys.server_principals who_x000A_              ON who.principal_id = what.grantee_principal_id_x000A_WHERE_x000A_       what.permission_name = 'Alter any credential' _x000A_AND    who.type_desc = 'SERVER_ROLE'_x000A_ORDER BY_x000A_       who.name_x000A_;_x000A_GO _x000A__x000A_If any role has 'Grant', 'With Grant' or 'Deny' privileges on this permission and users with that role are not authorized to have the permission, this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="517">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2012</S>
      <S N="VulnID">V-41299</S>
      <S N="RuleID">SV-53781r3_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL2-00-002700</S>
      <S N="Title">SQL Server must enforce access control policies to restrict the Alter any database permission to only authorized roles.</S>
      <S N="Description">The concept of least privilege must be applied to SQL Server processes, ensuring that the processes operate at privilege levels no higher than necessary to accomplish required organizational missions and/or functions. Organizations consider the creation of additional processes, roles, and SQL Server accounts as necessary to achieve least privilege. Organizations also apply least privilege concepts to the design, development, implementation, and operations of SQL Server and the OS._x000A__x000A_Unauthorized access to sensitive data or SQL Server control may compromise the confidentiality of personnel privacy, threaten national security, compromise a variety of other sensitive operations, or lead to a loss of system control. Access controls are best managed by defining requirements based on distinct job functions and assigning access based on the job function assigned to the individual user._x000A__x000A_SQL Server's 'Alter any database' permission is a high server-level privilege that must only be granted to individual administration accounts through roles If the 'Alter any database' permission is granted to roles that are unauthorized to have this privilege, then this access must be removed._x000A__x000A_Additionally, the permission must not be denied to a role, because that could disable a user's legitimate access via another role._x000A__x000A_The fix for this vulnerability specifies the use of REVOKE.  Be aware that revoking a permission that is currently denied to a role or user does not necessarily disable the permission.  If the user or role can inherent the permission from another role, revoking the denied permission from the user or the first role can effectively enable the inherited permission.tru</S>
      <S N="FixText">Remove the 'Alter any database' permission access from the role that is not authorized by executing the following query:_x000A__x000A__x000A_REVOKE Alter any database TO &lt;'role name'&gt;</S>
      <S N="Check">Obtain the list of roles that are authorized for the SQL Server 'Alter any database' permission and what 'Grant', 'Grant With', and/or 'Deny' privilege is authorized. Obtain the list of roles with that permission by running the following query:_x000A__x000A_SELECT _x000A_       who.name AS [Principal Name],_x000A_       who.type_desc AS [Principal Type],_x000A_       who.is_disabled AS [Principal Is Disabled],_x000A_       what.state_desc AS [Permission State],_x000A_       what.permission_name AS [Permission Name]_x000A_FROM _x000A_       sys.server_permissions what _x000A_       INNER JOIN sys.server_principals who_x000A_              ON who.principal_id = what.grantee_principal_id_x000A_WHERE_x000A_       what.permission_name = 'Alter any database' _x000A_AND    who.type_desc = 'SERVER_ROLE'_x000A_ORDER BY_x000A_       who.name_x000A_;_x000A_GO _x000A__x000A_If any role has 'Grant', 'With Grant' or 'Deny' privileges on this permission and users with that role are not authorized to have the permission, this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="518">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2012</S>
      <S N="VulnID">V-41300</S>
      <S N="RuleID">SV-53782r3_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL2-00-002600</S>
      <S N="Title">SQL Server must enforce access control policies to restrict the Alter any endpoint permission to only authorized roles.</S>
      <S N="Description">The concept of least privilege must be applied to SQL Server processes, ensuring that the processes operate at privilege levels no higher than necessary to accomplish required organizational missions and/or functions. Organizations consider the creation of additional processes, roles, and SQL Server accounts as necessary to achieve least privilege. Organizations also apply least privilege concepts to the design, development, implementation, and operations of SQL Server and the OS._x000A__x000A_Unauthorized access to sensitive data or SQL Server control may compromise the confidentiality of personnel privacy, threaten national security, compromise a variety of other sensitive operations, or lead to a loss of system control. Access controls are best managed by defining requirements based on distinct job functions and assigning access based on the job function assigned to the individual user._x000A__x000A_SQL Server's 'Alter any endpoint' permission is a high server-level privilege that must only be granted to individual administration accounts through roles. If the 'Alter any endpoint' permission is granted to roles that are unauthorized to have this privilege, then this access must be removed._x000A__x000A_Additionally, the permission must not be denied to a role, because that could disable a user's legitimate access via another role._x000A__x000A_The fix for this vulnerability specifies the use of REVOKE.  Be aware that revoking a permission that is currently denied to a role or user does not necessarily disable the permission.  If the user or role can inherent the permission from another role, revoking the denied permission from the user or the first role can effectively enable the inherited permission.tru</S>
      <S N="FixText">Remove the 'Alter any endpoint' permission access from the role that is not authorized by executing the following query:_x000A__x000A__x000A_REVOKE Alter any endpoint TO &lt;'role name'&gt;</S>
      <S N="Check">Obtain the list of roles that are authorized for the SQL Server 'Alter any endpoint' permission and what 'Grant', 'Grant With', and/or 'Deny' privilege is authorized. Obtain the list of roles with that permission by running the following query:_x000A__x000A_SELECT _x000A_       who.name AS [Principal Name],_x000A_       who.type_desc AS [Principal Type],_x000A_       who.is_disabled AS [Principal Is Disabled],_x000A_       what.state_desc AS [Permission State],_x000A_       what.permission_name AS [Permission Name]_x000A_FROM _x000A_       sys.server_permissions what _x000A_       INNER JOIN sys.server_principals who_x000A_              ON who.principal_id = what.grantee_principal_id_x000A_WHERE_x000A_       what.permission_name = 'Alter any endpoint' _x000A_AND    who.type_desc = 'SERVER_ROLE'_x000A_ORDER BY_x000A_       who.name_x000A_;_x000A_GO _x000A__x000A_If any role has 'Grant', 'With Grant' or 'Deny' privileges on this permission and users with that role are not authorized to have the permission, this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="519">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2012</S>
      <S N="VulnID">V-41302</S>
      <S N="RuleID">SV-53784r3_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL2-00-002400</S>
      <S N="Title">SQL Server must enforce access control policies to restrict the Alter any event session permission to only authorized roles.</S>
      <S N="Description">The concept of least privilege must be applied to SQL Server processes, ensuring that the processes operate at privilege levels no higher than necessary to accomplish required organizational missions and/or functions. Organizations consider the creation of additional processes, roles, and SQL Server accounts as necessary to achieve least privilege. Organizations also apply least privilege concepts to the design, development, implementation, and operations of SQL Server and the OS._x000A__x000A_Unauthorized access to sensitive data or SQL Server control may compromise the confidentiality of personnel privacy, threaten national security, compromise a variety of other sensitive operations, or lead to a loss of system control. Access controls are best managed by defining requirements based on distinct job functions and assigning access based on the job function assigned to the individual user._x000A__x000A_SQL Server's 'Alter any event session' permission is a high server-level privilege that must only be granted to individual administration accounts through roles. If the 'Alter any event session' permission is granted to roles that are unauthorized to have this privilege, then this access must be removed._x000A__x000A_Additionally, the permission must not be denied to a role, because that could disable a user's legitimate access via another role._x000A__x000A_The fix for this vulnerability specifies the use of REVOKE.  Be aware that revoking a permission that is currently denied to a role or user does not necessarily disable the permission.  If the user or role can inherent the permission from another role, revoking the denied permission from the user or the first role can effectively enable the inherited permission.tru</S>
      <S N="FixText">Remove the 'Alter any event session' permission access from the role that is not authorized by executing the following query:_x000A__x000A__x000A_REVOKE Alter any event session TO &lt;'role name'&gt;</S>
      <S N="Check">Obtain the list of roles that are authorized for the SQL Server 'Alter any event session' permission and what 'Grant', 'Grant With', and/or 'Deny' privilege is authorized. Obtain the list of roles with that permission by running the following query:_x000A__x000A_SELECT _x000A_       who.name AS [Principal Name],_x000A_       who.type_desc AS [Principal Type],_x000A_       who.is_disabled AS [Principal Is Disabled],_x000A_       what.state_desc AS [Permission State],_x000A_       what.permission_name AS [Permission Name]_x000A_FROM _x000A_       sys.server_permissions what _x000A_       INNER JOIN sys.server_principals who_x000A_              ON who.principal_id = what.grantee_principal_id_x000A_WHERE_x000A_       what.permission_name = 'Alter any event session' _x000A_AND    who.type_desc = 'SERVER_ROLE'_x000A_ORDER BY_x000A_       who.name_x000A_;_x000A_GO _x000A__x000A_If any role has 'Grant', 'With Grant' or 'Deny' privileges on this permission and users with that role are not authorized to have the permission, this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="520">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2012</S>
      <S N="VulnID">V-41303</S>
      <S N="RuleID">SV-53785r3_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL2-00-002300</S>
      <S N="Title">SQL Server must enforce access control policies to restrict Alter server state permissions to only authorized roles.</S>
      <S N="Description">The concept of least privilege must be applied to SQL Server processes, ensuring that the processes operate at privilege levels no higher than necessary to accomplish required organizational missions and/or functions. Organizations consider the creation of additional processes, roles, and SQL Server accounts as necessary to achieve least privilege. Organizations also apply least privilege concepts to the design, development, implementation, and operations of SQL Server and the OS._x000A__x000A_Unauthorized access to sensitive data or SQL Server control may compromise the confidentiality of personnel privacy, threaten national security, compromise a variety of other sensitive operations or lead to a loss of system control. Access controls are best managed by defining requirements based on distinct job functions and assigning access based on the job function assigned to the individual user._x000A__x000A_SQL Server's 'Alter server state' permission is a high server-level privilege that must only be granted to individual administration accounts through roles, and users who have access must require this privilege to accomplish the organizational missions and/or functions. If the 'Alter server state' permissions are granted to roles that are unauthorized to have this privilege, then this access must be removed._x000A__x000A_Additionally, the permission must not be denied to a role, because that could disable a user's legitimate access via another role._x000A__x000A_The fix for this vulnerability specifies the use of REVOKE.  Be aware that revoking a permission that is currently denied to a role or user does not necessarily disable the permission.  If the user or role can inherent the permission from another role, revoking the denied permission from the user or the first role can effectively enable the inherited permission.tru</S>
      <S N="FixText">Remove the 'Alter server state' permission access from the role that is not authorized by executing the following query:_x000A__x000A__x000A_REVOKE Alter server state TO &lt;'role name'&gt;</S>
      <S N="Check">Obtain the list of roles that are authorized for the SQL Server 'Alter server state' permission and what 'Grant', 'Grant With', and/or 'Deny' privilege is authorized. _x000A__x000A_Obtain the list of roles with that permission by running the following query:_x000A__x000A_SELECT _x000A_       who.name AS [Principal Name],_x000A_       who.type_desc AS [Principal Type],_x000A_       who.is_disabled AS [Principal Is Disabled],_x000A_       what.state_desc AS [Permission State],_x000A_       what.permission_name AS [Permission Name]_x000A_FROM _x000A_       sys.server_permissions what _x000A_       INNER JOIN sys.server_principals who_x000A_              ON who.principal_id = what.grantee_principal_id_x000A_WHERE_x000A_       what.permission_name = 'Alter server state' _x000A_AND    who.type_desc = 'SERVER_ROLE'_x000A_ORDER BY_x000A_       who.name_x000A_;_x000A_GO _x000A__x000A_If any role has 'Grant', 'With Grant' or 'Deny' privileges on this permission and users with that role are not authorized to have the permission, this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="521">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2012</S>
      <S N="VulnID">V-41304</S>
      <S N="RuleID">SV-53786r4_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL2-00-002200</S>
      <S N="Title">SQL Server must enforce non-DAC policies over users and resources where the policy rule set for each policy specifies access control information (i.e., position, nationality, age, project, time of day).</S>
      <S N="Description">Non-DAC controls are determined by policy makers and are managed centrally or by a central authority. These controls must not be changed at the discretion of ordinary application users. Data protection requirements may result in a non-DAC policy being specified as part of the application design. Non-DACs are employed at the application level to restrict and control access to application data, thereby providing increased information security for the organization._x000A__x000A_SQL Server Non-DAC is maintained through the use of Roles. Roles are set up within SQL Server to grant user accounts read and/or write permissions to system objects: databases, tables, columns, etc. After a role is created, user accounts can be assigned to a role granting them permissions of that role._x000A__x000A_If users have permissions to database objects that they are not authorized to have, the user account that has access to the unauthorized database object must be removed from the role that grants that access. Policy rule sets would be developed to establish that each user receives only the information to which the user is authorized._x000A__x000A_Frequently, roles grant access to multiple privileges; if a user is authorized and determined to need access to authorized privilege granted by a role, and unauthorized for other privileges of that same role, it may be necessary to split the privileges of one role into two roles.</S>
      <S N="FixText">Add the user as a member of the user-defined server role within the system documentation._x000A__x000A_Remove the user from direct access to server permission by running the following script:_x000A_USE master_x000A_REVOKE &lt;'server permission name'&gt; TO &lt;'account name'&gt; CASCADE_x000A__x000A_Remove the user from user-defined role access by running the following script:_x000A_USE master_x000A_ALTER SERVER ROLE [&lt;'server role name'&gt;] DROP MEMBER &lt;'user name'&gt;</S>
      <S N="Check">Check for direct user assignment to server permissions by running the following script:_x000A_/**********************************************************************************_x000A_LIST ALL DIRECT SERVER PERMISSIONS TO ANY ACCOUNT EXCEPT_x000A_SYSTEM ADMINISTRATOR ACCOUNTS.  DO NOT LIST ROLES._x000A_***********************************************************************************/_x000A_DECLARE @admin_Account_name sysname_x000A_SET @admin_Account_name = 'NO administrator account found'_x000A_DECLARE @server_name sysname_x000A_SET @server_name = 'NO Server found'_x000A__x000A_SELECT @server_name = name FROM sys.servers_x000A_WHERE server_id = 0_x000A_SET @admin_Account_name = @server_name + '\Administrator'_x000A__x000A_SELECT pe.grantee_principal_id_x000A_, pr.type AS 'Grantee_Type'_x000A_, pr.name AS 'Grantee_Name'_x000A_, pe.type_x000A_, pe.permission_name_x000A_, pe.state_x000A_, pe.state_desc_x000A_FROM sys.server_permissions pe_x000A_JOIN sys.server_principals pr_x000A_ON pe.grantee_principal_id = pr.principal_id_x000A_JOIN sys.server_principals ps_x000A_ON pe.grantor_principal_id = ps.principal_id_x000A_LEFT JOIN sys.server_principals us_x000A_ON us.principal_id = pe.major_id_x000A_WHERE pr.type IN ('K', 'S', 'U')_x000A_AND pe.grantee_principal_id &gt; 10_x000A_AND NOT pr.name IN ('##MS_PolicyEventProcessingLogin##', '##MS_PolicyTsqlExecutionLogin##',_x000A_'NT AUTHORITY\NETWORK SERVICE', 'NT AUTHORITY\SYSTEM', 'NT SERVICE\MSSQLSERVER',_x000A_'NT SERVICE\SQLSERVERAGENT', 'NT SERVICE\SQLWriter', 'NT SERVICE\Winmgmt')_x000A_AND NOT pr.name = @admin_Account_name_x000A_AND NOT pe.permission_name = 'connect sql'_x000A_ORDER BY CASE pr.type_x000A_WHEN 'K' THEN 1_x000A_WHEN 'S' THEN 2_x000A_WHEN 'U' THEN 3_x000A_ELSE 4_x000A_END;_x000A_GO_x000A__x000A_If any user account listed indicates direct access to any server permission, this is a finding._x000A__x000A_Obtain the list of available user-defined server roles from system documentation._x000A__x000A_Obtain the list of available user-defined server roles from the SQL Server system by running the following script:_x000A_/**********************************************************************************_x000A_ LIST ALL INDIRECT (via ROLES) ACCESS TO THE SERVER PERMISSION._x000A_ ***********************************************************************************/_x000A_DECLARE @admin_Account_name sysname_x000A_SET @admin_Account_name = 'NO admin ACCOUNT found'_x000A_DECLARE @server_name sysname_x000A_SET @server_name = 'NO Server found'_x000A__x000A_SELECT @server_name = name FROM sys.servers_x000A_WHERE server_id = 0_x000A_SET @admin_Account_name = @server_name + '\Administrator'_x000A__x000A_SELECT pe.grantee_principal_id_x000A_, pr.type AS 'Grantee_Type'_x000A_, pr.name AS 'Grantee_Name'_x000A_, pe.type_x000A_, pe.permission_name_x000A_, pe.state_x000A_, pe.state_desc_x000A_FROM sys.server_permissions pe_x000A_JOIN sys.server_principals pr_x000A_ON pe.grantee_principal_id = pr.principal_id_x000A_JOIN sys.server_principals ps_x000A_ON pe.grantor_principal_id = ps.principal_id_x000A_LEFT JOIN sys.server_principals us_x000A_ON us.principal_id = pe.major_id_x000A_WHERE pr.type IN ('R')_x000A_AND pe.grantee_principal_id &gt; 10_x000A_AND NOT pr.name IN ('##MS_PolicyEventProcessingLogin##', '##MS_PolicyTsqlExecutionLogin##',_x000A_'NT AUTHORITY\NETWORK SERVICE', 'NT AUTHORITY\SYSTEM', 'NT SERVICE\MSSQLSERVER',_x000A_'NT SERVICE\SQLSERVERAGENT', 'NT SERVICE\SQLWriter', 'NT SERVICE\Winmgmt')_x000A_AND NOT pr.name = @admin_Account_name_x000A_AND NOT pe.permission_name = 'connect sql'_x000A_ORDER BY CASE pe.state_x000A_WHEN 'D' THEN 1_x000A_WHEN 'W' THEN 2_x000A_WHEN 'G' THEN 3_x000A_ELSE 4_x000A_END;_x000A_GO_x000A__x000A_Obtain the list of user role assignments in the system documentation._x000A__x000A_Check all SQL Server user-defined server roles for authorized and documented permission assignments. Repeat steps for each user-defined server role._x000A_Navigate to SQL Server Management Studio &gt;&gt; Object Explorer &gt;&gt; &lt;'SQL Server name'&gt; &gt;&gt; Security &gt;&gt; Server Roles &gt;&gt; right click &lt;'user-defined server role name'&gt; &gt;&gt; Properties &gt;&gt; Members._x000A__x000A_If both user-defined role(s) and user(s) are listed as "Member of this role", this is a propagation of access rights, and this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="522">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2012</S>
      <S N="VulnID">V-41305</S>
      <S N="RuleID">SV-53787r4_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL2-00-023300</S>
      <S N="Title">SQL Server must notify appropriate individuals when accounts are modified.</S>
      <S N="Description">Once an attacker establishes initial access to a system, they often attempt to create a persistent method of re-establishing access. One way to accomplish this is for the attacker to modify an existing account for later use._x000A__x000A_Notification of account creation is one method and best practice for mitigating this risk. A comprehensive account management process will ensure an audit trail which documents the creation of application user accounts and notifies administrators and/or application owners exist. Such a process greatly reduces the risk that accounts will be surreptitiously created and provides logging that can be used for forensic purposes._x000A__x000A_To address the multitude of policy based access requirements, many application developers choose to integrate their applications with enterprise level authentication/access mechanisms that meet or exceed access control policy requirements. Such integration allows the application developer to off-load those access control functions and focus on core application features and functionality.</S>
      <S N="FixText">Create a trace that meets all auditing requirements._x000A__x000A_The script provided in the supplemental file, Trace.sql, can be used to do this; edit it as necessary to capture any additional, locally defined events.</S>
      <S N="Check">Check to see that all required events are being audited._x000A_From the query prompt:_x000A_     SELECT DISTINCT traceid FROM sys.fn_trace_getinfo(0);_x000A_All currently defined traces for the SQL server instance will be listed. If no traces are returned, this is a finding._x000A__x000A_Determine the trace(s) being used for the auditing requirement. _x000A_In the following, replace # with a trace ID being used for the auditing requirements._x000A_From the query prompt:_x000A_     SELECT DISTINCT(eventid) FROM sys.fn_trace_geteventinfo(#);_x000A_The following required event IDs should be listed:_x000A_     14, 15, 18, 20, _x000A_     102, 103, 104, 105, 106, 107, 108, 109, 110, _x000A_     111, 112, 113, 115, 116, 117, 118, _x000A_     128, 129, 130, _x000A_     131, 132, 133, 134, 135, _x000A_     152, 153, _x000A_     170, 171, 172, 173, 175, 176, 177, 178._x000A_If any of the audit event IDs required above is not listed, this is a finding._x000A__x000A_Notes:_x000A_1. It is acceptable to have the required event IDs spread across multiple traces, provided all of the traces are always active, and the event IDs are grouped in a logical manner._x000A_2. It is acceptable, from an auditing point of view, to include the same event IDs in multiple traces.  However, the effect of this redundancy on performance, storage, and the consolidation of audit logs into a central repository, should be taken into account._x000A_3. It is acceptable to trace additional event IDs. This is the minimum list._x000A_4. Once this check is satisfied, the DBA may find it useful to disable or modify the default trace that is set up by the SQL Server installation process. (Note that the Fix does NOT include code to do this.)  _x000A_Use the following query to obtain a list of all event IDs, and their meaning:_x000A_     SELECT * FROM sys.trace_events; _x000A_5. Because this check procedure is designed to address multiple requirements/vulnerabilities, it may appear to exceed the needs of some individual requirements.  However, it does represent the aggregate of all such requirements._x000A_6. Microsoft has flagged the trace techniques and tools used in this Check and Fix as deprecated.  They will be removed at some point after SQL Server 2014.  The replacement feature is Extended Events.  If Extended Events are in use, and cover all the required audit events listed above, this is not a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="523">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2012</S>
      <S N="VulnID">V-41306</S>
      <S N="RuleID">SV-53788r4_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL2-00-001900</S>
      <S N="Title">SQL Server must automatically audit account modification.</S>
      <S N="Description">Once an attacker establishes initial access to a system, they often attempt to create a persistent method of re-establishing access. One way to accomplish this is for the attacker to simply modify an existing account. _x000A__x000A_Auditing of account modification is one method and best practice for mitigating this risk. A comprehensive application account management process ensures an audit trail automatically documents the modification of application user accounts and, as required, notifies administrators, application owners, and/or appropriate individuals. Applications must provide this capability directly, leverage complimentary technology providing this capability, or a combination thereof._x000A__x000A_Automated account-auditing processes greatly reduce the risk that accounts will be surreptitiously modified, and provides logging that can be used for forensic purposes.  _x000A__x000A_To address the multitude of policy based access requirements, many application developers choose to integrate their applications with enterprise-level authentication/access mechanisms meeting or exceeding access control policy requirements.  Such integration allows the application developer to off-load those access control functions and focus on core application features and functionality.</S>
      <S N="FixText">Create a trace that meets all auditing requirements._x000A__x000A_The script provided in the supplemental file, Trace.sql, can be used to do this; edit it as necessary to capture any additional, locally defined events.</S>
      <S N="Check">Check to see that all required events are being audited._x000A_From the query prompt:_x000A_     SELECT DISTINCT traceid FROM sys.fn_trace_getinfo(0);_x000A_All currently defined traces for the SQL server instance will be listed. If no traces are returned, this is a finding._x000A__x000A_Determine the trace(s) being used for the auditing requirement. _x000A_In the following, replace # with a trace ID being used for the auditing requirements._x000A_From the query prompt:_x000A_     SELECT DISTINCT(eventid) FROM sys.fn_trace_geteventinfo(#);_x000A_The following required event IDs should be listed:_x000A_     14, 15, 18, 20, _x000A_     102, 103, 104, 105, 106, 107, 108, 109, 110, _x000A_     111, 112, 113, 115, 116, 117, 118, _x000A_     128, 129, 130, _x000A_     131, 132, 133, 134, 135, _x000A_     152, 153, _x000A_     170, 171, 172, 173, 175, 176, 177, 178._x000A_If any of the audit event IDs required above is not listed, this is a finding._x000A__x000A_Notes:_x000A_1. It is acceptable to have the required event IDs spread across multiple traces, provided all of the traces are always active, and the event IDs are grouped in a logical manner._x000A_2. It is acceptable, from an auditing point of view, to include the same event IDs in multiple traces.  However, the effect of this redundancy on performance, storage, and the consolidation of audit logs into a central repository, should be taken into account._x000A_3. It is acceptable to trace additional event IDs. This is the minimum list._x000A_4. Once this check is satisfied, the DBA may find it useful to disable or modify the default trace that is set up by the SQL Server installation process. (Note that the Fix does NOT include code to do this.)  _x000A_Use the following query to obtain a list of all event IDs, and their meaning:_x000A_     SELECT * FROM sys.trace_events; _x000A_5. Because this check procedure is designed to address multiple requirements/vulnerabilities, it may appear to exceed the needs of some individual requirements.  However, it does represent the aggregate of all such requirements._x000A_6. Microsoft has flagged the trace techniques and tools used in this Check and Fix as deprecated.  They will be removed at some point after SQL Server 2014.  The replacement feature is Extended Events.  If Extended Events are in use, and cover all the required audit events listed above, this is not a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="524">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2012</S>
      <S N="VulnID">V-41307</S>
      <S N="RuleID">SV-53789r4_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL2-00-001600</S>
      <S N="Title">SQL Server must ensure that remote sessions that access an organization-defined list of security functions and security-relevant information are audited.</S>
      <S N="Description">Remote access is any access to an organizational information system by a user (or an information system) communicating through an external, non-organization-controlled network (e.g., the Internet). Examples of remote access methods include dial-up, broadband, and wireless._x000A__x000A_Remote network and system access is accomplished by leveraging common communication protocols to establish a remote connection. These connections will typically originate over either the public Internet or the Public Switched Telephone Network (PSTN). Neither of these internetworking mechanisms is private or secure, and they do not by default restrict access to networked resources once connectivity is established._x000A__x000A_Numerous best practices are employed to protect remote connections, such as utilizing encryption to protect data sessions and firewalls to restrict and control network connectivity. In addition to these protections, auditing must also be utilized in order to track system activity, assist in diagnosing system issues, and provide evidence needed for forensic investigations post security incident._x000A_</S>
      <S N="FixText">Create a trace that meets all auditing requirements._x000A__x000A_The script provided in the supplemental file, Trace.sql, can be used to do this; edit it as necessary to capture any additional, locally defined events.</S>
      <S N="Check">Check to see that all required events are being audited._x000A_From the query prompt:_x000A_     SELECT DISTINCT traceid FROM sys.fn_trace_getinfo(0);_x000A_All currently defined traces for the SQL server instance will be listed. If no traces are returned, this is a finding._x000A__x000A_Determine the trace(s) being used for the auditing requirement. _x000A_In the following, replace # with a trace ID being used for the auditing requirements._x000A_From the query prompt:_x000A_     SELECT DISTINCT(eventid) FROM sys.fn_trace_geteventinfo(#);_x000A_The following required event IDs should be listed:_x000A_     14, 15, 18, 20, _x000A_     102, 103, 104, 105, 106, 107, 108, 109, 110, _x000A_     111, 112, 113, 115, 116, 117, 118, _x000A_     128, 129, 130, _x000A_     131, 132, 133, 134, 135, _x000A_     152, 153, _x000A_     170, 171, 172, 173, 175, 176, 177, 178._x000A_If any of the audit event IDs required above is not listed, this is a finding._x000A__x000A_Notes:_x000A_1. It is acceptable to have the required event IDs spread across multiple traces, provided all of the traces are always active, and the event IDs are grouped in a logical manner._x000A_2. It is acceptable, from an auditing point of view, to include the same event IDs in multiple traces.  However, the effect of this redundancy on performance, storage, and the consolidation of audit logs into a central repository, should be taken into account._x000A_3. It is acceptable to trace additional event IDs. This is the minimum list._x000A_4. Once this check is satisfied, the DBA may find it useful to disable or modify the default trace that is set up by the SQL Server installation process. (Note that the Fix does NOT include code to do this.)  _x000A_Use the following query to obtain a list of all event IDs, and their meaning:_x000A_     SELECT * FROM sys.trace_events; _x000A_5. Because this check procedure is designed to address multiple requirements/vulnerabilities, it may appear to exceed the needs of some individual requirements.  However, it does represent the aggregate of all such requirements._x000A_6. Microsoft has flagged the trace techniques and tools used in this Check and Fix as deprecated.  They will be removed at some point after SQL Server 2014.  The replacement feature is Extended Events.  If Extended Events are in use, and cover all the required audit events listed above, this is not a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="525">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2012</S>
      <S N="VulnID">V-41311</S>
      <S N="RuleID">SV-53793r4_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL2-00-000100</S>
      <S N="Title">The number of concurrent SQL Server sessions for each system account must be limited.</S>
      <S N="Description">A variety of technologies exist to limit or, in some cases, eliminate the effects of DoS attacks. For example, boundary protection devices can filter certain types of packets to protect devices on an organization’s internal network from being directly affected by DoS attacks._x000A__x000A_One way SQL Server can limit exposure to DoS attacks is to restrict the number of connections that can be opened by a single user. SQL Server supports this through the use of logon triggers.  (Note, however, that this need not be the only, or even the principal, means for satisfying this requirement.  Depending on the architecture and capabilities of the network and application, a network device or an application may be more suitable for providing this protection.)_x000A__x000A_When determining the appropriate values for this limit, take the characteristics of the various kinds of user into account, and bear in mind that some applications and some users may need to have multiple sessions open.  For example, while a standard account using a simple application may never need more than, say, five connections, a database administrator using SQL Server Management Studio may need significantly more, because each tab in that application counts as a distinct session._x000A__x000A_Architectural note:  In SQL Server, a count of active sessions by user can be obtained from one of the dynamic management views.   For example:_x000A__x000A__x0009_SELECT original_login_name, count(*) _x000A__x0009_FROM sys.dm_exec_sessions_x000A__x0009_WHERE is_user_process = 1_x000A__x0009_GROUP BY original_login_name;_x000A__x000A_However, for this to return an accurate count in a logon trigger, the user would have to have the View Server State privilege.  (Without this privilege, the trigger sees information only about the current session, so would always return a count of one.)  View Server State would give that user access to a wide swath of information about the server, violating SQL2-00-004100.  One way to avoid this exposure is to create a summary table, and a view of that table that restricts each user to seeing his/her own count, and establish a frequently-run background job to refresh the table (using the above query or similar).  The logon trigger then queries the view to obtain a count that is accurate enough for most purposes.tru</S>
      <S N="FixText">Establish the limit(s) appropriate to the type(s) of user account accessing the SQL Server instance, and record them in the system documentation._x000A__x000A_Implement one or more logon triggers to enforce the limit(s), without exposing the dynamic management views to general users.</S>
      <S N="Check">Review the system documentation to determine whether any limits have been defined.  If not, this is a finding._x000A__x000A_If one limit has been defined but is not applied to all users, including privileged administrative accounts, this is a finding._x000A__x000A_If multiple limits have been defined, to accommodate different types of user, verify that together they cover all users.  If not, this is a finding. _x000A__x000A_If a mechanism other than a logon trigger is used, verify its correct operation by the appropriate means.  If it does not work correctly, this is a finding._x000A__x000A_Otherwise, determine if a logon trigger exists:_x000A__x000A_EITHER, in SQL Server Management Studio's Object Explorer tree: _x000A_Expand [SQL Server Instance] &gt;&gt; Security &gt;&gt; Server Objects &gt;&gt; Triggers_x000A__x000A_OR run the query:_x000A_SELECT * FROM master.sys.server_triggers;_x000A__x000A_If no triggers are listed, this is a finding._x000A__x000A_If triggers are listed, identify the one(s) limiting the number of concurrent sessions per user.  If none are found, this is a finding. If they are present but disabled, this is a finding.  _x000A__x000A_Examine the trigger source code for logical correctness and for compliance with the documented limit(s).  If errors or variances exist, this is a finding._x000A__x000A_Verify that the system does execute the trigger(s) each time a user session is established.  If it does not operate correctly for all types of user, this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="526">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2012</S>
      <S N="VulnID">V-41419</S>
      <S N="RuleID">SV-53948r3_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL2-00-024500</S>
      <S N="Title">The Service Master Key must be backed up, stored offline and off-site.</S>
      <S N="Description">Backup and recovery of the Service Master Key may be critical to the complete recovery of the database. Not having this key can lead to loss of data during recovery.</S>
      <S N="FixText">Document and implement procedures to safely back up and store the Service Master Key. Include in the procedures methods to establish evidence of backup and storage, and careful, restricted access and restoration of the Service Master Key. Also, include provisions to store the key off-site._x000A_BACKUP SERVICE MASTER KEY TO FILE = 'path_to_file'_x000A_ENCRYPTION BY PASSWORD = 'password'</S>
      <S N="Check">Review procedures for, and evidence of backup of, the SQL Server Service Master Key in the System Security Plan._x000A__x000A_If the procedures or evidence do not exist, this is a finding._x000A__x000A_If the procedures do not indicate offline and off-site storage of the Service Master Key, this is a finding._x000A__x000A_If procedures do not indicate access restrictions to the Service Master Key backup, this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="527">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2012</S>
      <S N="VulnID">V-43196</S>
      <S N="RuleID">SV-55935r2_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL2-00-024600</S>
      <S N="Title">Domain accounts used to manage a SQL Server platform must be different from those used to manage other platforms.</S>
      <S N="Description">Separate accounts used to manage the SQL Server platform help prevent a lateral move within an environment if SQL were to be compromised.</S>
      <S N="FixText">Set up and use separate domain accounts to manage the SQL Server platform.  These accounts must be different from those used to manage other platforms.</S>
      <S N="Check">Determine the accounts being used to manage the SQL Server operating system.  Determine whether the same accounts are being used to manage other platforms. If the same account is used to manage more than one platform, this is a finding._x000A_Note: If, because of the application configuration, there are multiple instances of SQL that would share a given exploit, a single account would be allowed to be used for the group and would not be considered a finding._x000A_</S>
    </MS>
  </Obj>
  <Obj RefId="528">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2012</S>
      <S N="VulnID">V-53877</S>
      <S N="RuleID">SV-68097r2_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL2-00-019601</S>
      <S N="Title">SQL Server databases in the unclassified environment, containing sensitive information, must be encrypted using approved cryptography.</S>
      <S N="Description">Cryptography is only as strong as the encryption modules/algorithms employed to encrypt the data._x000A__x000A_Use of weak or untested encryption algorithms undermines the purposes of utilizing encryption to protect data._x000A__x000A_Data files that are not encrypted are vulnerable to theft. When data files are not encrypted, they can be copied and opened on a separate system. The data can be compromised without the information owner's knowledge that the theft has even taken place.tru</S>
      <S N="FixText">Configure SQL Server to encrypt sensitive data stored in each database. Use only NIST-certified cryptography to provide encryption.</S>
      <S N="Check">If the system exists in the Classified environment, this is NA._x000A__x000A_For each database under the SQL Server instance, review the system documentation to determine whether the database holds sensitive information. If it does not, this is not a finding._x000A__x000A_If it does handle sensitive information, review the system documentation and configuration to determine whether the sensitive information is protected by NIST-approved cryptography.  If not, this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="529">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2012</S>
      <S N="VulnID">V-54859</S>
      <S N="RuleID">SV-69105r5_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL2-00-025100</S>
      <S N="Title">The OS must limit privileges to the SQL Server Data Root directory and its subordinate directories and files.</S>
      <S N="Description">Default database file locations should be protected from unauthorized access.  The system databases, essential to SQL Server operation, are typically located here.tru</S>
      <S N="FixText">Navigate to the identified folder location(s). Right-click the folder, click Properties. On the Security tab, modify the security permissions so that files and folders have at most the permissions listed below. Right-click each folder under the identified folder(s), click Properties. On the Security tab, modify the security permissions so that at most the following permissions are present._x000A_CREATOR OWNER (Full Control)_x000A_System (Full control)_x000A_SQL Server Service SID OR Service Account (Full Control) [Notes 1, 2]_x000A_System Administrators (Full Control) [Note 3]_x000A_SQL Server Analysis Services (SSAS) Service SID or Service Account, if SSAS is in use (Read &amp; Execute) [Notes 1, 2]_x000A_SQL Server SQL Agent Service SID OR Service Account, if SQL Server Agent is in use. (Read, Execute, Write) [Notes 1, 2, 4]_x000A_SQL Server FD Launcher Service SID OR Service Account, if full-text indexing is in use. (Read, Execute, Write) [Notes 1, 2]_x000A__x000A_-----_x000A__x000A_Note 1: It is highly advisable to use a separate account for each service. When installing SQL Server in single-server mode, you can opt to have these provisioned for you. These automatically-generated accounts are referred to as virtual accounts. Each virtual account has an equivalent Service SID, with the same name. The installer also creates an equivalent SQL Server login, also with the same name. Applying folder and file permissions to Service SIDs, rather than to domain accounts or local computer accounts, provides tighter control because these permissions are available only to the specific service when it is running and not in any other context. (However, when using failover clustering, a domain account must be specified at installation, rather than a virtual account.) For more on this topic, see http://msdn.microsoft.com/en-us/library/ms143504(v=sql.110).aspx._x000A__x000A_Note 2: Tips for adding a service SID/virtual account to a folder's permission list._x000A_1) In Windows Explorer, right-click on the folder and select "Properties."_x000A_2) Select the "Security" tab_x000A_3) Click "Edit"_x000A_4) Click "Add"_x000A_5) Click "Locations"_x000A_6) Select the computer name_x000A_7) Search for the name_x000A_7.a) SQL Server Service_x000A_7.a.i) Type "NT SERVICE\MSSQL" and click "Check Names". (What you have just typed in is the first 16 characters of the name. At least one character must follow "NT SERVICE\"; you will be presented with a list of all matches. If you have typed in the full, correct name, step 7.a.ii is bypassed.)_x000A_7.a.ii) Select the "MSSQL$&lt;instance name&gt;" user and click OK_x000A_7.b) SQL Agent Service_x000A_7.b.i) Type "NT SERVICE\SQL" and click "Check Names"_x000A_7.b.ii) Select the "SQLAgent$&lt;instance name&gt;" user and click OK_x000A_8) Click OK_x000A_9) Permission like a normal user from here_x000A__x000A_Note 3: In the interest of separation of responsibilities with least privilege, consider granting Full Control only to SQL Database Administrators (create a custom group for these) and providing the local Administrators group with Read access only._x000A__x000A_Note 4: It may also be necessary to grant the SQL Server Agent permission to Delete the \Log directory and its contents.</S>
      <S N="Check">Obtain the SQL Server default data directory location: from a command prompt, open the registry editor by typing regedit.exe, and pressing [ENTER]. Navigate to the following registry location:_x000A_HKEY_LOCAL_MACHINE_x000A_&gt;&gt; SOFTWARE_x000A_&gt;&gt; Microsoft_x000A_&gt;&gt; Microsoft SQL Server_x000A_&gt;&gt; [INSTANCE NAME]_x000A_&gt;&gt; Setup_x000A_&gt;&gt; SqlDataRoot_x000A__x000A_In the registry tree, the [INSTANCE NAME] for a SQL Server 2012 database engine instance is normally shown as "MSSQL11" followed by a period and the name that was specified for the SQL Server service at installation time. If multiple SQL Server instances are installed, each will have its own [INSTANCE NAME] node and subtree in the registry._x000A__x000A_The value in the Data column for the SqlDataRootregistry entry is the default file system path for the SQL Server 2012 data files. Navigate to that folder location using a command prompt or Windows Explorer. The following instructions assume that Windows Explorer is used._x000A__x000A_Determine whether a DefaultData registry entry also exists. Repeat the above for the path:_x000A_...[INSTANCE NAME]_x000A_&gt;&gt; MSSQLServer_x000A_&gt;&gt; DefaultData_x000A__x000A_Verify that the identified folder(s) and their contents have only authorized privileges. Right-click the folder, click Properties. On the Security tab, verify that at most the following permissions are present:_x000A_CREATOR OWNER (Full Control)_x000A_System (Full control)_x000A_SQL Server Service SID OR Service Account (Full Control) [Notes 1, 2]_x000A_System Administrators (Full Control) [Note 3]_x000A_SQL Server Analysis Services (SSAS) Service SID or Service Account, if SSAS is in use (Read &amp; Execute) [Notes 1, 2]_x000A_SQL Server SQL Agent Service SID OR Service Account, if SQL Server Agent is in use. (Read, Execute, Write) [Notes 1, 2, 4]_x000A_SQL Server FD Launcher Service SID OR Service Account, if full-text indexing is in use. (Read, Execute, Write) [Notes 1, 2]_x000A_If any less restrictive permissions are present (and not specifically justified and approved), this is a finding._x000A__x000A_Right-click each folder, if any, under the above folder(s); click Properties. On the Security tab, verify that at most the permissions listed in the preceding paragraph are present. If any less restrictive permissions are present (and not specifically justified and approved), this is a finding._x000A__x000A_-----_x000A__x000A_Note 1: It is highly advisable to use a separate account for each service. When installing SQL Server in single-server mode, you can opt to have these provisioned for you. These automatically-generated accounts are referred to as virtual accounts. Each virtual account has an equivalent Service SID, with the same name. The installer also creates an equivalent SQL Server login, also with the same name. Applying folder and file permissions to Service SIDs, rather than to domain accounts or local computer accounts, provides tighter control because these permissions are available only to the specific service when it is running and not in any other context. (However, when using failover clustering, a domain account must be specified at installation, rather than a virtual account.) For more on this topic, see http://msdn.microsoft.com/en-us/library/ms143504(v=sql.110).aspx._x000A__x000A_Note 2: Tips for adding a service SID/virtual account to a folder's permission list._x000A_1) In Windows Explorer, right-click on the folder and select "Properties."_x000A_2) Select the "Security" tab_x000A_3) Click "Edit"_x000A_4) Click "Add"_x000A_5) Click "Locations"_x000A_6) Select the computer name_x000A_7) Search for the name_x000A_7.a) SQL Server Service_x000A_7.a.i) Type "NT SERVICE\MSSQL" and click "Check Names". (What you have just typed in is the first 16 characters of the name. At least one character must follow "NT SERVICE\"; you will be presented with a list of all matches. If you have typed in the full, correct name, step 7.a.ii is bypassed.)_x000A_7.a.ii) Select the "MSSQL$&lt;instance name&gt;" user and click OK_x000A_7.b) SQL Agent Service_x000A_7.b.i) Type "NT SERVICE\SQL" and click "Check Names"_x000A_7.b.ii) Select the "SQLAgent$&lt;instance name&gt;" user and click OK_x000A_8) Click OK_x000A_9) Permission like a normal user from here_x000A__x000A_Note 3: In the interest of separation of responsibilities with least privilege, consider granting Full Control only to SQL Database Administrators (create a custom group for these) and providing the local Administrators group with Read access only._x000A__x000A_Note 4: It may also be necessary to grant the SQL Server Agent permission to Delete the \Log directory and its contents.  This is not a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="530">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2012</S>
      <S N="VulnID">V-54879</S>
      <S N="RuleID">SV-69125r3_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL2-00-025200</S>
      <S N="Title">The OS must limit privileges to the SQL Server data directories and their subordinate directories and files.</S>
      <S N="Description">Database files must be protected from unauthorized access.  Although default data locations are created at installation time, sites can, and will, use other directories for site-created database files to comply with best practices.tru</S>
      <S N="FixText">Navigate to the identified folder location(s).  Right-click the folder, click Properties.  On the Security tab, modify the security permissions so that files and folders have at most the permissions listed below. Right-click each folder under the identified folder(s), click Properties. On the Security tab, modify the security permissions so that at most the following permissions are present._x000A_CREATOR OWNER (Full Control)_x000A_System (Full control)_x000A_SQL Server Service SID OR Service Account (Full Control)  [Notes 1, 2]  _x000A_SQL Server Analysis Services (SSAS) Service SID or Service Account, if SSAS is in use (Read &amp; Execute) [Notes 1, 2]_x000A_SQL Server SQL Agent Service SID OR Service Account, if SQL Server Agent is in use. (Read, Execute, Write)  [Notes 1, 2]  _x000A_SQL Server FD Launcher Service SID OR Service Account, if full-text indexing is in use.  (Read, Write)  [Notes 1, 2]  _x000A_System Administrators (Full Control)  [Note 3]_x000A__x000A__x000A_-----_x000A__x000A_Note 1:  It is highly advisable to use a separate account for each service.  When installing SQL Server in single-server mode, you can opt to have these provisioned for you.  These automatically-generated accounts are referred to as virtual accounts.  Each virtual account has an equivalent Service SID, with the same name.  The installer also creates an equivalent SQL Server login, also with the same name.  Applying folder and file permissions to Service SIDs, rather than to domain accounts or local computer accounts, provides tighter control because these permissions are available only to the specific service when it is running and not in any other context.  (However, when using failover clustering, a domain account must be specified at installation, rather than a virtual account.)  For more on this topic, see http://msdn.microsoft.com/en-us/library/ms143504(v=sql.110).aspx._x000A__x000A__x000A_Note 2:  Tips for adding a service SID/virtual account to a folder's permission list._x000A_1) In Windows Explorer, right-click on the folder and select "Properties."_x000A_2) Select the "Security" tab_x000A_3) Click "Edit"_x000A_4) Click "Add"_x000A_5) Click "Locations"_x000A_6) Select the computer name_x000A_7) Search for the name_x000A_7.a) SQL Server Service_x000A_7.a.i) Type "NT SERVICE\MSSQL" and click "Check Names".  (What you have just typed in is the first 16 characters of the name.  At least one character must follow "NT SERVICE\"; you will be presented with a list of all matches.  If you have typed in the full, correct name, step 7.a.ii is bypassed.)_x000A_7.a.ii) Select the "MSSQL$&lt;instance name&gt;" user and click OK_x000A_7.b) SQL Agent Service_x000A_7.b.i) Type "NT SERVICE\SQL" and click "Check Names"_x000A_7.b.ii) Select the "SQLAgent$&lt;instance name&gt;" user and click OK_x000A_8) Click OK_x000A_9) Permission like a normal user from here_x000A__x000A__x000A_Note 3:  In the interest of separation of responsibilities with least privilege, consider granting Full Control only to SQL Database Administrators (create a custom group for these) and providing the local Administrators group with Read access only.</S>
      <S N="Check">Obtain the SQL Server data directory location(s): in a tool such as SQL Server Management Studio, run the statement:_x000A_SELECT DISTINCT _x000A_LEFT(physical_name, (LEN(physical_name) - CHARINDEX('\',REVERSE(physical_name)) + 1 )) _x000A_AS "Database Data File Paths",_x000A_type_desc_x000A_FROM sys.master_files_x000A_WHERE database_id &gt; 4 _x000A_AND type = 0_x000A__x000A_The query result is a list of file systems locations used for databases other than the system databases.  Navigate to each of those folder locations using a command prompt or Windows Explorer.  The following instructions assume that Windows Explorer is used._x000A__x000A__x000A_Verify that the identified folders and their contents have only authorized privileges. Right-click each folder, click Properties. On the Security tab, verify that at most the following permissions are present:_x000A_CREATOR OWNER (Full Control)_x000A_System (Full control)_x000A_SQL Server Service SID OR Service Account (Full Control)  [Notes 1, 2]  _x000A_System Administrators (Full Control)  [Note 3]_x000A_SQL Server Analysis Services (SSAS) Service SID or Service Account, if SSAS is in use (Read &amp; Execute) [Notes 1, 2]_x000A_SQL Server SQL Agent Service SID OR Service Account, if SQL Server Agent is in use. (Read, Execute, Write)  [Notes 1, 2]  _x000A_SQL Server FD Launcher Service SID OR Service Account, if full-text indexing is in use.  (Read, Write)  [Notes 1, 2]  _x000A_If any less restrictive permissions are present (and not specifically justified and approved), this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="531">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2012</S>
      <S N="VulnID">V-54881</S>
      <S N="RuleID">SV-69127r4_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL2-00-025300</S>
      <S N="Title">The OS must limit privileges to the SQL Server backup directories and files.</S>
      <S N="Description">Backups must be protected from unauthorized deletion and modification.  They must also be protected from unauthorized use in database restoration.tru</S>
      <S N="FixText">Navigate to the SQL Server backup directory location.  Right-click the folder, click Properties.  On the Security tab, modify the security permissions, so that files and folders have at most the permissions listed below. Right-click each folder under the SQL Server backup folder, click Properties. On the Security tab, modify the security permissions, so that at most the following permissions are present._x000A_CREATOR OWNER (Full Control)_x000A_System (Full control)_x000A_SQL Server Service SID OR Service Account (Full Control)  [Notes 1, 2]  _x000A_SQL Server SQL Agent Service SID OR Service Account, if SQL Server Agent is in use. (Read, Execute, Write)  [Notes 1, 2]  _x000A_SQL Server FD Launcher Service SID OR Service Account, if full-text indexing is in use.  (Read, Write)  [Notes 1, 2]  _x000A_System Administrators (Full Control)  [Note 3]_x000A_SQL Server Analysis Services (SSAS) Service SID or Service Account, if SSAS is in use (Read &amp; Execute) [Notes 1, 2]_x000A__x000A__x000A_-----_x000A__x000A_Note 1: It is highly advisable to use a separate account for each service. When installing SQL Server in single-server mode, you can opt to have these provisioned for you. These automatically generated accounts are referred to as virtual accounts. Each virtual account has an equivalent Service SID, with the same name. The installer also creates an equivalent SQL Server login, also with the same name. Applying folder and file permissions to Service SIDs, rather than to domain accounts or local computer accounts, provides tighter control because these permissions are available only to the specific service when it is running and not in any other context. (However, when using failover clustering, a domain account must be specified at installation, rather than a virtual account.) For more on this topic, see http://msdn.microsoft.com/en-us/library/ms143504(v=sql.110).aspx._x000A__x000A_Note 2: Tips for adding a service SID/virtual account to a folder's permission list._x000A_1) In Windows Explorer, right-click on the folder and select "Properties."_x000A_2) Select the "Security" tab_x000A_3) Click "Edit"_x000A_4) Click "Add"_x000A_5) Click "Locations"_x000A_6) Select the computer name_x000A_7) Search for the name_x000A_7.a) SQL Server Service_x000A_7.a.i) Type "NT SERVICE\MSSQL" and click "Check Names". (What you have just typed in is the first 16 characters of the name. At least one character must follow "NT SERVICE\"; you will be presented with a list of all matches. If you have typed in the full, correct name, step 7.a.ii is bypassed.)_x000A_7.a.ii) Select the "MSSQL$&lt;instance name&gt;" user and click "OK"_x000A_7.b) SQL Agent Service_x000A_7.b.i) Type "NT SERVICE\SQL" and click "Check Names"_x000A_7.b.ii) Select the "SQLAgent$&lt;instance name&gt;" user and click "OK"_x000A_8) Click "OK"_x000A_9) Permission like a normal user from here_x000A__x000A_Note 3: In the interest of separation of responsibilities with least privilege, consider granting Full Control only to SQL Database Administrators (create a custom group for these) and providing the local Administrators group with Read access only.</S>
      <S N="Check">Obtain the SQL Server backup directory location: from a command prompt, open the registry editor by typing regedit.exe, and pressing [ENTER]. Navigate to the following registry location: _x000A_HKEY_LOCAL_MACHINE _x000A_&gt;&gt; SOFTWARE _x000A_&gt;&gt; Microsoft_x000A_&gt;&gt; Microsoft SQL Server _x000A_&gt;&gt; [INSTANCE NAME]_x000A_&gt;&gt; MSSQLServer_x000A_&gt;&gt; BackupDirectory_x000A__x000A_In the registry tree, the [INSTANCE NAME] for a SQL Server 2012 database engine instance is normally shown as "MSSQL11" followed by a period and the name that was specified for the SQL Server service at installation time.  If multiple SQL Server instances are installed, each will have its own [INSTANCE NAME] node and subtree in the registry._x000A__x000A_The value in the Data column for the BackupDirectory registry entry is the file system path for the SQL Server 2012 backups.  Also, review backup jobs to identify any additional directories used for backups._x000A__x000A_Navigate to each folder location using a command prompt or Windows Explorer.  The following instructions assume that Windows Explorer is used._x000A__x000A_Verify that backup files and folders have only authorized privileges. Right-click the backup folder, click Properties. On the Security tab, verify that at most the following permissions are present:_x000A_CREATOR OWNER (Full Control)_x000A_System (Full control)_x000A_SQL Server Service SID OR Service Account (Full Control)  [Notes 1, 2]  _x000A_SQL Server SQL Agent Service SID OR Service Account, if SQL Server Agent is in use. (Read, Execute, Write)  [Notes 1, 2]  _x000A_SQL Server FD Launcher Service SID OR Service Account, if full-text indexing is in use.  (Read, Write)  [Notes 1, 2]  _x000A_System Administrators (Full Control)  [Note 3]_x000A_SQL Server Analysis Services (SSAS) Service SID or Service Account, if SSAS is in use (Read &amp; Execute) [Notes 1, 2]_x000A_If any less restrictive permissions are present (and not specifically justified and approved), this is a finding._x000A__x000A_Right-click each folder, if any, under the backup folder; click Properties. On the Security tab, verify that at most the permissions listed in the preceding paragraph are present.  If any less restrictive permissions are present (and not specifically justified and approved), this is a finding._x000A__x000A__x000A_-----_x000A__x000A_Note 1: It is highly advisable to use a separate account for each service. When installing SQL Server in single-server mode, you can opt to have these provisioned for you. These automatically generated accounts are referred to as virtual accounts. Each virtual account has an equivalent Service SID, with the same name. The installer also creates an equivalent SQL Server login, also with the same name. Applying folder and file permissions to Service SIDs, rather than to domain accounts or local computer accounts, provides tighter control because these permissions are available only to the specific service when it is running and not in any other context. (However, when using failover clustering, a domain account must be specified at installation, rather than a virtual account.) For more on this topic, see http://msdn.microsoft.com/en-us/library/ms143504(v=sql.110).aspx._x000A__x000A_Note 2: Tips for adding a service SID/virtual account to a folder's permission list._x000A_1) In Windows Explorer, right-click on the folder and select "Properties."_x000A_2) Select the "Security" tab_x000A_3) Click "Edit"_x000A_4) Click "Add"_x000A_5) Click "Locations"_x000A_6) Select the computer name_x000A_7) Search for the name_x000A_7.a) SQL Server Service_x000A_7.a.i) Type "NT SERVICE\MSSQL" and click "Check Names". (What you have just typed in is the first 16 characters of the name. At least one character must follow "NT SERVICE\"; you will be presented with a list of all matches. If you have typed in the full, correct name, step 7.a.ii is bypassed.)_x000A_7.a.ii) Select the "MSSQL$&lt;instance name&gt;" user and click "OK"_x000A_7.b) SQL Agent Service_x000A_7.b.i) Type "NT SERVICE\SQL" and click "Check Names"_x000A_7.b.ii) Select the "SQLAgent$&lt;instance name&gt;" user and click "OK"_x000A_8) Click "OK"_x000A_9) Permission like a normal user from here_x000A__x000A_Note 3: In the interest of separation of responsibilities with least privilege, consider granting Full Control only to SQL Database Administrators (create a custom group for these) and providing the local Administrators group with Read access only.</S>
    </MS>
  </Obj>
  <Obj RefId="532">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2012</S>
      <S N="VulnID">V-55805</S>
      <S N="RuleID">SV-70059r4_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL2-00-004400</S>
      <S N="Title">SQL Server must not grant users direct access to the View Any Database permission.</S>
      <S N="Description">The concept of least privilege must be applied to SQL Server processes, ensuring that the processes operate at privilege levels no higher than necessary to accomplish required organizational missions and/or functions. Organizations consider the creation of additional processes, roles, and SQL Server accounts as necessary to achieve least privilege. Organizations also apply least privilege concepts to the design, development, implementation, and operations of SQL Server and the OS._x000A__x000A_Unauthorized access to sensitive data or SQL Server control may compromise the confidentiality of personnel privacy, threaten national security, compromise a variety of other sensitive operations or lead to a loss of system control. Access controls are best managed by defining requirements based on distinct job functions and assigning access based on the job function assigned to the individual user._x000A__x000A_Privileges granted outside of SQL Server's role-based account assignments are more likely to go unmanaged and without oversight of granted access. Maintenance of privileges using roles defined for discrete job functions offers improved oversight of application user privilege assignments and helps to protect against unauthorized privilege assignment._x000A__x000A_SQL Server's 'View Any Database' permission is a high server-level privilege that must only be granted to individual administration accounts through roles. This administrative privilege must not be assigned directly to administrative user accounts (or any other user accounts). If any user accounts have direct access to administrative privileges, this access must be removed._x000A__x000A_Note that this does not apply to logins with names of the form '##MS...##'. These accounts are internal-use system principals provisioned by the DBMS, and required by it for specific purposes.tru</S>
      <S N="FixText">Remove the 'View Any Database' permission access from the account that has direct access by running the following script:_x000A__x000A_USE master_x000A_REVOKE VIEW ANY DATABASE TO &lt;'account name'&gt;_x000A_GO   </S>
      <S N="Check">Obtain the list of accounts that have direct access to the server-level permission 'View Any Database' by running the following query:_x000A__x000A_SELECT_x000A_who.name AS [Principal Name],_x000A_who.type_desc AS [Principal Type],_x000A_who.is_disabled AS [Principal Is Disabled],_x000A_what.state_desc AS [Permission State],_x000A_what.permission_name AS [Permission Name]_x000A_FROM_x000A_sys.server_permissions what_x000A_INNER JOIN sys.server_principals who_x000A_ON who.principal_id = what.grantee_principal_id_x000A_WHERE_x000A_what.permission_name = 'View Any Database' _x000A_AND who.name NOT LIKE '##MS%##'_x000A_AND who.type_desc &lt;&gt; 'SERVER_ROLE'_x000A_ORDER BY_x000A_who.name_x000A_;_x000A_GO_x000A__x000A_If any user accounts have direct access to the 'View Any Database' permission, this is a finding._x000A__x000A_Alternatively, to provide a combined list for all requirements of this type:_x000A_SELECT_x000A_      what.permission_name AS [Permission Name],_x000A_      what.state_desc AS [Permission State],_x000A_      who.name AS [Principal Name],_x000A_      who.type_desc AS [Principal Type],_x000A_      who.is_disabled AS [Principal Is Disabled]_x000A_FROM_x000A_      sys.server_permissions what_x000A_      INNER JOIN sys.server_principals who_x000A_            ON who.principal_id = what.grantee_principal_id_x000A_WHERE_x000A_      what.permission_name IN_x000A_      (_x000A_      'Administer bulk operations',_x000A_      'Alter any availability group',_x000A_      'Alter any connection',_x000A_      'Alter any credential',_x000A_      'Alter any database',_x000A_      'Alter any endpoint ',_x000A_      'Alter any event notification ',_x000A_      'Alter any event session ',_x000A_      'Alter any linked server',_x000A_      'Alter any login',_x000A_      'Alter any server audit',_x000A_      'Alter any server role',_x000A_      'Alter resources',_x000A_      'Alter server state ',_x000A_      'Alter Settings ',_x000A_      'Alter trace',_x000A_      'Authenticate server ',_x000A_      'Control server',_x000A_      'Create any database ',_x000A_      'Create availability group',_x000A_      'Create DDL event notification',_x000A_      'Create endpoint',_x000A_      'Create server role',_x000A_      'Create trace event notification',_x000A_      'External access assembly',_x000A_      'Shutdown',_x000A_      'Unsafe Assembly',_x000A_      'View any database',_x000A_      'View any definition',_x000A_      'View server state'_x000A_      )_x000A_AND who.name NOT LIKE '##MS%##'_x000A_AND who.type_desc &lt;&gt; 'SERVER_ROLE'_x000A_ORDER BY_x000A_      what.permission_name,_x000A_      who.name_x000A_;_x000A_GO</S>
    </MS>
  </Obj>
  <Obj RefId="533">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2012</S>
      <S N="VulnID">V-59857</S>
      <S N="RuleID">SV-74287r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL2-00-009710</S>
      <S N="Title">Owners of privileged accounts must use non-privileged accounts for non-administrative activities.</S>
      <S N="Description">Use of privileged accounts for non-administrative purposes puts data at risk of unintended or unauthorized loss, modification, or exposure. In particular, DBA accounts, if used for non-administration application development or application maintenance, can lead to excessive privileges where privileges are inherited by object owners. It may also lead to loss or compromise of application data where the elevated privileges bypass controls designed in and provided by applications.</S>
      <S N="FixText">Require that DBAs and other privileged users use non-privileged accounts for non-administrative activities.</S>
      <S N="Check">Review procedures and practices.  If there is not a policy requiring owners of privileged accounts to use non-privileged accounts for non-administrative activities, this is a finding.  If there is evidence that owners of privileged accounts do not adhere to this policy, this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="534">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2012</S>
      <S N="VulnID">V-59915</S>
      <S N="RuleID">SV-74345r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL2-00-002500</S>
      <S N="Title">SQL Server must enforce access control policies to restrict the Alter any event notification permission to only authorized roles.</S>
      <S N="Description">The concept of least privilege must be applied to SQL Server processes, ensuring that the processes operate at privilege levels no higher than necessary to accomplish required organizational missions and/or functions. Organizations consider the creation of additional processes, roles, and SQL Server accounts as necessary to achieve least privilege. Organizations also apply least privilege concepts to the design, development, implementation, and operations of SQL Server and the OS._x000A__x000A_Unauthorized access to sensitive data or SQL Server control may compromise the confidentiality of personnel privacy, threaten national security, compromise a variety of other sensitive operations, or lead to a loss of system control. Access controls are best managed by defining requirements based on distinct job functions and assigning access based on the job function assigned to the individual user._x000A__x000A_SQL Server's 'Alter any event notification' permission is a high server-level privilege that must only be granted to individual administration accounts through roles. If the 'Alter any event notification' permission is granted to roles that are unauthorized to have this privilege, then this access must be removed._x000A__x000A_Additionally, the permission must not be denied to a role, because that could disable a user's legitimate access via another role._x000A__x000A_The fix for this vulnerability specifies the use of REVOKE. Be aware that revoking a permission that is currently denied to a role or user does not necessarily disable the permission. If the user or role can inherent the permission from another role, revoking the denied permission from the user or the first role can effectively enable the inherited permission.</S>
      <S N="FixText">Remove the 'Alter any event notification' permission access from the role that is not authorized by executing the following query:_x000A__x000A_REVOKE Alter any event notification TO &lt;'role name'&gt;</S>
      <S N="Check">Obtain the list of roles that are authorized for the SQL Server 'Alter any event notification' permission and what 'Grant', 'Grant With', and/or 'Deny' privilege is authorized. Obtain the list of roles with that permission by running the following query:_x000A__x000A_SELECT_x000A_who.name AS [Principal Name],_x000A_who.type_desc AS [Principal Type],_x000A_who.is_disabled AS [Principal Is Disabled],_x000A_what.state_desc AS [Permission State],_x000A_what.permission_name AS [Permission Name]_x000A_FROM_x000A_sys.server_permissions what_x000A_INNER JOIN sys.server_principals who_x000A_ON who.principal_id = what.grantee_principal_id_x000A_WHERE_x000A_what.permission_name = 'Alter any event notification'_x000A_AND who.type_desc = 'SERVER_ROLE'_x000A_ORDER BY_x000A_who.name_x000A_;_x000A_GO </S>
    </MS>
  </Obj>
  <Obj RefId="535">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2012</S>
      <S N="VulnID">V-69169</S>
      <S N="RuleID">SV-83773r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL2-00-015355</S>
      <S N="Title">Software, applications, and configuration files that are part of, or related to, the SQL Server 2012 installation must be audited.</S>
      <S N="Description">When dealing with change control issues, it should be noted, any changes to the hardware, software, and/or firmware components of applications and tools related to SQL Server can potentially have significant effects on the overall security of the system. Only qualified and authorized individuals shall be allowed to obtain access to components related to SQL Server for purposes of initiating changes, including upgrades and modifications._x000A__x000A_Unmanaged changes that occur to the software libraries or configuration can lead to unauthorized or compromised installations._x000A__x000A_Of particular note in this context is that any software installed for auditing and/or audit file management must be protected and audited.</S>
      <S N="FixText">Include locations of all files, libraries, scripts, and executables that are part of, or related to, the SQL Server 2012 installation in the documentation._x000A__x000A_Ensure that files and folders that are part of, or related to, the SQL Server 2012 installation have auditing enabled. Right-click on the file/folder, click Properties. On the Security tab, click Advanced. On the Auditing tab, use the Add or Edit buttons and the dialogs that follow from them, to set up the following on at least one audit:_x000A_Type: All_x000A_Principal: Everyone_x000A_Access: Modify_x000A_Applies to: This Folder, subfolder, and files [where applicable]</S>
      <S N="Check">Obtain the SQL Server software directory location: from a command prompt, open the registry editor by typing regedit.exe and pressing [ENTER]. Navigate to the following registry location:_x000A_HKEY_LOCAL_MACHINE_x000A_&gt;&gt; SOFTWARE_x000A_&gt;&gt; Microsoft_x000A_&gt;&gt; Microsoft SQL Server_x000A_&gt;&gt; [INSTANCE NAME]_x000A_&gt;&gt; Setup_x000A_&gt;&gt; SQLBinRoot_x000A__x000A_Determine the location of separate but related softare, such as audit file management tools._x000A__x000A_Verify that files and folders that are part of, or related to, the SQL Server 2012 installation have auditing enabled. Right-click on the file/folder, click Properties. On the Security tab, click Advanced. On the Auditing tab, verify _x000A_that the following is set up on at least one audit:_x000A_Type: All_x000A_Principal: Everyone_x000A_Access: Modify_x000A_Applies to: This Folder, subfolder, and files [where applicable]_x000A__x000A_If the required audit settings are not configured, there is a risk that unauthorized changes to the software will go undetected, and this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="536">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2012</S>
      <S N="VulnID">V-70625</S>
      <S N="RuleID">SV-85247r1_rule</S>
      <S N="Severity">low</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL2-00-039100</S>
      <S N="Title">The SQL Server Browser service must be disabled if its use is not necessary.</S>
      <S N="Description">The SQL Server Browser simplifies the administration of SQL Server, particularly when multiple instances of SQL Server coexist on the same computer.  It avoids the need to hard-assign port numbers to the instances and to set and maintain those port numbers in client systems.  It enables administrators and authorized users to discover database management system instances, and the databases they support, over the network._x000A__x000A_This convenience also presents the possibility of unauthorized individuals gaining knowledge of the available SQL Server resources.  Therefore, it is necessary to consider whether the SQL Server Browser is needed.  Typically, if only a single instance is installed, using the default name (MSSQLSERVER) and port assignment (1433), the Browser is not adding any value.   The more complex the installation, the more likely SQL Server Browser is to be helpful._x000A__x000A_This requirement is not intended to prohibit use of the Browser service in any circumstances; rather, it calls for administrators and management to consider whether the benefits of its use outweigh the potential negative consequences.</S>
      <S N="FixText">If SQL Server Browser is needed, document the justification and obtain the appropriate approvals._x000A__x000A_Where SQL Server Browser is judged unnecessary, in the Services tool, double-click on "SQL Server Browser" to open its "Properties" dialog.  Set Startup Type to "Disabled".  If Service Status is "Running", click on "Stop".  Click on "OK".</S>
      <S N="Check">If the need for the SQL Server Browser service is documented, with appropriate approval, this is not a finding._x000A__x000A_Open the Services tool._x000A__x000A_Either navigate, via the Windows Start Menu and/or Control Panel, to "Administrative Tools", and select "Services" or at a command prompt, type "services.msc" and press the "Enter" key._x000A__x000A_Scroll to "SQL Server Browser"._x000A__x000A_If its Startup Type is not shown as "Disabled", this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="537">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2012</S>
      <S N="VulnID">V-72413</S>
      <S N="RuleID">SV-87037r1_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL2-00-038900</S>
      <S N="Title">If SQL Server authentication, using passwords, is employed, SQL Server must enforce the DoD standards for password complexity.</S>
      <S N="Description">Windows domain/enterprise authentication and identification must be used (SQL2-00-023600). Native SQL Server authentication may be used only when circumstances make it unavoidable; and must be documented and AO-approved._x000A__x000A_The DoD standard for authentication is DoD-approved PKI certificates. Authentication based on User ID and Password may be used only when it is not possible to employ a PKI certificate, and requires AO approval._x000A__x000A_In such cases, the DoD standards for password complexity must be implemented._x000A__x000A_The requirements for password complexity are:_x000A_a. minimum of 15 Characters, 1 of each of the following character sets:_x000A_- Upper-case_x000A_- Lower-case_x000A_- Numeric_x000A_- Special characters (e.g. ~ ! @ # $ % ^ &amp; * ( ) _ + = - ' [ ] / ? &gt; </S>
      <S N="FixText">For each SQL Server Login identified in the Check as out of compliance:_x000A_In SQL Server Management Studio Object Explorer, navigate to &lt;SQL Server instance name&gt; &gt;&gt; Security &gt;&gt; Logins &gt;&gt; &lt;login name&gt;.  Right-click, select Properties.  Select the check box Enforce Password Policy.  Click OK._x000A__x000A_Alternatively, for each identified Login, run the statement:_x000A_ALTER LOGIN &lt;login name&gt; CHECK_POLICY = ON;</S>
      <S N="Check">Run the statement:_x000A_SELECT_x000A_    name_x000A_FROM _x000A_    sys.sql_logins _x000A_WHERE_x000A_    type_desc = 'SQL_LOGIN'_x000A_    AND is_disabled = 0_x000A_    AND is_policy_checked = 0 ; _x000A__x000A_If no account names are listed, this is not a finding._x000A__x000A_For each account name listed, determine whether it is documented as requiring exemption from the standard password complexity rules.  If it is not, this is a finding.</S>
    </MS>
  </Obj>
  <Obj RefId="538">
    <TNRef RefId="0" />
    <MS>
      <S N="Type">Instance</S>
      <S N="SqlVersion">2012</S>
      <S N="VulnID">V-72415</S>
      <S N="RuleID">SV-87039r2_rule</S>
      <S N="Severity">medium</S>
      <S N="Weight">10.0</S>
      <S N="Version">SQL2-00-038910</S>
      <S N="Title">If SQL Server authentication, using passwords, is employed, SQL Server must enforce the DoD standards for password lifetime.</S>
      <S N="Description">Windows domain/enterprise authentication and identification must be used (SQL2-00-023600). Native SQL Server authentication may be used only when circumstances make it unavoidable; and must be documented and AO-approved._x000A__x000A_The DoD standard for authentication is DoD-approved PKI certificates. Authentication based on User ID and Password may be used only when it is not possible to employ a PKI certificate, and requires AO approval._x000A__x000A_In such cases, the DoD standards for password lifetime must be implemented._x000A__x000A_The requirements for password lifetime are:_x000A_a. Password lifetime limits for interactive accounts:  Minimum 24 hours, Maximum 60 days_x000A_b. Password lifetime limits for non-interactive accounts:  Minimum 24 hours, Maximum 365 days_x000A_c. Number of password changes before an old one may be reused:  Minimum of 5._x000A__x000A_To enforce this in SQL Server, configure each DBMS-managed login to inherit the rules from Windows.</S>
      <S N="FixText">For each SQL Server Login identified in the Check as out of compliance:_x000A_In SQL Server Management Studio Object Explorer, navigate to &lt;SQL Server instance name&gt; &gt;&gt; Security &gt;&gt; Logins &gt;&gt; &lt;login name&gt;. Right-click, select Properties. Select the check box Enforce Password Expiration. Click OK._x000A__x000A_Alternatively, for each identified Login, run the statement:_x000A_ALTER LOGIN &lt;login name&gt; CHECK_EXPIRATION = ON;</S>
      <S N="Check">Run the statement:_x000A_SELECT_x000A_name_x000A_FROM_x000A_sys.sql_logins_x000A_WHERE_x000A_type_desc = 'SQL_LOGIN'_x000A_AND is_disabled = 0_x000A_AND is_expiration_checked = 0;_x000A__x000A_If no account names are listed, this is not a finding._x000A__x000A_For each account name listed, determine whether it is documented as requiring exemption from the standard password lifetime rules, if it is not, this is a finding.</S>
    </MS>
  </Obj>
</Objs>
